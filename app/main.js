(self["webpackChunkdevice"] = self["webpackChunkdevice"] || []).push([["main"],{

/***/ 28171:
/*!***********************************************!*\
  !*** ./projects/core/src/app/data/data/ad.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Ad": () => (/* binding */ Ad)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Ad extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Ad";
    }
}


/***/ }),

/***/ 82901:
/*!****************************************************!*\
  !*** ./projects/core/src/app/data/data/address.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Address": () => (/* binding */ Address)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Address extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Address";
    }
}


/***/ }),

/***/ 20202:
/*!******************************************************!*\
  !*** ./projects/core/src/app/data/data/agreement.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Agreement": () => (/* binding */ Agreement)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Agreement extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Agreement";
        this.passive = false;
    }
}


/***/ }),

/***/ 32552:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/badge.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Badge": () => (/* binding */ Badge)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Badge extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Badge";
    }
}


/***/ }),

/***/ 25237:
/*!****************************************************!*\
  !*** ./projects/core/src/app/data/data/benefit.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Benefit": () => (/* binding */ Benefit)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _order_item__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./order-item */ 88783);
/* harmony import */ var _utility_math_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility/math-utils */ 45672);



class Benefit extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Benefit";
        this.max = 1; //using times
        this.fixedamount = 0; //discount reduced to a fixed amount
        this.applied = false; //for gift/unlock benefit, when the gift or unlock cat found, applied = true
        this.used = 0;
    }
    /**clone original benefit as a new benefit object**/
    static cloneBenefit(ben) {
        let b = new Benefit();
        if (ben.type)
            b.type = ben.type;
        if (ben.amount)
            b.amount = ben.amount;
        if (ben.code)
            b.code = ben.code;
        if (ben.code2)
            b.code2 = ben.code2;
        if (ben.max)
            b.max = ben.max;
        if (ben.percent)
            b.percent = ben.percent;
        if (ben.applied)
            b.applied = ben.applied;
        if (ben.used)
            b.used = ben.used;
        if (ben.display)
            b.display = ben.display;
        if (ben.display2)
            b.display2 = ben.display2;
        if (ben.fixedamount)
            b.fixedamount = ben.fixedamount;
        return b;
    }
    /**
     * @param order, order
     * @param condition, discount's main condition
     * @param promo, discount
     * @param orderitem (optional), used only when discount is of item level
     * calculate discount amount
     * */
    apply(order, condition, promo, orderItem = null, tmpCounter = 0, store, roundPrecision = 1) {
        let discount = 0; //discounted amount after applying this benefit
        switch (this.type) {
            case 'fixedamount': {
                if (condition.type == "itemgroup") {
                    if (promo.available >= this.max) {
                        break;
                    }
                }
                let count = 1;
                if (tmpCounter > count) {
                    count = tmpCounter;
                }
                // if (condition.type === "total") {
                //     //do nothing
                // } else if (condition.level === "item" && condition.type !== "itemgroup_count") {
                //     //condition type = item or itemgroup or exitemgroup
                //     if (orderItem.quantity) count = orderItem.quantity;
                // }
                let netAmount = 0;
                let mainItem = _order_item__WEBPACK_IMPORTED_MODULE_1__.OrderItem.getMainItem(orderItem);
                if (this.fixedamount < orderItem.total) {
                    netAmount = (mainItem.price - this.fixedamount);
                }
                else {
                    netAmount = this.fixedamount;
                }
                discount = this.round(netAmount * count);
                if (orderItem) {
                    orderItem.discount = discount;
                    if (orderItem.discounts && orderItem.discounts.length > 0) {
                        if (orderItem.discounts.indexOf(promo) === -1) {
                            orderItem.discounts.push(promo);
                        }
                    }
                    else {
                        orderItem.discounts.push(promo);
                    }
                }
                this.setMainItemDiscounted(orderItem, discount, promo);
                //for itemgroup_count type conditon, discountClaimed will be updated at condition.ts
                if ((condition.type != "itemgroup_count" && condition.type != "item_count") && condition.type != "item")
                    orderItem["discountClaimed"] += count;
                promo.available += count;
                break;
            }
            case 'amount': {
                if (this.amount > 0) {
                    if (condition.type == "itemgroup") {
                        if (promo.available >= this.max) {
                            break;
                        }
                    }
                    let count = 1;
                    if (condition.type === "total") {
                        let total = condition.discounted ? order.grandTotal : order.total;
                        total = condition.applyHandling ? total + order.handling : total;
                        count = Math.floor(total / condition.amount);
                    }
                    else if (condition.level === "item" && condition.type !== "itemgroup_count" && condition.type !== "item_count") {
                        //condition type = item or itemgroup or exitemgroup
                        if (orderItem.quantity)
                            count = orderItem.quantity;
                    }
                    else if (condition.type === 'itemgroup_count' || condition.type === 'item_count') {
                        count = tmpCounter;
                    }
                    if (count > this.max)
                        count = this.max;
                    if (this.amount)
                        discount = this.round(this.amount * count);
                    if (discount > order.grandTotal) {
                        promo.overpay = this.round(discount - order.grandTotal);
                    }
                    if (orderItem) {
                        orderItem.discount = discount;
                        if (orderItem.discounts && orderItem.discounts.length > 0) {
                            if (orderItem.discounts.indexOf(promo) === -1) {
                                orderItem.discounts.push(promo);
                            }
                        }
                        else {
                            orderItem.discounts.push(promo);
                        }
                    }
                    promo.available += count;
                }
                break;
            }
            //split two cases: order level and item level discount
            //when in item level, promotion group items should be calculate separately
            case 'percent': {
                if (this.percent) {
                    //The precision of discount lookup from currency.
                    // Check out precision will look on menu settings , otherwise fall back to look currency
                    // let roundPrecision = orderManager.getPrecision();
                    //let roundPrecision = orderManager.getStoreGrandTotalPrecision(store.currency);
                    let count = 1;
                    if (condition.level == "order") {
                        //todo?? not first discount
                        let discountableTotal = condition.discounted ? order.grandTotal : order.total;
                        // let discountableTotal = order.total;
                        // TODO: the round is step 0.5 now. Should change round step based on currency?
                        let temp = promo.conditions.find(condition => condition.traverseItemsDiscountable);
                        if (temp) {
                            order.orderitems.forEach(oi => {
                                let orderItemDiscount = 0;
                                oi.items.forEach(item => {
                                    if (!item.discountable) {
                                        discountableTotal -= item.price * (item.quantity * oi.quantity);
                                    }
                                    else {
                                        orderItemDiscount += item.price * (item.quantity * oi.quantity);
                                    }
                                });
                                if (oi.discounts && oi.discounts.length > 0) {
                                    oi.discounts.forEach(dis => {
                                        if (dis.level && dis.level == "order") {
                                            oi.discount = orderItemDiscount * this.percent / 100.0;
                                        }
                                        else {
                                            oi.discount += orderItemDiscount * this.percent / 100.0;
                                        }
                                    });
                                }
                                else {
                                    oi.discount += orderItemDiscount * this.percent / 100.0;
                                    oi.discounts.push(promo);
                                }
                                oi.discount = this.orderItemDiscountRound(oi.discount, roundPrecision, store);
                                if (oi.discounts.indexOf(promo) === -1) {
                                    oi.discounts.push(promo);
                                }
                            });
                        }
                        else {
                            // TODO: handle isMainItemOnly case
                            // traverseItemsDiscountable is false, only apply main item discountable to all items
                            order.orderitems.forEach(oi => {
                                let orderItemDiscount = 0;
                                const mainItem = oi.items[0];
                                const discountable = (mainItem.marker && mainItem.marker == "alone" && !mainItem.discountable) || (mainItem.marker !== "alone" && !oi.items[0].discountable) || !mainItem.discountable;
                                oi.items.forEach(item => {
                                    if (discountable) {
                                        discountableTotal -= item.price * (item.quantity * oi.quantity);
                                    }
                                    else {
                                        orderItemDiscount += item.price * (item.quantity * oi.quantity);
                                    }
                                });
                                if (oi.discounts && oi.discounts.length > 0) {
                                    oi.discounts.forEach(dis => {
                                        if (dis.level && dis.level == "order") {
                                            oi.discount = orderItemDiscount * this.percent / 100.0;
                                        }
                                        else {
                                            oi.discount += orderItemDiscount * this.percent / 100.0;
                                        }
                                    });
                                }
                                else {
                                    oi.discount += orderItemDiscount * this.percent / 100.0;
                                    oi.discounts.push(promo);
                                }
                                oi.discount = this.orderItemDiscountRound(oi.discount, roundPrecision, store);
                                if (oi.discounts.indexOf(promo) === -1) {
                                    oi.discounts.push(promo);
                                }
                            });
                        }
                        discount = this.discountRound(discountableTotal, roundPrecision, store);
                    }
                    else if (condition.level == "item") {
                        if (orderItem.quantity)
                            count = Math.min(orderItem.quantity, this.max);
                        if (tmpCounter > count) {
                            count = tmpCounter;
                        }
                        //Spilt Promotion Group Item
                        let clone = Object.assign({}, orderItem);
                        let mainItem = _order_item__WEBPACK_IMPORTED_MODULE_1__.OrderItem.getMainItem(clone);
                        let pgroupItems = [];
                        if (mainItem.pgroupId) {
                            let pgroup = orderItem.groups.find(group => {
                                return group.id === mainItem.pgroupId;
                            });
                            pgroupItems = pgroup && pgroup.items;
                        }
                        // check every item
                        discount = 0;
                        if (mainItem.discountable) {
                            let discountableTotal = orderItem.total * count;
                            if (condition.isMainItemOnly()) {
                                const mainItem = orderItem.items[0];
                                orderItem.items.forEach(item => {
                                    discountableTotal -= item.price * (item.quantity * orderItem.quantity);
                                });
                                if (mainItem.discountable) {
                                    discountableTotal += mainItem.price * (mainItem.quantity * orderItem.quantity);
                                }
                            }
                            else {
                                let target = true;
                                if (condition.type === 'itemgroup' || condition.type === 'itemgroup_count') {
                                    target = false;
                                }
                                let temp = promo.conditions.find(condition => target === condition.traverseItemsDiscountable);
                                if (temp) {
                                    orderItem.items.forEach(item => {
                                        if ((item.marker && item.marker == "alone" && !item.discountable) || (item.marker !== "alone" && !orderItem.items[0].discountable) || !item.discountable) {
                                            discountableTotal -= item.price * (item.quantity * orderItem.quantity);
                                        }
                                    });
                                }
                                else {
                                    //boolean mainDiscountable = oi.getFlattenItemsWithModifiers().get(0).getDiscountable();
                                    //
                                    // 			for(Item item: items){
                                    // 				if(mainDiscountable){
                                    // 					total += item.getPrice() * item.getQuantity();
                                    // 				}
                                    // 			}
                                    const mainItem = orderItem.items[0];
                                    const mainDiscountable = mainItem.discountable;
                                    orderItem.items.forEach((item, i) => {
                                        if (!mainItem.discountable) {
                                            discountableTotal -= item.price * (item.quantity * orderItem.quantity);
                                        }
                                        else if (mainItem.discountable && i !== 0) {
                                            discountableTotal -= item.price * (item.quantity * orderItem.quantity);
                                        }
                                    });
                                }
                            }
                            discount = this.discountRound(discountableTotal, roundPrecision, store);
                        }
                        if (pgroupItems != null && pgroupItems.length > 0) {
                            pgroupItems.forEach(pitem => {
                                if (!pitem.discountable) {
                                    discount -= (pitem.price * pitem.quantity * this.percent / 100.00 * count);
                                }
                            });
                        }
                        discount = this.orderItemDiscountRound(discount, roundPrecision, store);
                        orderItem.discount = discount;
                        if (orderItem.discounts && orderItem.discounts.length > 0) {
                            if (orderItem.discounts.indexOf(promo) === -1) {
                                orderItem.discounts.push(promo);
                            }
                        }
                        else {
                            orderItem.discounts.push(promo);
                        }
                    }
                    promo.available += count;
                }
                break;
            }
            //TODO NOT YET APPLIED
            case 'offer': {
                if (this.code) {
                }
                break;
            }
            //for type==gift, only mark applied as true when gift is available
            case 'gift': {
                if (this.code) {
                    let item = this.findGift(promo);
                    this.applied = !!item;
                }
                break;
            }
            //for type==unlock, only mark applied as true when unlock category is available
            case 'unlock': {
                if (this.code) {
                    let cat = this.fetchUnlock(promo);
                    let used = 0;
                    if (cat !== null) {
                        order.orderitems.forEach(oi => {
                            if (oi.categoryId === this.code) {
                                used += oi.quantity;
                                console.log("used+:", oi.quantity);
                            }
                        });
                    }
                    console.log("used:", used);
                    this.used = used;
                    this.applied = used === 0; //if not yet used then apply this benefit
                }
                break;
            }
            default:
                break;
        }
        return discount;
    }
    /**get discount unlocked category**/
    fetchUnlock(promo) {
        if (promo.unlocks) {
            for (let unlock of promo.unlocks) {
                if (unlock.id == this.code) {
                    return unlock;
                }
            }
        }
        return null;
    }
    /**get discount gift**/
    findGift(promo) {
        if (promo.gifts) {
            for (let gift of promo.gifts) {
                if (gift && gift.groups && gift.groups[0] && gift.groups[0].items && gift.groups[0].items.length > 0) {
                    for (let item of gift.groups[0].items) {
                        if (item.id == this.code)
                            return item;
                    }
                }
            }
        }
        return null;
    }
    /*getDisplay() {
        this.display = "";
        if (this.amount) {
            this.display = "-" + this.amount;
        } else if (this.percent) {
            this.display = "-" + this.percent + "%";
        }
        return this.display;
    }*/
    isDiscount() {
        return this.type !== "unlock";
        //unlock type always is of lowest priority
    }
    isItemDiscount() {
        switch (this.type) {
            case "amount":
                return true;
            default:
                break;
        }
        return false;
    }
    setMainItemDiscounted(oi, amount, discount) {
        if (oi.groups || oi.groups.length == 0)
            return;
        oi.groups[0].items.forEach(item => {
            item.discounted = true;
            item.discount = amount;
            item.discountCode = discount.backendId;
            item.discountedId = discount.id;
        });
    }
    round(value) {
        return _utility_math_utils__WEBPACK_IMPORTED_MODULE_2__.MathUtils.round(value, 2);
    }
    toProperty(name, value) {
        return value;
    }
    /** 有些pos要求每個orderitem有discount，而且要按照他們的計算要求, 所以特别使用了discountRoundMode**/
    orderItemDiscountRound(value, precision, store) {
        if (store && store.menu && store.menu.settings && store.menu.settings.discountRoundMode) {
            if (store.menu.settings.discountRoundMode === 'rounddown') {
                return _utility_math_utils__WEBPACK_IMPORTED_MODULE_2__.MathUtils.floor(value, precision);
            }
            else if (store.menu.settings.discountRoundMode === 'roundup') {
                return _utility_math_utils__WEBPACK_IMPORTED_MODULE_2__.MathUtils.ceil(value, precision);
            }
            else if (store.menu.settings.discountRoundMode === 'roundtonear5') {
                return _utility_math_utils__WEBPACK_IMPORTED_MODULE_2__.MathUtils.round(value, precision);
            }
            else {
                return _utility_math_utils__WEBPACK_IMPORTED_MODULE_2__.MathUtils.round(value, precision);
            }
        }
        else {
            return _utility_math_utils__WEBPACK_IMPORTED_MODULE_2__.MathUtils.round(value, precision);
        }
    }
    discountRound(value, precision, store) {
        let discountRoundMethod;
        let p = precision;
        if (store && store.menu && store.menu.settings) {
            discountRoundMethod = store.menu.settings.discountRoundMethod;
            if (typeof store.menu.settings.discountRoundingPrecision === 'number') {
                p = store.menu.settings.discountRoundingPrecision;
            }
        }
        let roundTo = 10;
        if (p && typeof p === 'number') {
            if (p === 0) {
                roundTo = 1;
            }
            else {
                roundTo = Math.pow(10, p);
            }
        }
        switch (discountRoundMethod) {
            case 'round2discount':
                return Math.round(value * this.percent / 100.0 * roundTo) / roundTo;
            case 'round2net':
                return value - Math.round(value * (1 - this.percent / 100.0) * roundTo) / roundTo;
            default:
                return value * this.percent / 100.0;
        }
    }
}


/***/ }),

/***/ 91826:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/brand.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Brand": () => (/* binding */ Brand)
/* harmony export */ });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ 84291);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _ad__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ad */ 28171);
/* harmony import */ var _crm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./crm */ 47114);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./store */ 94045);





class Brand extends _data__WEBPACK_IMPORTED_MODULE_3__.Data {
    constructor() {
        super(...arguments);
        this.class = "Brand";
        this.features = [];
        this.themes = {};
        this.extra = {};
        this.payments = [];
    }
    toProperty(name, value) {
        if (name == "stores") {
            return _data__WEBPACK_IMPORTED_MODULE_3__.Data.toDataArray(_store__WEBPACK_IMPORTED_MODULE_4__.Store, value);
        }
        else if (name == "ads") {
            return _data__WEBPACK_IMPORTED_MODULE_3__.Data.toDataArray(_ad__WEBPACK_IMPORTED_MODULE_1__.Ad, value);
        }
        else if (name == "crm") {
            return _data__WEBPACK_IMPORTED_MODULE_3__.Data.toData(_crm__WEBPACK_IMPORTED_MODULE_2__.Crm, value);
        }
        return value;
    }
    static hasFeature(brand, feature) {
        if (brand === null || brand === void 0 ? void 0 : brand.features) {
            return brand.features.indexOf(feature) >= 0;
        }
        return false;
    }
    static getBusiness(store, time) {
        var offset = 8;
        if (store.timezone) {
            offset = Number.parseInt(store.timezone.replace("GMT", ""));
        }
        return moment__WEBPACK_IMPORTED_MODULE_0__(time.getTime()).utcOffset(offset).format('YYYY-MM-DD');
    }
}


/***/ }),

/***/ 42143:
/*!***********************************************************!*\
  !*** ./projects/core/src/app/data/data/category-group.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CategoryGroup": () => (/* binding */ CategoryGroup)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _item_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./item-group */ 3840);


class CategoryGroup extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "CategoryGroup";
    }
    toProperty(name, value) {
        switch (name) {
            case "groups":
                value = _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_item_group__WEBPACK_IMPORTED_MODULE_1__.ItemGroup, value);
                break;
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
}


/***/ }),

/***/ 62419:
/*!*****************************************************!*\
  !*** ./projects/core/src/app/data/data/category.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Category": () => (/* binding */ Category)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _item_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./item-group */ 3840);


class Category extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Category";
        this.groupIds = [];
        this.groups = [];
        this.isWarningViewed = false;
    }
    toProperty(name, value) {
        switch (name) {
            case "groups":
                value = _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_item_group__WEBPACK_IMPORTED_MODULE_1__.ItemGroup, value);
                break;
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
    get displayName() {
        if (this.prefix)
            return this.prefix + this.name;
        return this.name;
    }
    static toCategoryData(category) {
        var json = {};
        if (category) {
            json["id"] = category.id;
            json['name'] = category.name;
            json['type'] = category.type;
        }
        // json["cGroupId"] = category.cGroupId;
        // json["departmentId"] = category.departmentId;
        return json;
    }
}


/***/ }),

/***/ 92587:
/*!***************************************************!*\
  !*** ./projects/core/src/app/data/data/charge.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Charge": () => (/* binding */ Charge)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Charge extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Charge";
    }
}


/***/ }),

/***/ 24194:
/*!******************************************************!*\
  !*** ./projects/core/src/app/data/data/condition.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Condition": () => (/* binding */ Condition)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _order_item__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./order-item */ 88783);


class Condition extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super();
        this.class = "Condition";
        this.applicable = 1; //# times of meeting the condition
        this.discounted = false; //used for amount condition
        this.count = 1; // itemgroup count
    }
    /**Clone original condition as a new condition object**/
    static cloneCondition(cond) {
        let c = new Condition();
        if (cond.type)
            c.type = cond.type;
        if (cond.code)
            c.code = cond.code;
        if (cond.member)
            c.member = cond.member;
        if (cond.amount)
            c.amount = cond.amount;
        if (cond.applicable)
            c.applicable = cond.applicable;
        if (cond.discounted)
            c.discounted = cond.discounted;
        if (cond.applyHandling)
            c.applyHandling = cond.applyHandling;
        if (cond.display)
            c.display = cond.display;
        if (cond.prefix)
            c.prefix = cond.prefix;
        if (cond.level)
            c.level = cond.level;
        if (cond.tiers)
            c.tiers = [...cond.tiers];
        if (cond.source)
            c.source = cond.source;
        if (cond.couponPoint)
            c.couponPoint = cond.couponPoint;
        if (cond.count)
            c.count = cond.count;
        if (cond.traverseItemsDiscountable)
            c.traverseItemsDiscountable = cond.traverseItemsDiscountable;
        if (cond.ignoreCase)
            c.ignoreCase = cond.ignoreCase;
        c.getLevel();
        c.getDisplay();
        return c;
    }
    /**
     * applying discount and get discount amount
     * @param order: current order
     * @param promo: discount
     * @param benefit: discount's benefit
     * **/
    apply(order, promo, benefit, store, roundPrecision = 1) {
        if (this.getLevel() == 'item') {
            let total = 0;
            if (this.type == "itemgroup_count" || this.type == 'item_count') {
                if (benefit.max > 1) {
                    let benefitMax = benefit.max;
                    //sort order item with price to set discount to the min value orderitem
                    order.orderitems.sort((a, b) => a.total - b.total);
                    let ois = [];
                    ois = JSON.parse(JSON.stringify(order.orderitems));
                    // find the oi which has the condition code
                    ois = ois.filter((oi) => {
                        return this.oiContainsCode(oi);
                    });
                    let totalCount = ois.reduce((a, b) => a + b.quantity, 0);
                    this.applicable = Math.floor(totalCount / this.count);
                    //set orderitems from min to max
                    // ois = ois.sort((a, b) =>a.total - b.total);
                    let count = 0;
                    order.orderitems.forEach((oi) => {
                        if (this.oiContainsCode(oi) && count < this.applicable) {
                            let applyCount;
                            let discount;
                            if (((oi.quantity - oi['discountClaimed']) > 0)) {
                                if ((oi.quantity - oi['discountClaimed']) >= benefitMax) {
                                    count = benefit.max;
                                    discount = benefit.apply(order, this, promo, oi, benefitMax, store, roundPrecision);
                                    oi['discountClaimed'] += benefitMax;
                                    benefitMax = 0;
                                }
                                else {
                                    applyCount = (this.applicable - count) < oi.quantity ? (this.applicable - count) : oi.quantity;
                                    discount = benefit.apply(order, this, promo, oi, applyCount, store, roundPrecision);
                                    oi['discountClaimed'] += applyCount;
                                    benefitMax = benefitMax - oi.quantity;
                                }
                            }
                            count += applyCount;
                            //let discount = benefit.apply(order, this, promo, oi, 0, store, orderManager);
                            total += discount;
                            if (discount && promo.backendId) {
                                oi.discountCode = promo.backendId;
                            }
                            if (discount || benefit.applied)
                                oi.discountDesc = promo.desc ? promo.desc : promo.name;
                        }
                    });
                }
                else if (benefit.max == 1) {
                    let minOi;
                    let minTotal;
                    for (let oi of order.orderitems) {
                        if (this.oiContainsCode(oi) && !this.hasExistingItemLevelDiscount(oi, promo)) {
                            if ((!minTotal || minTotal > oi.total) && (oi['discountClaimed'] < oi.quantity)) {
                                minTotal = oi.total;
                                minOi = oi;
                            }
                        }
                    }
                    if (minOi) {
                        minOi['discountClaimed']++;
                    }
                    if (minOi) {
                        let discount = benefit.apply(order, this, promo, minOi, 1, store, roundPrecision);
                        total += discount;
                        if (discount && promo.backendId) {
                            minOi.discountCode = promo.backendId;
                        }
                        if (discount || benefit.applied)
                            minOi.discountDesc = promo.desc ? promo.desc : promo.name;
                    }
                }
            }
            else {
                var benefitMax = benefit.max;
                order.orderitems.forEach(oi => {
                    if (this.oiContainsCode(oi) && !this.hasExistingItemLevelDiscount(oi, promo)) {
                        var discount = 0;
                        if (((oi.quantity - oi['discountClaimed']) > 0) && benefitMax > 0) {
                            if ((oi.quantity - oi['discountClaimed']) >= benefitMax) {
                                discount = benefit.apply(order, this, promo, oi, benefitMax, store, roundPrecision);
                                oi['discountClaimed'] += benefitMax;
                                benefitMax = 0;
                            }
                            else {
                                discount = benefit.apply(order, this, promo, oi, oi.quantity, store, roundPrecision);
                                oi['discountClaimed'] += oi.quantity;
                                benefitMax = benefitMax - oi.quantity;
                            }
                        }
                        total += discount;
                        if (discount && promo.backendId) {
                            oi.discountCode = promo.backendId;
                        }
                        // oi.discounts.push(promo); //no use
                        if (discount || benefit.applied)
                            oi.discountDesc = promo.desc ? promo.desc : promo.name;
                    }
                });
            }
            return total;
        }
        else {
            return benefit.apply(order, this, promo, null, 0, store, roundPrecision);
        }
    }
    /**check conditions to use the discount**/
    isSatisfied(order, promo) {
        let ok = false;
        if (!promo) {
            console.log("isSatisfied: ", ok);
            return ok;
        }
        switch (this.type.toLowerCase()) {
            //unconditional
            case 'all': {
                ok = true;
                break;
            }
            case 'coupon': {
                ok = true;
                break;
            }
            case 'guest': {
                this.applicable = 0;
                if (!this.member && !order.member) {
                    ok = true;
                    this.applicable = 1;
                }
                break;
            }
            //check member type, check member tier
            case 'member': {
                this.applicable = 0;
                if (this.member && order.member && order.member.method != 'device') {
                    if (this.tiers) {
                        if (!order.member.tier || this.tiers.indexOf(order.member.tier) < 0) {
                            ok = false;
                            break;
                        }
                    }
                    this.applicable = 1;
                    ok = true;
                }
                break;
            }
            //TODO: maintotal???
            case 'total':
            case 'maintotal': {
                if (this.amount) {
                    let total = this.discounted ? order.grandTotal : order.total;
                    total = this.applyHandling ? total + order.handling : total;
                    //unlock benefit special deal
                    if (!this.discounted && promo.benefits && promo.benefits[0] && promo.benefits[0].type == "unlock") {
                        if (promo.benefits[0].code) {
                            let code = promo.benefits[0].code;
                            order.orderitems.forEach(oi => {
                                if (oi.categoryId == code && oi.quantity > 0) {
                                    total -= oi.total * oi.quantity;
                                }
                            });
                        }
                    }
                    if (total >= this.amount) {
                        this.applicable = Math.floor(total / this.amount);
                        ok = true;
                    }
                    else {
                        this.applicable = 0;
                    }
                }
                break;
            }
            //ordered mainitem(s)
            case 'item': {
                if (this.code) {
                    this.applicable = 0;
                    if (this.code.toLowerCase() == "all") {
                        ok = true;
                        order.orderitems.forEach(oi => {
                            this.applicable += oi.quantity;
                        });
                        break;
                    }
                    let codes = this.code.split(",");
                    let total = 0;
                    let minTotal = 0;
                    if (codes && codes.length > 0) {
                        for (let oi of order.orderitems) {
                            let item = oi.items[0]; //Main Item
                            if (codes.indexOf(item.id) >= 0) {
                                if (!this.hasExistingItemLevelDiscount(oi, promo)) {
                                    total += oi.quantity;
                                    oi['tmpApplied'] = 0;
                                    if (oi['tmpApplied'] < oi.quantity && !(minTotal >= this.count)) {
                                        let q = oi.quantity;
                                        if ((q - oi['tmpApplied']) > 0) {
                                            if (q < this.count) {
                                                oi['tmpApplied'] += q;
                                                minTotal += q;
                                            }
                                            else {
                                                oi['tmpApplied'] += this.count;
                                                minTotal += this.count;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        ok = (total >= this.count && minTotal >= this.count);
                        this.applicable = Math.floor(total / this.count);
                    }
                }
                break;
            }
            //ordered items as Mainitem within specific itemgroup(s)
            case 'itemgroup': {
                if (this.code) {
                    this.applicable = 0;
                    if (this.code.toLowerCase() == "all") {
                        ok = true;
                        order.orderitems.forEach(oi => {
                            this.applicable += oi.quantity;
                        });
                        break;
                    }
                    let codes = this.code.split(",");
                    if (codes && codes.length > 0) {
                        for (let oi of order.orderitems) {
                            if (oi.groups && oi.groups.length > 0) {
                                let group = oi.groups[0]; //Main itemgroup
                                if (codes.indexOf(group.id) >= 0) {
                                    if (!this.hasExistingItemLevelDiscount(oi, promo)) {
                                        this.applicable += oi.quantity;
                                    }
                                }
                            }
                        }
                    }
                    ok = this.applicable > 0;
                }
                break;
            }
            //Purchase X in specific one item group (X > 0)
            case "itemgroup_count": {
                //reset
                this.applicable = 0;
                if (this.code && this.count) {
                    if (this.code.toLowerCase() == "all") {
                        ok = true;
                        order.orderitems.forEach(oi => {
                            this.applicable += oi.quantity;
                        });
                        break;
                    }
                    let codes = this.code.split(",");
                    let total = 0;
                    let minTotal = 0;
                    let minOi;
                    if (codes && codes.length > 0) {
                        for (let oi of order.orderitems) {
                            if (oi.groups && oi.groups.length > 0) {
                                let group = oi.groups[0]; //Main itemgroup
                                if (codes.indexOf(group.id) >= 0) {
                                    if (!this.hasExistingItemLevelDiscount(oi, promo)) {
                                        total += oi.quantity;
                                        oi['tmpApplied'] = 0;
                                        if (!(minTotal >= this.count)) {
                                            let q = oi.quantity;
                                            if ((q - oi['tmpApplied']) > 0) {
                                                if (q < this.count) {
                                                    oi['tmpApplied'] += q;
                                                    minTotal += q;
                                                }
                                                else {
                                                    oi['tmpApplied'] += this.count;
                                                    minTotal += this.count;
                                                }
                                            }
                                        }
                                    }
                                }
                                else {
                                    //check for sub item group
                                    for (let ig of oi.groups) {
                                        if (codes.indexOf(ig.id) >= 0) {
                                            if (!this.hasExistingItemLevelDiscount(oi, promo)) {
                                                //check all item quantity
                                                for (let item of ig.items) {
                                                    total += item.quantity;
                                                }
                                                if (total >= this.count) {
                                                    ok = true;
                                                    this.applicable = Math.floor(total / this.count);
                                                    break;
                                                }
                                            }
                                        }
                                    }
                                    ok = (total >= this.count && minTotal >= this.count);
                                    this.applicable = Math.floor(total / this.count);
                                    if (ok) {
                                        return ok;
                                    }
                                }
                            }
                        }
                    }
                    ok = (total >= this.count && minTotal >= this.count);
                    this.applicable = Math.floor(total / this.count);
                }
                break;
            }
            case 'item_count': {
                this.applicable = 0;
                if (this.code && this.count) {
                    if (this.code.toLowerCase() == "all") {
                        ok = true;
                        order.orderitems.forEach(oi => {
                            this.applicable += oi.quantity;
                        });
                        break;
                    }
                    let codes = this.code.split(",");
                    let total = 0;
                    let minTotal = 0;
                    if (codes && codes.length > 0) {
                        for (let oi of order.orderitems) {
                            let mainitem = _order_item__WEBPACK_IMPORTED_MODULE_1__.OrderItem.getMainItem(oi); //mainitem
                            if (codes.indexOf(mainitem.id) >= 0) {
                                if (!this.hasExistingItemLevelDiscount(oi, promo)) {
                                    total += oi.quantity;
                                    oi['tmpApplied'] = 0;
                                    if (!(minTotal >= this.count)) {
                                        let q = oi.quantity;
                                        if ((q - oi['tmpApplied']) > 0) {
                                            if (q < this.count) {
                                                oi['tmpApplied'] += q;
                                                minTotal += q;
                                            }
                                            else {
                                                oi['tmpApplied'] += this.count;
                                                minTotal += this.count;
                                            }
                                        }
                                    }
                                }
                            }
                            //TODO: Check subitems
                        }
                    }
                    ok = (total >= this.count && minTotal >= this.count);
                    this.applicable = Math.floor(total / this.count);
                }
                break;
            }
            //ordered mainitems not under specific group
            case 'exitemgroup': {
                let total = 0;
                this.applicable = 0;
                ok = true;
                if (this.code && order.orderitems) {
                    // for (let oi of order.orderitems) {
                    //     if (oi.groups && oi.groups.length > 0){
                    //         let group = oi.groups[0]; //Main itemgroup
                    //         if (this.code !== group.id) total += oi.quantity;
                    //     }
                    // }
                    for (let oi of order.orderitems) {
                        if (oi.groups && oi.groups.length > 0) {
                            let group = oi.groups[0]; //Main itemgroup
                            if (!this.oiContainsCode(oi)) { //revert
                                ok = false;
                                break;
                            }
                            else {
                                total += oi.quantity;
                            }
                        }
                    }
                }
                if (ok && total > 0) {
                    this.applicable = total;
                }
                break;
            }
            //not order mainitems
            case 'exitem':
                {
                    let total = 0;
                    if (this.code && order.orderitems) {
                        for (let oi of order.orderitems) {
                            if (oi.items && oi.items.length > 0) {
                                let mainitem = oi.items[0]; //Main item
                                if (this.code !== mainitem.id)
                                    total += oi.quantity;
                            }
                        }
                    }
                    ok = total > 0;
                    this.applicable = total;
                    break;
                }
            //promotion code
            case 'code':
                {
                    this.applicable = 0;
                    if (this.code && order.promoCode && this.promoCodeCheck(order.promoCode, this.code)) {
                        ok = true;
                        this.applicable = 1;
                    }
                    else if (this.code && order.promoCodes && order.promoCodes.length > 0) {
                        for (let pC of order.promoCodes) {
                            if (this.promoCodeCheck(pC, this.code)) {
                                ok = true;
                                this.applicable = 1;
                                break;
                            }
                        }
                    }
                    break;
                }
            //TODO check when payment -test if card no can be got??????? when check
            case 'cardprefix':
                {
                    if (order.payment && order.payment == "creditcard" && this.prefix) {
                        //TODO
                        let payment = order.payments[0];
                        if (payment.cardNo.indexOf(this.prefix) === 0) {
                            ok = true;
                        }
                    }
                    break;
                }
            //TODO
            case "offer":
                {
                    let offer = order.offers.find(offer => {
                        return (offer.backendId === this.code) || (offer.campaignId === parseInt(this.code));
                    });
                    if (offer)
                        ok = true;
                    break;
                }
            //TODO
            case "reward":
                {
                    this.applicable = 0;
                    let offer = order.offers.find(offer => {
                        return (offer.rewardId === parseInt(this.code));
                    });
                    if (offer) {
                        this.applicable = 1;
                        ok = true;
                    }
                    break;
                }
            //TODO
            case "welcome":
                {
                    if (order.member) {
                        //TODO get welcomed???
                        // if (order.member.membership)
                    }
                    break;
                }
            //TODO?? byod?? code = dinein / takeaway / delivery / byod
            case "ordertype":
                {
                    if (this.code) {
                        let codes = this.code.split(",");
                        if (codes && codes.length > 0) {
                            if (codes.indexOf("dinein") >= 0 && !order.takeout) {
                                ok = true;
                            }
                            else if (codes.indexOf("takeaway") >= 0 && order.takeout) {
                                ok = true;
                            }
                            else if (codes.indexOf("delivery") >= 0 && order.type === "delivery") {
                                ok = true;
                            }
                            else if (codes.indexOf("byod") >= 0 && order.type === "byod") {
                                ok = true;
                            }
                        }
                        else {
                            ok = true;
                        }
                    }
                    break;
                }
            case "seats":
                {
                    if (order.seats && order.seats > this.amount) {
                        ok = this.applicable > 0;
                    }
                    break;
                }
            case "source":
                {
                    if (this.source.indexOf(order.source) > -1)
                        ok = true;
                    break;
                }
            case "points":
                {
                    if (order.usedPoints == this.couponPoint)
                        ok = true;
                    break;
                }
            default:
                break;
        }
        console.log("isSatisfied: ", ok);
        return ok;
    }
    hasExistingItemLevelDiscount(oi, promo) {
        let occupied = false;
        // if already applied an item level discount, do not apply another item level discount
        if (this.getLevel() === 'item') {
            if (oi.discounts && oi.discounts.length > 0) {
                occupied = oi.discounts.some(discount => {
                    return discount.id === promo.id || discount.level === 'item';
                });
                console.log('occupied: ' + promo.name, occupied);
            }
        }
        return occupied;
    }
    /**Decide discount's level, item or order level**/
    getLevel() {
        if (this.level)
            return this.level;
        switch (this.type) {
            case 'item':
            case 'itemgroup':
            case 'exitemgroup':
            case 'exitem':
            case "itemgroup_count":
            case "item_count": {
                this.level = "item";
                break;
            }
            case 'all':
            case 'ordertype':
            case 'coupon':
            case 'guest':
            case 'member':
            case 'total':
            case 'code':
            case 'seats':
            case 'points':
            case 'source':
            case 'reward':
            case 'cardprefix': {
                this.level = "order";
                break;
            }
            default: {
                this.level = "";
                break;
            }
        }
        return this.level;
    }
    getDisplay() {
        if (this.display)
            return this.display;
        switch (this.type) {
            case 'guest': {
                this.display = "Guest";
                break;
            }
            case 'member': {
                this.display = "Member";
                break;
            }
            case 'all':
            case 'coupon':
            case 'total':
            case 'itemgroup':
            case 'item':
            case 'code':
            case 'cardprefix':
            case 'exitemgroup':
            case 'source':
            case 'ordertype':
            default: {
                this.display = "";
                break;
            }
        }
        return this.display;
    }
    /**For item level discount,
     * check if order items have specific items/itemgroups with id == code
     * **/
    oiContainsCode(oi) {
        if (!this.code)
            return false;
        if (this.code.toLowerCase() == "all")
            return true;
        let contain = false;
        switch (this.type) {
            case "item": {
                let codes = this.code.split(",");
                if (codes && codes.length > 0) {
                    let item = oi.items[0]; //Main Item
                    if (codes.indexOf(item.id) >= 0) {
                        contain = true;
                    }
                }
                break;
            }
            case "itemgroup": {
                let codes = this.code.split(",");
                if (codes && codes.length > 0) {
                    //let item = oi.items[0]; //Main Item
                    if (codes.indexOf(oi.groups[0].id) >= 0) {
                        contain = true;
                    }
                }
                break;
            }
            case "itemgroup_count": {
                let codes = this.code.split(",");
                if (oi.groups && oi.groups.length > 0) {
                    let group = oi.groups[0]; //Main itemgroup
                    if (codes && codes.length > 0) {
                        if (codes.indexOf(group.id) >= 0) {
                            contain = true;
                        }
                        else {
                            //check for sub item group
                            for (let ig of oi.groups) {
                                if (codes.indexOf(group.id) >= 0) {
                                    contain = true;
                                    break;
                                }
                            }
                        }
                    }
                }
                break;
            }
            case "item_count": {
                let codes = this.code.split(",");
                let mainitem = _order_item__WEBPACK_IMPORTED_MODULE_1__.OrderItem.getMainItem(oi); //mainitem
                if (codes && codes.length > 0) {
                    if (codes.indexOf(mainitem.id) >= 0) {
                        contain = true;
                    }
                    else {
                        //TODO: check subitem
                    }
                }
                break;
            }
            case "exitemgroup": {
                let codes = this.code.split(",");
                if (codes && codes.length > 0) {
                    //let item = oi.items[0]; //Main Item
                    if (codes.indexOf(oi.groups[0].id) < 0) {
                        contain = true;
                    }
                }
                break;
            }
            case "exitem": {
                if (oi.items && oi.items.length > 0 && (oi.items[0].id !== this.code)) {
                    contain = true;
                }
                break;
            }
            default:
                break;
        }
        return contain;
    }
    setCode(code) {
        this.code = code;
    }
    setDisplay(display) {
        this.display = display;
    }
    //TODO??
    isMainItemOnly() {
        if (this.type === 'total')
            return true;
        if (this.type == 'itemgroup' || this.type == 'itemgroup_count' || this.type == 'item_count')
            return !this.traverseItemsDiscountable;
        return false;
    }
    toProperty(name, value) {
        return value;
    }
    promoCodeCheck(promoteCode, code) {
        if (this.ignoreCase) {
            return promoteCode.toLowerCase() === code.toLowerCase();
        }
        return promoteCode === code;
    }
}


/***/ }),

/***/ 41647:
/*!***************************************************!*\
  !*** ./projects/core/src/app/data/data/coupon.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Coupon": () => (/* binding */ Coupon)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Coupon extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Coupon";
    }
    toProperty(name, value) {
        switch (name) {
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
}


/***/ }),

/***/ 65142:
/*!****************************************************!*\
  !*** ./projects/core/src/app/data/data/courier.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Courier": () => (/* binding */ Courier)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Courier extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Courier";
    }
}


/***/ }),

/***/ 25810:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/court.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Court": () => (/* binding */ Court)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./store */ 94045);


class Court extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Court";
        this.features = [];
    }
    static hasFeature(court, feature) {
        if (court.features) {
            return court.features.indexOf(feature) >= 0;
        }
        return false;
    }
    hasFeature(feature) {
        if (this.features) {
            return this.features.indexOf(feature) >= 0;
        }
        return false;
    }
    toProperty(name, value) {
        switch (name) {
            case "stores":
                value = _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_store__WEBPACK_IMPORTED_MODULE_1__.Store, value);
                break;
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
}


/***/ }),

/***/ 80966:
/*!********************************************************!*\
  !*** ./projects/core/src/app/data/data/credit-card.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CreditCard": () => (/* binding */ CreditCard)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/**
 * Created by aigens on 20/12/2016.
 */

class CreditCard extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.isSelected = false;
    }
}


/***/ }),

/***/ 47114:
/*!************************************************!*\
  !*** ./projects/core/src/app/data/data/crm.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Crm": () => (/* binding */ Crm)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Crm extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Crm";
    }
    static hasFeature(crm, feature) {
        if (crm === null || crm === void 0 ? void 0 : crm.features) {
            return crm.features.indexOf(feature) >= 0;
        }
        return false;
    }
    static getPointIcon(crm) {
        var _a;
        if ((_a = crm === null || crm === void 0 ? void 0 : crm.pointIcon) === null || _a === void 0 ? void 0 : _a.url) {
            return crm.pointIcon.url;
        }
    }
}


/***/ }),

/***/ 54738:
/*!*************************************************!*\
  !*** ./projects/core/src/app/data/data/data.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Data": () => (/* binding */ Data)
/* harmony export */ });
class Data {
    constructor() {
    }
    static toData(cls, json) {
        var result = new cls();
        for (var propName in json) {
            var value = json[propName];
            if (value != null) {
                result[propName] = result.toProperty(propName, value);
            }
        }
        return result;
    }
    toProperty(name, value) {
        if (value == null)
            return value;
        return value;
    }
    static log(tag, msg) {
        if (!Data.debug)
            return;
        console.log(tag, msg);
    }
    static toDataArray(cls, jarray) {
        var result = [];
        Data.log("toDataArray", jarray);
        for (let jo of jarray) {
            var data = Data.toData(cls, jo);
            if (data) {
                result.push(data);
            }
        }
        return result;
    }
    getImage(name, width, crop) {
        return Data.getImage(this, name, width, crop);
    }
    static getImage(data, name, width, crop) {
        if (!data.images)
            return null;
        var im = data.images[name];
        if (!im)
            return null;
        var url = im.url;
        if (!url)
            return null;
        return this.getImageUrl(url, width, crop);
    }
    static getImageUrl(url, width, crop) {
        if (!url)
            return null;
        width = Math.floor(width);
        if (url.indexOf("googleuser") > 0 && width) {
            var suffix = "=s" + width;
            if (crop) {
                suffix += "-c";
            }
            url += suffix;
        }
        else if ((url.indexOf("content.aigens.com.cn") > 0 || url.indexOf("cdn.aigens.com.cn") > 0 || url.indexOf("cdn.aigens.cn") > 0) && width) {
            var suffix = "?x-oss-process=image/resize";
            if (crop) {
                suffix += ",m_fill";
            }
            url += suffix + ",w_" + width;
        }
        if (url.indexOf("http://") == 0 && url.indexOf("localhost") == -1) {
            url = url.replace("http:", "https:");
        }
        if (Data.imageHost) {
            var replace = "lh3.googleusercontent.com";
            var i = url.indexOf(replace);
            if (i > 0) {
                var path = url.substring(i + replace.length, url.length);
                url = Data.imageHost + path;
            }
        }
        return url;
    }
    clone(type) {
        var obj2 = Object.assign(new type(), this);
        return obj2;
    }
    static cloneArray(type, array) {
        var result = [];
        for (let data of array) {
            result.push(data.clone(type));
        }
        return result;
    }
    static remove(array, obj) {
        var index = array.indexOf(obj, 0);
        if (index > -1) {
            array.splice(index, 1);
        }
    }
    static replace(array, obj) {
        for (var i = 0; i < array.length; i++) {
            var id = obj.id;
            if (id && id == array[i].id) {
                array[i] = obj;
                return;
            }
        }
    }
    static clearCache(obj) {
        for (let key of Object.keys(obj)) {
            if (key && key.indexOf('_') == 0) {
                delete obj[key];
            }
        }
    }
    static JsonReplacer(key, value) {
        if (key && key.indexOf('_') == 0) {
            return undefined;
        }
        return value;
    }
    evaluate(condition) {
        return eval(condition);
    }
    get name18n() {
        return this.lookup('name');
    }
    lookup(name) {
        var _a, _b;
        var result = null;
        var lang = (_b = (_a = window['aigens']) === null || _a === void 0 ? void 0 : _a.context) === null || _b === void 0 ? void 0 : _b.userLang;
        console.log("get String", lang);
        if (lang) {
            result = this[name + "_" + lang];
        }
        if (!result) {
            result = this[name];
        }
        return result;
    }
}
Data.debug = false;


/***/ }),

/***/ 22682:
/*!******************************************************************!*\
  !*** ./projects/core/src/app/data/data/directory-state.model.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DirectoryState": () => (/* binding */ DirectoryState)
/* harmony export */ });
class DirectoryState {
}


/***/ }),

/***/ 15508:
/*!*****************************************************!*\
  !*** ./projects/core/src/app/data/data/discount.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Discount": () => (/* binding */ Discount)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _category__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./category */ 62419);
/* harmony import */ var _benefit__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./benefit */ 25237);
/* harmony import */ var _condition__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./condition */ 24194);




class Discount extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Discount";
        this.available = 0; //used times
        this.alone = false; //if must be 1st discount
    }
    toProperty(name, value) {
        if (name == 'conditions') {
            return _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_condition__WEBPACK_IMPORTED_MODULE_3__.Condition, value);
        }
        else if (name == 'benefits') {
            return _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_benefit__WEBPACK_IMPORTED_MODULE_2__.Benefit, value);
        }
        else if (name == 'unlocks') {
            return _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_category__WEBPACK_IMPORTED_MODULE_1__.Category, value);
        }
        return value;
    }
    static toDiscountData(discount) {
        var json = {};
        json["id"] = discount.id;
        return json;
    }
}


/***/ }),

/***/ 34649:
/*!********************************************************!*\
  !*** ./projects/core/src/app/data/data/edit-record.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EditRecord": () => (/* binding */ EditRecord)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class EditRecord extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
}


/***/ }),

/***/ 56706:
/*!*************************************************!*\
  !*** ./projects/core/src/app/data/data/edit.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Edit": () => (/* binding */ Edit)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Edit extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Edit";
    }
}


/***/ }),

/***/ 50966:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/field.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Field": () => (/* binding */ Field)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Field extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.readonly = false;
        this.required = false;
        this.admin = false;
        this.stage = false;
        this.show = false;
        this.resolved = false;
        this.feature = false;
        this.invalid = false;
        this.published = false;
        this.enabled = false;
    }
    clear() {
        this.value = null;
        this.time = null;
        this.moment = null;
    }
}


/***/ }),

/***/ 11094:
/*!*************************************************!*\
  !*** ./projects/core/src/app/data/data/file.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "File": () => (/* binding */ File)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class File extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "File";
    }
}


/***/ }),

/***/ 58899:
/*!************************************************!*\
  !*** ./projects/core/src/app/data/data/geo.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Geo": () => (/* binding */ Geo)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Geo extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    toProperty(name, value) {
        if (name == "subs") {
            return _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(Geo, value);
        }
        return super.toProperty(name, value);
    }
}


/***/ }),

/***/ 14311:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/group.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Group": () => (/* binding */ Group)
/* harmony export */ });
/* harmony import */ var _brand__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./brand */ 91826);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ 54738);


class Group extends _data__WEBPACK_IMPORTED_MODULE_1__.Data {
    constructor() {
        super(...arguments);
        this.class = "Group";
    }
    toProperty(name, value) {
        if (name == "brands") {
            return _data__WEBPACK_IMPORTED_MODULE_1__.Data.toDataArray(_brand__WEBPACK_IMPORTED_MODULE_0__.Brand, value);
        }
        return super.toProperty(name, value);
    }
}


/***/ }),

/***/ 69448:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/image.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Image": () => (/* binding */ Image)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Image extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.width = 0;
        this.height = 0;
    }
}


/***/ }),

/***/ 3840:
/*!*******************************************************!*\
  !*** ./projects/core/src/app/data/data/item-group.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ItemGroup": () => (/* binding */ ItemGroup)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _item__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./item */ 5647);


class ItemGroup extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "ItemGroup";
        this.items = [];
        this.modifier = false;
        this.optional = false;
        this.tags = [];
        this.choices = 1;
        this.repeat = false;
        this.skippable = false;
        this.min = 1;
        this.max = 1;
        this.cmap = {};
        this.printers = [];
    }
    getSelectedNames() {
        var names = [];
        for (let item of this.selected) {
            names.push(item.name);
        }
        return names.join();
    }
    getSelectedItemIds() {
        var names = [];
        for (let item of this.selected) {
            names.push(item.id);
        }
        return names.join();
    }
    toProperty(name, value) {
        switch (name) {
            case "items":
                value = _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_item__WEBPACK_IMPORTED_MODULE_1__.Item, value);
                break;
            case "parentItems":
                value = _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_item__WEBPACK_IMPORTED_MODULE_1__.Item, value);
                break;
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
    static getPublishedItems(ig, now) {
        return _item__WEBPACK_IMPORTED_MODULE_1__.Item.filterPublished(ig.items, now);
    }
    static getPublishedItemsWithMap(catId, ig, index, filter) {
        var catId = catId;
        // catId = catId + "." + index.toString();
        return _item__WEBPACK_IMPORTED_MODULE_1__.Item.filterPublishedItems(ig.items, ig.cmap, catId, index, filter);
    }
    static toItemGroupsData(itemGroups, toServer = false) {
        var results = [];
        for (let itemGroup of itemGroups) {
            var tmp = ItemGroup.toItemGroupData(itemGroup, toServer);
            results.push(tmp);
        }
        return results;
    }
    static toItemGroupData(itemGroup, toServer = false) {
        var json = {};
        json["id"] = itemGroup.id;
        json["items"] = _item__WEBPACK_IMPORTED_MODULE_1__.Item.toItemsData(itemGroup.items, toServer);
        json["name"] = itemGroup.name;
        json["pagerMode"] = itemGroup.pagerMode;
        return json;
    }
}


/***/ }),

/***/ 5647:
/*!*************************************************!*\
  !*** ./projects/core/src/app/data/data/item.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Item": () => (/* binding */ Item)
/* harmony export */ });
/* harmony import */ var _item_group__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./item-group */ 3840);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _coupon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./coupon */ 41647);



class Item extends _data__WEBPACK_IMPORTED_MODULE_1__.Data {
    constructor() {
        super(...arguments);
        this.class = 'Item';
        this.published = true;
        this.suspended = false;
        this.inventory = -1;
        this.quantity = 0;
        this.points = 0;
        this.groupIds = [];
        this.mgroupIds = [];
        this.groups = [];
        this.mgroups = [];
        this.modifier = false;
        this.combo = false;
        this.modifiable = false;
        this.printers = [];
        this.baseQty = 0;
        this.soldQty = 0;
        this.dinein = false;
        this.handling = 0;
        this.discount = 0;
        this.discountCode = '';
        this.isPrint = true;
        this.prefix = '';
        this.discounted = false;
        this.discounts = [];
        this.discountable = true;
        this.featuredRating = 0;
        this.addTime = Number(new Date()) + Math.random();
        this.featured = false;
        this.coupons = [];
        //analytics purpose, not part of real object
        this.igPos = 0;
        this.setLayout = null;
    }
    toProperty(name, value) {
        switch (name) {
            case 'groups':
                value = _data__WEBPACK_IMPORTED_MODULE_1__.Data.toDataArray(_item_group__WEBPACK_IMPORTED_MODULE_0__.ItemGroup, value);
                break;
            case 'mgroups':
                value = _data__WEBPACK_IMPORTED_MODULE_1__.Data.toDataArray(_item_group__WEBPACK_IMPORTED_MODULE_0__.ItemGroup, value);
                break;
            case 'coupons':
                value = _data__WEBPACK_IMPORTED_MODULE_1__.Data.toDataArray(_coupon__WEBPACK_IMPORTED_MODULE_2__.Coupon, value);
                break;
            case 'variations':
                value = _data__WEBPACK_IMPORTED_MODULE_1__.Data.toDataArray(Item, value);
                break;
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
    static isSet(category, item) {
        if (category && category.igMode == 'single') {
            return false;
        }
        if (item.groups && item.groups.length > 0) {
            return true;
        }
        if (category && category.groups && category.groups.length > 1) {
            return true;
        }
        return false;
    }
    static isVariations(item, singleChildShowVariation) {
        if (singleChildShowVariation && item.parentId === item.id && item.variations.length == 0) {
            return true;
        }
        return item && item.variations && item.variations.length > 0;
    }
    static isModifiable(item) {
        let mgroups = item.mgroups;
        if (!mgroups || mgroups.length == 0) {
            return false;
        }
        return mgroups.some(g => g.items && g.items.length > 0);
    }
    static isSetMessageLimit(item) {
        return item && item.messageLimit && item.messageLimit > 0;
        ;
    }
    static isPublished(item, now) {
        if (!item.start && !item.end) {
            return true;
        }
        let greaterThanStart = true;
        let lessThanEnd = true;
        if (item.start) {
            greaterThanStart = now >= item.start;
        }
        if (item.end) {
            lessThanEnd = now <= item.end;
        }
        return greaterThanStart && lessThanEnd;
    }
    static filterPublished(items, now) {
        var result = [];
        if (!items || items.length == 0) {
            return result;
        }
        for (let item of items) {
            if (item.published && Item.isPublished(item, now)) {
                result.push(item);
            }
        }
        return result;
    }
    static filterPublishedItems(items, cmap, catId, index, filter) {
        var result = [];
        var catIdWithIndex = catId + '.' + index.toString();
        if (!items || items.length == 0) {
            return result;
        }
        for (let item of items) {
            if (item.groups.length == 0) {
                item.combo = false;
            }
            if (cmap && (cmap[catIdWithIndex] || cmap[catId])) {
                var published = cmap[catIdWithIndex] ? cmap[catIdWithIndex] : cmap[catId];
                if (published && published[item.id]) {
                    result.push(item);
                }
            }
            else {
                if (filter) {
                    if (filter(item)) {
                        result.push(item);
                    }
                }
                else if (item.published) {
                    result.push(item);
                }
            }
        }
        return result;
    }
    static toItemsData(items, toServer = false) {
        var results = [];
        for (let item of items) {
            var tmp = Item.toItemData(item, toServer);
            if (toServer) {
                // console.log('tem', tmp); BurgerKing紧急fix : baseQty 会把 q=0的 item push入 order,然后替换成absentItem , 但frontend不应该把 mitem(with qua =0) post to server
                if ((tmp === null || tmp === void 0 ? void 0 : tmp.quantity) > 0) {
                    results.push(tmp);
                }
            }
            else {
                results.push(tmp);
            }
        }
        return results;
    }
    static toItemData(item, toServer = false) {
        var json = {};
        json['id'] = item.id;
        json['quantity'] = item.quantity;
        json['inventory'] = item.inventory;
        json['name'] = item.name;
        json['price'] = item.price;
        json['price0'] = item.price0;
        json['price1'] = item.price1;
        json['price2'] = item.price2;
        json['modifiable'] = item.modifiable;
        json['modifier'] = item.modifier;
        if (item.points >= 0) {
            json['points'] = item.points;
            json['usedPoints'] = item.points;
        }
        json['title'] = item.title;
        json['discounted'] = item.discounted;
        json['mgroups'] = item.mgroups ? _item_group__WEBPACK_IMPORTED_MODULE_0__.ItemGroup.toItemGroupsData(item.mgroups, toServer) : null;
        json['combo'] = item.combo;
        json['comboId'] = item.comboId;
        json['comboName'] = item.comboName;
        json['taxGroup'] = item.taxGroup;
        json['discountedId'] = item.discountedId;
        json['barcode'] = item.barcode;
        json['custom'] = item.custom;
        json['addtime'] = item.addTime;
        json['type'] = item.type;
        json['baseQty'] = item.baseQty;
        json['absentId'] = item.absentId;
        // it should minus the quantity if baseQty exists when post order to server(server calculate not handle item.baseQty)
        if (toServer && (item === null || item === void 0 ? void 0 : item.baseQty) && (item === null || item === void 0 ? void 0 : item.quantity) > 0) {
            json['quantity'] = item.quantity - item.baseQty;
        }
        // copy i18n item name also for supporting translation when refresh
        const keys = Object.keys(item);
        keys.filter(f => f.includes('name_'))
            .map(o => o)
            .forEach(o => {
            json[o] = item[o];
        });
        return json;
    }
    static getPrice(item, level) {
        var result = item.price;
        switch (level) {
            case 1:
                result = item['price1'];
                break;
            case 2:
                result = item['price2'];
                break;
            case 3:
                result = item['price3'];
                break;
            case 4:
                result = item['price4'];
                break;
            case 5:
                result = item['price5'];
                break;
            case 6:
                result = item['price6'];
                break;
            case 7:
                result = item['price7'];
                break;
            case 8:
                result = item['price8'];
                break;
            case 9:
                result = item['price9'];
                break;
            default:
                result = item['price1'];
                break;
        }
        if (!result && result != 0) {
            result = item.price;
        }
        return result;
    }
    static isItemHasCustomMessage(item) {
        return item && item.custom && item.custom.message && item.custom.message.length > 0;
    }
}


/***/ }),

/***/ 24042:
/*!***************************************************************!*\
  !*** ./projects/core/src/app/data/data/kitchen-order-item.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "KitchenOrderItem": () => (/* binding */ KitchenOrderItem)
/* harmony export */ });
class KitchenOrderItem {
    constructor() {
        this.printQueue = {};
        this.dualReceipt = false;
        this.showNo = false;
        this.callNo = null;
    }
}


/***/ }),

/***/ 18671:
/*!*************************************************!*\
  !*** ./projects/core/src/app/data/data/link.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Link": () => (/* binding */ Link)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Link extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
}


/***/ }),

/***/ 19052:
/*!*****************************************************!*\
  !*** ./projects/core/src/app/data/data/location.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Location": () => (/* binding */ Location)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Location extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Location";
    }
}


/***/ }),

/***/ 53310:
/*!***************************************************!*\
  !*** ./projects/core/src/app/data/data/member.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Member": () => (/* binding */ Member)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Member extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Member";
        this.admin = false;
        this.readOnly = false;
        this.sessionTimeout = 0;
        this.marketing = false;
        this.guest = false;
    }
    static toMemberData(member) {
        var json = {};
        json["id"] = member.id;
        json["sessionId"] = member.sessionId;
        json["username"] = member.username;
        json["storeId"] = member.storeId;
        json["type"] = member.type;
        json["regions"] = member.regions;
        json["language"] = member.language;
        json["name"] = member.name;
        json["gender"] = member.gender;
        json["education"] = member.education;
        json["occupation"] = member.occupation;
        json["firstName"] = member.firstName;
        json["lastName"] = member.lastName;
        json["groupId"] = member.groupId;
        json["brandId"] = member.brandId;
        json["storeId"] = member.storeId;
        json["phone"] = member.phone;
        json["backendId"] = member.backendId;
        json["birthdate"] = member.birthdate;
        json["marketing"] = member.marketing;
        json["cardNo"] = member.cardNo;
        json["membership"] = member.membership;
        json["tier"] = member.tier;
        json["allowereceipt"] = member.allowereceipt;
        json['ecredit'] = member.ecredit;
        json["gm"] = member.gm;
        return json;
    }
    static toOrderMemberData(member) {
        var json = {};
        json['firstName'] = member.firstName;
        json['lastName'] = member.lastName;
    }
}


/***/ }),

/***/ 69656:
/*!*******************************************************!*\
  !*** ./projects/core/src/app/data/data/membership.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Membership": () => (/* binding */ Membership)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _member__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./member */ 53310);


class Membership extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Membership";
        this.marketing = false;
        this.groupMarketing = false;
    }
    toProperty(name, value) {
        switch (name) {
            case "member":
                value = _data__WEBPACK_IMPORTED_MODULE_0__.Data.toData(_member__WEBPACK_IMPORTED_MODULE_1__.Member, value);
                break;
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
}


/***/ }),

/***/ 16554:
/*!*************************************************!*\
  !*** ./projects/core/src/app/data/data/menu.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Menu": () => (/* binding */ Menu)
/* harmony export */ });
/* harmony import */ var _pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pos */ 44846);
/* harmony import */ var _item_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./item-group */ 3840);
/* harmony import */ var _period__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./period */ 62569);
/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./store */ 94045);
/* harmony import */ var _category__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./category */ 62419);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _item__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./item */ 5647);
/* harmony import */ var _setting__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./setting */ 35979);
/* harmony import */ var _badge__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./badge */ 32552);
/* harmony import */ var _price_rule__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./price-rule */ 71700);
/* harmony import */ var _discount__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./discount */ 15508);
/* harmony import */ var _tax_rule__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./tax-rule */ 95607);












class Menu extends _data__WEBPACK_IMPORTED_MODULE_5__.Data {
    constructor() {
        super(...arguments);
        this.class = "Menu";
        this.subs = [];
        this.legacy = false;
        this.itemOpenings = {};
        //current price level of this menu item.price
        this.priceLevel = 1;
        this.catGroup = false;
    }
    toProperty(name, value) {
        switch (name) {
            case "badges":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_badge__WEBPACK_IMPORTED_MODULE_8__.Badge, value);
                break;
            case "categories":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_category__WEBPACK_IMPORTED_MODULE_4__.Category, value);
                break;
            case "subs":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(Menu, value);
                break;
            case "groups":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_item_group__WEBPACK_IMPORTED_MODULE_1__.ItemGroup, value);
                break;
            case "stores":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_store__WEBPACK_IMPORTED_MODULE_3__.Store, value);
                break;
            case "periods":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_period__WEBPACK_IMPORTED_MODULE_2__.Period, value);
                break;
            case "pos":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_pos__WEBPACK_IMPORTED_MODULE_0__.Pos, value);
                break;
            case "recommendation":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_category__WEBPACK_IMPORTED_MODULE_4__.Category, value);
                break;
            case "unlocks":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_category__WEBPACK_IMPORTED_MODULE_4__.Category, value);
                break;
            case "gifts":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_category__WEBPACK_IMPORTED_MODULE_4__.Category, value);
                break;
            case "settings":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_setting__WEBPACK_IMPORTED_MODULE_7__.Setting, value);
                break;
            case "items":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_item__WEBPACK_IMPORTED_MODULE_6__.Item, value);
                break;
            case "priceRules":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_price_rule__WEBPACK_IMPORTED_MODULE_9__.PriceRule, value);
                break;
            case "create":
            case "update":
                value = new Date();
                break;
            case "taxRules":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_tax_rule__WEBPACK_IMPORTED_MODULE_11__.TaxRule, value);
                break;
            case "discounts":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_discount__WEBPACK_IMPORTED_MODULE_10__.Discount, value);
                break;
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
}


/***/ }),

/***/ 46344:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/offer.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Offer": () => (/* binding */ Offer)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _reward__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./reward */ 29219);
/* harmony import */ var _order_item__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./order-item */ 88783);



class Offer extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Offer";
        this.orderitems = [];
    }
    toProperty(name, value) {
        if (name == "reward") {
            return _data__WEBPACK_IMPORTED_MODULE_0__.Data.toData(_reward__WEBPACK_IMPORTED_MODULE_1__.Reward, value);
        }
        return value;
    }
    static toOffersData(offers) {
        var result = [];
        for (let offer of offers) {
            var tmp = Offer.toOfferData(offer);
            result.push(tmp);
        }
        return result;
    }
    static toOfferData(offer) {
        var json = {};
        json["id"] = offer.id;
        json["name"] = offer.name;
        json["hint"] = offer.hint;
        json["publihed"] = offer.publihed;
        json["backendId"] = offer.backendId;
        json["orderitems"] = _order_item__WEBPACK_IMPORTED_MODULE_2__.OrderItem.toOrderItemsData(offer.orderitems);
        json["reward"] = _reward__WEBPACK_IMPORTED_MODULE_1__.Reward.toRewardData(offer.reward);
        json["campaignId"] = offer.campaignId;
        json["rewardId"] = offer.rewardId;
        return json;
    }
}


/***/ }),

/***/ 33336:
/*!**********************************************************!*\
  !*** ./projects/core/src/app/data/data/opening-hours.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OpeningHours": () => (/* binding */ OpeningHours)
/* harmony export */ });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ 84291);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _slot__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./slot */ 66910);



class OpeningHours extends _data__WEBPACK_IMPORTED_MODULE_1__.Data {
    constructor() {
        super(...arguments);
        this.class = "OpeningHours";
    }
    static isDateOpen(oh, time) {
        if (!oh)
            return true;
        if (oh.always)
            return true;
        //check ovewrites, holidays, and then normal hours
        var day = new Date(time);
        //console.log("day", day.getDate());
        if (oh.overwrites) {
            for (let slot of oh.overwrites) {
                if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isWithinDayRange(slot, time)) {
                    //console.log("within overwrites", slot);
                    if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isOpenType(slot)) {
                        //console.log("overwrite true");
                        return true;
                    }
                    else {
                        //console.log("overwrite false");
                        return false;
                    }
                }
            }
        }
        var ph1Slot;
        var ph2Slot;
        if (oh.holidays) {
            for (let slot of oh.holidays) {
                if (slot.weekday == 101) {
                    ph1Slot = slot;
                    //console.log("ph1", slot);
                }
                else if (slot.weekday == 102) {
                    ph2Slot = slot;
                    //console.log("ph2", slot);
                }
                else if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isWithinDayRange(slot, time)) {
                    //console.log("within real holiday", slot);
                    if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isOpenType(slot)) {
                        //console.log("holiday true");
                        return true;
                    }
                    else {
                        //console.log("holiday false");
                        return false;
                    }
                }
            }
        }
        if (oh.ph1 && ph1Slot) {
            for (let slot of oh.ph1) {
                if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isWithinDayRange(slot, time)) {
                    //console.log("within holiday1", slot);
                    if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isOpenType(ph1Slot)) {
                        //console.log("holiday true");
                        return true;
                    }
                    else {
                        //console.log("holiday false");
                        return false;
                    }
                }
            }
        }
        if (oh.ph2 && ph2Slot) {
            for (let slot of oh.ph2) {
                if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isWithinDayRange(slot, time)) {
                    //console.log("within holiday2", slot);
                    if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isOpenType(ph2Slot)) {
                        //console.log("holiday true");
                        return true;
                    }
                    else {
                        //console.log("holiday false");
                        return false;
                    }
                }
            }
        }
        if (oh.weekdays) {
            for (let slot of oh.weekdays) {
                if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isWeekdayOpen(slot, time)) {
                    //console.log("weekday open");
                    return true;
                }
            }
        }
        else {
            //console.log("weekdays not set, open");
            return true;
        }
        //console.log("none match closed", oh);
        return false;
    }
    static isTimeOpen(brandOh, oh, time) {
        if (!oh)
            return true;
        if (oh.always)
            return true;
        //console.log("brand OpeningHours", brandOh);
        var day = new Date(time);
        //console.log("day", day.getDate());
        if (oh.overwrites) {
            for (let slot of oh.overwrites) {
                if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isWithinDayRange(slot, time)) {
                    //console.log("within overwrites", slot);
                    if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isTimeOpen(slot, time, false)) {
                        //console.log("overwrite true");
                        return true;
                    }
                    else {
                        //console.log("overwrite false");
                        return false;
                    }
                }
            }
        }
        var ph1Slot;
        var ph2Slot;
        if (oh.holidays) {
            for (let slot of oh.holidays) {
                if (slot.weekday == 101) {
                    ph1Slot = slot;
                    //console.log("ph1", slot);
                }
                else if (slot.weekday == 102) {
                    ph2Slot = slot;
                    //console.log("ph2", slot);
                }
                else if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isWithinDayRange(slot, time)) {
                    //console.log("within holiday", slot);
                    if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isTimeOpen(slot, time, false)) {
                        //console.log("holiday true");
                        return true;
                    }
                    else {
                        //console.log("holiday false");
                        return false;
                    }
                }
            }
        }
        if (brandOh && brandOh.ph1 && ph1Slot) {
            for (let slot of brandOh.ph1) {
                slot.startTime = ph1Slot.startTime;
                slot.endTime = ph1Slot.endTime;
                if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isWithinDayRange(slot, time)) {
                    //console.log("within holiday1", slot);
                    if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isTimeOpen(ph1Slot, time, false)) {
                        //console.log("holiday true");
                        return true;
                    }
                    else {
                        //console.log("holiday false");
                        return false;
                    }
                }
            }
        }
        if (brandOh && brandOh.ph2 && ph2Slot) {
            for (let slot of brandOh.ph2) {
                slot.startTime = ph2Slot.startTime;
                slot.endTime = ph2Slot.endTime;
                if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isWithinDayRange(slot, time)) {
                    //console.log("within holiday2", slot);
                    if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isTimeOpen(ph2Slot, time, false)) {
                        //console.log("holiday true");
                        return true;
                    }
                    else {
                        //console.log("holiday false");
                        return false;
                    }
                }
            }
        }
        if (oh.weekdays) {
            if (_slot__WEBPACK_IMPORTED_MODULE_2__.Slot.isTimeOpenOnWeekdays(oh.weekdays, time)) {
                return true;
            }
            // for (let slot of oh.weekdays) {
            //     if (Slot.isTimeOpen(slot, time, true)) {
            //         //console.log("weekday open");
            //         return true;
            //     }
            // }
        }
        else {
            //console.log("weekdays not set, open");
            return true;
        }
        // console.log("should close");
        return false;
    }
    static getDescription(openings) {
        //var openings = this.store.openings;
        var result = openings['_desc'];
        if (result) {
            return result;
        }
        if (!openings || openings.always)
            return ["24 hrs"];
        var fragments = {};
        //make Monday first
        var weekdays = openings.weekdays.slice(1, 7);
        weekdays.push(openings.weekdays[0]);
        for (let day of weekdays) {
            var startDesc = moment__WEBPACK_IMPORTED_MODULE_0__(day.startTime, 'HH:mm').format('h:mm A');
            var endDesc = moment__WEBPACK_IMPORTED_MODULE_0__(day.endTime, 'HH:mm').format('h:mm A');
            var str = startDesc + " - " + endDesc;
            var list = fragments[str];
            if (!list) {
                list = [];
                fragments[str] = list;
            }
            list.push(day.weekday == 0 ? 7 : day.weekday);
        }
        result = [];
        for (let desc of Object.keys(fragments)) {
            var days = fragments[desc];
            var daysStr = this.weekdays2Str(days);
            var line = daysStr + " : " + desc;
            result.push(line);
        }
        openings['_desc'] = result;
        return result;
    }
    static weekdays2Str(list) {
        if (list.length == 1) {
            return this.weekday2Str(list[0]);
        }
        var shorten = [];
        var startRange = list[0];
        for (var i = 1; i <= list.length; i++) {
            var current = list[i];
            var previous = list[i - 1];
            //range stop
            if (current != previous + 1) {
                shorten.push({
                    start: startRange,
                    end: previous
                });
                startRange = current;
            }
        }
        var frags = [];
        for (let range of shorten) {
            var str = this.weekday2Str(range.start) + "-" + this.weekday2Str(range.end);
            frags.push(str);
        }
        return frags.join(',');
    }
    static weekday2Str(n) {
        return moment__WEBPACK_IMPORTED_MODULE_0__().day(n % 7).format("ddd");
    }
}


/***/ }),

/***/ 88783:
/*!*******************************************************!*\
  !*** ./projects/core/src/app/data/data/order-item.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OrderItem": () => (/* binding */ OrderItem)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _category__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./category */ 62419);
/* harmony import */ var _item_group__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./item-group */ 3840);
/* harmony import */ var _item__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./item */ 5647);




class OrderItem extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "OrderItem";
        this.total = 0;
        this.groups = [];
        this.groupIds = [];
        this.itemIds = [];
        this.quantity = 1;
        this.combo = false;
        this.modifiable = false;
        this.handling = 0;
        this.discount = 0;
        this.points = 0;
        this.usedPoints = 0;
        this.discounts = [];
        this.recommended = false;
        this.unlockDiscountConditionType = null; // if current OI is unlock-discount-item, so remark it
        this.items = [];
    }
    yPosition(yPosition) {
        throw new Error('Method not implemented.');
    }
    toProperty(name, value) {
        if (name == 'items') {
            return _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_item__WEBPACK_IMPORTED_MODULE_3__.Item, value);
        }
        else if (name == 'groups') {
            return _data__WEBPACK_IMPORTED_MODULE_0__.Data.toDataArray(_item_group__WEBPACK_IMPORTED_MODULE_2__.ItemGroup, value);
        }
        else {
            return super.toProperty(name, value);
        }
    }
    static isSet(oi) {
        if (oi.groups && oi.groups.length > 1) {
            return true;
        }
        if (oi.combo)
            return true;
        let mainItem = OrderItem.getMainItem(oi);
        if (mainItem) {
            return _item__WEBPACK_IMPORTED_MODULE_3__.Item.isSet(oi.category, mainItem);
        }
        return false;
    }
    static getMainItem(oi) {
        let item;
        if (oi.items && oi.items.length > 0) {
            item = oi.items[0];
        }
        else {
            item = oi.groups[0].items[0];
        }
        /*
        if(item && item.origin){
            item = item.origin;
        }*/
        return item;
    }
    setDicountcode(discountcode) {
        this.discountId = discountcode;
    }
    setRecommended(isRec) {
        this.recommended = isRec;
    }
    static flattenItems(oi) {
        /*
        var items = [];
        for(let group of oi.groups){
            for(let item of group.items){
                items.push(item);
            }
        }
        oi.items = items;
        */
        oi.items = OrderItem.getFlattenItems(oi, true);
    }
    static getFlattenItems(oi, includeMods) {
        var items = [];
        for (let group of oi.groups) {
            if (!group.items)
                continue;
            for (let item of group.items) {
                items.push(item);
                if (includeMods && item.mgroups) {
                    for (let mig of item.mgroups) {
                        for (let item of mig.items) {
                            item.modifier = true;
                            items.push(item);
                        }
                    }
                }
            }
        }
        return items;
    }
    static toOrderItemsData(orderItems, toServer = false) {
        var result = [];
        for (let orderItem of orderItems) {
            var tmp = OrderItem.toOrderItemData(orderItem, toServer);
            result.push(tmp);
        }
        return result;
    }
    static toOrderItemData(orderItem, toServer = false) {
        var json = {};
        json['total'] = orderItem.total;
        json['groups'] = _item_group__WEBPACK_IMPORTED_MODULE_2__.ItemGroup.toItemGroupsData(orderItem.groups, toServer);
        json['quantity'] = orderItem.quantity;
        json['category'] = _category__WEBPACK_IMPORTED_MODULE_1__.Category.toCategoryData(orderItem.category);
        json['categoryId'] = orderItem.categoryId;
        json['categoryType'] = orderItem.categoryType;
        json['discountId'] = orderItem.discountId;
        json['combo'] = orderItem.combo;
        if (orderItem.category) {
            json['cgroupId'] = orderItem.category.cgroupId;
            json['departmentId'] = orderItem.category.departmentId;
        }
        json['handling'] = orderItem.handling;
        json['recommended'] = orderItem.recommended;
        json['serviceCharge'] = orderItem.serviceCharge;
        json['points'] = orderItem.points;
        json['note'] = orderItem.note;
        return json;
    }
    static isUnlockOrderItem(oi) {
        var _a;
        return ((_a = oi === null || oi === void 0 ? void 0 : oi.category) === null || _a === void 0 ? void 0 : _a.type) === 'unlock' || (oi === null || oi === void 0 ? void 0 : oi.categoryType) == 'unlockItem';
    }
    static isOrderItemHasCategoryType(oi, type) {
        var _a;
        return ((_a = oi === null || oi === void 0 ? void 0 : oi.category) === null || _a === void 0 ? void 0 : _a.type) === type || (oi === null || oi === void 0 ? void 0 : oi.categoryType) == type;
    }
}


/***/ }),

/***/ 43494:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/order.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Order": () => (/* binding */ Order)
/* harmony export */ });
/* harmony import */ var _brand__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./brand */ 91826);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _discount__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./discount */ 15508);
/* harmony import */ var _location__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./location */ 19052);
/* harmony import */ var _offer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./offer */ 46344);
/* harmony import */ var _order_item__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./order-item */ 88783);
/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./store */ 94045);







class Order extends _data__WEBPACK_IMPORTED_MODULE_1__.Data {
    constructor() {
        super(...arguments);
        this.class = "Order";
        this.itemsCount = 0;
        this.brandId = 0;
        this.identifications = [];
        this.grandTotal = 0;
        this.chargeAmount = 0;
        this.total = 0;
        this.discount = 0;
        this.service = 0;
        this.orderitems = [];
        this.discounts = []; // applied discount
        this.offers = [];
        this.newOffers = [];
        this.handling = 0;
        this.printers = [];
        this.usablePoints = 0;
        this.usedPoints = 0; //order to use points
        this.usedPointsAmt = 0; //order to use points amount
        this.reservedPoints = 0; //points reserved in server
        this.usedPointsToMoney = 0; // the points value to using pointToMoney
        this.usedPointsToItem = 0; // the points value to using pointToItem
        this.usedPointsForItem = 0;
        this.canUseEcredit = 0; // user pay with ewallet balance by FE
        this.eqvEcreditAmt = 0; // the spend only pay with ewallet balance
        this.payFee = 0;
        this.rounding = 0;
        this.shipping = 0;
        this.overpay = 0;
        this.completed = false;
        this.cutlery = false;
        this.contactless = false;
        this.ended = false;
    }
    static flattenItems(order) {
        for (let oi of order.orderitems) {
            _order_item__WEBPACK_IMPORTED_MODULE_5__.OrderItem.flattenItems(oi);
        }
    }
    static getCount(order) {
        let quantities = {};
        let count = 0;
        for (let oi of order.orderitems) {
            if (!_order_item__WEBPACK_IMPORTED_MODULE_5__.OrderItem.isSet(oi)) {
                count += oi.quantity;
                let t = oi.quantity * oi.total;
                //total += MathUtils.round(t, 2);
                let mainItemId = oi.items[0].id;
                let quantity = quantities[mainItemId];
                if (!quantity)
                    quantity = 0;
                quantity += oi.quantity;
                quantities[mainItemId] = quantity;
            }
            else {
                count += oi.quantity;
                //let t = oi.quantity * oi.total;
                //total += MathUtils.round(t, 2);
            }
        }
        return count;
    }
    /*
    static toOrdersData(orders: Order[]): any[] {
        var result: any[] = [];
        for (let order of orders) {
            var tmp = Order.toOrderData(order);
            result.push(tmp);
        }

        return result;

    }
    */
    static toOrderData(order, toServer = false) {
        var json = {};
        json["total"] = order.total;
        json["grandTotal"] = order.grandTotal;
        json["itemsCount"] = order.itemsCount;
        json["discount"] = order.discount;
        json["discountCode"] = order.discountCode;
        json["promoCode"] = order.promoCode;
        json["promoCodes"] = order.promoCodes;
        json["storeId"] = order.storeId;
        json["courtId"] = order.courtId;
        json["type"] = order.type;
        json["charge"] = order.charge;
        json["uuid"] = order.uuid;
        json["payFee"] = order.payFee;
        json["serviceCharge"] = order.serviceCharge;
        json["handling"] = order.handling;
        if (order.sub) {
            json["sub"] = order.sub;
        }
        if (order.source) {
            json["source"] = order.source;
        }
        if (order.container) {
            json["container"] = order.container;
        }
        json["sourceUrl"] = order.sourceUrl;
        json["email"] = order.email;
        json["note"] = order.note;
        json["loveCode"] = order.loveCode;
        json["companyCode"] = order.companyCode;
        json["ereceipt"] = order.ereceipt;
        json["batchId"] = order.batchId;
        json["memberId"] = order.memberId;
        json["charge"] = order['charge'];
        json["deviceId"] = order.deviceId;
        if (order.receiptOption) {
            json["receiptOption"] = order.receiptOption;
        }
        if (order.spot) {
            json["spot"] = order.spot;
        }
        if (order.pagerNo) {
            json["pagerNo"] = order.pagerNo;
        }
        if (order.extra) {
            json["extra"] = order.extra;
        }
        if (order === null || order === void 0 ? void 0 : order.session) {
            json["session"] = order.session;
        }
        if (!isNaN(order.usedPoints) && order.usedPoints > 0) {
            json["usedPoints"] = order.usedPoints;
        }
        if (!isNaN(order.usedPointsForItem) || !isNaN(order.usedPointsToMoney)) {
            // json["usedPoints"] = (!isNaN(order.usedPointsForItem) ? order.usedPointsForItem : 0) + (!isNaN(order.usedPointsToMoney) ? order.usedPointsToMoney : 0);
            // console.log('order use point for item', order.usedPointsForItem);
            // console.log('order use point for money', order.usedPointsToMoney);
            json["usedPointsForItem"] = order === null || order === void 0 ? void 0 : order.usedPointsForItem;
            json["usedPointsToMoney"] = order === null || order === void 0 ? void 0 : order.usedPointsToMoney;
        }
        json['canUseEcredit'] = order === null || order === void 0 ? void 0 : order.canUseEcredit;
        json['eqvEcreditAmt'] = order === null || order === void 0 ? void 0 : order.eqvEcreditAmt;
        json["orderitems"] = _order_item__WEBPACK_IMPORTED_MODULE_5__.OrderItem.toOrderItemsData(order.orderitems, toServer);
        if (order === null || order === void 0 ? void 0 : order.offers) {
            json["offers"] = _offer__WEBPACK_IMPORTED_MODULE_4__.Offer.toOffersData(order.offers);
        }
        if (order.expire) {
            json["expire"] = order.expire;
        }
        if (order.memberCode) {
            json["memberCode"] = order.memberCode;
        }
        json["sequence"] = order.sequence;
        if (order.multiOrderGrandTotal) {
            json['multiOrderDiscount'] = order.multiOrderDiscount;
            json['multiOrderGrandTotal'] = order.multiOrderGrandTotal;
        }
        var subs = order.subs;
        if (subs && subs.length > 0) {
            var ja = [];
            for (let so of subs) {
                var jo = Order.toOrderData(so);
                ja.push(jo);
            }
            json['subs'] = ja;
        }
        return json;
    }
    calculate() {
        var grandTotal = 0;
        for (let oi of this.orderitems) {
            var oiTotal = 0;
            for (let group of oi.groups) {
                var items = group.selected;
                oiTotal += items[0].price;
            }
            oi.total = oiTotal;
            grandTotal += oiTotal;
        }
        this.grandTotal = grandTotal;
    }
    toProperty(name, value) {
        if (name == "orderitems") {
            return _data__WEBPACK_IMPORTED_MODULE_1__.Data.toDataArray(_order_item__WEBPACK_IMPORTED_MODULE_5__.OrderItem, value);
        }
        else if (name == "promotions") {
            return _data__WEBPACK_IMPORTED_MODULE_1__.Data.toDataArray(_discount__WEBPACK_IMPORTED_MODULE_2__.Discount, value);
        }
        else if (name == "location") {
            return _data__WEBPACK_IMPORTED_MODULE_1__.Data.toData(_location__WEBPACK_IMPORTED_MODULE_3__.Location, value);
        }
        else if (name == "brand") {
            return _data__WEBPACK_IMPORTED_MODULE_1__.Data.toData(_brand__WEBPACK_IMPORTED_MODULE_0__.Brand, value);
        }
        else if (name == "store") {
            return _data__WEBPACK_IMPORTED_MODULE_1__.Data.toData(_store__WEBPACK_IMPORTED_MODULE_6__.Store, value);
        }
        else if (name == "offers" || name == "newOffers") {
            return _data__WEBPACK_IMPORTED_MODULE_1__.Data.toDataArray(_offer__WEBPACK_IMPORTED_MODULE_4__.Offer, value);
        }
        else {
            return super.toProperty(name, value);
        }
    }
}


/***/ }),

/***/ 62569:
/*!***************************************************!*\
  !*** ./projects/core/src/app/data/data/period.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Period": () => (/* binding */ Period)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ 84291);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


class Period extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = 'Period';
    }
    static isTimeOpen(period, time) {
        var startTime = period.startTime;
        var endTime = period.endTime;
        var start = moment__WEBPACK_IMPORTED_MODULE_1__(startTime, 'HH:mm');
        var end = moment__WEBPACK_IMPORTED_MODULE_1__(endTime, 'HH:mm');
        if (!start || !end) {
            console.log("invalid start / end, period invalid");
            return false;
        }
        var now = moment__WEBPACK_IMPORTED_MODULE_1__(time);
        start.year(now.year());
        start.month(now.month());
        start.dayOfYear(now.dayOfYear());
        end.year(now.year());
        end.month(now.month());
        end.dayOfYear(now.dayOfYear());
        if (end < start) {
            console.log("stepped over time to next day!!!");
            if (now > end) {
                end = end.add(24, 'hours');
            }
            else {
                start = start.add(-24, 'hours');
            }
        }
        var within = Period.between(start, end, now);
        return within;
    }
    static between(start, end, time) {
        var ms = time.valueOf();
        return ms >= start.valueOf() && ms <= end.valueOf();
    }
}


/***/ }),

/***/ 44846:
/*!************************************************!*\
  !*** ./projects/core/src/app/data/data/pos.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Pos": () => (/* binding */ Pos)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Pos extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Pos";
        this.payments = [];
        this.lockTable = false;
        this.manualSync = false;
        this.extra = {};
    }
    toProperty(name, value) {
        return value;
    }
    hasPayment(method) {
        if (!this.payments)
            return false;
        return this.payments.indexOf(method) >= 0;
    }
}


/***/ }),

/***/ 71700:
/*!*******************************************************!*\
  !*** ./projects/core/src/app/data/data/price-rule.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PriceRule": () => (/* binding */ PriceRule)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _opening_hours__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./opening-hours */ 33336);


class PriceRule extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "PriceRule";
        this.level = 1;
    }
    toProperty(name, value) {
        switch (name) {
            case "openings":
                value = _data__WEBPACK_IMPORTED_MODULE_0__.Data.toData(_opening_hours__WEBPACK_IMPORTED_MODULE_1__.OpeningHours, value);
                break;
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
    static isActive(rule, time, store) {
        if (!rule.openings) {
            return true;
        }
        let brandOpeningHours = null;
        if (store && store.brand && store.brand.openings) {
            brandOpeningHours = store.brand.openings;
        }
        return _opening_hours__WEBPACK_IMPORTED_MODULE_1__.OpeningHours.isTimeOpen(brandOpeningHours, rule.openings, time);
    }
    static getUserScore(rule, member) {
        console.log('getUserScore2', rule);
        var users = rule.users;
        if (!users || users.length == 0)
            return 0;
        //NOTE: Only support guest or member now
        var type = "guest";
        if (member === null || member === void 0 ? void 0 : member.membership) {
            type = 'member';
        }
        if (users.indexOf(type) >= 0) {
            return 100;
        }
        else {
            return -10000;
        }
    }
    static getMemberTierScore(rule, member) {
        var _a, _b, _c;
        var users = rule.tier;
        if (!users || users.length == 0)
            return 0;
        //NOTE: Support member tier now
        var type = ((_b = (_a = member === null || member === void 0 ? void 0 : member.membership) === null || _a === void 0 ? void 0 : _a.memberTierPolicy) === null || _b === void 0 ? void 0 : _b.tier) || ((_c = member === null || member === void 0 ? void 0 : member.membership) === null || _c === void 0 ? void 0 : _c.tier);
        if (type === users) {
            return 100;
        }
        else {
            return -10000;
        }
    }
    static getModeScore(rule, mode) {
        var modes = rule.modes;
        console.log("getModeScore2", mode);
        if (!modes || modes.length == 0)
            return 0;
        if (rule.modes.indexOf(mode) >= 0) {
            return 100;
        }
        else {
            return -10000;
        }
    }
    static getMatch(rule, time, mode, member, store, checkTierPrice) {
        var timeOk = PriceRule.isActive(rule, time, store);
        if (!timeOk) {
            console.log('not active');
            return -10000;
        }
        var userScore = PriceRule.getUserScore(rule, member);
        var modeScore = PriceRule.getModeScore(rule, mode);
        var memberTierScore = PriceRule.getMemberTierScore(rule, member);
        //var periodScore = PriceRule.getPeriodScore(rule);
        console.log('userScore', userScore, 'modeScore', modeScore);
        if (checkTierPrice) {
            if (userScore > -10000 && modeScore > -10000 && memberTierScore > -10000) {
                return userScore + modeScore + memberTierScore;
            }
        }
        else {
            if (userScore > -10000 && modeScore > -10000) {
                return userScore + modeScore;
            }
        }
        return -10000;
    }
}


/***/ }),

/***/ 40305:
/*!******************************************************!*\
  !*** ./projects/core/src/app/data/data/print-job.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PrintJob": () => (/* binding */ PrintJob)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class PrintJob extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "PrintJob";
        this.test = false;
    }
}


/***/ }),

/***/ 13554:
/*!****************************************************!*\
  !*** ./projects/core/src/app/data/data/printer.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Printer": () => (/* binding */ Printer)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Printer extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Printer";
        this.enabled = false;
        this.cloud = false;
    }
}


/***/ }),

/***/ 81031:
/*!*****************************************************!*\
  !*** ./projects/core/src/app/data/data/property.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Property": () => (/* binding */ Property)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Property extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Property";
    }
    toProperty(name, value) {
        return super.toProperty(name, value);
    }
}


/***/ }),

/***/ 12704:
/*!****************************************************!*\
  !*** ./projects/core/src/app/data/data/publish.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Publish": () => (/* binding */ Publish)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Publish extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Publish";
    }
}


/***/ }),

/***/ 47126:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/queue.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Queue": () => (/* binding */ Queue)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Queue extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Queue";
        this.active = false;
    }
}


/***/ }),

/***/ 10468:
/*!*****************************************************************!*\
  !*** ./projects/core/src/app/data/data/recommendation-group.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RecommendationGroup": () => (/* binding */ RecommendationGroup)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class RecommendationGroup extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "RecommendationGroup";
    }
}


/***/ }),

/***/ 77595:
/*!***********************************************************!*\
  !*** ./projects/core/src/app/data/data/recommendation.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Recommendation": () => (/* binding */ Recommendation)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Recommendation extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Recommendation";
    }
}


/***/ }),

/***/ 29219:
/*!***************************************************!*\
  !*** ./projects/core/src/app/data/data/reward.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Reward": () => (/* binding */ Reward)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _discount__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./discount */ 15508);


class Reward extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Reward";
    }
    static toRewardData(reward) {
        var json = {};
        json["id"] = reward.id;
        json["name"] = reward.name;
        json["hint"] = reward.hint;
        json["published"] = reward.published;
        json["backendId"] = reward.backendId;
        json["price"] = reward.price;
        if (reward.discount) {
            json["discount"] = _discount__WEBPACK_IMPORTED_MODULE_1__.Discount.toDiscountData(reward.discount);
        }
        return json;
    }
    toProperty(name, value) {
        if (name == "discount") {
            return _data__WEBPACK_IMPORTED_MODULE_0__.Data.toData(_discount__WEBPACK_IMPORTED_MODULE_1__.Discount, value);
        }
        return value;
    }
    // 判断在当前的order下是否满足使用reward的条件(reward flow：用佐offer, 相当于apply 一次 discount)
    // Whether to meet the conditions of using reward with Order
    isReawardSatisfied(order) {
        let ok = true;
        let promo = this.findPromo_discount(order);
        promo && this.discount && this.discount.conditions.forEach(c => {
            if (!c.isSatisfied(order, promo))
                ok = false;
        });
        return ok;
    }
    // 从所有的 discounts 里找到当前 reward 对应的 discount
    findPromo_discount(order) {
        // order.promotions: original discounts_all information
        if (!order || !order.promotions || order.promotions.length === 0)
            return null;
        let promos = order.promotions.filter((pro) => {
            return this.discount && pro && this.discount.id === pro.id;
        });
        let promo = promos && promos[0];
        if (!promo) {
            console.log('找不到reward 对应的discount in store.menu.discounts(brand.discounts)');
        }
        return promo;
    }
}


/***/ }),

/***/ 45005:
/*!***************************************************!*\
  !*** ./projects/core/src/app/data/data/screen.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Screen": () => (/* binding */ Screen)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Screen extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Screen";
        this.sequence = 0;
        this.dynamic = false;
        this.published = false;
        this.maxTiles = 10;
    }
}


/***/ }),

/***/ 27858:
/*!************************************************!*\
  !*** ./projects/core/src/app/data/data/seo.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Seo": () => (/* binding */ Seo)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Seo extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
}


/***/ }),

/***/ 35979:
/*!****************************************************!*\
  !*** ./projects/core/src/app/data/data/setting.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Setting": () => (/* binding */ Setting)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Setting extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
}


/***/ }),

/***/ 24925:
/*!****************************************************!*\
  !*** ./projects/core/src/app/data/data/signage.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Signage": () => (/* binding */ Signage)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Signage extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Signage";
        this.screenCount = 0;
        this.dynamic = false;
        this.published = false;
    }
}


/***/ }),

/***/ 66910:
/*!*************************************************!*\
  !*** ./projects/core/src/app/data/data/slot.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Slot": () => (/* binding */ Slot)
/* harmony export */ });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ 84291);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ 54738);


class Slot extends _data__WEBPACK_IMPORTED_MODULE_1__.Data {
    constructor() {
        super(...arguments);
        this.class = "Slot";
    }
    static isWithinDayRange(slot, time) {
        var start = moment__WEBPACK_IMPORTED_MODULE_0__(slot.startDate);
        var end = moment__WEBPACK_IMPORTED_MODULE_0__(slot.endDate);
        if (slot.startTime && slot.endTime) {
            var startTime = moment__WEBPACK_IMPORTED_MODULE_0__(slot.startTime, 'HH:mm');
            var endTime = moment__WEBPACK_IMPORTED_MODULE_0__(slot.endTime, 'HH:mm');
            end = endTime < startTime ? moment__WEBPACK_IMPORTED_MODULE_0__((slot.endDate + " " + slot.endTime), "YYYY-MM-DD HH:mm") : moment__WEBPACK_IMPORTED_MODULE_0__(slot.endDate);
        }
        end.add("day", 1);
        var now = moment__WEBPACK_IMPORTED_MODULE_0__(time);
        //console.log("is within?", now.toISOString(), start.toISOString(), end.toISOString());
        return Slot.between(start, end, now);
    }
    //inclusive start, exclusive end
    static between(start, end, time, exclusiveEnd = true) {
        var ms = time.valueOf();
        if (exclusiveEnd) {
            return ms >= start.valueOf() && ms < end.valueOf();
        }
        else {
            return ms >= start.valueOf() && ms <= end.valueOf();
        }
    }
    static isTimeOpen(slot, time, checkWeekdays) {
        var startTime = slot.startTime;
        var endTime = slot.endTime;
        var start = moment__WEBPACK_IMPORTED_MODULE_0__(startTime, "HH:mm");
        var end = moment__WEBPACK_IMPORTED_MODULE_0__(endTime, "HH:mm");
        if (!start || !end) {
            //console.log("invalid start / end, period invalid");
            return false;
        }
        var now = moment__WEBPACK_IMPORTED_MODULE_0__(time);
        var weekday = now.day();
        var overNextDay = end < start;
        var isOverDay = overNextDay && (slot.weekday - weekday == -1 || slot.weekday - weekday == 6);
        if (checkWeekdays && weekday != slot.weekday && slot.weekday < 10) {
            //console.log("wrong weekday");
            if (!isOverDay) {
                return false;
            }
        }
        if (!Slot.isOpenType(slot)) {
            //if slot time is closed and it's matching day, always closed
            return false;
        }
        //console.log("right weekday", slot.weekday);
        start.year(now.year());
        start.month(now.month());
        start.dayOfYear(now.dayOfYear());
        end.year(now.year());
        end.month(now.month());
        end.dayOfYear(now.dayOfYear());
        if (overNextDay) {
            //console.log("stepped over time to next day!!!");
            if (weekday == 0) {
                if (now > end && isOverDay) {
                    end = end.add(24, 'hours');
                }
                else if (isOverDay) {
                    start = start.add(-24, 'hours');
                }
            }
            else if (now > end) {
                end = end.add(24, 'hours');
            }
            else if (isOverDay || slot.weekday > 10) {
                start = start.add(-24, 'hours');
            }
        }
        //console.log("start moment", start.toDate());
        //console.log("now moment", now.toDate());
        //console.log("end moment", end.toDate());
        var within = Slot.between(start, end, now, false);
        return within;
    }
    static isWeekdayOpen(slot, time) {
        var now = moment__WEBPACK_IMPORTED_MODULE_0__(time);
        var weekday = now.day();
        if (weekday != slot.weekday) {
            return false;
        }
        var startTime = slot.startTime;
        var endTime = slot.endTime;
        if (startTime && endTime)
            return Slot.isOpenType(slot);
        return false;
    }
    static isDateOpen(slot, time) {
        var now = moment__WEBPACK_IMPORTED_MODULE_0__(time);
        var startTime = slot.startTime;
        var endTime = slot.endTime;
        if (startTime && endTime)
            return Slot.isOpenType(slot);
        return false;
    }
    static isOpenType(slot) {
        if (slot.type) {
            return 'open' == slot.type;
        }
        return true;
    }
    /**
     * Get start & end time from specific slot with reference of time & n day before/after
     *
     * @param time
     * @param slot
     * @param n
     * @private
     */
    static getTimeFromSlot(time, slot, n) {
        const now = moment__WEBPACK_IMPORTED_MODULE_0__(time);
        let start = moment__WEBPACK_IMPORTED_MODULE_0__(slot.startTime, 'HH:mm');
        let end = moment__WEBPACK_IMPORTED_MODULE_0__(slot.endTime, 'HH:mm');
        start.year(now.year());
        start.month(now.month());
        start.date(now.date());
        end.year(now.year());
        end.month(now.month());
        end.date(now.date());
        start = start.add(n * 24, 'hours');
        end = end.add(n * 24, 'hours');
        if (end < start) {
            end = end.add(24, 'hours');
        }
        return {
            start,
            end
        };
    }
    /**
     * Method for checking it time open or not in weekdays (0 - 6).
     * 0 = SUN, 6 = SAT
     *
     * It compares the date with current time & before time & next time.
     * So, case of over day should be covered.
     *
     * Ex:
     * Schedule : SAT = 18 - 4, SUN = 22 - 1
     * If time ref is SUN 3, then it should use time slot SAT
     *
     * @param slots
     * @param time
     */
    static isTimeOpenOnWeekdays(slots, time) {
        // console.log('start checking======= ', slots);
        // DEBUG PURPOSE ONLY
        // const t = new Date(2023, 2, 30, 1, 0, 0).getTime();
        const t = time;
        const now = moment__WEBPACK_IMPORTED_MODULE_0__(t);
        const nowWeekday = now.day();
        const todaySlot = slots.find(f => f.weekday == nowWeekday);
        if (!todaySlot) {
            return false;
        }
        const beforeSlotWeekday = todaySlot.weekday - 1 == -1 ? 6 : todaySlot.weekday - 1;
        const beforeSlot = slots.find(f => f.weekday == beforeSlotWeekday);
        const afterSlotWeekday = todaySlot.weekday + 1 == 7 ? 0 : todaySlot.weekday + 1;
        const afterSlot = slots.find(f => f.weekday == afterSlotWeekday);
        const beforeTime = this.getTimeFromSlot(t, beforeSlot, -1);
        const todayTime = this.getTimeFromSlot(t, todaySlot, 0);
        const afterTime = this.getTimeFromSlot(t, afterSlot, 1);
        if (Slot.between(todayTime.start, todayTime.end, now, false) && Slot.isOpenType(todaySlot)) {
            return true;
        }
        else if (Slot.between(beforeTime.start, beforeTime.end, now, false) && Slot.isOpenType(beforeSlot)) {
            return true;
        }
        else if (Slot.between(afterTime.start, afterTime.end, now, false) && Slot.isOpenType(afterSlot)) {
            return true;
        }
        // console.log('mmmm before ', beforeSlot, beforeTime.start.toDate(), beforeTime.end.toDate());
        // console.log('mmmm today ', todaySlot, todayTime.start.toDate(), todayTime.end.toDate());
        // console.log('mmmm after ', afterSlot, afterTime.start.toDate(), afterTime.end.toDate());
        return false;
    }
}


/***/ }),

/***/ 73798:
/*!*************************************************!*\
  !*** ./projects/core/src/app/data/data/spot.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Spot": () => (/* binding */ Spot)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Spot extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Spot";
    }
}


/***/ }),

/***/ 15555:
/*!****************************************************!*\
  !*** ./projects/core/src/app/data/data/station.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Station": () => (/* binding */ Station)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Station extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Station";
    }
}


/***/ }),

/***/ 94045:
/*!**************************************************!*\
  !*** ./projects/core/src/app/data/data/store.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Store": () => (/* binding */ Store)
/* harmony export */ });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ 84291);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utility_check_format_tool__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utility/check-format-tool */ 8137);
/* harmony import */ var _brand__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./brand */ 91826);
/* harmony import */ var _category__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./category */ 62419);
/* harmony import */ var _crm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./crm */ 47114);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./data */ 54738);
/* harmony import */ var _location__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./location */ 19052);
/* harmony import */ var _menu__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./menu */ 16554);
/* harmony import */ var _opening_hours__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./opening-hours */ 33336);
/* harmony import */ var _period__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./period */ 62569);
/* harmony import */ var _pos__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./pos */ 44846);
/* harmony import */ var _printer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./printer */ 13554);
/* harmony import */ var _seo__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./seo */ 27858);
/* harmony import */ var _aigens_core_src_app_framework_services_menu_util__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @aigens/core/src/app/framework/services/menu.util */ 79771);














class Store extends _data__WEBPACK_IMPORTED_MODULE_5__.Data {
    constructor() {
        super(...arguments);
        this.class = "Store";
        this.channels = [];
        this.features = [];
        this.cateringPickupModes = [];
    }
    get sign() {
        if (this.currency == null && this.currencySign == null)
            return "$";
        if (this.currencySign != null)
            return this.currencySign;
        let cur = this.currency.toLowerCase();
        let sign = "$";
        if ("cny" == cur) {
            sign = "¥";
        }
        else if ("inr" == cur) {
            sign = "₹";
        }
        else if ("myr" == cur) {
            sign = "RM";
        }
        else if ("sgd" == cur) {
            sign = "S$";
        }
        else {
            sign = "$";
        }
        return sign;
    }
    static getBusiness(store, time) {
        var offset = 8;
        if (store.timezone) {
            offset = Number.parseInt(store.timezone.replace("GMT", ""));
        }
        return moment__WEBPACK_IMPORTED_MODULE_0__(time.getTime()).utcOffset(offset).format('YYYY-MM-DD');
    }
    static isOpeningHours(store, time) {
        var oh = store === null || store === void 0 ? void 0 : store.openings;
        if (!oh)
            return true;
        var brand = store.brand;
        if (brand && brand.openings) {
            var holidays = brand.openings;
            oh.ph1 = holidays.holidays;
        }
        let openings = null;
        if (brand && brand.openings) {
            openings = brand.openings;
        }
        return _opening_hours__WEBPACK_IMPORTED_MODULE_8__.OpeningHours.isTimeOpen(openings, oh, time);
    }
    static checkTimeWithinPeriods(store, time) {
        let periods = store.menu ? store.menu.periods : [];
        let withinPeriods = []; // current time within that periods
        const now = time ? new Date(time) : new Date();
        periods.forEach((period, index) => {
            if ((0,_utility_check_format_tool__WEBPACK_IMPORTED_MODULE_1__.isAvailablePeriod)(store, period, now)) {
                withinPeriods.push(period);
            }
        });
        // console.log("current time withinperiod ? " , withinPeriods)
        return withinPeriods;
    }
    static getAllPeriodOfMode(store, mode) {
        const processPeriods = _aigens_core_src_app_framework_services_menu_util__WEBPACK_IMPORTED_MODULE_13__.MenuUtil.getValidPeriod(null, store);
        const availByMode = processPeriods.filter(period => {
            var _a, _b, _c;
            return (((_a = period === null || period === void 0 ? void 0 : period.modes) === null || _a === void 0 ? void 0 : _a.includes(mode)) ||
                ((_b = period === null || period === void 0 ? void 0 : period.modes) === null || _b === void 0 ? void 0 : _b.includes('all')) || // all = include
                !(period === null || period === void 0 ? void 0 : period.modes) || ((_c = period === null || period === void 0 ? void 0 : period.modes) === null || _c === void 0 ? void 0 : _c.length) === 0); // null = all = include
        });
        // console.log('xxxxx ', JSON.parse(JSON.stringify(availByMode)));
        // eliminate period that start - end in range of other period
        const temp = [];
        availByMode.forEach(o => {
            let canSkip = false;
            temp.forEach(t => {
                if (o.startNum < t.endNum && o.endNum > t.startNum) {
                    canSkip = true;
                }
            });
            if (!canSkip) {
                temp.push(o);
            }
        });
        // console.log('==== ', availByMode, temp);
        return this.mergePeriod(temp);
    }
    static mergePeriod(period) {
        if (period.length < 2) {
            return period;
        }
        period.sort((a, b) => a['startNum'] - b['startNum']);
        // console.log('sort ==== ', JSON.parse(JSON.stringify(period)));
        const x = [];
        // x.push({startNum: period[0].startNum, endNum: period[0].endNum});
        x.push(period[0]);
        for (let i = 1; i < period.length; i++) {
            const p = period[i];
            const lastIdx = x.length - 1;
            const lastX = x[lastIdx];
            if (lastX.endNum >= p.startNum) {
                lastX.endNum = p.endNum;
                lastX.end = p.end;
                lastX.endTime = p.endTime;
            }
            else {
                // x.push({startNum: p.startNum, endNum: p.endNum});
                x.push(p);
            }
        }
        // console.log('xxxxxxxx ', x);
        return x;
    }
    static stoppedPreOrder(store, time, varPeriod) {
        let periods = varPeriod ? varPeriod : (store.menu ? store.menu.periods : []);
        let currentPeriod;
        const now = time ? new Date(time) : new Date();
        const currentTime = now.getTime();
        let stopped = null;
        if (!periods) {
            periods = [];
        }
        if (Store.isWholeDayOpen(store)) {
            const period = new _period__WEBPACK_IMPORTED_MODULE_9__.Period();
            period.endTime = store.menu.periods[store.menu.periods.length - 1].endTime;
            period.end = store.menu.periods[store.menu.periods.length - 1].end;
            period.startTime = store.menu.periods[0].startTime;
            period.start = store.menu.periods[0].start;
            period['prestop'] = store.menu.periods[store.menu.periods.length - 1]['prestop'] ? store.menu.periods[store.menu.periods.length - 1]['prestop'] : 0;
            stopped = (0,_utility_check_format_tool__WEBPACK_IMPORTED_MODULE_1__.isPeriodClosed)(store, period, currentTime);
            return [stopped, period];
        }
        periods.forEach((period, index) => {
            if ((0,_utility_check_format_tool__WEBPACK_IMPORTED_MODULE_1__.isAvailablePeriod)(store, period, now)) {
                if (stopped === null) {
                    stopped = (0,_utility_check_format_tool__WEBPACK_IMPORTED_MODULE_1__.isPeriodClosed)(store, period, currentTime);
                    currentPeriod = period;
                }
            }
        });
        if (periods.length <= 0) {
            const closeTime = (0,_utility_check_format_tool__WEBPACK_IMPORTED_MODULE_1__.getTodayMillisecondsFromTimeString)((0,_utility_check_format_tool__WEBPACK_IMPORTED_MODULE_1__.getClosedTime)(store, time), time);
            const current = now.getMilliseconds();
            stopped = (current >= closeTime);
            return [stopped, null];
        }
        if (stopped === null) {
            return [true, null];
        }
        return [stopped, currentPeriod];
    }
    static hasFeature(store, feature) {
        if (store.features) {
            return store.features.indexOf(feature) >= 0;
        }
        return false;
    }
    static getPickUpInfo(store) {
        let addInfo = {};
        if (store && store.location && store.menu.settings && store.menu.settings.pickUpTimeLimit) {
            addInfo = {
                time: store.menu.settings.pickUpTimeLimit,
                store: store.name,
                branch: store.location.name
            };
        }
        return addInfo;
    }
    static isWholeDayOpen(store) {
        let previousEndTime;
        let isWholeDay = true;
        const periods = store.menu ? (store.menu.periods ? store.menu.periods : []) : [];
        if (periods.length <= 0) {
            return false;
        }
        periods.forEach((period, index) => {
            if (previousEndTime && isWholeDay) {
                isWholeDay = period.start - previousEndTime === 60000;
            }
            previousEndTime = period.end;
        });
        return isWholeDay;
    }
    hasFeature(feature) {
        if (this.features) {
            return this.features.indexOf(feature) >= 0;
        }
        return false;
    }
    toProperty(name, value) {
        switch (name) {
            case "brand":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_brand__WEBPACK_IMPORTED_MODULE_2__.Brand, value);
                break;
            case "menu":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_menu__WEBPACK_IMPORTED_MODULE_7__.Menu, value);
                break;
            case "categories":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_category__WEBPACK_IMPORTED_MODULE_3__.Category, value);
                break;
            case "location":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_location__WEBPACK_IMPORTED_MODULE_6__.Location, value);
                break;
            case "pos":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_pos__WEBPACK_IMPORTED_MODULE_10__.Pos, value);
                break;
            case "printers":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_printer__WEBPACK_IMPORTED_MODULE_11__.Printer, value);
                break;
            case "periods":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toDataArray(_period__WEBPACK_IMPORTED_MODULE_9__.Period, value);
                break;
            case "openings":
            case "openings2":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_opening_hours__WEBPACK_IMPORTED_MODULE_8__.OpeningHours, value);
                break;
            case "crm":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_crm__WEBPACK_IMPORTED_MODULE_4__.Crm, value);
                break;
            case "seo":
                value = _data__WEBPACK_IMPORTED_MODULE_5__.Data.toData(_seo__WEBPACK_IMPORTED_MODULE_12__.Seo, value);
                break;
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
}


/***/ }),

/***/ 95607:
/*!*****************************************************!*\
  !*** ./projects/core/src/app/data/data/tax-rule.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TaxRule": () => (/* binding */ TaxRule)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class TaxRule extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "TaxRule";
    }
    toProperty(name, value) {
        switch (name) {
            default:
                value = super.toProperty(name, value);
                break;
        }
        return value;
    }
}


/***/ }),

/***/ 73653:
/*!***************************************************!*\
  !*** ./projects/core/src/app/data/data/ticket.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Ticket": () => (/* binding */ Ticket)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Ticket extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Ticket";
        this.phoneNotify = false;
    }
}


/***/ }),

/***/ 38854:
/*!*************************************************!*\
  !*** ./projects/core/src/app/data/data/tile.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Tile": () => (/* binding */ Tile)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ 54738);

class Tile extends _data__WEBPACK_IMPORTED_MODULE_0__.Data {
    constructor() {
        super(...arguments);
        this.class = "Tile";
        this.sequence = 0;
        this.screenPos = 0;
        this.visibleItems = 0;
        this.virtual = false;
    }
}


/***/ }),

/***/ 51707:
/*!*********************************************!*\
  !*** ./projects/core/src/app/data/index.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Ad": () => (/* reexport safe */ _data_ad__WEBPACK_IMPORTED_MODULE_0__.Ad),
/* harmony export */   "Address": () => (/* reexport safe */ _data_address__WEBPACK_IMPORTED_MODULE_1__.Address),
/* harmony export */   "Agreement": () => (/* reexport safe */ _data_agreement__WEBPACK_IMPORTED_MODULE_2__.Agreement),
/* harmony export */   "Badge": () => (/* reexport safe */ _data_badge__WEBPACK_IMPORTED_MODULE_3__.Badge),
/* harmony export */   "Benefit": () => (/* reexport safe */ _data_benefit__WEBPACK_IMPORTED_MODULE_4__.Benefit),
/* harmony export */   "Brand": () => (/* reexport safe */ _data_brand__WEBPACK_IMPORTED_MODULE_5__.Brand),
/* harmony export */   "Category": () => (/* reexport safe */ _data_category__WEBPACK_IMPORTED_MODULE_6__.Category),
/* harmony export */   "CategoryGroup": () => (/* reexport safe */ _data_category_group__WEBPACK_IMPORTED_MODULE_7__.CategoryGroup),
/* harmony export */   "Charge": () => (/* reexport safe */ _data_charge__WEBPACK_IMPORTED_MODULE_8__.Charge),
/* harmony export */   "CheckFormatTool": () => (/* reexport module object */ _utility_check_format_tool__WEBPACK_IMPORTED_MODULE_56__),
/* harmony export */   "Condition": () => (/* reexport safe */ _data_condition__WEBPACK_IMPORTED_MODULE_9__.Condition),
/* harmony export */   "Courier": () => (/* reexport safe */ _data_courier__WEBPACK_IMPORTED_MODULE_10__.Courier),
/* harmony export */   "Court": () => (/* reexport safe */ _data_court__WEBPACK_IMPORTED_MODULE_11__.Court),
/* harmony export */   "CreditCard": () => (/* reexport safe */ _data_credit_card__WEBPACK_IMPORTED_MODULE_12__.CreditCard),
/* harmony export */   "Crm": () => (/* reexport safe */ _data_crm__WEBPACK_IMPORTED_MODULE_13__.Crm),
/* harmony export */   "Data": () => (/* reexport safe */ _data_data__WEBPACK_IMPORTED_MODULE_14__.Data),
/* harmony export */   "Discount": () => (/* reexport safe */ _data_discount__WEBPACK_IMPORTED_MODULE_15__.Discount),
/* harmony export */   "Edit": () => (/* reexport safe */ _data_edit__WEBPACK_IMPORTED_MODULE_16__.Edit),
/* harmony export */   "EditRecord": () => (/* reexport safe */ _data_edit_record__WEBPACK_IMPORTED_MODULE_17__.EditRecord),
/* harmony export */   "Field": () => (/* reexport safe */ _data_field__WEBPACK_IMPORTED_MODULE_18__.Field),
/* harmony export */   "File": () => (/* reexport safe */ _data_file__WEBPACK_IMPORTED_MODULE_19__.File),
/* harmony export */   "Geo": () => (/* reexport safe */ _data_geo__WEBPACK_IMPORTED_MODULE_20__.Geo),
/* harmony export */   "Group": () => (/* reexport safe */ _data_group__WEBPACK_IMPORTED_MODULE_21__.Group),
/* harmony export */   "Image": () => (/* reexport safe */ _data_image__WEBPACK_IMPORTED_MODULE_22__.Image),
/* harmony export */   "Item": () => (/* reexport safe */ _data_item__WEBPACK_IMPORTED_MODULE_23__.Item),
/* harmony export */   "ItemGroup": () => (/* reexport safe */ _data_item_group__WEBPACK_IMPORTED_MODULE_24__.ItemGroup),
/* harmony export */   "KitchenOrderItem": () => (/* reexport safe */ _data_kitchen_order_item__WEBPACK_IMPORTED_MODULE_25__.KitchenOrderItem),
/* harmony export */   "Link": () => (/* reexport safe */ _data_link__WEBPACK_IMPORTED_MODULE_26__.Link),
/* harmony export */   "Location": () => (/* reexport safe */ _data_location__WEBPACK_IMPORTED_MODULE_27__.Location),
/* harmony export */   "MathUtils": () => (/* reexport safe */ _utility_math_utils__WEBPACK_IMPORTED_MODULE_57__.MathUtils),
/* harmony export */   "Member": () => (/* reexport safe */ _data_member__WEBPACK_IMPORTED_MODULE_28__.Member),
/* harmony export */   "Membership": () => (/* reexport safe */ _data_membership__WEBPACK_IMPORTED_MODULE_29__.Membership),
/* harmony export */   "Menu": () => (/* reexport safe */ _data_menu__WEBPACK_IMPORTED_MODULE_30__.Menu),
/* harmony export */   "Offer": () => (/* reexport safe */ _data_offer__WEBPACK_IMPORTED_MODULE_31__.Offer),
/* harmony export */   "OpeningHours": () => (/* reexport safe */ _data_opening_hours__WEBPACK_IMPORTED_MODULE_32__.OpeningHours),
/* harmony export */   "Order": () => (/* reexport safe */ _data_order__WEBPACK_IMPORTED_MODULE_33__.Order),
/* harmony export */   "OrderItem": () => (/* reexport safe */ _data_order_item__WEBPACK_IMPORTED_MODULE_34__.OrderItem),
/* harmony export */   "Period": () => (/* reexport safe */ _data_period__WEBPACK_IMPORTED_MODULE_35__.Period),
/* harmony export */   "Pos": () => (/* reexport safe */ _data_pos__WEBPACK_IMPORTED_MODULE_36__.Pos),
/* harmony export */   "PriceRule": () => (/* reexport safe */ _data_price_rule__WEBPACK_IMPORTED_MODULE_37__.PriceRule),
/* harmony export */   "PrintJob": () => (/* reexport safe */ _data_print_job__WEBPACK_IMPORTED_MODULE_38__.PrintJob),
/* harmony export */   "Printer": () => (/* reexport safe */ _data_printer__WEBPACK_IMPORTED_MODULE_39__.Printer),
/* harmony export */   "Property": () => (/* reexport safe */ _data_property__WEBPACK_IMPORTED_MODULE_40__.Property),
/* harmony export */   "Publish": () => (/* reexport safe */ _data_publish__WEBPACK_IMPORTED_MODULE_41__.Publish),
/* harmony export */   "Queue": () => (/* reexport safe */ _data_queue__WEBPACK_IMPORTED_MODULE_42__.Queue),
/* harmony export */   "Recommendation": () => (/* reexport safe */ _data_recommendation__WEBPACK_IMPORTED_MODULE_43__.Recommendation),
/* harmony export */   "RecommendationGroup": () => (/* reexport safe */ _data_recommendation_group__WEBPACK_IMPORTED_MODULE_44__.RecommendationGroup),
/* harmony export */   "Reward": () => (/* reexport safe */ _data_reward__WEBPACK_IMPORTED_MODULE_45__.Reward),
/* harmony export */   "Screen": () => (/* reexport safe */ _data_screen__WEBPACK_IMPORTED_MODULE_46__.Screen),
/* harmony export */   "Setting": () => (/* reexport safe */ _data_setting__WEBPACK_IMPORTED_MODULE_47__.Setting),
/* harmony export */   "Signage": () => (/* reexport safe */ _data_signage__WEBPACK_IMPORTED_MODULE_48__.Signage),
/* harmony export */   "Slot": () => (/* reexport safe */ _data_slot__WEBPACK_IMPORTED_MODULE_49__.Slot),
/* harmony export */   "Spot": () => (/* reexport safe */ _data_spot__WEBPACK_IMPORTED_MODULE_50__.Spot),
/* harmony export */   "Station": () => (/* reexport safe */ _data_station__WEBPACK_IMPORTED_MODULE_51__.Station),
/* harmony export */   "Store": () => (/* reexport safe */ _data_store__WEBPACK_IMPORTED_MODULE_52__.Store),
/* harmony export */   "TaxRule": () => (/* reexport safe */ _data_tax_rule__WEBPACK_IMPORTED_MODULE_53__.TaxRule),
/* harmony export */   "Ticket": () => (/* reexport safe */ _data_ticket__WEBPACK_IMPORTED_MODULE_54__.Ticket),
/* harmony export */   "Tile": () => (/* reexport safe */ _data_tile__WEBPACK_IMPORTED_MODULE_55__.Tile)
/* harmony export */ });
/* harmony import */ var _data_ad__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data/ad */ 28171);
/* harmony import */ var _data_address__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data/address */ 82901);
/* harmony import */ var _data_agreement__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./data/agreement */ 20202);
/* harmony import */ var _data_badge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./data/badge */ 32552);
/* harmony import */ var _data_benefit__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./data/benefit */ 25237);
/* harmony import */ var _data_brand__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./data/brand */ 91826);
/* harmony import */ var _data_category__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./data/category */ 62419);
/* harmony import */ var _data_category_group__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./data/category-group */ 42143);
/* harmony import */ var _data_charge__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./data/charge */ 92587);
/* harmony import */ var _data_condition__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./data/condition */ 24194);
/* harmony import */ var _data_courier__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./data/courier */ 65142);
/* harmony import */ var _data_court__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./data/court */ 25810);
/* harmony import */ var _data_credit_card__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./data/credit-card */ 80966);
/* harmony import */ var _data_crm__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./data/crm */ 47114);
/* harmony import */ var _data_data__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./data/data */ 54738);
/* harmony import */ var _data_discount__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./data/discount */ 15508);
/* harmony import */ var _data_edit__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./data/edit */ 56706);
/* harmony import */ var _data_edit_record__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./data/edit-record */ 34649);
/* harmony import */ var _data_field__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./data/field */ 50966);
/* harmony import */ var _data_file__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./data/file */ 11094);
/* harmony import */ var _data_geo__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./data/geo */ 58899);
/* harmony import */ var _data_group__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./data/group */ 14311);
/* harmony import */ var _data_image__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./data/image */ 69448);
/* harmony import */ var _data_item__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./data/item */ 5647);
/* harmony import */ var _data_item_group__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./data/item-group */ 3840);
/* harmony import */ var _data_kitchen_order_item__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./data/kitchen-order-item */ 24042);
/* harmony import */ var _data_link__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./data/link */ 18671);
/* harmony import */ var _data_location__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./data/location */ 19052);
/* harmony import */ var _data_member__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./data/member */ 53310);
/* harmony import */ var _data_membership__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./data/membership */ 69656);
/* harmony import */ var _data_menu__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./data/menu */ 16554);
/* harmony import */ var _data_offer__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./data/offer */ 46344);
/* harmony import */ var _data_opening_hours__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./data/opening-hours */ 33336);
/* harmony import */ var _data_order__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./data/order */ 43494);
/* harmony import */ var _data_order_item__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./data/order-item */ 88783);
/* harmony import */ var _data_period__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./data/period */ 62569);
/* harmony import */ var _data_pos__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./data/pos */ 44846);
/* harmony import */ var _data_price_rule__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./data/price-rule */ 71700);
/* harmony import */ var _data_print_job__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./data/print-job */ 40305);
/* harmony import */ var _data_printer__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./data/printer */ 13554);
/* harmony import */ var _data_property__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./data/property */ 81031);
/* harmony import */ var _data_publish__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./data/publish */ 12704);
/* harmony import */ var _data_queue__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./data/queue */ 47126);
/* harmony import */ var _data_recommendation__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./data/recommendation */ 77595);
/* harmony import */ var _data_recommendation_group__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./data/recommendation-group */ 10468);
/* harmony import */ var _data_reward__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./data/reward */ 29219);
/* harmony import */ var _data_screen__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./data/screen */ 45005);
/* harmony import */ var _data_setting__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./data/setting */ 35979);
/* harmony import */ var _data_signage__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./data/signage */ 24925);
/* harmony import */ var _data_slot__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./data/slot */ 66910);
/* harmony import */ var _data_spot__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ./data/spot */ 73798);
/* harmony import */ var _data_station__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ./data/station */ 15555);
/* harmony import */ var _data_store__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ./data/store */ 94045);
/* harmony import */ var _data_tax_rule__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ./data/tax-rule */ 95607);
/* harmony import */ var _data_ticket__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ./data/ticket */ 73653);
/* harmony import */ var _data_tile__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! ./data/tile */ 38854);
/* harmony import */ var _utility_check_format_tool__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! ./utility/check-format-tool */ 8137);
/* harmony import */ var _utility_math_utils__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! ./utility/math-utils */ 45672);





























































/***/ }),

/***/ 8137:
/*!*****************************************************************!*\
  !*** ./projects/core/src/app/data/utility/check-format-tool.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "asLetter": () => (/* binding */ asLetter),
/* harmony export */   "confirmEmailFormatValidator": () => (/* binding */ confirmEmailFormatValidator),
/* harmony export */   "confirmPasswordFormatValidator": () => (/* binding */ confirmPasswordFormatValidator),
/* harmony export */   "convertNowDateToStoreTimeZone": () => (/* binding */ convertNowDateToStoreTimeZone),
/* harmony export */   "countryCallingCodes": () => (/* binding */ countryCallingCodes),
/* harmony export */   "countryPhoneReg": () => (/* binding */ countryPhoneReg),
/* harmony export */   "currentTimeString": () => (/* binding */ currentTimeString),
/* harmony export */   "emailFormatValidator": () => (/* binding */ emailFormatValidator),
/* harmony export */   "emailValidator": () => (/* binding */ emailValidator),
/* harmony export */   "findCountryByCodes": () => (/* binding */ findCountryByCodes),
/* harmony export */   "firstNameFormatValidator": () => (/* binding */ firstNameFormatValidator),
/* harmony export */   "getClosedTime": () => (/* binding */ getClosedTime),
/* harmony export */   "getCountryCallingCode": () => (/* binding */ getCountryCallingCode),
/* harmony export */   "getDateStringLabel": () => (/* binding */ getDateStringLabel),
/* harmony export */   "getDeliveryDelayTime": () => (/* binding */ getDeliveryDelayTime),
/* harmony export */   "getPhoneLength": () => (/* binding */ getPhoneLength),
/* harmony export */   "getPickupDelayTime": () => (/* binding */ getPickupDelayTime),
/* harmony export */   "getSanitizePhone": () => (/* binding */ getSanitizePhone),
/* harmony export */   "getTandCUrl": () => (/* binding */ getTandCUrl),
/* harmony export */   "getTodayMillisecondsFromTimeString": () => (/* binding */ getTodayMillisecondsFromTimeString),
/* harmony export */   "getWeekdayStartAndEnd": () => (/* binding */ getWeekdayStartAndEnd),
/* harmony export */   "hasHoliday": () => (/* binding */ hasHoliday),
/* harmony export */   "hasNumber": () => (/* binding */ hasNumber),
/* harmony export */   "isAvailableOffer": () => (/* binding */ isAvailableOffer),
/* harmony export */   "isAvailablePeriod": () => (/* binding */ isAvailablePeriod),
/* harmony export */   "isAvailableReward": () => (/* binding */ isAvailableReward),
/* harmony export */   "isEmailValid": () => (/* binding */ isEmailValid),
/* harmony export */   "isEmptyInputValue": () => (/* binding */ isEmptyInputValue),
/* harmony export */   "isEmptyOrWhiteSpace": () => (/* binding */ isEmptyOrWhiteSpace),
/* harmony export */   "isEmptyOrWhiteSpaceValidator": () => (/* binding */ isEmptyOrWhiteSpaceValidator),
/* harmony export */   "isNameVaild": () => (/* binding */ isNameVaild),
/* harmony export */   "isPasswordVaild": () => (/* binding */ isPasswordVaild),
/* harmony export */   "isPeriodClosed": () => (/* binding */ isPeriodClosed),
/* harmony export */   "isPhoneIncludingCode": () => (/* binding */ isPhoneIncludingCode),
/* harmony export */   "isPhoneNumberVaild": () => (/* binding */ isPhoneNumberVaild),
/* harmony export */   "isPhoneValid": () => (/* binding */ isPhoneValid),
/* harmony export */   "isUnitNumberFormat": () => (/* binding */ isUnitNumberFormat),
/* harmony export */   "isValidJson": () => (/* binding */ isValidJson),
/* harmony export */   "lastNameFormatValidator": () => (/* binding */ lastNameFormatValidator),
/* harmony export */   "maxDate": () => (/* binding */ maxDate),
/* harmony export */   "nameDefaultRegex": () => (/* binding */ nameDefaultRegex),
/* harmony export */   "onlyHasNumber": () => (/* binding */ onlyHasNumber),
/* harmony export */   "parseRegex": () => (/* binding */ parseRegex),
/* harmony export */   "passwordFormatValidator": () => (/* binding */ passwordFormatValidator),
/* harmony export */   "phoneValidator": () => (/* binding */ phoneValidator),
/* harmony export */   "timeStringLabel": () => (/* binding */ timeStringLabel)
/* harmony export */ });
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! .. */ 51707);

/** to form logic  start */
/* Extracted from google's libphonenumber */
/* Use JSON.parse because parsing json is faster than defining objects */
const countryCallingCodes = JSON.parse('{"AC":"247","AD":"376","AE":"971","AF":"93","AG":"1","AI":"1","AL":"355","AM":"374","AO":"244","AR":"54","AS":"1","AT":"43","AU":"61","AW":"297","AX":"358","AZ":"994","BA":"387","BB":"1","BD":"880","BE":"32","BF":"226","BG":"359","BH":"973","BI":"257","BJ":"229","BL":"590","BM":"1","BN":"673","BO":"591","BQ":"599","BR":"55","BS":"1","BT":"975","BW":"267","BY":"375","BZ":"501","CA":"1","CC":"61","CD":"243","CF":"236","CG":"242","CH":"41","CI":"225","CK":"682","CL":"56","CM":"237","CN":"86","CO":"57","CR":"506","CU":"53","CV":"238","CW":"599","CX":"61","CY":"357","CZ":"420","DE":"49","DJ":"253","DK":"45","DM":"1","DO":"1","DZ":"213","EC":"593","EE":"372","EG":"20","EH":"212","ER":"291","ES":"34","ET":"251","FI":"358","FJ":"679","FK":"500","FM":"691","FO":"298","FR":"33","GA":"241","GB":"44","GD":"1","GE":"995","GF":"594","GG":"44","GH":"233","GI":"350","GL":"299","GM":"220","GN":"224","GP":"590","GQ":"240","GR":"30","GT":"502","GU":"1","GW":"245","GY":"592","HK":"852","HN":"504","HR":"385","HT":"509","HU":"36","ID":"62","IE":"353","IL":"972","IM":"44","IN":"91","IO":"246","IQ":"964","IR":"98","IS":"354","IT":"39","JE":"44","JM":"1","JO":"962","JP":"81","KE":"254","KG":"996","KH":"855","KI":"686","KM":"269","KN":"1","KP":"850","KR":"82","KW":"965","KY":"1","KZ":"7","LA":"856","LB":"961","LC":"1","LI":"423","LK":"94","LR":"231","LS":"266","LT":"370","LU":"352","LV":"371","LY":"218","MA":"212","MC":"377","MD":"373","ME":"382","MF":"590","MG":"261","MH":"692","MK":"389","ML":"223","MM":"95","MN":"976","MO":"853","MP":"1","MQ":"596","MR":"222","MS":"1","MT":"356","MU":"230","MV":"960","MW":"265","MX":"52","MY":"60","MZ":"258","NA":"264","NC":"687","NE":"227","NF":"672","NG":"234","NI":"505","NL":"31","NO":"47","NP":"977","NR":"674","NU":"683","NZ":"64","OM":"968","PA":"507","PE":"51","PF":"689","PG":"675","PH":"63","PK":"92","PL":"48","PM":"508","PR":"1","PS":"970","PT":"351","PW":"680","PY":"595","QA":"974","RE":"262","RO":"40","RS":"381","RU":"7","RW":"250","SA":"966","SB":"677","SC":"248","SD":"249","SE":"46","SG":"65","SH":"290","SI":"386","SJ":"47","SK":"421","SL":"232","SM":"378","SN":"221","SO":"252","SR":"597","SS":"211","ST":"239","SV":"503","SX":"1","SY":"963","SZ":"268","TA":"290","TC":"1","TD":"235","TG":"228","TH":"66","TJ":"992","TK":"690","TL":"670","TM":"993","TN":"216","TO":"676","TR":"90","TT":"1","TV":"688","TW":"886","TZ":"255","UA":"380","UG":"256","US":"1","UY":"598","UZ":"998","VA":"39","VC":"1","VE":"58","VG":"1","VI":"1","VN":"84","VU":"678","WF":"681","WS":"685","XK":"383","YE":"967","YT":"262","ZA":"27","ZM":"260","ZW":"263","001":"979"}');
const countryPhoneReg = JSON.parse('{"AC":"^((?:[01589]\\\\d|[46])\\\\d{4})$","AD":"^((?:1|6\\\\d)\\\\d{7}|[135-9]\\\\d{5})$","AE":"^(?:0)?((?:[4-7]\\\\d|9[0-689])\\\\d{7}|800\\\\d{2,9}|[2-4679]\\\\d{7})$","AF":"^(?:0)?([2-7]\\\\d{8})$","AG":"^(?:1)?((?:268|[58]\\\\d\\\\d|900)\\\\d{7})$","AI":"^(?:1)?((?:264|[58]\\\\d\\\\d|900)\\\\d{7})$","AL":"^(?:0)?((?:700\\\\d\\\\d|900)\\\\d{3}|8\\\\d{5,7}|(?:[2-5]|6\\\\d)\\\\d{7})$","AM":"^(?:0)?((?:[1-489]\\\\d|55|60|77)\\\\d{6})$","AO":"^([29]\\\\d{8})$","AR":"^(?:0)?((?:11|[89]\\\\d\\\\d)\\\\d{8}|[2368]\\\\d{9})$","AS":"^(?:1)?((?:[58]\\\\d\\\\d|684|900)\\\\d{7})$","AT":"^(?:0)?(1\\\\d{3,12}|2\\\\d{6,12}|43(?:(?:0\\\\d|5[02-9])\\\\d{3,9}|2\\\\d{4,5}|[3467]\\\\d{4}|8\\\\d{4,6}|9\\\\d{4,7})|5\\\\d{4,12}|8\\\\d{7,12}|9\\\\d{8,12}|(?:[367]\\\\d|4[0-24-9])\\\\d{4,11})$","AU":"^(?:0)?(1(?:[0-79]\\\\d{7}(?:\\\\d(?:\\\\d{2})?)?|8[0-24-9]\\\\d{7})|[2-478]\\\\d{8}|1\\\\d{4,7})$","AW":"^((?:[25-79]\\\\d\\\\d|800)\\\\d{4})$","AX":"^(?:0)?(2\\\\d{4,9}|35\\\\d{4,5}|(?:60\\\\d\\\\d|800)\\\\d{4,6}|7\\\\d{5,11}|(?:[14]\\\\d|3[0-46-9]|50)\\\\d{4,8})$","AZ":"^(?:0)?(365\\\\d{6}|(?:[124579]\\\\d|60|88)\\\\d{7})$","BA":"^(?:0)?(6\\\\d{8}|(?:[35689]\\\\d|49|70)\\\\d{6})$","BB":"^(?:1)?((?:246|[58]\\\\d\\\\d|900)\\\\d{7})$","BD":"^(?:0)?([1-469]\\\\d{9}|8[0-79]\\\\d{7,8}|[2-79]\\\\d{8}|[2-9]\\\\d{7}|[3-9]\\\\d{6}|[57-9]\\\\d{5})$","BE":"^(?:0)?(4\\\\d{8}|[1-9]\\\\d{7})$","BF":"^([025-7]\\\\d{7})$","BG":"^(?:0)?([2-7]\\\\d{6,7}|[89]\\\\d{6,8}|2\\\\d{5})$","BH":"^([136-9]\\\\d{7})$","BI":"^((?:[267]\\\\d|31)\\\\d{6})$","BJ":"^((?:[25689]\\\\d|40)\\\\d{6})$","BL":"^(?:0)?((?:590|(?:69|80)\\\\d|976)\\\\d{6})$","BM":"^(?:1)?((?:441|[58]\\\\d\\\\d|900)\\\\d{7})$","BN":"^([2-578]\\\\d{6})$","BO":"^(?:0)?((?:[2-467]\\\\d\\\\d|8001)\\\\d{5})$","BQ":"^((?:[34]1|7\\\\d)\\\\d{5})$","BR":"^(?:0)?((?:[1-46-9]\\\\d\\\\d|5(?:[0-46-9]\\\\d|5[0-46-9]))\\\\d{8}|[1-9]\\\\d{9}|[3589]\\\\d{8}|[34]\\\\d{7})$","BS":"^(?:1)?((?:242|[58]\\\\d\\\\d|900)\\\\d{7})$","BT":"^([17]\\\\d{7}|[2-8]\\\\d{6})$","BW":"^((?:0800|(?:[37]|800)\\\\d)\\\\d{6}|(?:[2-6]\\\\d|90)\\\\d{5})$","BY":"^(?:8)?((?:[12]\\\\d|33|44|902)\\\\d{7}|8(?:0[0-79]\\\\d{5,7}|[1-7]\\\\d{9})|8(?:1[0-489]|[5-79]\\\\d)\\\\d{7}|8[1-79]\\\\d{6,7}|8[0-79]\\\\d{5}|8\\\\d{5})$","BZ":"^((?:0800\\\\d|[2-8])\\\\d{6})$","CA":"^(?:1)?((?:[2-8]\\\\d|90)\\\\d{8}|3\\\\d{6})$","CC":"^(?:0)?(1(?:[0-79]\\\\d{8}(?:\\\\d{2})?|8[0-24-9]\\\\d{7})|[148]\\\\d{8}|1\\\\d{5,7})$","CD":"^(?:0)?([189]\\\\d{8}|[1-68]\\\\d{6})$","CF":"^((?:[27]\\\\d{3}|8776)\\\\d{4})$","CG":"^(222\\\\d{6}|(?:0\\\\d|80)\\\\d{7})$","CH":"^(?:0)?(8\\\\d{11}|[2-9]\\\\d{8})$","CI":"^([02]\\\\d{9})$","CK":"^([2-578]\\\\d{4})$","CL":"^(12300\\\\d{6}|6\\\\d{9,10}|[2-9]\\\\d{8})$","CM":"^([26]\\\\d{8}|88\\\\d{6,7})$","CN":"^(?:0)?(1[127]\\\\d{8,9}|2\\\\d{9}(?:\\\\d{2})?|[12]\\\\d{6,7}|86\\\\d{6}|(?:1[03-689]\\\\d|6)\\\\d{7,9}|(?:[3-579]\\\\d|8[0-57-9])\\\\d{6,9})$","CO":"^(?:0)?((?:60\\\\d\\\\d|9101)\\\\d{6}|(?:1\\\\d|3)\\\\d{9})$","CR":"^((?:8\\\\d|90)\\\\d{8}|(?:[24-8]\\\\d{3}|3005)\\\\d{4})$","CU":"^(?:0)?([27]\\\\d{6,7}|[34]\\\\d{5,7}|(?:5|8\\\\d\\\\d)\\\\d{7})$","CV":"^((?:[2-59]\\\\d\\\\d|800)\\\\d{4})$","CW":"^((?:[34]1|60|(?:7|9\\\\d)\\\\d)\\\\d{5})$","CX":"^(?:0)?(1(?:[0-79]\\\\d{8}(?:\\\\d{2})?|8[0-24-9]\\\\d{7})|[148]\\\\d{8}|1\\\\d{5,7})$","CY":"^((?:[279]\\\\d|[58]0)\\\\d{6})$","CZ":"^((?:[2-578]\\\\d|60)\\\\d{7}|9\\\\d{8,11})$","DE":"^(?:0)?([2579]\\\\d{5,14}|49(?:[34]0|69|8\\\\d)\\\\d\\\\d?|49(?:37|49|60|7[089]|9\\\\d)\\\\d{1,3}|49(?:2[024-9]|3[2-689]|7[1-7])\\\\d{1,8}|(?:1|[368]\\\\d|4[0-8])\\\\d{3,13}|49(?:[015]\\\\d|2[13]|31|[46][1-8])\\\\d{1,9})$","DJ":"^((?:2\\\\d|77)\\\\d{6})$","DK":"^([2-9]\\\\d{7})$","DM":"^(?:1)?((?:[58]\\\\d\\\\d|767|900)\\\\d{7})$","DO":"^(?:1)?((?:[58]\\\\d\\\\d|900)\\\\d{7})$","DZ":"^(?:0)?((?:[1-4]|[5-79]\\\\d|80)\\\\d{7})$","EC":"^(?:0)?(1\\\\d{9,10}|(?:[2-7]|9\\\\d)\\\\d{7})$","EE":"^(8\\\\d{9}|[4578]\\\\d{7}|(?:[3-8]\\\\d|90)\\\\d{5})$","EG":"^(?:0)?([189]\\\\d{8,9}|[24-6]\\\\d{8}|[135]\\\\d{7})$","EH":"^(?:0)?([5-8]\\\\d{8})$","ER":"^(?:0)?([178]\\\\d{6})$","ES":"^([5-9]\\\\d{8})$","ET":"^(?:0)?((?:11|[2-579]\\\\d)\\\\d{7})$","FI":"^(?:0)?([1-35689]\\\\d{4}|7\\\\d{10,11}|(?:[124-7]\\\\d|3[0-46-9])\\\\d{8}|[1-9]\\\\d{5,8})$","FJ":"^(45\\\\d{5}|(?:0800\\\\d|[235-9])\\\\d{6})$","FK":"^([2-7]\\\\d{4})$","FM":"^((?:[39]\\\\d\\\\d|820)\\\\d{4})$","FO":"^([2-9]\\\\d{5})$","FR":"^(?:0)?([1-9]\\\\d{8})$","GA":"^((?:[067]\\\\d|11)\\\\d{6}|[2-7]\\\\d{6})$","GB":"^(?:0)?([1-357-9]\\\\d{9}|[18]\\\\d{8}|8\\\\d{6})$","GD":"^(?:1)?((?:473|[58]\\\\d\\\\d|900)\\\\d{7})$","GE":"^(?:0)?((?:[3-57]\\\\d\\\\d|800)\\\\d{6})$","GF":"^(?:0)?((?:[56]94|80\\\\d|976)\\\\d{6})$","GG":"^(?:0)?((?:1481|[357-9]\\\\d{3})\\\\d{6}|8\\\\d{6}(?:\\\\d{2})?)$","GH":"^(?:0)?((?:[235]\\\\d{3}|800)\\\\d{5})$","GI":"^((?:[25]\\\\d\\\\d|606)\\\\d{5})$","GL":"^((?:19|[2-689]\\\\d|70)\\\\d{4})$","GM":"^([2-9]\\\\d{6})$","GN":"^(722\\\\d{6}|(?:3|6\\\\d)\\\\d{7})$","GP":"^(?:0)?((?:590|(?:69|80)\\\\d|976)\\\\d{6})$","GQ":"^(222\\\\d{6}|(?:3\\\\d|55|[89]0)\\\\d{7})$","GR":"^(5005000\\\\d{3}|8\\\\d{9,11}|(?:[269]\\\\d|70)\\\\d{8})$","GT":"^((?:1\\\\d{3}|[2-7])\\\\d{7})$","GU":"^(?:1)?((?:[58]\\\\d\\\\d|671|900)\\\\d{7})$","GW":"^([49]\\\\d{8}|4\\\\d{6})$","GY":"^(9008\\\\d{3}|(?:[2-467]\\\\d\\\\d|862)\\\\d{4})$","HK":"^(8[0-46-9]\\\\d{6,7}|9\\\\d{4,7}|(?:[2-7]|9\\\\d{3})\\\\d{7})$","HN":"^(8\\\\d{10}|[237-9]\\\\d{7})$","HR":"^(?:0)?((?:[24-69]\\\\d|3[0-79])\\\\d{7}|80\\\\d{5,7}|[1-79]\\\\d{7}|6\\\\d{5,6})$","HT":"^([2-489]\\\\d{7})$","HU":"^(?:06)?([235-7]\\\\d{8}|[1-9]\\\\d{7})$","ID":"^(?:0)?((?:(?:00[1-9]|8\\\\d)\\\\d{4}|[1-36])\\\\d{6}|00\\\\d{10}|[1-9]\\\\d{8,10}|[2-9]\\\\d{7})$","IE":"^(?:0)?((?:1\\\\d|[2569])\\\\d{6,8}|4\\\\d{6,9}|7\\\\d{8}|8\\\\d{8,9})$","IL":"^(?:0)?(1\\\\d{6}(?:\\\\d{3,5})?|[57]\\\\d{8}|[1-489]\\\\d{7})$","IM":"^(?:0)?(1624\\\\d{6}|(?:[3578]\\\\d|90)\\\\d{8})$","IN":"^(?:0)?((?:000800|[2-9]\\\\d\\\\d)\\\\d{7}|1\\\\d{7,12})$","IO":"^(3\\\\d{6})$","IQ":"^(?:0)?((?:1|7\\\\d\\\\d)\\\\d{7}|[2-6]\\\\d{7,8})$","IR":"^(?:0)?([1-9]\\\\d{9}|(?:[1-8]\\\\d\\\\d|9)\\\\d{3,4})$","IS":"^((?:38\\\\d|[4-9])\\\\d{6})$","IT":"^(0\\\\d{5,10}|1\\\\d{8,10}|3(?:[0-8]\\\\d{7,10}|9\\\\d{7,8})|(?:55|70)\\\\d{8}|8\\\\d{5}(?:\\\\d{2,4})?)$","JE":"^(?:0)?(1534\\\\d{6}|(?:[3578]\\\\d|90)\\\\d{8})$","JM":"^(?:1)?((?:[58]\\\\d\\\\d|658|900)\\\\d{7})$","JO":"^(?:0)?((?:(?:[2689]|7\\\\d)\\\\d|32|53)\\\\d{6})$","JP":"^(?:0)?(00[1-9]\\\\d{6,14}|[257-9]\\\\d{9}|(?:00|[1-9]\\\\d\\\\d)\\\\d{6})$","KE":"^(?:0)?((?:[17]\\\\d\\\\d|900)\\\\d{6}|(?:2|80)0\\\\d{6,7}|[4-6]\\\\d{6,8})$","KG":"^(?:0)?(8\\\\d{9}|(?:[235-8]\\\\d|99)\\\\d{7})$","KH":"^(?:0)?(1\\\\d{9}|[1-9]\\\\d{7,8})$","KI":"^(?:0)?((?:[37]\\\\d|6[0-79])\\\\d{6}|(?:[2-48]\\\\d|50)\\\\d{3})$","KM":"^([3478]\\\\d{6})$","KN":"^(?:1)?((?:[58]\\\\d\\\\d|900)\\\\d{7})$","KP":"^(?:0)?(85\\\\d{6}|(?:19\\\\d|[2-7])\\\\d{7})$","KR":"^(?:0)?(00[1-9]\\\\d{8,11}|(?:[12]|5\\\\d{3})\\\\d{7}|[13-6]\\\\d{9}|(?:[1-6]\\\\d|80)\\\\d{7}|[3-6]\\\\d{4,5}|(?:00|7)0\\\\d{8})$","KW":"^(18\\\\d{5}|(?:[2569]\\\\d|41)\\\\d{6})$","KY":"^(?:1)?((?:345|[58]\\\\d\\\\d|900)\\\\d{7})$","KZ":"^(?:8)?((?:33622|8\\\\d{8})\\\\d{5}|[78]\\\\d{9})$","LA":"^(?:0)?([23]\\\\d{9}|3\\\\d{8}|(?:[235-8]\\\\d|41)\\\\d{6})$","LB":"^(?:0)?([27-9]\\\\d{7}|[13-9]\\\\d{6})$","LC":"^(?:1)?((?:[58]\\\\d\\\\d|758|900)\\\\d{7})$","LI":"^(?:0)?([68]\\\\d{8}|(?:[2378]\\\\d|90)\\\\d{5})$","LK":"^(?:0)?([1-9]\\\\d{8})$","LR":"^(?:0)?((?:2|33|5\\\\d|77|88)\\\\d{7}|[4-6]\\\\d{6})$","LS":"^((?:[256]\\\\d\\\\d|800)\\\\d{5})$","LT":"^(?:8)?((?:[3469]\\\\d|52|[78]0)\\\\d{6})$","LU":"^(35[013-9]\\\\d{4,8}|6\\\\d{8}|35\\\\d{2,4}|(?:[2457-9]\\\\d|3[0-46-9])\\\\d{2,9})$","LV":"^((?:[268]\\\\d|90)\\\\d{6})$","LY":"^(?:0)?([2-9]\\\\d{8})$","MA":"^(?:0)?([5-8]\\\\d{8})$","MC":"^(?:0)?((?:[3489]|6\\\\d)\\\\d{7})$","MD":"^(?:0)?((?:[235-7]\\\\d|[89]0)\\\\d{6})$","ME":"^(?:0)?((?:20|[3-79]\\\\d)\\\\d{6}|80\\\\d{6,7})$","MF":"^(?:0)?((?:590|(?:69|80)\\\\d|976)\\\\d{6})$","MG":"^(?:0)?([23]\\\\d{8})$","MH":"^(?:1)?(329\\\\d{4}|(?:[256]\\\\d|45)\\\\d{5})$","MK":"^(?:0)?([2-578]\\\\d{7})$","ML":"^([24-9]\\\\d{7})$","MM":"^(?:0)?(1\\\\d{5,7}|95\\\\d{6}|(?:[4-7]|9[0-46-9])\\\\d{6,8}|(?:2|8\\\\d)\\\\d{5,8})$","MN":"^(?:0)?([12]\\\\d{7,9}|[5-9]\\\\d{7})$","MO":"^(0800\\\\d{3}|(?:28|[68]\\\\d)\\\\d{6})$","MP":"^(?:1)?([58]\\\\d{9}|(?:67|90)0\\\\d{7})$","MQ":"^(?:0)?((?:69|80)\\\\d{7}|(?:59|97)6\\\\d{6})$","MR":"^((?:[2-4]\\\\d\\\\d|800)\\\\d{5})$","MS":"^(?:1)?((?:[58]\\\\d\\\\d|664|900)\\\\d{7})$","MT":"^(3550\\\\d{4}|(?:[2579]\\\\d\\\\d|800)\\\\d{5})$","MU":"^((?:[57]|8\\\\d\\\\d)\\\\d{7}|[2-468]\\\\d{6})$","MV":"^((?:800|9[0-57-9]\\\\d)\\\\d{7}|[34679]\\\\d{6})$","MW":"^(?:0)?((?:[1289]\\\\d|31|77)\\\\d{7}|1\\\\d{6})$","MX":"^(?:01)?(1(?:(?:[27]2|44|99)[1-9]|65[0-689])\\\\d{7}|(?:1(?:[01]\\\\d|2[13-9]|[35][1-9]|4[0-35-9]|6[0-46-9]|7[013-9]|8[1-79]|9[1-8])|[2-9]\\\\d)\\\\d{8})$","MY":"^(?:0)?(1\\\\d{8,9}|(?:3\\\\d|[4-9])\\\\d{7})$","MZ":"^((?:2|8\\\\d)\\\\d{7})$","NA":"^(?:0)?([68]\\\\d{7,8})$","NC":"^((?:050|[2-57-9]\\\\d\\\\d)\\\\d{3})$","NE":"^([027-9]\\\\d{7})$","NF":"^([13]\\\\d{5})$","NG":"^(?:0)?((?:[124-7]|9\\\\d{3})\\\\d{6}|[1-9]\\\\d{7}|[78]\\\\d{9,13})$","NI":"^((?:1800|[25-8]\\\\d{3})\\\\d{4})$","NL":"^(?:0)?((?:[124-7]\\\\d\\\\d|3(?:[02-9]\\\\d|1[0-8]))\\\\d{6}|8\\\\d{6,9}|9\\\\d{6,10}|1\\\\d{4,5})$","NO":"^((?:0|[2-9]\\\\d{3})\\\\d{4})$","NP":"^(?:0)?((?:1\\\\d|9)\\\\d{9}|[1-9]\\\\d{7})$","NR":"^((?:444|(?:55|8\\\\d)\\\\d|666)\\\\d{4})$","NU":"^((?:[47]|888\\\\d)\\\\d{3})$","NZ":"^(?:0)?([29]\\\\d{7,9}|50\\\\d{5}(?:\\\\d{2,3})?|6[0-35-9]\\\\d{6}|7\\\\d{7,8}|8\\\\d{4,9}|(?:11\\\\d|[34])\\\\d{7})$","OM":"^((?:1505|[279]\\\\d{3}|500)\\\\d{4}|800\\\\d{5,6})$","PA":"^((?:00800|8\\\\d{3})\\\\d{6}|[68]\\\\d{7}|[1-57-9]\\\\d{6})$","PE":"^(?:0)?((?:[14-8]|9\\\\d)\\\\d{7})$","PF":"^(4\\\\d{5}(?:\\\\d{2})?|8\\\\d{7,8})$","PG":"^((?:180|[78]\\\\d{3})\\\\d{4}|(?:[2-589]\\\\d|64)\\\\d{5})$","PH":"^(?:0)?((?:[2-7]|9\\\\d)\\\\d{8}|2\\\\d{5}|(?:1800|8)\\\\d{7,9})$","PK":"^(?:0)?(122\\\\d{6}|[24-8]\\\\d{10,11}|9(?:[013-9]\\\\d{8,10}|2(?:[01]\\\\d\\\\d|2(?:[06-8]\\\\d|1[01]))\\\\d{7})|(?:[2-8]\\\\d{3}|92(?:[0-7]\\\\d|8[1-9]))\\\\d{6}|[24-9]\\\\d{8}|[89]\\\\d{7})$","PL":"^((?:6|8\\\\d\\\\d)\\\\d{7}|[1-9]\\\\d{6}(?:\\\\d{2})?|[26]\\\\d{5})$","PM":"^(?:0)?((?:[45]|80\\\\d\\\\d)\\\\d{5})$","PR":"^(?:1)?((?:[589]\\\\d\\\\d|787)\\\\d{7})$","PS":"^(?:0)?([2489]2\\\\d{6}|(?:1\\\\d|5)\\\\d{8})$","PT":"^(1693\\\\d{5}|(?:[26-9]\\\\d|30)\\\\d{7})$","PW":"^((?:[24-8]\\\\d\\\\d|345|900)\\\\d{4})$","PY":"^(?:0)?(59\\\\d{4,6}|9\\\\d{5,10}|(?:[2-46-8]\\\\d|5[0-8])\\\\d{4,7})$","QA":"^((?:0080|[2-7])\\\\d{7}|800\\\\d{4}(?:\\\\d{2})?|2\\\\d{6})$","RE":"^(?:0)?(976\\\\d{6}|(?:26|[68]\\\\d)\\\\d{7})$","RO":"^(?:0)?((?:[2378]\\\\d|90)\\\\d{7}|[23]\\\\d{5})$","RS":"^(?:0)?(38[02-9]\\\\d{6,9}|6\\\\d{7,9}|90\\\\d{4,8}|38\\\\d{5,6}|(?:7\\\\d\\\\d|800)\\\\d{3,9}|(?:[12]\\\\d|3[0-79])\\\\d{5,10})$","RU":"^(?:8)?(8\\\\d{13}|[347-9]\\\\d{9})$","RW":"^(?:0)?((?:06|[27]\\\\d\\\\d|[89]00)\\\\d{6})$","SA":"^(?:0)?(92\\\\d{7}|(?:[15]|8\\\\d)\\\\d{8})$","SB":"^((?:[1-6]|[7-9]\\\\d\\\\d)\\\\d{4})$","SC":"^(800\\\\d{4}|(?:[249]\\\\d|64)\\\\d{5})$","SD":"^(?:0)?([19]\\\\d{8})$","SE":"^(?:0)?((?:[26]\\\\d\\\\d|9)\\\\d{9}|[1-9]\\\\d{8}|[1-689]\\\\d{7}|[1-4689]\\\\d{6}|2\\\\d{5})$","SG":"^((?:(?:1\\\\d|8)\\\\d\\\\d|7000)\\\\d{7}|[3689]\\\\d{7})$","SH":"^((?:[256]\\\\d|8)\\\\d{3})$","SI":"^(?:0)?([1-7]\\\\d{7}|8\\\\d{4,7}|90\\\\d{4,6})$","SJ":"^(0\\\\d{4}|(?:[489]\\\\d|[57]9)\\\\d{6})$","SK":"^(?:0)?([2-689]\\\\d{8}|[2-59]\\\\d{6}|[2-5]\\\\d{5})$","SL":"^(?:0)?((?:[237-9]\\\\d|66)\\\\d{6})$","SM":"^((?:0549|[5-7]\\\\d)\\\\d{6})$","SN":"^((?:[378]\\\\d|93)\\\\d{7})$","SO":"^(?:0)?([346-9]\\\\d{8}|[12679]\\\\d{7}|[1-5]\\\\d{6}|[1348]\\\\d{5})$","SR":"^((?:[2-5]|68|[78]\\\\d)\\\\d{5})$","SS":"^(?:0)?([19]\\\\d{8})$","ST":"^((?:22|9\\\\d)\\\\d{5})$","SV":"^([267]\\\\d{7}|[89]00\\\\d{4}(?:\\\\d{4})?)$","SX":"^(?:1)?(7215\\\\d{6}|(?:[58]\\\\d\\\\d|900)\\\\d{7})$","SY":"^(?:0)?([1-39]\\\\d{8}|[1-5]\\\\d{7})$","SZ":"^(0800\\\\d{4}|(?:[237]\\\\d|900)\\\\d{6})$","TA":"^(8\\\\d{3})$","TC":"^(?:1)?((?:[58]\\\\d\\\\d|649|900)\\\\d{7})$","TD":"^((?:22|[69]\\\\d|77)\\\\d{6})$","TG":"^([279]\\\\d{7})$","TH":"^(?:0)?((?:001800|[2-57]|[689]\\\\d)\\\\d{7}|1\\\\d{7,9})$","TJ":"^((?:00|[1-57-9]\\\\d)\\\\d{7})$","TK":"^([2-47]\\\\d{3,6})$","TL":"^(7\\\\d{7}|(?:[2-47]\\\\d|[89]0)\\\\d{5})$","TM":"^(?:8)?([1-6]\\\\d{7})$","TN":"^([2-57-9]\\\\d{7})$","TO":"^((?:0800|(?:[5-8]\\\\d\\\\d|999)\\\\d)\\\\d{3}|[2-8]\\\\d{4})$","TR":"^(?:0)?(4\\\\d{6}|8\\\\d{11,12}|(?:[2-58]\\\\d\\\\d|900)\\\\d{7})$","TT":"^(?:1)?((?:[58]\\\\d\\\\d|900)\\\\d{7})$","TV":"^((?:2|7\\\\d\\\\d|90)\\\\d{4})$","TW":"^(?:0)?([2-689]\\\\d{8}|7\\\\d{9,10}|[2-8]\\\\d{7}|2\\\\d{6})$","TZ":"^(?:0)?((?:[25-8]\\\\d|41|90)\\\\d{7})$","UA":"^(?:0)?([89]\\\\d{9}|[3-9]\\\\d{8})$","UG":"^(?:0)?(800\\\\d{6}|(?:[29]0|[347]\\\\d)\\\\d{7})$","US":"^(?:1)?([2-9]\\\\d{9}|3\\\\d{6})$","UY":"^(?:0)?((?:0004|4)\\\\d{9}|[1249]\\\\d{7}|(?:[49]\\\\d|80)\\\\d{5})$","UZ":"^(?:8)?((?:33|55|[679]\\\\d|88)\\\\d{7})$","VA":"^(0\\\\d{5,10}|3[0-8]\\\\d{7,10}|55\\\\d{8}|8\\\\d{5}(?:\\\\d{2,4})?|(?:1\\\\d|39)\\\\d{7,8})$","VC":"^(?:1)?((?:[58]\\\\d\\\\d|784|900)\\\\d{7})$","VE":"^(?:0)?([68]00\\\\d{7}|(?:[24]\\\\d|[59]0)\\\\d{8})$","VG":"^(?:1)?((?:284|[58]\\\\d\\\\d|900)\\\\d{7})$","VI":"^(?:1)?([58]\\\\d{9}|(?:34|90)0\\\\d{7})$","VN":"^(?:0)?([12]\\\\d{9}|[135-9]\\\\d{8}|[16]\\\\d{7}|[16-8]\\\\d{6})$","VU":"^([57-9]\\\\d{6}|(?:[238]\\\\d|48)\\\\d{3})$","WF":"^((?:40|72)\\\\d{4}|8\\\\d{5}(?:\\\\d{3})?)$","WS":"^((?:[2-6]|8\\\\d{5})\\\\d{4}|[78]\\\\d{6}|[68]\\\\d{5})$","XK":"^(?:0)?([23]\\\\d{7,8}|(?:4\\\\d\\\\d|[89]00)\\\\d{5})$","YE":"^(?:0)?((?:1|7\\\\d)\\\\d{7}|[1-7]\\\\d{6})$","YT":"^(?:0)?(80\\\\d{7}|(?:26|63)9\\\\d{6})$","ZA":"^(?:0)?([1-79]\\\\d{8}|8\\\\d{4,9})$","ZM":"^(?:0)?(800\\\\d{6}|(?:21|63|[79]\\\\d)\\\\d{7})$","ZW":"^(?:0)?(2(?:[0-57-9]\\\\d{6,8}|6[0-24-9]\\\\d{6,7})|[38]\\\\d{9}|[35-8]\\\\d{8}|[3-6]\\\\d{7}|[1-689]\\\\d{6}|[1-3569]\\\\d{5}|[1356]\\\\d{4})$","001":"^([1359]\\\\d{8})$"}');
const phoneLength = {
    '852': 8,
    '853': 8,
    '65': 8,
    '60': 10,
    '886': 10,
    '86': 11,
    '62': '8-12',
    '33': '7-14',
    '61': '8-9',
    '673': '6-7',
};
const nameDefaultRegex = (maxChar) => {
    return Object.assign({ 'no-punctuation': /^[^,;]+$/ }, maxChar && { 'limit-character': new RegExp(`^[a-zA-Z\\u4e00-\\u9eff\\s]{1,${maxChar}}$`, '') });
};
// 8-12 letters and numbers
function passwordFormatValidator(control) {
    return isPasswordVaild(control.value) ? null : { invalidPassword: true };
}
function confirmPasswordFormatValidator(control) {
    const input = control.value;
    const isValid = control.root.value['password'] === input;
    if (!isValid) {
        return { passwordNotEqual: true };
    }
    else {
        return null;
    }
}
function confirmEmailFormatValidator(control) {
    const input = control.value;
    const isValid = control.root.value['email'] === input;
    if (!isValid) {
        return { emailNotMatch: true };
    }
    else {
        return null;
    }
}
function isPasswordVaild(value) {
    let isVaild = false;
    if (value) {
        isVaild =
            (/[a-z]/.test(value) && /[0-9]/.test(value)) ||
                (/[0-9]/.test(value) && /[A-Z]/.test(value));
    }
    return isVaild;
}
// by '852' number-string return 'hk'
function findCountryByCodes(value) {
    let key;
    for (let k in countryCallingCodes) {
        if (countryCallingCodes[k] === value) {
            key = k;
            break;
        }
    }
    return key || 'HK';
}
function phoneValidator(control) {
    if (isEmptyInputValue(control.value)) {
        return null; // don't validate empty values to allow optional controls
    }
    return isPhoneNumberVaild(control.value.toString())
        ? null
        : { 'mobile phone invaild': 'phone number invaild' };
}
function isEmptyInputValue(value) {
    return (value == null ||
        (typeof value === 'string' && value.length === 0) ||
        value === undefined);
}
function isPhoneNumberVaild(value) {
    let isVaild = false;
    if (value !== undefined) {
        // 不能以 0/1 開頭
        // isVaild = value.length == 8 && /^([2-9])\d{7}/.test(value);
        const newValue = value.trim();
        if (newValue) {
            isVaild = newValue.length > 7 && /^\d+$/.test(newValue);
        }
        else {
            isVaild = value.length > 7 && /^\d+$/.test(value);
        }
    }
    return isVaild;
}
function isPhoneValid(phone, country = 'HK', customPhoneRegex = null) {
    let isValid = false;
    if (customPhoneRegex) {
        return new RegExp(customPhoneRegex).test(phone);
    }
    if (countryPhoneReg[country]) {
        return new RegExp(countryPhoneReg[country]).test(phone);
    }
    if (!onlyHasNumber(phone)) {
        return false;
    }
    if (phone !== undefined && phone !== '') {
        let length = String(getPhoneLength(country));
        let min = length.split('-')[0];
        let max = length.split('-')[1];
        if (max) {
            if (phone.length >= Number(min) && phone.length <= Number(max)) {
                isValid = true;
            }
        }
        else {
            if (phone.length === getPhoneLength(country)) {
                isValid = true;
            }
            else {
                // 当号码有前缀也通过 比如说 85244090771 而不只是 44090771
                let countryCode = phone.slice(0, phone.length - getPhoneLength(country));
                isValid =
                    phone.length ===
                        getCountryCallingCode(country).length +
                            getPhoneLength(country) &&
                        countryCode === getCountryCallingCode(country);
            }
        }
    }
    return isValid;
}
// 前提是通过电话验证 isPhoneValid()
function isPhoneIncludingCode(phone, country = 'HK') {
    let isSeparate = false; // 是否分隔
    let isIncludingCode = false; // 是否has country code
    let separateSymbol = null; // 分隔符号
    let noCodePhone = '';
    if (isPhoneValid(phone, country)) {
        if (phone.length === getPhoneLength(country)) {
            return {
                isSeparate,
                isIncludingCode,
                separateSymbol,
                noCodePhone: phone,
            };
        }
        else {
            // including code
            if (phone.length ===
                getCountryCallingCode(country).length + getPhoneLength(country)) {
                // not has separateSymbol
                isIncludingCode = true;
                noCodePhone = phone.slice(getCountryCallingCode(country).length);
                return {
                    isSeparate,
                    isIncludingCode,
                    separateSymbol,
                    noCodePhone,
                };
            }
            else {
                // has separateSymbol
                isIncludingCode = true;
                isSeparate = true;
                separateSymbol = phone.slice(getCountryCallingCode(country).length, getCountryCallingCode(country).length + 1);
                noCodePhone = phone.slice(getCountryCallingCode(country).length + 1);
                return {
                    isSeparate,
                    isIncludingCode,
                    separateSymbol,
                    noCodePhone,
                };
            }
        }
    }
    else {
        return {};
    }
}
function isEmailValid(value) {
    try {
        value = value.toLowerCase();
        let isValid = false;
        if (value !== undefined) {
            const regExp = /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;
            //    isVaild = value.includes("@") && (value.includes(".com") || value.includes(".net"));
            isValid =
                regExp.test(value) &&
                    !value.includes('.web') &&
                    !value.includes('..') &&
                    value.indexOf('.') !== 0;
            isValid =
                isValid &&
                    !(value.includes('<') &&
                        value.indexOf('>') === value.length - 1) &&
                    value.indexOf('@') === value.lastIndexOf('@') &&
                    value.indexOf(')') !== value.length - 1;
            isValid =
                isValid &&
                    !(/^\d+$/.test(value[value.length - 1]) &&
                        value.length - 1 - value.lastIndexOf('.') >= 4);
        }
        return isValid;
    }
    catch (err) {
        return false;
    }
}
function emailFormatValidator(control) {
    return isEmailValid(control.value)
        ? null
        : { 'email format': 'email invaild' };
}
function firstNameFormatValidator(control) {
    return isNameVaild(control.value)
        ? null
        : { 'first name format': 'first name is english and space' };
}
function isNameVaild(username) {
    let isVaild = false;
    if (username) {
        isVaild = /^[A-Za-z\s]+$/.test(username);
    }
    else {
        isVaild = true;
    }
    return isVaild;
}
function lastNameFormatValidator(control) {
    return isNameVaild(control.value)
        ? null
        : { 'last name format': 'first name is english and space' };
}
function onlyHasNumber(string) {
    const regExp = /^\d+$/;
    return regExp.test(string);
}
// by country return '852': number-string
function getCountryCallingCode(country = 'HK') {
    let tmp = countryCallingCodes[country];
    if (!tmp) {
        tmp = '852';
    }
    return tmp;
}
function getPhoneLength(country) {
    return phoneLength[getCountryCallingCode(country)];
}
function isUnitNumberFormat(string) {
    const regExp = /[^A-Za-z0-9 /-]/;
    let onlyNumberAndLetterAndSpace;
    onlyNumberAndLetterAndSpace = !regExp.test(string);
    return onlyNumberAndLetterAndSpace;
}
function asLetter(string) {
    const regExp = /[A-Za-z]/;
    return regExp.test(string);
}
function hasNumber(string) {
    const regExp = /[0-9]/;
    return regExp.test(string);
}
function getDateStringLabel(milliseconds) {
    const date = new Date(milliseconds);
    let timeString = date.getFullYear().toString() + '-';
    if (date.getMonth() + 1 <= 9) {
        timeString = timeString + '0' + (date.getMonth() + 1).toString() + '-';
    }
    else {
        timeString = timeString + (date.getMonth() + 1).toString() + '-';
    }
    if (date.getDate() <= 9) {
        timeString = timeString + '0' + date.getDate().toString();
    }
    else {
        timeString = timeString + date.getDate().toString();
    }
    return timeString;
}
function currentTimeString() {
    return timeStringLabel(null, true);
}
function timeStringLabel(pickUpTime, withSecond = false) {
    let date;
    if (pickUpTime) {
        date = new Date(pickUpTime);
    }
    else {
        date = new Date();
    }
    let timeString = date.getHours() + ':';
    if (date.getMinutes() === 0) {
        timeString = timeString + '00';
    }
    else if (date.getMinutes() <= 9) {
        timeString = timeString + '0' + date.getMinutes();
    }
    else {
        timeString = timeString + date.getMinutes();
    }
    if (withSecond) {
        timeString = timeString + ':';
        if (date.getSeconds() === 0) {
            timeString = timeString + '00';
        }
        else if (date.getSeconds() <= 9) {
            timeString = timeString + '0' + date.getSeconds();
        }
        else {
            timeString = timeString + date.getSeconds();
        }
    }
    return timeString;
}
function getClosedTime(store, time) {
    let storeCloseTime;
    const today = time ? new Date(time) : new Date();
    if (store.openings && store.openings['weekdays']) {
        const weekday = today.getDay();
        storeCloseTime = store.openings['weekdays'][weekday]['endTime'];
    }
    if (!storeCloseTime) {
        return '24:00';
    }
    return storeCloseTime;
}
function getPickupDelayTime(store) {
    if (!store) {
        return 0;
    }
    if (!store.pos) {
        return 0;
    }
    return Number(store.pos['pickupDelay']);
}
function getDeliveryDelayTime(store) {
    if (!store) {
        return 0;
    }
    if (!store.pos) {
        return 0;
    }
    return Number(store.pos['deliveryDelay']);
}
function getTodayMillisecondsFromTimeString(timeLabel, time) {
    const date = time ? new Date(time) : new Date();
    if (!isNaN(Number(timeLabel.split(':')[0]))) {
        if (timeLabel.split(':').length === 2) {
            date.setHours(Number(timeLabel.split(':')[0]), Number(timeLabel.split(':')[1]), 0, 0);
        }
        else if (timeLabel.split(':').length === 3) {
            date.setHours(Number(timeLabel.split(':')[0]), Number(timeLabel.split(':')[1]), Number(timeLabel.split(':')[2]), 0);
        }
        else if (timeLabel.split(':').length === 4) {
            date.setHours(Number(timeLabel.split(':')[0]), Number(timeLabel.split(':')[1]), Number(timeLabel.split(':')[2]), Number(timeLabel.split(':')[3]));
        }
    }
    else {
        return 0;
    }
    return Number(timeLabel.split(':')[0]) === 0
        ? date.getTime() + 24 * 60 * 60000
        : date.getTime();
}
function isAvailableOffer(offer) {
    const current = new Date().getTime();
    const start = offer.start ? offer.start : current;
    const end = offer.expire ? offer.expire : current;
    return start <= current && end >= current;
}
function isAvailableReward(reward) {
    const current = new Date().getTime();
    const start = reward.start ? reward.start : current;
    const end = reward.end ? reward.end : current;
    return start <= current && end >= current;
}
function isAvailablePeriod(store, period, now) {
    // var today: Date = new Date();
    // today.setHours(0, 0, 0, 0);
    // var diff = now.getTime() - today.getTime();
    // var start:number;
    // var end:number;
    // //console.log("diff", diff);
    // if(period.openings && period.openings.weekdays){
    //     var [dateStart,startString,dateEnd,endString] = this.getWeekdayStartAndEnd(period);
    //     start = dateStart.getTime() - today.getTime();
    //     end = dateEnd.getTime() - today.getTime();
    // }else{
    //     if (!period.start || !period.end) return false;
    //     start = period.start;
    //     end = period.end;
    // }
    // return diff >= start && diff < end;
    if (period.openings) {
        // console.log('isAvailable : check by opening rules');
        if (!checkPrestopFromStart(now, period)) {
            console.log('the period not available');
            return false;
        }
        const open = ___WEBPACK_IMPORTED_MODULE_0__.OpeningHours.isTimeOpen(store.brand.openings, period.openings, now.getTime());
        return open;
    }
    else {
        // console.log("diff", diff);
        //TODO: 也許應該 del 這段 code? 因為現在這樣的話, set 00:00 就不行, 需要 set: 00.01
        if (!period.start && !period.end) {
            return false;
        }
        // console.log('isAvailable : check by start & end');
        return ___WEBPACK_IMPORTED_MODULE_0__.Period.isTimeOpen(period, now.getTime());
    }
}
function checkPrestopFromStart(useTime, period) {
    var _a;
    const { prestopFromStart, startTime } = (((_a = period === null || period === void 0 ? void 0 : period.openings) === null || _a === void 0 ? void 0 : _a.weekdays) &&
        period.openings.weekdays[useTime.getDay()]) ||
        {};
    if (!startTime || !prestopFromStart) {
        return true;
    }
    const time = new Date(useTime);
    const periodStartTime = time.setHours(Number(startTime.split(':')[0]), Number(startTime.split(':')[1]), 0, 0);
    if (periodStartTime <= useTime.getTime()) {
        return true;
    }
    else {
        return (periodStartTime - (prestopFromStart || 0) * 60000 >
            useTime.getTime()); // true is available
    }
}
function getWeekdayStartAndEnd(period) {
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    const weekday = period['savedWeekday'] || today.getDay();
    const weekdays = period.openings.weekdays;
    let start = new Date();
    let end = new Date();
    let startTime;
    let endTime;
    let isOpen = true;
    if (weekdays[weekday]['startTime'] && weekdays[weekday]['endTime']) {
        startTime = weekdays[weekday]['startTime'];
        endTime = weekdays[weekday]['endTime'];
        isOpen = weekdays[weekday].type === 'open';
    }
    else {
        startTime = period.startTime;
        endTime = period.endTime;
    }
    start.setHours(Number(startTime.split(':')[0]), Number(startTime.split(':')[1]), 0, 0);
    end.setHours(Number(endTime.split(':')[0]), Number(endTime.split(':')[1]), 0, 0);
    if (today.getDay() !== weekday) {
        if (end < start) {
            start = new Date(start.getTime() - 24 * 60 * 60000);
        }
        else {
            start = new Date(start.getTime() - 24 * 60 * 60000);
            end = new Date(end.getTime() - 24 * 60 * 60000);
        }
    }
    else {
        if (end < start) {
            console.log('stepped over time to next day!!!');
            end = new Date(end.getTime() + 24 * 60 * 60000);
        }
    }
    return [start, startTime, end, endTime, isOpen];
}
function hasHoliday(brand, oh, time = new Date().getTime()) {
    if (!oh) {
        return null;
    }
    if (oh.overwrites) {
        for (const slot of oh.overwrites) {
            if (___WEBPACK_IMPORTED_MODULE_0__.Slot.isWithinDayRange(slot, time)) {
                console.log('within overwrites', slot);
                return slot;
            }
        }
    }
    if (brand.openings) {
        if (brand.openings.ph1) {
            for (const slot of brand.openings.ph1) {
                if (___WEBPACK_IMPORTED_MODULE_0__.Slot.isWithinDayRange(slot, time)) {
                    console.log('within holiday1', slot);
                    return oh.holidays[0];
                }
            }
        }
        if (brand.openings.ph2) {
            for (const slot of brand.openings.ph2) {
                if (___WEBPACK_IMPORTED_MODULE_0__.Slot.isWithinDayRange(slot, time)) {
                    console.log('within holiday2', slot);
                    return oh.holidays[1];
                }
            }
        }
    }
    return null;
}
function isPeriodClosed(store, period, currentTime) {
    if (!period) {
        return false;
    }
    else {
        const preStop = period['prestop'] ? period['prestop'] : 0;
        if (preStop === 1440) {
            return true;
        }
        let endTime = new Date(currentTime); // let the date same with currentTime param. Just need to alter hours later.
        const holidaySlot = hasHoliday(store.brand, period.openings);
        if (holidaySlot) {
            const startTime = new Date(currentTime);
            // endTime.setHours(Number(holidaySlot.endTime.split(":")[0]), Number(holidaySlot.endTime.split(":")[1]));
            startTime.setHours(Number(holidaySlot.startTime.split(':')[0]), Number(holidaySlot.startTime.split(':')[1]), 0, 0);
            endTime.setHours(Number(holidaySlot.endTime.split(':')[0]), Number(holidaySlot.endTime.split(':')[1]), 0, 0);
            if (endTime <= startTime) {
                // console.log('stepped over time to next day!!!');
                // if (new Date() > endTime) {
                endTime = new Date(endTime.getTime() + 24 * 60 * 60000);
                // }
            }
        }
        else if (period.openings && period.openings.weekdays) {
            const [dateStart, startString, dateEnd, endString] = getWeekdayStartAndEnd(period);
            // keep the date. Make sure the date same with currentTime param
            endTime.setHours(dateEnd.getHours(), dateEnd.getMinutes(), dateEnd.getSeconds(), dateEnd.getMilliseconds());
            // endTime = dateEnd;
        }
        else {
            const startTime = new Date(currentTime);
            startTime.setHours(Number(period.startTime.split(':')[0]), Number(period.startTime.split(':')[1]), 0, 0);
            endTime.setHours(Number(period.endTime.split(':')[0]), Number(period.endTime.split(':')[1]), 0, 0);
            if (endTime <= startTime) {
                // console.log('stepped over time to next day!!!');
                // if (new Date() > endTime) {
                endTime = new Date(endTime.getTime() + 24 * 60 * 60000);
                // }
            }
        }
        // console.log('endTime:' + (endTime.getTime() - preStop * 60000));
        // console.log('currentTime:' + currentTime);
        return endTime.getTime() - preStop * 60000 < currentTime;
    }
}
function getTandCUrl(brand, name) {
    if (!brand.links) {
        return null;
    }
    const link = brand.links[name];
    if (!link) {
        return null;
    }
    let url = link.url;
    if (!url) {
        return null;
    }
    if (url.indexOf('http://') === 0 && url.indexOf('localhost') === -1) {
        url = url.replace('http:', 'https:');
    }
    return url;
}
function convertNowDateToStoreTimeZone(timeZone, time) {
    timeZone = timeZone ? timeZone : 'GMT+8';
    let timeZoneValue = timeZone.split('GMT')[1];
    // let isPositive = timeZoneValue.startsWith('+');
    let integerTimeZoneValue = parseFloat(timeZoneValue);
    let now = time ? new Date(time) : new Date();
    now.setHours(now.getUTCHours() + integerTimeZoneValue);
    return now;
}
const maxDate = (group) => {
    let days = group.get('dayDate');
    let month = group.get('monthDate');
    const dt = new Date();
    let year = dt.getFullYear();
    let d = days.value;
    let m = month.value;
    let maximumDate;
    const daysInMonth = (m, y) => {
        switch (m) {
            case 1:
                return (y % 4 == 0 && y % 100) || y % 400 == 0 ? 29 : 28;
            case 8:
            case 3:
                return 30;
            case 5:
            case 10:
                return 30;
            default:
                return 31;
        }
    };
    if (m >= 0 && m < 12) {
        maximumDate = daysInMonth(Number(m), year);
    }
    if (days.value < '0' || days.value > maximumDate) {
        return {
            dateMaximum: true
        };
    }
    return null;
};
function emailValidator(control) {
    if (!control.value) {
        return null;
    }
    let REGEXP;
    REGEXP =
        /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return REGEXP.test(control.value) ? null : { email: true };
}
function isEmptyOrWhiteSpaceValidator(control) {
    if (isEmptyInputValue(control.value)) {
        return null; // don't validate empty values to allow optional controls
    }
    return isEmptyOrWhiteSpace(control.value.toString()) ? { 'emptyOrWhiteSpaceOnly': true } : null;
}
function isEmptyOrWhiteSpace(str) {
    // return true if the string is empty or only white space
    return (str.match(/^\s*$/) || []).length > 0;
}
function getSanitizePhone(phone, countryCode) {
    const regex = new RegExp(countryPhoneReg[countryCode]);
    const result = regex.exec(phone);
    return (result === null || result === void 0 ? void 0 : result.length) > 0 ? result[1] : phone;
}
const parseRegex = (option) => {
    let finalRegex = {};
    Object.keys(option).forEach((x) => {
        finalRegex = Object.assign(Object.assign({}, finalRegex), { [x]: new RegExp(option[x]) });
        return finalRegex;
    });
    return finalRegex;
};
const isValidJson = (regex) => {
    try {
        var json = JSON.parse(regex);
        return (typeof json === 'object');
    }
    catch (error) {
        return false;
    }
};
/** to form logic  end */


/***/ }),

/***/ 45672:
/*!**********************************************************!*\
  !*** ./projects/core/src/app/data/utility/math-utils.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MathUtils": () => (/* binding */ MathUtils)
/* harmony export */ });
class MathUtils {
    static round(value, precision) {
        var multiplier = Math.pow(10, precision || 0);
        return Math.round(value * multiplier) / multiplier;
    }
    static floor(value, precision) {
        var multiplier = Math.pow(10, precision || 0);
        return Math.floor(value * multiplier) / multiplier;
    }
    static ceil(value, precision) {
        var multiplier = Math.pow(10, precision || 0);
        return Math.ceil(value * multiplier) / multiplier;
    }
    static roundToNearest5(value, precision) {
        var precisionUnit = 5 / Math.pow(10, precision || 0);
        if (precisionUnit === 0) {
            return value;
        }
        var unitRawCount = 0;
        unitRawCount = value / precisionUnit;
        var roundedCount = Math.round(unitRawCount);
        return this.round(roundedCount * precisionUnit, precision);
    }
}


/***/ }),

/***/ 33759:
/*!********************************************************!*\
  !*** ./projects/core/src/app/framework/base/aquery.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AQuery": () => (/* binding */ AQuery)
/* harmony export */ });
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/common/http */ 28784);
/* harmony import */ var aigens_ng_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-ng-core */ 51707);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs/operators */ 50635);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rxjs/operators */ 19337);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! rxjs/operators */ 87580);
/* harmony import */ var _services_api_bridge_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../services/api-bridge.service */ 20819);
/* harmony import */ var _services_config_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../services/config.service */ 2171);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/core */ 3184);







class AQuery {
    constructor(injector) {
        this.shouldAuth = false;
        this.http = injector.get(_angular_common_http__WEBPACK_IMPORTED_MODULE_3__.HttpClient);
        this.configs = injector.get(_services_config_service__WEBPACK_IMPORTED_MODULE_2__.ConfigService);
        this.apiBridge = injector.get(_services_api_bridge_service__WEBPACK_IMPORTED_MODULE_1__.ApiBridgeService);
        this.clear();
    }
    clear() {
        this.method = "get";
        this.params = {};
        this.url = null;
        this.body = null;
        this.headers = {};
        this.shouldAuth = false;
        this.authorization = null;
        this.data = null;
        this.file = null;
        this.timeoutTime = 55000;
    }
    getDefaultHeaders(inputs) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_3__.HttpHeaders();
        for (var key in inputs) {
            var value = inputs[key];
            headers = headers.set(key, value + "");
        }
        if (this.authorization) {
            headers = headers.set('AUTHORIZATION', 'Basic ' + this.authorization.getAuth());
        }
        else {
            if (this.shouldAuth) {
                //allow header have sid already
                var sid = inputs['sid'] || this.configs.getSessionId();
                if (sid) {
                    headers = headers.set('sid', sid);
                }
            }
        }
        return headers;
    }
    auth(auth) {
        this.shouldAuth = auth;
        return this;
    }
    basicAuth(auth) {
        this.authorization = auth;
        return this;
    }
    setTimeoutTime(time) {
        this.timeoutTime = time;
        return this;
    }
    getParams(inputs) {
        Object.keys(inputs).forEach((key) => (inputs[key] == null) && delete inputs[key]);
        let params = new _angular_common_http__WEBPACK_IMPORTED_MODULE_3__.HttpParams({
            fromObject: inputs
        });
        var lang = this.configs.getLocale();
        if (lang && !inputs["locale"] && this.url.indexOf("locale") == -1) {
            params = params.set('locale', lang);
        }
        return params;
    }
    getJson() {
        var result = this.doHttp();
        this.clear();
        return result;
    }
    getHost() {
        if (this.host)
            return this.host;
        return this.configs.getApi();
    }
    doHttp() {
        var url = this.url;
        if (url.indexOf("/") == 0) {
            url = this.getHost() + url;
        }
        if (this.apiBridge) {
            url = this.apiBridge.translateUrl(url, this);
        }
        var params = this.params;
        var headers = this.headers;
        var method = this.method;
        var searchParams = this.getParams(params);
        var httpHeaders = this.getDefaultHeaders(headers);
        if ("get" == method) {
            return this.http.get(url, { params: searchParams, headers: httpHeaders, observe: 'response' }).pipe(this.timeoutError()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(r => this.processJson(r)));
        }
        else if ("post" == method || "put" == method || "delete" == method) {
            var body = this.body;
            // File upload
            if (this.file) {
                // httpHeaders = httpHeaders.set('Content-Type', 'multipart/form-data');
                const formData = new FormData();
                formData.set('data', this.file);
                //body = JSON.stringify(this.body);
                if ("post" == method) {
                    return this.http.post(url, formData, {
                        params: searchParams, headers: httpHeaders, reportProgress: true, observe: 'events'
                    });
                }
                else if ("put" == method) {
                    return this.http.put(url, formData, { params: searchParams, headers: httpHeaders, reportProgress: true, observe: 'events' });
                }
            }
            else if (this.body) {
                httpHeaders = httpHeaders.set("Content-Type", "application/json");
                body = JSON.stringify(this.body, aigens_ng_core__WEBPACK_IMPORTED_MODULE_0__.Data.JsonReplacer);
                //body = JSON.stringify(this.body);
                if ("post" == method) {
                    return this.http.post(url, body, { params: searchParams, headers: httpHeaders, observe: 'response' }).pipe(this.timeoutError()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(r => this.processJson(r)));
                }
                else if ("put" == method) {
                    return this.http.put(url, body, { params: searchParams, headers: httpHeaders, observe: 'response' }).pipe(this.timeoutError()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(r => this.processJson(r)));
                }
                else if ("delete" == method) {
                    return this.http.delete(url, { params: searchParams, headers: httpHeaders, observe: 'response' }).pipe(this.timeoutError()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(r => this.processJson(r)));
                }
            }
            else if (this.data) {
                console.log("raw bytes not supported, fix me");
                /*
                if ('post' == method) {
                    return this.http.post(url, this.data).pipe(map(r => this.processJson(r)));
                }*/
            }
            else {
                httpHeaders = httpHeaders.set('Content-Type', 'application/x-www-form-urlencoded');
                var str = searchParams.toString();
                str = str.replace(/\+/g, "%2b");
                //console.log("urlencoded body", str);
                if ("post" == method) {
                    return this.http.post(url, str, { headers: httpHeaders, observe: 'response' }).pipe(this.timeoutError()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(r => this.processJson(r)));
                }
                else if ("put" == method) {
                    return this.http.put(url, str, { headers: httpHeaders, observe: 'response' }).pipe(this.timeoutError()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(r => this.processJson(r)));
                }
                else if ("delete" == method) {
                    return this.http.delete(url, { params: searchParams, headers: httpHeaders, observe: 'response' }).pipe(this.timeoutError()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(r => this.processJson(r)));
                }
            }
        } /* else if ("put" == method) {

            var body = this.body;
            if (this.body) {
                httpHeaders.set("Content-Type", "application/json"),
                    body = JSON.stringify(this.body);

                return this.http.put(url, body, { search: searchParams, headers: httpHeaders }).map(r => r.json());
            } else {
                httpHeaders.set('Content-Type', 'application/x-www-form-urlencoded');
                body = searchParams.toString();
                return this.http.put(url, body, { headers: httpHeaders }).map(r => r.json());
            }

        }*/
        return null;
    }
    processJson(response) {
        var dateStr = response.headers.get('Date');
        var json = response.body;
        if (dateStr && json) {
            var date = new Date(dateStr);
            json['time'] = date.getTime();
        }
        return json;
    }
    timeoutError() {
        if (this.timeoutTime === 0) {
            return (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.tap)({ complete: () => console.log('no timeout') });
        }
        return (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.timeout)({
            each: this.timeoutTime,
            with: () => { throw new Error('timeout error'); }
        });
    }
}
AQuery.ɵfac = function AQuery_Factory(t) { return new (t || AQuery)(_angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_7__.Injector)); };
AQuery.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdefineComponent"]({ type: AQuery, selectors: [["ng-component"]], decls: 0, vars: 0, template: function AQuery_Template(rf, ctx) { }, encapsulation: 2 });


/***/ }),

/***/ 3308:
/*!**********************************************************!*\
  !*** ./projects/core/src/app/framework/base/base-app.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BaseApp": () => (/* binding */ BaseApp)
/* harmony export */ });
/* harmony import */ var _base_page__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base-page */ 74522);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);


//import { ProgressDialogComponent } from '../dialogs/progress-dialog/progress-dialog.component';
class BaseApp extends _base_page__WEBPACK_IMPORTED_MODULE_0__.BasePage {
    constructor(injector) {
        super(injector);
        this.busy = false;
    }
    superloading(show) {
        /*
        if (show) {
            this.superLoader = this.dialogCtr.open(ProgressDialogComponent, { data: {}, disableClose: true });
        } else {

            if (this.superLoader) {
                this.superLoader.close();
                this.superLoader = null;
            }

        }
        */
    }
    loading(show) {
        this.busy = show;
    }
    setBusy(busy) {
        this.busy = busy;
    }
}
BaseApp.ɵfac = function BaseApp_Factory(t) { return new (t || BaseApp)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_1__.Injector)); };
BaseApp.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineComponent"]({ type: BaseApp, selectors: [["ng-component"]], features: [_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵInheritDefinitionFeature"]], decls: 0, vars: 0, template: function BaseApp_Template(rf, ctx) { }, encapsulation: 2 });


/***/ }),

/***/ 22963:
/*!****************************************************************!*\
  !*** ./projects/core/src/app/framework/base/base-component.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BaseComponent": () => (/* binding */ BaseComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _pure_services_time_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../../pure/services/time.service */ 72570);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var _pure_base_page_params__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../pure/base/page-params */ 8744);
/* harmony import */ var _pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../pure/managers/setting-manager */ 74663);
/* harmony import */ var _pure_services_platform_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../pure/services/platform.service */ 45485);
/* harmony import */ var _pure_services_routing_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../pure/services/routing.service */ 28759);
/* harmony import */ var _services_analytics_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../services/analytics.service */ 4297);
/* harmony import */ var _services_config_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../services/config.service */ 2171);
/* harmony import */ var _services_context_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/context.service */ 73769);
/* harmony import */ var _services_data_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../services/data.service */ 1024);
/* harmony import */ var _services_dialog_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../services/dialog.service */ 69104);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @angular/core */ 3184);
















// DO NOT ADD PROJECT DEPENDENCY TO THIS CLASS
class BaseComponent {
    constructor(injector) {
        this.isAnimationOff = false;
        this.configService = injector.get(_services_config_service__WEBPACK_IMPORTED_MODULE_6__.ConfigService);
        this.t = injector.get(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.TranslateService);
        this.context = injector.get(_services_context_service__WEBPACK_IMPORTED_MODULE_7__.Context);
        this.router = injector.get(_angular_router__WEBPACK_IMPORTED_MODULE_11__.Router);
        this.route = injector.get(_angular_router__WEBPACK_IMPORTED_MODULE_11__.ActivatedRoute);
        this.routerLoc = injector.get(_angular_common__WEBPACK_IMPORTED_MODULE_12__.Location);
        this.routingService = injector.get(_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_4__.RoutingService);
        this.dataService = injector.get(_services_data_service__WEBPACK_IMPORTED_MODULE_8__.DataService);
        this.dialogService = injector.get(_services_dialog_service__WEBPACK_IMPORTED_MODULE_9__.DialogService);
        this.analyticsService = injector.get(_services_analytics_service__WEBPACK_IMPORTED_MODULE_5__.AnalyticsService);
        this.platformService = injector.get(_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_3__.PlatformService);
        //this.browserService = injector.get(BrowserService);
        this.timeService = injector.get(_pure_services_time_service__WEBPACK_IMPORTED_MODULE_0__.TimeService);
        this.settingManager = injector.get(_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_2__.SettingManager);
        this.my = window['my'];
        this.navParams = new _pure_base_page_params__WEBPACK_IMPORTED_MODULE_1__.PageParams();
        this.navParams.route = this.route;
        this.isAnimationOff = this.configService.getAnimationOff();
    }
    back() {
        this.routerLoc.back();
    }
    setBusy(busy) {
        this.context.app.setBusy(busy);
    }
    getImage(data, name, width = 300) {
        let url = null;
        if (data.images && data.images[name]) {
            url = data.images[name].url;
        }
        return url;
    }
    hasImage(content, imgName = 'default') {
        var _a;
        const imgs = content.images || ((_a = content[0]) === null || _a === void 0 ? void 0 : _a.images);
        if (imgs) {
            var img = imgs[imgName] || imgs['logo'];
            if (img) {
                return true;
            }
        }
        return false;
    }
    /*

    showError(err) {
        this.context.app.showError(err);
    }
    
    showAlert(title: string, message: string, buttons: any = ['OK']) {

        this.context.app.showAlert(title, message, buttons);

    }

   

    showToast(message: string) {
        this.context.app.showToast(message);
    }

    showSnack(message: string, action: string, fn) {
        this.context.app.showSnack(message, action, fn);
    }

    loading(show, message: string = null){
        this.context.app.loading(show, message);
    }

    superloading(show){
        this.context.app.superloading(show);
    }
    */
    isDev() {
        return this.configService.isDev() || (this.configService.isLocalhost() && !this.platformService.isApp());
    }
    isPrd() {
        return this.configService.isPrd();
    }
    getLangValue(item, name, lang = null) {
        if (!lang) {
            lang = this.context.contentLang;
        }
        let value = null;
        if (lang && lang.indexOf('en') === -1) {
            value = item[name + '_' + lang];
        }
        if (!value) {
            value = item[name];
        }
        return value;
    }
    getISOLangCode() {
        var _a, _b;
        const langMap = {
            'zh': 'zh-Hant',
            'zh-cn': 'zh-Hans'
        };
        const lang = (_b = (_a = this === null || this === void 0 ? void 0 : this.context) === null || _a === void 0 ? void 0 : _a.userLang) !== null && _b !== void 0 ? _b : 'en';
        return (lang in langMap) ? langMap[lang] : lang;
    }
    isAdmin() {
        return this.context.admin;
    }
    openLazyDialog(componentName, data, options = {}) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
        });
    }
    matchElement(data, element, isElementMatchOnly = false) {
        const isElementMatch = data === element;
        return isElementMatchOnly ? isElementMatch : (isElementMatch || data === 'old' || data === 'default');
    }
}
BaseComponent.ɵfac = function BaseComponent_Factory(t) { return new (t || BaseComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_14__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_14__.Injector)); };
BaseComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_14__["ɵɵdefineComponent"]({ type: BaseComponent, selectors: [["ng-component"]], decls: 0, vars: 0, template: function BaseComponent_Template(rf, ctx) { }, encapsulation: 2 });


/***/ }),

/***/ 76309:
/*!**************************************************************!*\
  !*** ./projects/core/src/app/framework/base/base-context.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BaseContext": () => (/* binding */ BaseContext)
/* harmony export */ });
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! rxjs/operators */ 50635);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! rxjs/operators */ 59295);
/* harmony import */ var _pure_services_common_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../pure/services/common.service */ 43872);
/* harmony import */ var _pure_services_platform_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../pure/services/platform.service */ 45485);
/* harmony import */ var _pure_services_sentry_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../pure/services/sentry.service */ 38792);
/* harmony import */ var _pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../pure/services/subscribe.service */ 47074);
/* harmony import */ var _services_data_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../services/data.service */ 1024);
/* harmony import */ var _services_storage_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../services/storage.service */ 24430);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/core */ 3184);









class BaseContext {
    constructor(injector) {
        this.storageService = injector.get(_services_storage_service__WEBPACK_IMPORTED_MODULE_5__.StorageService);
        this.subscribeService = injector.get(_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_3__.SubscribeService);
        this.platformService = injector.get(_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_1__.PlatformService);
        this.sentryService = injector.get(_pure_services_sentry_service__WEBPACK_IMPORTED_MODULE_2__.SentryService);
        this.dataService = injector.get(_services_data_service__WEBPACK_IMPORTED_MODULE_4__.DataService);
    }
    get(fieldName, url, params = {}) {
        this.dataService.get(url, params).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.map)(jo => this.setData(fieldName, jo)));
    }
    setData(fieldName, data) {
        this[fieldName] = data;
        return data;
    }
    /*
    bind(obj: any, fieldName: string){

        var bs : BehaviorSubject<any> = this[fieldName];

        if(bs){

        }

    }*/
    //Child should overwrite this, or nothing will be saved
    makeSaveData() {
        return null;
    }
    restoreSavedData(data) {
    }
    makeGenericKey(context = {}, type, locale = "multi") {
        if (!context.groupId)
            return null;
        var segs = [];
        segs.push("type=" + type);
        segs.push("groupId=" + context.groupId);
        if (context.courtId) {
            segs.push("courtId=" + context.courtId);
        }
        else if (context.brandId) {
            segs.push("brandId=" + context.brandId);
            /*
            if(context.storeId){
                segs.push("storeId=" + context.storeId);
            }
            */
        }
        segs.push("locale=" + locale);
        var key = segs.join('&');
        return key;
    }
    save() {
        var key = this.contextId;
        console.log("saving context", key);
        if (!key) {
            console.log("MISSING contextId");
            return;
        }
        var data = this.makeSaveData();
        if (!data) {
            this.storageService.setStorage(key, null);
            return;
        }
        if (!this.platformService.isSDK() || (this.platformService.isSDK() && window['cachedOrderContext'])) {
            var now = new Date().getTime();
            data['saved'] = now;
            data['expire'] = now + 1000 * 60 * 60 * 24 * 7;
            var serialized = this.serialize(data);
            this.storageService.setStorage(key, serialized);
            console.log("saved context");
        }
    }
    serialize(data, compress = false) {
        if (!compress)
            return data;
        var jsonStr = JSON.stringify(data);
        return jsonStr;
    }
    deserialize(raw, compress = false) {
        if (!compress)
            return raw;
        var result = JSON.parse(raw);
        console.log("deserialized", result.groupId, result);
        return result;
    }
    restore(callback = null) {
        console.log("restoring context", this.contextId, window.location.href);
        this.storageService.getStorage(this.contextId)
            .then((value) => {
            var de = this.deserialize(value);
            if (de) {
                this.restoreSavedData(de);
                if (callback)
                    callback(this);
            }
            else {
                if (callback)
                    callback(null);
            }
        }).catch((reason) => {
            console.log("ERROR", reason);
            if (callback)
                callback(null);
        });
    }
    setLocal(key, object) {
        _pure_services_common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.setLocal(key, object);
    }
    getLocal(key) {
        return _pure_services_common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.getLocal(key);
    }
    bind(fields) {
        this.subscribeService.bind(this, fields);
    }
    next(name, value) {
        this[name] = value;
        this.subscribeService.next(name, value);
    }
    listen(name, once = false) {
        var obs = this.subscribeService.getObservable(name);
        if (once) {
            obs = obs.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.take)(1));
        }
        return obs;
    }
}
BaseContext.ɵfac = function BaseContext_Factory(t) { return new (t || BaseContext)(_angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_8__.Injector)); };
BaseContext.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdefineInjectable"]({ token: BaseContext, factory: BaseContext.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 74522:
/*!***********************************************************!*\
  !*** ./projects/core/src/app/framework/base/base-page.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BasePage": () => (/* binding */ BasePage)
/* harmony export */ });
/* harmony import */ var _pure_services_time_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../../pure/services/time.service */ 72570);
/* harmony import */ var aigens_ng_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aigens-ng-core */ 51707);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rxjs/operators */ 87260);
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! .. */ 44651);
/* harmony import */ var _pure_base_page_params__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../pure/base/page-params */ 8744);
/* harmony import */ var _pure_services_ad_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../pure/services/ad.service */ 32083);
/* harmony import */ var _pure_services_sentry_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../pure/services/sentry.service */ 38792);
/* harmony import */ var _services_config_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../services/config.service */ 2171);
/* harmony import */ var _services_context_manager_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/context-manager.service */ 98235);
/* harmony import */ var _services_context_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../services/context.service */ 73769);
/* harmony import */ var _base_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./base-component */ 22963);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @angular/core */ 3184);













class BasePage extends _base_component__WEBPACK_IMPORTED_MODULE_9__.BaseComponent {
    constructor(injector) {
        var _a;
        super(injector);
        this.active = false;
        this.winWidth = window.innerWidth;
        this.autoDismissPreLoader = true;
        this.navParams = new _pure_base_page_params__WEBPACK_IMPORTED_MODULE_3__.PageParams();
        this.navParams.route = this.route;
        this.configService = injector.get(_services_config_service__WEBPACK_IMPORTED_MODULE_6__.ConfigService);
        this.context = injector.get(_services_context_service__WEBPACK_IMPORTED_MODULE_8__.Context);
        this.navParams.querys = this.route.snapshot.queryParams;
        this.navParams.params = this.route.snapshot.params;
        this.navParams.input = this.routingService.getAuxInput();
        this.member = this.context.member;
        this.membership = this.context.membership;
        this.group = this.context.group;
        this.brand = aigens_ng_core__WEBPACK_IMPORTED_MODULE_1__.Data.toData(aigens_ng_core__WEBPACK_IMPORTED_MODULE_1__.Brand, (_a = this === null || this === void 0 ? void 0 : this.context) === null || _a === void 0 ? void 0 : _a.brand);
        this.store = this.context.store;
        this.court = this.context.court;
        this.themeColorService = injector.get(___WEBPACK_IMPORTED_MODULE_2__.ThemeColorService);
        this.contextManager = injector.get(_services_context_manager_service__WEBPACK_IMPORTED_MODULE_7__.ContextManager);
        this.memberContext = injector.get(___WEBPACK_IMPORTED_MODULE_2__.MemberContext);
        this.adService = injector.get(_pure_services_ad_service__WEBPACK_IMPORTED_MODULE_4__.AdService);
        this.sentryService = injector.get(_pure_services_sentry_service__WEBPACK_IMPORTED_MODULE_5__.SentryService);
        this.timeService = injector.get(_pure_services_time_service__WEBPACK_IMPORTED_MODULE_0__.TimeService);
    }
    getNav(app) {
        const navs = app.getRootNav();
        if (navs && navs.length > 0) {
            return navs[0];
        }
        return app.getActiveNav('nav');
    }
    ngAfterViewInit() {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;
        console.log("ngAfterViewInit", this.route.snapshot.data);
        var routeData = this.route.snapshot.data;
        if (routeData && routeData.preloader === true) {
        }
        else {
            this.dialogService.dismissPreLoader();
        }
        this.sentryService.setContext('Aigens', {
            version: (_b = (_a = window['aigens']) === null || _a === void 0 ? void 0 : _a.version) !== null && _b !== void 0 ? _b : ''
        });
        if ((_d = (_c = window['aigens']) === null || _c === void 0 ? void 0 : _c.context) === null || _d === void 0 ? void 0 : _d.brandId) {
            this.sentryService.setTag("brandId", (_f = (_e = window['aigens']) === null || _e === void 0 ? void 0 : _e.context) === null || _f === void 0 ? void 0 : _f.brandId);
        }
        if ((_h = (_g = window['aigens']) === null || _g === void 0 ? void 0 : _g.context) === null || _h === void 0 ? void 0 : _h.courtId) {
            this.sentryService.setTag("courtId", (_k = (_j = window['aigens']) === null || _j === void 0 ? void 0 : _j.context) === null || _k === void 0 ? void 0 : _k.courtId);
        }
    }
    canBack() {
        //return this.routingService.canBack();
        return this.routingService.canBack();
    }
    getUIRefreshInterval() {
        return 0;
    }
    onRefreshUI() {
        console.log('you need to implment onRefreshUI');
    }
    startTimer(interval) {
        if (!this.timer) {
            console.log('start timer');
            this.timer = setInterval(() => {
                this.onRefreshUI();
            }, interval);
        }
    }
    stopTimer() {
        if (this.timer) {
            console.log('stop timer');
            clearInterval(this.timer);
            this.timer = null;
        }
    }
    ngOnInit() {
        const interval = this.getUIRefreshInterval();
        console.log("INT", interval);
        if (interval > 500) {
            this.startTimer(interval);
        }
    }
    ngOnDestroy() {
        this.stopTimer();
    }
    hasMenu() {
        return this.routingService.hasMenu() && !this.settingManager.get('appHideTabbarMenu', false);
    }
    isRoot() {
        return this.routingService.isRoot();
    }
    isTab() {
        return this.route.snapshot.data.tab == true;
    }
    isMenu() {
        return this.route.snapshot.data && this.route.snapshot.data.menu == true;
    }
    showMenu() {
        console.log('menuClicked');
        this.context.app.openDrawer();
    }
    clearReuse() {
        const strat = this.router.routeReuseStrategy;
        strat.clear();
    }
    autoContext(fields = null, params = null, callback = null) {
        if (!fields)
            fields = this.context.fields;
        if (!params) {
            var groupId = this.navParams.get("groupId");
            var courtId = this.navParams.get("courtId");
            var brandId = this.navParams.get("brandId");
            var storeId = this.navParams.get("storeId");
            params = {
                groupId: groupId,
                courtId: courtId,
                brandId: brandId,
                storeId: storeId
            };
        }
        this.contextManager.autoContext(fields, params, () => {
            this.themeColorService.setThemeByContext();
            this.init();
        });
    }
    //overwrite this method to be called after autoContext
    init() {
    }
    isDev() {
        return this.configService.get('dev') == true;
    }
    isPrd() {
        return this.configService.get('production') == true;
    }
    listenParams(callback) {
        //must skip first one, or will fire immediately!
        //we don't need to unsubscribe because NG router does that automatically
        this.route.queryParams.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.skip)(1)).subscribe(p => callback(p));
        this.route.params.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.skip)(1)).subscribe(p => callback(p));
    }
    setLang(storeLang) {
        var _a;
        this.t.use(storeLang);
        this.configService.setLocale(storeLang);
        this.t.setDefaultLang(storeLang);
        this.t.currentLang = storeLang;
        this.context.userLang = storeLang;
        ((_a = window['aigens']) === null || _a === void 0 ? void 0 : _a.context) && (window['aigens'].context.userLang = storeLang);
    }
    isLoggedIn() {
        var member = this.context.member;
        if (member && !member.guest) {
            return true;
        }
        return false;
    }
    getSetting(name, defValue = null) {
        return this.settingManager.get(name, defValue);
    }
}
BasePage.ɵfac = function BasePage_Factory(t) { return new (t || BasePage)(_angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_11__.Injector)); };
BasePage.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdefineComponent"]({ type: BasePage, selectors: [["ng-component"]], features: [_angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵInheritDefinitionFeature"]], decls: 0, vars: 0, template: function BasePage_Template(rf, ctx) { }, encapsulation: 2 });


/***/ }),

/***/ 9110:
/*!**************************************************************!*\
  !*** ./projects/core/src/app/framework/base/base-service.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BaseService": () => (/* binding */ BaseService)
/* harmony export */ });
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/common/http */ 28784);
/* harmony import */ var _services_config_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../services/config.service */ 2171);
/* harmony import */ var _services_context_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../services/context.service */ 73769);
/* harmony import */ var _aquery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./aquery */ 33759);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);






class BaseService {
    constructor(injector) {
        this.context = injector.get(_services_context_service__WEBPACK_IMPORTED_MODULE_1__.Context);
        this.configs = injector.get(_services_config_service__WEBPACK_IMPORTED_MODULE_0__.ConfigService);
        this.http = injector.get(_angular_common_http__WEBPACK_IMPORTED_MODULE_3__.HttpClient);
        this.aq = new _aquery__WEBPACK_IMPORTED_MODULE_2__.AQuery(injector);
    }
}
BaseService.ɵfac = function BaseService_Factory(t) { return new (t || BaseService)(_angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_4__.Injector)); };
BaseService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineInjectable"]({ token: BaseService, factory: BaseService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 89071:
/*!******************************************************************!*\
  !*** ./projects/core/src/app/framework/base/modifier-builder.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ModifierBuilder": () => (/* binding */ ModifierBuilder)
/* harmony export */ });
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../data */ 51707);
/* harmony import */ var _orderitem_builder__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./orderitem-builder */ 6949);


/**
 * A temporary modifier group manager
 * **/
class ModifierBuilder {
    constructor(store, orderitem, items = null) {
        this.items = null;
        /*
    
    {
        "itemId":[
    
            {
                id: "mgroupId"
    
                items: []
    
            },
    
            {
                id: "mgroupId"
                items:[]
            }
        ]
    
    }
    
        */
        this.mods = {};
        this.qmap = {};
        this.pmap = {};
        this.mmap = {}; // modifier item map
        this.store = store;
        this.orderitem = orderitem;
        this.addExisting();
        var allItems = this.findItems(orderitem);
        if (items) {
            this.items = allItems.filter(i => items.find(ii => ii.id === i.id) != null);
        }
        else {
            this.items = allItems;
        }
    }
    clear() {
        this.mods = {};
        this.qmap = {};
        this.pmap = {};
    }
    /**
     * Clear all modifiers selected for specific item and group
     * @param item
     */
    clearForItem(item, group) {
        /* this.mods[item.id] = null;
        Object.keys(this.qmap).filter(key => this.isKeyForItem(key, item)).forEach(key => {
            this.qmap[key] = null;
        }) */
        //
        let mgroups = this.mods[this.createModifierMapKey(item)];
        let mgroup = this.findById(mgroups, group.id);
        // let index: number = mgroups.indexOf(mgroup);
        if (!mgroup)
            return;
        if (mgroups) {
            let index = mgroups.indexOf(mgroup);
            mgroups.splice(index, 1);
        }
        mgroup.items.forEach(mod => {
            let qkey = this.createQuantityMapKey(item, mod, group);
            this.qmap[qkey] = 0;
            this.pmap[qkey] = 0;
        });
    }
    transfer(oi) {
        if (!oi || !oi.groups) {
            return;
        }
        oi.groups.forEach(group => {
            let items = group.items;
            items
                .filter(item => item.mgroups && item.mgroups.length > 0)
                .forEach(item => {
                let mgroups = item.mgroups;
                mgroups.forEach(mgroup => {
                    let mitems = mgroup.items;
                    mitems.forEach(mitem => {
                        this.setMod(item, mgroup, mitem, mitem.quantity);
                    });
                });
            });
        });
    }
    addExisting() {
        var _a, _b, _c;
        var items = _data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getFlattenItems(this.orderitem, false);
        for (let item of items) {
            var mgroups = item.mgroups;
            if (mgroups && mgroups.length > 0) {
                for (let mgroup of mgroups) {
                    var mods = mgroup.items;
                    if (mods && mods.length > 0) {
                        for (let mod of mods) {
                            (mod === null || mod === void 0 ? void 0 : mod.mgroup) && (this.mmap[mod.mgroup] = mod);
                            this.setMod(item, mgroup, mod, mod.quantity, true);
                        }
                    }
                }
            }
            else {
                // 购物车里不存在 item mod(即 mitem.currentQty == 0 ) , so 执行 auto add absentItem logic(mitem level)
                const origin = (_b = (_a = this === null || this === void 0 ? void 0 : this.store) === null || _a === void 0 ? void 0 : _a.menu) === null || _b === void 0 ? void 0 : _b['imap'][item === null || item === void 0 ? void 0 : item.id];
                if (origin === null || origin === void 0 ? void 0 : origin.mgroups) {
                    (_c = origin === null || origin === void 0 ? void 0 : origin.mgroups) === null || _c === void 0 ? void 0 : _c.map(mg => {
                        var _a;
                        return (_a = mg === null || mg === void 0 ? void 0 : mg.items) === null || _a === void 0 ? void 0 : _a.map(mItem => {
                            if ((mItem === null || mItem === void 0 ? void 0 : mItem.baseQty) === 0 && (mItem === null || mItem === void 0 ? void 0 : mItem.absentId) /*&& q === 0*/) { // 初始化时 baseQty === 0 并且对应的absent存在，把absent 加入mdBuidler
                                let absentItem = this.findAbsentItemByAbsentid(mItem, mg === null || mg === void 0 ? void 0 : mg.items);
                                console.log('when new ModifierBuilder() auto add absentItem', absentItem === null || absentItem === void 0 ? void 0 : absentItem.name);
                                absentItem && this.plus(item, mg, absentItem);
                            }
                        });
                    });
                }
            }
        }
    }
    getQty(quantity, mod, ignoreBaseQty = false) {
        let fullmod = this.findItem(mod);
        if (!fullmod)
            return quantity;
        if (quantity == 0 && fullmod.absentId)
            return -1;
        if (!ignoreBaseQty) {
            if (fullmod.baseQty)
                quantity -= fullmod.baseQty;
        }
        if (quantity < 0)
            quantity = 0;
        return quantity;
    }
    minus(item, group, mItem) {
        var q = this.getQuantity(item, group, mItem);
        if (q > mItem.min) {
            q--;
        }
        if ((mItem === null || mItem === void 0 ? void 0 : mItem.absentId) && q === 0) { // 当 当前mitem 数量0并且对应的absent存在，把absent 加入mdBuidler
            // add the absentItem mod
            let absentItem = this.findAbsentItemByAbsentid(mItem, group === null || group === void 0 ? void 0 : group.items);
            console.log('ModifierBuilder add absentItem', absentItem === null || absentItem === void 0 ? void 0 : absentItem.name);
            absentItem && this.plus(item, group, absentItem);
        }
        this.setMod(item, group, mItem, q);
    }
    plus(item, group, mItem) {
        var q = this.getQuantity(item, group, mItem);
        const max = mItem.max || group.max;
        if (max > q) {
            q++;
        }
        console.log('ModifierBuilder plus mItem', mItem === null || mItem === void 0 ? void 0 : mItem.name, q);
        if (mItem === null || mItem === void 0 ? void 0 : mItem.absentId) {
            // clear the absentItem mod
            let absentItem = this.findAbsentItemByAbsentid(mItem, group === null || group === void 0 ? void 0 : group.items);
            console.log('ModifierBuilder clear absentItem', absentItem === null || absentItem === void 0 ? void 0 : absentItem.name);
            absentItem && this.setMod(item, group, absentItem, 0);
        }
        this.setMod(item, group, mItem, q);
    }
    // find absent item
    findAbsentItemByAbsentid(mitem, items = []) {
        let a = items === null || items === void 0 ? void 0 : items.find(i => (i === null || i === void 0 ? void 0 : i.id) === (mitem === null || mitem === void 0 ? void 0 : mitem.absentId));
        return a || (items === null || items === void 0 ? void 0 : items.find(i => (mitem === null || mitem === void 0 ? void 0 : mitem.id) === (i === null || i === void 0 ? void 0 : i.absentId)));
    }
    setMod(item, mgroup, mod, quantity, addExisting = false) {
        //var mgroups = this.mods[item.id];
        var mgroups = this.mods[this.createModifierMapKey(item)];
        if (!mgroups) {
            mgroups = [];
            //this.mods[item.id] = mgroups;
            this.mods[this.createModifierMapKey(item)] = mgroups;
        }
        var mg = this.findById(mgroups, mgroup.id); //TODO
        if (!mg) {
            //mg = this.cloneIG(mgroup);
            mg = _orderitem_builder__WEBPACK_IMPORTED_MODULE_1__.OrderItemBuilder.cloneIG(mgroup);
            mgroups.push(mg);
        }
        var mods = mg.items;
        var existing = this.findById(mods, mod.id);
        if (!existing) {
            //existing = this.cloneMod(mod);
            existing = _orderitem_builder__WEBPACK_IMPORTED_MODULE_1__.OrderItemBuilder.cloneItem(mod);
            mods.push(existing);
        }
        let qty = this.getQty(quantity, mod, true); // 废弃 getQuantity() baseQty logic, so now hardcode true
        console.log("qty", qty);
        /*
        if (quantity <= 0 && mod.baseQty <= 0) {
            this.removeObject(existing, mods);
        }*/
        let remove = false;
        if (qty == 0) {
            this.removeObject(existing, mods);
            remove = true;
            console.log("remove 0 qty mod");
        }
        if (qty == -1) {
            qty = 0; //need to route to absent item
        }
        existing.quantity = qty;
        if (mods.length == 0) {
            this.removeObject(mg, mgroups);
        }
        var qkey = this.createQuantityMapKey(item, mod, mgroup);
        if (!remove) {
            this.qmap[qkey] = qty;
            if (!!mod.baseQty) {
                if ((qty - (mod === null || mod === void 0 ? void 0 : mod.baseQty)) > 0) {
                    qty = (qty - (mod === null || mod === void 0 ? void 0 : mod.baseQty));
                }
                else {
                    qty = 0;
                }
            }
            this.pmap[qkey] = _data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(mod.price * qty, 2);
        }
        else {
            delete this.qmap[qkey];
            delete this.pmap[qkey];
        }
        //console.log("qmap", this.qmap);
        //console.log("pmap", this.pmap);
    }
    getPrice(item, group, mItem) {
        let qty = this.getQuantity(item, group, mItem);
        if (mItem.baseQty && qty > mItem.baseQty)
            return mItem.price;
        else
            return 0;
    }
    getTotal() {
        let total = 0;
        Object.keys(this.pmap).forEach(p => {
            total += this.pmap[p];
        });
        total = _data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(total, 2);
        return total;
    }
    createQuantityMapKey(item, mod, mgroup) {
        return item.addTime + '.' + item.id + '.' + mod.id + '.' + mgroup.id;
    }
    createModifierMapKey(item) {
        return item.addTime + '.' + item.id;
    }
    getQuantity(item, mgroup, mod) {
        var qkey = this.createQuantityMapKey(item, mod, mgroup);
        var q = this.qmap[qkey];
        if (q == null || isNaN(q)) {
            if (mod.baseQty)
                q = mod.baseQty;
            else
                q = 0;
        }
        else {
            // if (q > 0 && mod.baseQty)
            //     q += mod.baseQty;
        }
        return q;
    }
    getSelectedModifierCount(item) {
        if (!this.qmap) {
            return 0;
        }
        let count = 0;
        Object.keys(this.qmap)
            .filter(key => this.isKeyForItem(key, item))
            .forEach(key => {
            let quantity = this.qmap[key];
            if (quantity != null && !isNaN(quantity) && quantity > 0) {
                count += quantity;
            }
        });
        return count;
    }
    isKeyForItem(key, item) {
        let parts = key.split(".");
        let itemId = null;
        /*if (parts.length == 2) {
            itemId = parts[0];
        }*/
        let index;
        if (parts.length == 3) {
            itemId = parts[1];
            index = parts[0];
        }
        //return (itemId != null && itemId == item.id);
        return (itemId != null && itemId == item.id && Number(index) == item.addTime);
    }
    build() {
        var items = _data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getFlattenItems(this.orderitem, false);
        for (let item of items) {
            //var mgroups = this.mods[item.id];
            var mgroups = this.mods[this.createModifierMapKey(item)];
            if (mgroups && mgroups.length > 0) {
                item.mgroups = mgroups;
            }
            else {
                item.mgroups = null;
            }
        }
        // replace item by using absentItem
        // ModifierBuilder.build(this.orderitem, this.store?.menu?.['imap']);
        return this.orderitem;
    }
    static build(orderitem, imap) {
        if (!imap)
            imap = {};
        orderitem.items.forEach(i => {
            let mgroups = i.mgroups;
            if (mgroups && mgroups.length > 0) {
                mgroups.forEach(mgroup => {
                    let newItems = [];
                    let original = mgroup.items;
                    original.forEach(mitem => {
                        var _a;
                        let fullItem = imap[mitem.id];
                        if ((mitem === null || mitem === void 0 ? void 0 : mitem.quantity) == 0 && (fullItem === null || fullItem === void 0 ? void 0 : fullItem.absentId) && (mitem === null || mitem === void 0 ? void 0 : mitem.baseQty)) {
                            let absent = (_a = orderitem === null || orderitem === void 0 ? void 0 : orderitem.items) === null || _a === void 0 ? void 0 : _a.find(i => (i === null || i === void 0 ? void 0 : i.id) === (fullItem === null || fullItem === void 0 ? void 0 : fullItem.absentId)); // orderitem item 有无 对应的 absent item
                            if (absent) { // 改数量
                                absent.quantity = 1; // now absentItem quality only will be one ;todo: handle absentItem quanlity?
                            }
                            else {
                                absent = imap[fullItem.absentId];
                                if (absent) {
                                    console.log("replace with absent item", mitem.backendId + "=>" + absent.backendId);
                                    let absentItem = _orderitem_builder__WEBPACK_IMPORTED_MODULE_1__.OrderItemBuilder.cloneItem(absent);
                                    absentItem.quantity = 1;
                                    newItems.push(absentItem);
                                }
                                else {
                                    console.log("absent item not found", fullItem.absentId);
                                }
                            }
                        }
                        else {
                            newItems.push(mitem);
                        }
                    });
                    mgroup.items = newItems;
                });
            }
        });
        _data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.flattenItems(orderitem);
        return orderitem;
    }
    findById(list, id) {
        if (!list)
            return null;
        for (let o of list) {
            if (id == o.id) {
                return o;
            }
        }
        return null;
    }
    /*private cloneMod(from: Item): Item {

        var item = new Item();

        item.id = from.id;
        item.name = from.name;
        item.price = from.price;
        item.quantity = 0;
        item.backendId = from.backendId;
        item.extra = from.extra;

        return item;

    }

    private cloneIG(from: ItemGroup): ItemGroup {

        var ig = new ItemGroup();

        ig.id = from.id;
        ig.items = [];
        ig.name = from.name;
        ig.backendId = from.backendId;
        ig.printers = from.printers;

        return ig;

    }*/
    removeObject(object, array) {
        var idx = array.indexOf(object);
        if (idx != -1) {
            array.splice(idx, 1);
        }
    }
    /**
     * Find all modifiable items from current order item
     * @param oi order item
     */
    static findItems(store, oi) {
        let gmap = store.menu['gmap'];
        //console.log("modifier builder find items", gmap, oi);
        var itemsMap = {};
        for (let ig of oi.groups) {
            var realIg = gmap[ig.id];
            for (let item of realIg.items) {
                itemsMap[item.id] = item;
            }
        }
        var items = _data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getFlattenItems(oi, false);
        let result = [];
        for (let item of items) {
            //var realItem = itemsMap[item.id]; //!!!reference
            var realItem = Object.assign({}, itemsMap[item.id]);
            realItem.addTime = item.addTime;
            result.push(realItem);
        }
        //console.log("modable items", result);
        result = result.filter(item => {
            let mgroups = item.mgroups;
            if (!mgroups || mgroups.length == 0) {
                return false;
            }
            return mgroups.some(mgroup => {
                let mitems = mgroup.items;
                return mitems && mitems.length > 0;
            });
        });
        return result;
    }
    findItem(i) {
        let imap = this.store.menu['imap'];
        if (imap)
            return imap[i.id];
        else
            return null;
    }
    findItems(oi) {
        //let gmap = this.store.menu['gmap'];
        return ModifierBuilder.findItems(this.store, oi);
    }
    getMGroupQTY(mainItem, group) {
        let quantities = 0; // this.mdBuilder.getSelectedModifierCount(item);
        for (const tmpItem of group === null || group === void 0 ? void 0 : group.items) {
            quantities += this.getQuantity(mainItem, group, tmpItem);
        }
        return quantities;
    }
    // 判断 mitem 是否可以加入 mdBuilder
    canAdd(item, group, mItem) {
        var _a;
        const max = group === null || group === void 0 ? void 0 : group.max;
        let quantities = 0; // this.mdBuilder.getSelectedModifierCount(item);
        for (const tmpItem of group === null || group === void 0 ? void 0 : group.items) {
            quantities += this.getQuantity(item, group, tmpItem);
        }
        this.mmap = {};
        if (max <= quantities) {
            return false;
        }
        (_a = group === null || group === void 0 ? void 0 : group.items) === null || _a === void 0 ? void 0 : _a.forEach((mitem) => {
            if (mitem.mgroup && this.has(item, group, mitem)) {
                this.mmap[mitem.mgroup] = mitem;
            }
        });
        if (max > quantities && mItem && this.mmap[mItem.mgroup] && mItem.id !== this.mmap[mItem.mgroup].id) {
            return true;
        }
        return max > quantities;
    }
    clearMmapBykey(key) {
        this.mmap[key] = null;
    }
    clearSameMGroup(item, group, mItem) {
        const i = this.mmap[mItem.mgroup];
        if (i) {
            this.setMod(item, group, i, 0);
        }
        this.mmap[mItem.mgroup] = mItem;
    }
    // 判断 mdBuilber里是否选过了 mitem
    has(item, group, mItem) {
        return (this === null || this === void 0 ? void 0 : this.getQuantity(item, group, mItem)) > 0;
    }
}


/***/ }),

/***/ 6949:
/*!*******************************************************************!*\
  !*** ./projects/core/src/app/framework/base/orderitem-builder.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OrderItemBuilder": () => (/* binding */ OrderItemBuilder)
/* harmony export */ });
/* harmony import */ var _modifier_builder__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./modifier-builder */ 89071);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../data */ 51707);


/**
 * a temporary order item manager
 * **/
class OrderItemBuilder {
    constructor(store) {
        this.originGroups = [];
        this.groups = [];
        //combo: boolean = false;
        this.items = [];
        this.qmap = [];
        this.noNeedConfirm = {};
        this.noNeedConfirmButtonFlag = false;
        this.store = store;
    }
    /**
     * save the origin itemGroups to use
     * @param mainItemGroup mainItem 所属的 itemGroup
     * @param mainItem
     */
    setOriginGroups(mainItemGroup, mainItem) {
        this.originGroups = [];
        if (mainItemGroup) {
            this.originGroups.push(mainItemGroup);
        }
        if (mainItem && mainItem.groups) {
            this.originGroups.push(...mainItem.groups);
        }
    }
    getOriginGroups() {
        return this.originGroups;
    }
    /**
     * 在 this.builder 配置的 groups 中找到指定 group的下标
     * @param group
     * @returns
     */
    getItemGroupIndex_hasSelected(group) {
        return this.findIndexByGroups(this.groups, group);
    }
    getItemGroupIndex_allGroups(group) {
        return this.findIndexByGroups(this.originGroups, group);
    }
    getGroupById(groupId) {
        var _a;
        let arr = (_a = this.groups) === null || _a === void 0 ? void 0 : _a.filter(g => (g === null || g === void 0 ? void 0 : g.id) === groupId);
        return arr && arr[0] || null;
    }
    findIndexByGroups(groups, group) {
        return groups.findIndex(g => {
            // TODO: is compared by id safe?
            return (g !== null && g !== undefined && g.id === group.id);
        });
    }
    getItemGroupItemsQuantity(group) {
        let igIndex = this.getItemGroupIndex_hasSelected(group);
        let groupMap = this.qmap[igIndex];
        let itemsQuantity = 0;
        for (const key in groupMap) {
            groupMap[key] && groupMap[key] > 0 && (itemsQuantity += groupMap[key]);
        }
        return itemsQuantity || 0;
    }
    // 判断当前的 group 是否完成配置最低要求的items
    isGroupCompleted(group) {
        // console.log(group);
        if (!group) {
            return true;
        }
        const quantity = this.getItemGroupItemsQuantity(group);
        if (group.min <= quantity || quantity === group.max) {
            return true;
        }
        if (group.optional) {
            if (group.skippable) {
                // return true;
                // 4. optional == true, skipable == true:
                // 若min ==0，那麼可以直接當這個IG completed
                // 若min >0，那麼用戶要選擇「可不選」或是所選的item 數目大於等於min 才算completed
                return group.min > 0 ? (quantity >= group.min || this.noNeedConfirm[group.id]) : true;
            }
            else {
                // optional == true, skipable == false:
                // 忽略min == 0，用戶必須要選「可不選」或所選的sub-item 數目大於等于min 才可以當是completed
                return (quantity >= group.min || this.noNeedConfirm[group.id]);
            }
        }
        return false;
    }
    clone() {
        let builder = new OrderItemBuilder(this.store);
        builder.category = this.category;
        //builder.combo = this.combo;
        //builder.mods = this.mods;
        this.copyTo(builder);
        return builder;
    }
    copyTo(another) {
        let groups = [];
        this.groups.forEach((group, i) => {
            if (group) {
                groups[i] = _data__WEBPACK_IMPORTED_MODULE_1__.Data.toData(_data__WEBPACK_IMPORTED_MODULE_1__.ItemGroup, JSON.parse(JSON.stringify(group)));
            }
        });
        another.groups = groups;
        another.items = _data__WEBPACK_IMPORTED_MODULE_1__.Data.toDataArray(_data__WEBPACK_IMPORTED_MODULE_1__.Item, JSON.parse(JSON.stringify(this.items)));
        another.qmap = JSON.parse(JSON.stringify(this.qmap));
    }
    static test(store) {
        console.log("testing builder", store);
        var b = new OrderItemBuilder(store);
        var cat = store.categories[0];
        var ig = cat.groups[0];
        var item = ig.items[0];
        var mig = item.mgroups[0];
        var mod = mig.items[0];
        var ig2 = item.groups[0];
        var item2 = ig2.items[0];
        b.setCategory(cat);
        b.setItem(ig, item, 0);
        //b.setModItem(0, mig, mod, 0);
        b.setItem(ig2, item2, 2);
        var oi = b.build();
        console.log("oi", oi);
        var mb = new _modifier_builder__WEBPACK_IMPORTED_MODULE_0__.ModifierBuilder(store, oi);
        mb.setMod(item, mig, mod, 2);
        var quan = mb.getQuantity(item, mig, mod);
        console.log("quantity", quan);
        var oi2 = mb.build();
        console.log("oi2", oi2);
        var flattens = _data__WEBPACK_IMPORTED_MODULE_1__.OrderItem.getFlattenItems(oi2, true);
        console.log(flattens);
    }
    static createEmptyCategory(category) {
        let cat = new _data__WEBPACK_IMPORTED_MODULE_1__.Category();
        cat.id = category.id;
        cat.name = category.name;
        cat.type = category.type;
        cat.openings = category.openings;
        cat.cgroupId = category.cgroupId;
        cat.departmentId = category.departmentId;
        cat.periods = category.periods;
        cat.igMode = category.igMode;
        if (category.groups) {
            cat.groups = category.groups;
        }
        return cat;
    }
    findItems(index) {
        if (index < 0 || index >= this.groups.length)
            return [];
        let g = this.groups[index];
        if (!g)
            return [];
        return g.items;
    }
    build(number) {
        var _a;
        var oi = new _data__WEBPACK_IMPORTED_MODULE_1__.OrderItem();
        if (!this.category) {
            console.log("ERROR! Category must be set!");
            return null;
        }
        oi.category = OrderItemBuilder.createEmptyCategory(this.category);
        oi.categoryId = this.category.id;
        oi.categoryType = this.category.type;
        oi.cgroupId = this.category.cgroupId;
        oi.departmentId = this.category.departmentId;
        number && (oi.quantity = number);
        if (!this.store || !this.store.id) {
            console.warn("store is empty! ", this);
        }
        oi.storeId = this.store.id;
        // console.log("builder.groups:", this.groups);
        oi.groups = [];
        for (let ig of this.groups) {
            if (ig) {
                oi.groups.push(ig);
            }
        }
        _data__WEBPACK_IMPORTED_MODULE_1__.OrderItem.flattenItems(oi);
        //console.log("flatten", oi.items);
        let markerItem = null;
        let points = 0;
        for (let item of oi.items) {
            if (item.modifiable)
                oi.modifiable = true;
            if (item.marker)
                markerItem = item;
            if (item.points && item.points > 0)
                points += item.points;
        }
        oi.points = points;
        if (oi.items.length > 0 && oi.items[0].combo && ((_a = this.category) === null || _a === void 0 ? void 0 : _a.igMode) === 'combo') {
            oi.combo = true;
        }
        else {
            oi.combo = false;
        }
        oi.takeout = false;
        if (markerItem)
            oi.takeout = markerItem.marker == "takeaway";
        this.items = oi.items;
        this.orderItem = oi;
        this.calculateoi(oi);
        return oi;
    }
    // some item has absentItem 并且要自动 auto mdBuilder 里
    autoAddAbsentItem() {
        console.log('autoAddAbsentItem');
        let mdBuilder = new _modifier_builder__WEBPACK_IMPORTED_MODULE_0__.ModifierBuilder(this.store, this.orderItem);
        this.orderItem = mdBuilder === null || mdBuilder === void 0 ? void 0 : mdBuilder.build();
    }
    // 计算 orderbuilder build出来的orderItem 更新 oi.total
    calculateoi(orderitem) {
        var total = 0;
        for (let item of orderitem.items) {
            let realq = item.quantity;
            let q = item.quantity;
            let t; // extra price?
            if (item.baseQty) {
                if (realq >= item.baseQty) {
                    realq = realq - item.baseQty;
                    t = item.price * realq;
                }
                else if (realq < item.baseQty) {
                    t = 0;
                }
            }
            else {
                t = item.price * q;
            }
            //if (!q || q < 0) q = 1;
            total += _data__WEBPACK_IMPORTED_MODULE_1__.MathUtils.round(t, 2);
        }
        orderitem.total = _data__WEBPACK_IMPORTED_MODULE_1__.MathUtils.round(total, 2);
    }
    setCategory(cat) {
        this.category = cat;
    }
    setItem(group, item, index, quantity = 1, ignoreAddTime = true, includeMod = false) {
        this.plusItem(group, item, index, quantity, ignoreAddTime, includeMod);
    }
    clearItems(index) {
        this.groups[index] = null;
        this.qmap[index] = {};
        //console.log("cleared index " + index, this.groups);
    }
    plusItem(group, item, index, fixed = 0, ignoreAddTime = true, includeMod = false) {
        var _a;
        if (this.noNeedConfirm && ((_a = this.noNeedConfirm) === null || _a === void 0 ? void 0 : _a[group === null || group === void 0 ? void 0 : group.id]))
            delete this.noNeedConfirm[group === null || group === void 0 ? void 0 : group.id];
        var isModifiable = this.checkIsModifiable(group, item);
        item.modifiable = isModifiable;
        console.log("adding " + item.name + " to index " + index, item);
        var ig = this.groups[index];
        if (!ig) {
            ig = OrderItemBuilder.cloneIG(group);
            this.groups[index] = ig;
        }
        var items = ig.items;
        if (!items) {
            items = [];
            ig.items = items;
        }
        var isModifiable = this.checkIsModifiable(group, item);
        var savedItem = null;
        if (!isModifiable) {
            for (let exist of items) {
                if (exist.id == item.id) {
                    savedItem = exist;
                }
            }
        }
        //NOT SEPARATE SUB-ITEMS
        //find the existing item
        /*var savedItem = null;
        for (let exist of items) {
            if (exist.id == item.id) {
                savedItem = exist;
            }
        }

        //if none found, add it
        if (!savedItem) {

            savedItem = OrderItemBuilder.cloneItem(item, includeMod);
            savedItem.quantity = 0;
            items.push(savedItem);
        }*/
        let isSetMessage = _data__WEBPACK_IMPORTED_MODULE_1__.Item.isSetMessageLimit(item);
        //SEPARATE SUB_ITEMS
        if (!savedItem || isModifiable || isSetMessage) {
            savedItem = OrderItemBuilder.cloneItem(item, includeMod);
            savedItem.quantity = 0;
            if (!ignoreAddTime)
                savedItem.addTime = item.addTime;
            items.push(savedItem);
        }
        //SEPARATE SUB_ITEMS -- END
        // fixed = item.quantity; // dont know why add this code , now i remove it for task (IHAF-652)
        if (fixed == 0) {
            savedItem.quantity = savedItem.quantity + 1;
        }
        else {
            savedItem.quantity = fixed;
        }
        this.saveQuantity(index, item.id, savedItem.quantity, isModifiable || isSetMessage);
    }
    checkIsModifiable(group, item) {
        // var originsItemGroup = this.store.menu['gmap'][group.id];
        // for(let originsItem of originsItemGroup.items)
        // {
        //     if(originsItem.id == item.id)
        //     {
        //         var orimgroups = originsItem.mgroups;
        //         if(orimgroups && orimgroups.length > 0){
        //             isModifiable =  true;
        //             break;
        //         }
        //     }
        // }
        let realItem = item;
        if (this.store.menu) {
            let imap = this.store.menu['imap'];
            if (imap && item.id in imap) {
                realItem = imap[item.id];
            }
        }
        return _data__WEBPACK_IMPORTED_MODULE_1__.Item.isModifiable(realItem);
    }
    minusItem(group, item, index, ignoreAddTime = true) {
        var ig = this.groups[index];
        if (!ig)
            return;
        var items = ig.items;
        if (!items) {
            return;
        }
        //find the existing item
        //let isModifiable = item.mgroups && item.mgroups.length > 0;
        var isModifiable = this.checkIsModifiable(group, item);
        var savedItem = null;
        var itemIndex = 0;
        for (let i = items.length - 1; i >= 0; i--) {
            let exist = items[i];
            if (exist.id == item.id) {
                if (!ignoreAddTime && exist.addTime != item.addTime)
                    continue;
                savedItem = exist;
                itemIndex = i;
                break;
            }
            //itemIndex++;
        }
        if (!savedItem)
            return;
        var n = savedItem.quantity - 1;
        savedItem.quantity = n;
        //this.saveQuantity(index, item.id, n);
        this.saveQuantity(index, item.id, -1, isModifiable);
        if (n <= 0) {
            items.splice(itemIndex, 1);
        }
    }
    isCleared(igIndex) {
        return this.groups[igIndex] == null && this.qmap[igIndex] != null;
    }
    noNeedSelected(igIndex, editMode) {
        // console.log("noNeedSelected", this.groups);
        let g = this.groups[igIndex];
        if (editMode && !g)
            return true;
        if (!editMode && typeof g !== 'undefined' && g == null)
            return true;
        return false;
    }
    deleteItem(igIndex) {
        this.groups[igIndex] = null;
        this.qmap[igIndex] = null;
    }
    isModifiable(groups, igIndex = null) {
        if (igIndex == null) {
            return this.groups.some((group, i) => this.isModifiable(groups, i));
        }
        let ig = groups[igIndex];
        if (!ig) {
            console.log("item group not found!");
            return false;
        }
        let items = ig.items;
        return items.some(item => _data__WEBPACK_IMPORTED_MODULE_1__.Item.isModifiable(item));
    }
    setModItem(igIndex, mgroup, mitem, index) {
        var ig = this.groups[igIndex];
        if (!ig) {
            console.log("ERROR! Cannot add modifier to non existing IG position", igIndex);
            return;
        }
        var item = ig.items[0];
        var mig = OrderItemBuilder.cloneIG(mgroup);
        var mod = OrderItemBuilder.cloneItem(mitem);
        mod.quantity = 1;
        mig.items = [mod];
        if (!item.mgroups) {
            item.mgroups = [];
        }
        item.mgroups[index] = mig;
    }
    static cloneIG(from) {
        var ig = new _data__WEBPACK_IMPORTED_MODULE_1__.ItemGroup();
        ig.id = from.id;
        ig.items = [];
        ig.name = from.name;
        for (let namekey in from) {
            if (namekey && namekey.startsWith("name")) {
                ig[namekey] = from[namekey];
            }
        }
        ig.backendId = from.backendId;
        ig.max = from.max;
        ig.min = from.min;
        ig.modifier = from.modifier;
        //ig.optional = from.optional;
        ig.repeat = from.repeat;
        ig.skippable = from.skippable;
        ig.tags = from.tags;
        ig.printers = from.printers;
        ig.defaultId = from.defaultId;
        ig.pagerMode = from.pagerMode;
        return ig;
    }
    static cloneItem(from, cloneModifiers = false) {
        var item = new _data__WEBPACK_IMPORTED_MODULE_1__.Item();
        // item.addTime = from.addTime; addTime 是modifier 为唯一标识，clone时不应一致
        item.id = from.id;
        item.name = from.name;
        item.baseQty = from.baseQty;
        item.absentId = from.absentId;
        // api回来的数据是各种语言name_ 但执行cloneItem filter佐
        for (let namekey in from) {
            if (namekey && namekey.startsWith("name")) {
                item[namekey] = from[namekey];
            }
        }
        item.backendName = from.backendName;
        item.price = from.price;
        item.price0 = from.price0;
        item.price1 = from.price1;
        item.price2 = from.price2;
        item.inventory = from.inventory;
        item.handling = from.handling;
        item.setLayout = from.setLayout;
        if (!cloneModifiers || from.mgroups == null) {
            item.mgroups = null;
        }
        else {
            let mgroups = [];
            from.mgroups.forEach(mgroup => {
                let mg = this.cloneIG(mgroup);
                mgroup.items.forEach(mitem => {
                    let i = this.cloneItem(mitem, false);
                    mg.items.push(i);
                });
                mgroups.push(mg);
            });
            item.mgroups = mgroups;
        }
        item.quantity = from.quantity;
        item.backendId = from.backendId;
        item.printName = from.printName;
        item.images = from.images;
        item.tags = from.tags;
        item.modifiable = from.modifiable;
        item.combo = from.combo;
        item.printers = from.printers;
        item.extra = from.extra;
        item.pgroupId = from.pgroupId;
        item.marker = from.marker;
        item.points = from.points;
        item.discountable = from.discountable;
        item.comboId = from.comboId;
        item.comboName = from.comboName;
        item.taxGroup = from.taxGroup;
        item.packing = from.packing;
        item.discountedId = from.discountedId;
        item.mgroupIds = from.mgroupIds;
        item.mgroup = from.mgroup; // string
        item.serviceChargeable = from.serviceChargeable;
        item.periods = from.periods;
        item.type = from.type;
        item.messageLimit = from.messageLimit;
        item.messageMaxLength = from.messageMaxLength;
        item.messageOptional = from.messageOptional;
        item.custom = from.custom;
        item.igPos = from.igPos;
        item.min = from.min;
        item.max = from.max;
        item.custom = from.custom;
        return item;
    }
    static cloneOrderItem(from, cloneModifiers = false) {
        var oi = new _data__WEBPACK_IMPORTED_MODULE_1__.OrderItem();
        oi.total = from.total;
        var groups = [];
        for (let ig of from.groups) {
            var items = [];
            for (let i of ig.items) {
                items.push(this.cloneItem(i, cloneModifiers));
            }
            var newIg = this.cloneIG(ig);
            newIg.items = items;
            groups.push(newIg);
        }
        oi.groups = groups;
        oi.categoryId = from.categoryId;
        oi.category = from.category;
        oi.categoryType = from.categoryType;
        oi.quantity = from.quantity;
        oi.combo = from.combo;
        oi.modifiable = from.modifiable;
        oi.storeId = from.storeId;
        oi.handling = from.handling;
        oi.discount = from.discount;
        oi.discountId = from.discountId;
        oi.discounts = from.discounts;
        oi.takeout = from.takeout;
        oi.barcode = from.barcode;
        oi.message = from.message;
        oi.grandTotal = from.grandTotal;
        oi.points = from.points;
        oi.packing = from.packing;
        oi.serviceCharge = from.serviceCharge;
        oi.unlockDiscountConditionType = from.unlockDiscountConditionType;
        oi.note = from.note;
        return oi;
    }
    //subgroups (does not include main group) is used to find the proper position of the item
    transferSubitems(oi, subgroups) {
        var gids = subgroups.map(function (g) { return g.id; });
        for (let ig of oi.groups.slice(1)) {
            let index = gids.indexOf(ig.id);
            for (let item of ig.items) {
                this.setItem(ig, item, index + 1, item.quantity, false, true);
            }
        }
    }
    transferAllItems(oi, subgroups) {
        var gids = subgroups.map(function (g) { return g.id; });
        for (let ig of oi.groups) {
            let index = gids.indexOf(ig.id);
            for (let item of ig.items) {
                this.setItem(ig, item, index + 1, item.quantity, false, true);
            }
        }
    }
    findOriwithStore(oi, store) {
        console.log(store);
        let ocat = store.menu['cmap'][oi.categoryId];
        let gmap = store.menu['gmap'];
        let oigs = ocat ? ocat.groups : [gmap[oi.categoryId]];
        ocat = ocat ? ocat : oi.category;
        var mainItem = oi.groups[0].items[0];
        let oig = gmap[oi.groups[0].id];
        var oitem = oig.items.filter(item => item.id == mainItem.id)[0];
        this.category = ocat;
        console.log("origins", ocat, oigs, oitem);
        return { category: ocat, groups: oigs, item: oitem };
    }
    findOrigins(oi) {
        console.log(this.store);
        let ocat = this.store.menu['cmap'][oi.categoryId];
        let gmap = this.store.menu['gmap'];
        let oigs = ocat ? ocat.groups : [gmap[oi.categoryId]];
        ocat = ocat ? ocat : oi.category;
        var mainItem = oi.groups[0].items[0];
        let oig = gmap[oi.groups[0].id];
        var oitem = oig.items.filter(item => item.id == mainItem.id)[0];
        this.category = ocat;
        let rimap = this.store.menu['rimap'][oitem === null || oitem === void 0 ? void 0 : oitem.id];
        const itemIg = rimap === null || rimap === void 0 ? void 0 : rimap.ig;
        console.log('origins', ocat, oigs, oitem, itemIg);
        return { category: ocat, groups: oigs, item: oitem, itemIg };
    }
    saveQuantity(igIndex, itemId, n, isModifiable = false) {
        var map = this.qmap[igIndex];
        if (!map) {
            map = {};
            this.qmap[igIndex] = map;
            map[itemId] = n > 0 ? n : 0;
        }
        else {
            if (isNaN(map[itemId]))
                map[itemId] = 0;
            if (n > 0) {
                map[itemId] = isModifiable ? map[itemId] + n : n;
            }
            else {
                map[itemId] = map[itemId] + n;
            }
            if (map[itemId] < 0)
                map[itemId] = 0;
        }
        //map[itemId] = n;
    }
    getQuantity(itemId) {
        var total = 0;
        for (let i = 0; i < this.groups.length; i++) {
            total += this.getQuantityInGroup(i, itemId);
        }
        return total;
    }
    getQuantityInGroup(igIndex, itemId) {
        var map = this.qmap[igIndex];
        if (!map)
            return 0;
        var n = map[itemId];
        if (!n)
            return 0;
        return n;
    }
    getSelectedItems(igIndex, filterZeroItem = false) {
        var map = this.qmap[igIndex];
        if (!map)
            return [];
        if (filterZeroItem) {
            var tmpMap = {};
            for (let key in map) {
                if (map[key] > 0) {
                    tmpMap[key] = map[key];
                }
            }
            return Object.keys(tmpMap);
        }
        return Object.keys(map);
    }
    //get the number of selected choices in that group
    getChoices(igIndex) {
        var ig = this.groups[igIndex];
        if (!ig)
            return 0;
        var items = ig.items;
        if (!items)
            return 0;
        let choices = 0;
        items.forEach(i => {
            i.quantity && (choices++);
        });
        return choices;
    }
    updateByOi(oi) {
        let groups = oi === null || oi === void 0 ? void 0 : oi.groups;
        let groups_ = groups === null || groups === void 0 ? void 0 : groups.map(g => {
            var g_ = OrderItemBuilder.cloneIG(g);
            return g_;
        });
        groups_ && (this.groups = groups_);
    }
}


/***/ }),

/***/ 4134:
/*!***********************************************************************************!*\
  !*** ./projects/core/src/app/framework/directives/apply-modal-style.directive.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ApplyModalStyleDirective": () => (/* binding */ ApplyModalStyleDirective)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _pure_services_platform_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../pure/services/platform.service */ 45485);



class ApplyModalStyleDirective {
    constructor(el, platformService) {
        this.el = el;
        this.platformService = platformService;
    }
    ngOnInit() {
        this.setModalStyle();
    }
    setModalStyle() {
        const style = {
            background: "white",
            height: "700px",
            maxHeight: "initial",
            maxWidth: "initial",
            minHeight: "initial",
            minWidth: "initial",
            width: "700px"
        };
        const makeModalStyle = (options) => {
            var result = {};
            if (this.platformService.isMobile()) {
                result.minHeight = "100vh";
                result.maxHeight = "100%";
                result.width = "100%";
                result.height = "100vh";
            }
            else {
                result.minWidth = options.minWidth || 'initial';
                result.maxWidth = options.maxWidth || 'initial';
                result.minHeight = options.minHeight || 'initial';
                result.maxHeight = options.maxHeight || 'initial';
                result.width = options.width || 'initial';
                result.height = options.height || 'initial';
            }
            result.background = options.background || 'white';
            return result;
        };
        var modalStyle = makeModalStyle(style);
        try {
            for (const s in modalStyle) {
                this.el.nativeElement.style[s] = modalStyle[s];
            }
        }
        catch (error) {
            console.log("error:", error);
        }
    }
}
ApplyModalStyleDirective.ɵfac = function ApplyModalStyleDirective_Factory(t) { return new (t || ApplyModalStyleDirective)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_1__.ElementRef), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_0__.PlatformService)); };
ApplyModalStyleDirective.ɵdir = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineDirective"]({ type: ApplyModalStyleDirective, selectors: [["", "applyModalStyle", ""]] });


/***/ }),

/***/ 68941:
/*!************************************************************************!*\
  !*** ./projects/core/src/app/framework/directives/ng-let.directive.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LetDirective": () => (/* binding */ LetDirective)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);


//COPY from https://stackblitz.com/edit/directive-collection-with-examples?file=src%2Fapp%2Fng-let.directive.ts
class LetDirective {
    constructor(vcRef, templateRef) {
        this.vcRef = vcRef;
        this.templateRef = templateRef;
        this.context = {};
    }
    set ngLet(value) {
        // if embeadded view doesn't exist yet create it (only once)
        if (!this._ref)
            this.createView();
        // if value is empty destroy the component
        // here it's acctualy works like ngIf (will rerender on non-empty value)
        if (!value) {
            this._ref.destroy();
            this._ref = undefined;
            return;
        }
        // add the value to the context
        this._ref.context.$implicit = this.context.ngLet = value;
    }
    createView() {
        this.vcRef.clear();
        this._ref = this.vcRef.createEmbeddedView(this.templateRef, this.context);
    }
}
LetDirective.ɵfac = function LetDirective_Factory(t) { return new (t || LetDirective)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewContainerRef), _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.TemplateRef)); };
LetDirective.ɵdir = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineDirective"]({ type: LetDirective, selectors: [["", "ngLet", ""]], inputs: { ngLet: "ngLet" } });


/***/ }),

/***/ 44723:
/*!**************************************************************************!*\
  !*** ./projects/core/src/app/framework/directives/select-by-keyboard.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SelectByKeyboardDirective": () => (/* binding */ SelectByKeyboardDirective),
/* harmony export */   "SelectByKeyboardService": () => (/* binding */ SelectByKeyboardService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);


// import { RoutingService } from '../../../../../core/src/app/pure/services/routing.service';
class SelectByKeyboardDirective {
    constructor(injector, el, selectByKeyboardService) {
        this.injector = injector;
        this.el = el;
        this.selectByKeyboardService = selectByKeyboardService;
    }
    // get routingService() {
    //     return this.injector.get(RoutingService);
    // }
    ngAfterViewInit() {
        this.currentDivElement = this.el.nativeElement;
        this.handle(this.currentDivElement);
        this.observer = new MutationObserver((mutationsList, observer) => {
            for (let mutation of mutationsList) {
                if (mutation.type === 'childList') {
                    this.handle(this.el.nativeElement);
                }
            }
        });
        this.observer.observe(this.currentDivElement, { childList: true });
    }
    isNone(ele) {
        if (!ele)
            return true;
        const isValid = ele.offsetWidth > 0 && ele.offsetHeight > 0;
        return window.getComputedStyle(ele).display === 'none' || !isValid;
    }
    handle(divElement) {
        if (!divElement['_id_']) {
            if (!this.isNone(divElement)) {
                divElement['_id_'] = new Date().getTime();
                this.selectByKeyboardService.addData(divElement);
            }
        }
        else {
            if (this.isNone(divElement)) {
                this.selectByKeyboardService.removeData(divElement);
            }
        }
    }
    ngOnDestroy() {
        var _a, _b;
        this.selectByKeyboardService.removeData(this.currentDivElement);
        ((_a = this.observer) === null || _a === void 0 ? void 0 : _a.disconnect) && ((_b = this.observer) === null || _b === void 0 ? void 0 : _b.disconnect());
    }
}
SelectByKeyboardDirective.ɵfac = function SelectByKeyboardDirective_Factory(t) { return new (t || SelectByKeyboardDirective)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ElementRef), _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](SelectByKeyboardService)); };
SelectByKeyboardDirective.ɵdir = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineDirective"]({ type: SelectByKeyboardDirective, selectors: [["", "appSelectByKeyboard", ""]] });
class SelectByKeyboardService {
    constructor(injector) {
        this.injector = injector;
        this.datas = [];
        this.className = "active_aigens";
        this.listenKeyboard();
    }
    insertStyle(element) {
        var styleContent = `.${this.className} { background: ${this.getActiveBgColor(element)} !important; }`;
        const id = "device-style-active-key-id";
        var style = document.getElementById(id);
        if (style) {
            style.innerText = styleContent;
            return;
        }
        style = document.createElement("style");
        style.innerText = styleContent;
        style.setAttribute('id', id);
        // style.appendChild(document.createTextNode(styleContent));
        document.head.appendChild(style);
    }
    static setCurrentAlert(alert) {
        var _a;
        SelectByKeyboardService._currentAlert = alert;
        (_a = alert === null || alert === void 0 ? void 0 : alert.afterClosed()) === null || _a === void 0 ? void 0 : _a.subscribe((respone) => {
            this.clearCurrentAlert();
        });
    }
    static clearCurrentAlert() {
        SelectByKeyboardService._currentAlert = null;
    }
    // get routingService() {
    //     return this.injector.get(RoutingService);
    // }
    listenKeyboard() {
        window.addEventListener('keydown', event => {
            var _a, _b;
            const key = event === null || event === void 0 ? void 0 : event.key;
            const enabledKeyboardAction = (_b = (_a = window === null || window === void 0 ? void 0 : window['aigensDeviceNormal']) === null || _a === void 0 ? void 0 : _a.keyboardAction) === null || _b === void 0 ? void 0 : _b.enabledKeyboardAction;
            if (enabledKeyboardAction)
                this.handleKeycode(key);
        });
    }
    isNone(ele) {
        if (!ele)
            return true;
        const isValid = ele.offsetWidth > 0 && ele.offsetHeight > 0;
        return window.getComputedStyle(ele).display === 'none' || !isValid;
    }
    processStatus(targetIndex, status) {
        var _a, _b, _c;
        // this.clearInvaild();
        if (!this.datas || !this.datas.length)
            return;
        let target = (_a = this.datas) === null || _a === void 0 ? void 0 : _a[targetIndex];
        if ((_b = target === null || target === void 0 ? void 0 : target.classList) === null || _b === void 0 ? void 0 : _b.contains(this.className))
            return;
        (_c = target === null || target === void 0 ? void 0 : target.classList) === null || _c === void 0 ? void 0 : _c.add(this.className);
        this.insertStyle(target);
    }
    handleKeycode(key) {
        var _a, _b, _c, _d, _e, _f, _g, _h;
        this.clearInvaild();
        const datas = this.datas || [];
        if (!datas.length)
            return;
        let targetIndex = 0;
        switch (key) {
            case 'ArrowUp':
            case 'ArrowLeft':
                for (let i = 0; i < datas.length; i++) {
                    const data = datas[i];
                    if ((_a = data === null || data === void 0 ? void 0 : data.classList) === null || _a === void 0 ? void 0 : _a.contains(this.className)) {
                        targetIndex = (i - 1 < 0) ? 0 : i - 1;
                    }
                    (_b = data === null || data === void 0 ? void 0 : data.classList) === null || _b === void 0 ? void 0 : _b.remove(this.className);
                }
                this.processStatus(targetIndex, 'up');
                break;
            case 'ArrowDown':
            case 'ArrowRight':
                for (let i = 0; i < datas.length; i++) {
                    const data = datas[i];
                    if ((_c = data === null || data === void 0 ? void 0 : data.classList) === null || _c === void 0 ? void 0 : _c.contains(this.className)) {
                        targetIndex = (i + 1 === datas.length) ? 0 : i + 1;
                    }
                    (_d = data === null || data === void 0 ? void 0 : data.classList) === null || _d === void 0 ? void 0 : _d.remove(this.className);
                }
                this.processStatus(targetIndex, 'down');
                break;
            case 'Enter':
                // if (this.routingService.isAux()) {
                //     this.routingService.navigateCloseAllModal();
                //     return;
                // }
                this.datas.forEach(d => {
                    if (this.isInputFocused(d)) {
                        d.blur();
                    }
                });
                if (SelectByKeyboardService._currentAlert) {
                    (_f = (_e = SelectByKeyboardService._currentAlert) === null || _e === void 0 ? void 0 : _e.close) === null || _f === void 0 ? void 0 : _f.call(_e);
                    return;
                }
                SelectByKeyboardService.clearCurrentAlert();
                const active = (_g = this.datas) === null || _g === void 0 ? void 0 : _g.find(d => { var _a; return (_a = d === null || d === void 0 ? void 0 : d.classList) === null || _a === void 0 ? void 0 : _a.contains(this.className); });
                (_h = active === null || active === void 0 ? void 0 : active.click) === null || _h === void 0 ? void 0 : _h.call(active);
                break;
        }
        this.clearInvaild();
    }
    isInputFocused(ele) {
        var _a, _b;
        return !((_a = ele === null || ele === void 0 ? void 0 : ele.classList) === null || _a === void 0 ? void 0 : _a.contains(this.className)) && ((_b = ele === null || ele === void 0 ? void 0 : ele.tagName) === null || _b === void 0 ? void 0 : _b.toLowerCase().includes('input')) && ele === document.activeElement;
    }
    addData(data) {
        if (!this.datas)
            this.datas = [];
        this.datas.push(data);
    }
    getAllDatas() {
        return this.datas;
    }
    removeData(data) {
        this.datas = this.datas.filter(item => item['_id_'] !== data['_id_']);
    }
    clearInvaild() {
        for (var i = this.datas.length - 1; i >= 0; i--) {
            if (this.isNone(this.datas[i])) {
                this.datas.splice(i, 1);
            }
        }
    }
    clear() {
        this.datas = [];
    }
    getActiveBgColor(ele) {
        var _a, _b, _c, _d;
        const configBg = (_b = (_a = window === null || window === void 0 ? void 0 : window['aigensDeviceNormal']) === null || _a === void 0 ? void 0 : _a.keyboardAction) === null || _b === void 0 ? void 0 : _b['activeBg'];
        if (configBg)
            return configBg;
        if (!ele)
            return "";
        const originBg = window.getComputedStyle(ele).backgroundColor;
        const a = ((_d = (_c = window === null || window === void 0 ? void 0 : window['aigensDeviceNormal']) === null || _c === void 0 ? void 0 : _c.keyboardAction) === null || _d === void 0 ? void 0 : _d['activeBgTransparency']) || 0.3;
        if (originBg.startsWith('rgb(')) {
            return originBg.replace("rgb(", "rgba(").replace(')', `,${a})`);
        }
        let bigint = parseInt(originBg.replace('#', ''), 16);
        let r = (bigint >> 16) & 255;
        let g = (bigint >> 8) & 255;
        let b = bigint & 255;
        return `rgba(${r},${g},${b},${a})`;
    }
}
SelectByKeyboardService.ɵfac = function SelectByKeyboardService_Factory(t) { return new (t || SelectByKeyboardService)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injector)); };
SelectByKeyboardService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({ token: SelectByKeyboardService, factory: SelectByKeyboardService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 48297:
/*!**********************************************************************!*\
  !*** ./projects/core/src/app/framework/directives/throttle-click.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ThrottleClickDirective": () => (/* binding */ ThrottleClickDirective)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs/operators */ 35004);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ 80228);




class ThrottleClickDirective {
    constructor() {
        this.throttleTime = 300;
        this.throttleClick = new _angular_core__WEBPACK_IMPORTED_MODULE_0__.EventEmitter();
        this.clicks = new rxjs__WEBPACK_IMPORTED_MODULE_1__.Subject();
    }
    ngOnInit() {
        this.subscription = this.clicks.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.throttleTime)(this.throttleTime)).subscribe(e => this.throttleClick.emit(e));
    }
    ngOnDestroy() {
        this.subscription.unsubscribe();
    }
    clickEvent(event) {
        event.preventDefault();
        event.stopPropagation();
        this.clicks.next(event);
    }
}
ThrottleClickDirective.ɵfac = function ThrottleClickDirective_Factory(t) { return new (t || ThrottleClickDirective)(); };
ThrottleClickDirective.ɵdir = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineDirective"]({ type: ThrottleClickDirective, selectors: [["", "appThrottleClick", ""]], hostBindings: function ThrottleClickDirective_HostBindings(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵlistener"]("click", function ThrottleClickDirective_click_HostBindingHandler($event) { return ctx.clickEvent($event); });
    } }, inputs: { throttleTime: "throttleTime" }, outputs: { throttleClick: "throttleClick" } });


/***/ }),

/***/ 25443:
/*!*************************************************************!*\
  !*** ./projects/core/src/app/framework/framework.module.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FrameworkModule": () => (/* binding */ FrameworkModule)
/* harmony export */ });
/* harmony import */ var _services_error_handler_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./services/error-handler.service */ 57278);
/* harmony import */ var _pipes_point_display_pipe__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./pipes/point-display.pipe */ 21963);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! @angular/common/http */ 28784);
/* harmony import */ var _pipes_getDateStringLabelPipe__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./pipes/getDateStringLabelPipe */ 26709);
/* harmony import */ var _pipes_sort_by_pipe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pipes/sort-by.pipe */ 42832);
/* harmony import */ var _pipes_flatten_item_pipe__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./pipes/flatten-item.pipe */ 96841);
/* harmony import */ var _pipes_timeStringLabelPipe__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./pipes/timeStringLabelPipe */ 18181);
/* harmony import */ var _pipes_custom_filter_pipe__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./pipes/custom-filter.pipe */ 8803);
/* harmony import */ var _pipes_safe_html_pipe__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./pipes/safe-html.pipe */ 51625);
/* harmony import */ var _pipes_price_display_pipe__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./pipes/price-display.pipe */ 93985);
/* harmony import */ var _pipes_item_price_pipe__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./pipes/item-price.pipe */ 51432);
/* harmony import */ var _directives_ng_let_directive__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./directives/ng-let.directive */ 68941);
/* harmony import */ var _directives_throttle_click__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./directives/throttle-click */ 48297);
/* harmony import */ var _pipes_status_display_pipe__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./pipes/status-display.pipe */ 18073);
/* harmony import */ var _pipes_resort_or_filter_unlock_item_pipe__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./pipes/resort-or-filter-unlock-item.pipe */ 13591);
/* harmony import */ var _pipes_remove_item_variations_pipe__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./pipes/remove-item-variations.pipe */ 58144);
/* harmony import */ var _pipes_date_locale_pipe__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./pipes/date-locale.pipe */ 63754);
/* harmony import */ var _pipes_sub_store_name_by_id_pipe__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./pipes/sub-store-name-by-id.pipe */ 24778);
/* harmony import */ var _directives_apply_modal_style_directive__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./directives/apply-modal-style.directive */ 4134);
/* harmony import */ var _pipes_point_to_cash_pipe__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./pipes/point-to-cash.pipe */ 74133);
/* harmony import */ var _pipes_sanitize_pipe__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./pipes/sanitize.pipe */ 20322);
/* harmony import */ var _pipes_combine_order_status_pipe__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./pipes/combine-order-status.pipe */ 84925);
/* harmony import */ var _pipes_text_ellipsis_pipe__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./pipes/text-ellipsis.pipe */ 74043);
/* harmony import */ var _pipes_ewallet_pipe__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./pipes/ewallet.pipe */ 33270);
/* harmony import */ var _pipes_number_display_pipe__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./pipes/number-display.pipe */ 94062);
/* harmony import */ var _pipes_form_translate_pipe__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./pipes/form-translate.pipe */ 69745);
/* harmony import */ var _pipes_form_error_message_pipe__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./pipes/form-error-message.pipe */ 83183);
/* harmony import */ var _directives_select_by_keyboard__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./directives/select-by-keyboard */ 44723);
































const PIPES = [
    _pipes_getDateStringLabelPipe__WEBPACK_IMPORTED_MODULE_2__.GetDateStringLabelPipe,
    _pipes_sort_by_pipe__WEBPACK_IMPORTED_MODULE_3__.SortByPipe,
    _pipes_flatten_item_pipe__WEBPACK_IMPORTED_MODULE_4__.FlattenItemPipe,
    _pipes_resort_or_filter_unlock_item_pipe__WEBPACK_IMPORTED_MODULE_13__.ResortOrFilterUnlockItemPipe,
    _pipes_remove_item_variations_pipe__WEBPACK_IMPORTED_MODULE_14__.RemoveItemVariationsPipe,
    _pipes_timeStringLabelPipe__WEBPACK_IMPORTED_MODULE_5__.TimeStringLabelPipe,
    _pipes_custom_filter_pipe__WEBPACK_IMPORTED_MODULE_6__.CustomFilterPipe,
    _pipes_safe_html_pipe__WEBPACK_IMPORTED_MODULE_7__.SafeHtmlPipe,
    _pipes_price_display_pipe__WEBPACK_IMPORTED_MODULE_8__.PriceDisplayPipe,
    _pipes_item_price_pipe__WEBPACK_IMPORTED_MODULE_9__.ItemPricePipe,
    _pipes_status_display_pipe__WEBPACK_IMPORTED_MODULE_12__.StatusDisplayPipe,
    _pipes_date_locale_pipe__WEBPACK_IMPORTED_MODULE_15__.DateLocalePipe,
    _pipes_sub_store_name_by_id_pipe__WEBPACK_IMPORTED_MODULE_16__.SubStoreNameByIdPipe,
    _pipes_point_to_cash_pipe__WEBPACK_IMPORTED_MODULE_18__.PointToCashPipe,
    _pipes_sanitize_pipe__WEBPACK_IMPORTED_MODULE_19__.SanitizePipe,
    _pipes_combine_order_status_pipe__WEBPACK_IMPORTED_MODULE_20__.CombineOrderStatusPipe,
    _pipes_point_display_pipe__WEBPACK_IMPORTED_MODULE_1__.PointDisplay,
    _pipes_text_ellipsis_pipe__WEBPACK_IMPORTED_MODULE_21__.TextEllipsisPipe,
    _pipes_combine_order_status_pipe__WEBPACK_IMPORTED_MODULE_20__.CombineOrderStatusPipe,
    _pipes_ewallet_pipe__WEBPACK_IMPORTED_MODULE_22__.EwalletPipe,
    _pipes_number_display_pipe__WEBPACK_IMPORTED_MODULE_23__.NumberDisplayPipe,
    _pipes_form_translate_pipe__WEBPACK_IMPORTED_MODULE_24__.FormTranslatePipe,
    _pipes_form_error_message_pipe__WEBPACK_IMPORTED_MODULE_25__.FormErrorMessagePipe,
];
const DIRECTIVES = [_directives_ng_let_directive__WEBPACK_IMPORTED_MODULE_10__.LetDirective, _directives_throttle_click__WEBPACK_IMPORTED_MODULE_11__.ThrottleClickDirective, _directives_apply_modal_style_directive__WEBPACK_IMPORTED_MODULE_17__.ApplyModalStyleDirective, _directives_select_by_keyboard__WEBPACK_IMPORTED_MODULE_26__.SelectByKeyboardDirective];
class FrameworkModule {
}
FrameworkModule.ɵfac = function FrameworkModule_Factory(t) { return new (t || FrameworkModule)(); };
FrameworkModule.ɵmod = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_27__["ɵɵdefineNgModule"]({ type: FrameworkModule });
FrameworkModule.ɵinj = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_27__["ɵɵdefineInjector"]({ providers: [
        _pipes_combine_order_status_pipe__WEBPACK_IMPORTED_MODULE_20__.CombineOrderStatusPipe,
        _pipes_number_display_pipe__WEBPACK_IMPORTED_MODULE_23__.NumberDisplayPipe,
        {
            provide: _angular_core__WEBPACK_IMPORTED_MODULE_27__.ErrorHandler,
            useClass: _services_error_handler_service__WEBPACK_IMPORTED_MODULE_0__.ErrorHandlerService,
        },
    ], imports: [_angular_common__WEBPACK_IMPORTED_MODULE_28__.CommonModule,
        _angular_common_http__WEBPACK_IMPORTED_MODULE_29__.HttpClientModule,
        _ngx_translate_core__WEBPACK_IMPORTED_MODULE_30__.TranslateModule] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && _angular_core__WEBPACK_IMPORTED_MODULE_27__["ɵɵsetNgModuleScope"](FrameworkModule, { declarations: [_pipes_getDateStringLabelPipe__WEBPACK_IMPORTED_MODULE_2__.GetDateStringLabelPipe,
        _pipes_sort_by_pipe__WEBPACK_IMPORTED_MODULE_3__.SortByPipe,
        _pipes_flatten_item_pipe__WEBPACK_IMPORTED_MODULE_4__.FlattenItemPipe,
        _pipes_resort_or_filter_unlock_item_pipe__WEBPACK_IMPORTED_MODULE_13__.ResortOrFilterUnlockItemPipe,
        _pipes_remove_item_variations_pipe__WEBPACK_IMPORTED_MODULE_14__.RemoveItemVariationsPipe,
        _pipes_timeStringLabelPipe__WEBPACK_IMPORTED_MODULE_5__.TimeStringLabelPipe,
        _pipes_custom_filter_pipe__WEBPACK_IMPORTED_MODULE_6__.CustomFilterPipe,
        _pipes_safe_html_pipe__WEBPACK_IMPORTED_MODULE_7__.SafeHtmlPipe,
        _pipes_price_display_pipe__WEBPACK_IMPORTED_MODULE_8__.PriceDisplayPipe,
        _pipes_item_price_pipe__WEBPACK_IMPORTED_MODULE_9__.ItemPricePipe,
        _pipes_status_display_pipe__WEBPACK_IMPORTED_MODULE_12__.StatusDisplayPipe,
        _pipes_date_locale_pipe__WEBPACK_IMPORTED_MODULE_15__.DateLocalePipe,
        _pipes_sub_store_name_by_id_pipe__WEBPACK_IMPORTED_MODULE_16__.SubStoreNameByIdPipe,
        _pipes_point_to_cash_pipe__WEBPACK_IMPORTED_MODULE_18__.PointToCashPipe,
        _pipes_sanitize_pipe__WEBPACK_IMPORTED_MODULE_19__.SanitizePipe,
        _pipes_combine_order_status_pipe__WEBPACK_IMPORTED_MODULE_20__.CombineOrderStatusPipe,
        _pipes_point_display_pipe__WEBPACK_IMPORTED_MODULE_1__.PointDisplay,
        _pipes_text_ellipsis_pipe__WEBPACK_IMPORTED_MODULE_21__.TextEllipsisPipe,
        _pipes_combine_order_status_pipe__WEBPACK_IMPORTED_MODULE_20__.CombineOrderStatusPipe,
        _pipes_ewallet_pipe__WEBPACK_IMPORTED_MODULE_22__.EwalletPipe,
        _pipes_number_display_pipe__WEBPACK_IMPORTED_MODULE_23__.NumberDisplayPipe,
        _pipes_form_translate_pipe__WEBPACK_IMPORTED_MODULE_24__.FormTranslatePipe,
        _pipes_form_error_message_pipe__WEBPACK_IMPORTED_MODULE_25__.FormErrorMessagePipe, _directives_ng_let_directive__WEBPACK_IMPORTED_MODULE_10__.LetDirective, _directives_throttle_click__WEBPACK_IMPORTED_MODULE_11__.ThrottleClickDirective, _directives_apply_modal_style_directive__WEBPACK_IMPORTED_MODULE_17__.ApplyModalStyleDirective, _directives_select_by_keyboard__WEBPACK_IMPORTED_MODULE_26__.SelectByKeyboardDirective], imports: [_angular_common__WEBPACK_IMPORTED_MODULE_28__.CommonModule,
        _angular_common_http__WEBPACK_IMPORTED_MODULE_29__.HttpClientModule,
        _ngx_translate_core__WEBPACK_IMPORTED_MODULE_30__.TranslateModule], exports: [_pipes_getDateStringLabelPipe__WEBPACK_IMPORTED_MODULE_2__.GetDateStringLabelPipe,
        _pipes_sort_by_pipe__WEBPACK_IMPORTED_MODULE_3__.SortByPipe,
        _pipes_flatten_item_pipe__WEBPACK_IMPORTED_MODULE_4__.FlattenItemPipe,
        _pipes_resort_or_filter_unlock_item_pipe__WEBPACK_IMPORTED_MODULE_13__.ResortOrFilterUnlockItemPipe,
        _pipes_remove_item_variations_pipe__WEBPACK_IMPORTED_MODULE_14__.RemoveItemVariationsPipe,
        _pipes_timeStringLabelPipe__WEBPACK_IMPORTED_MODULE_5__.TimeStringLabelPipe,
        _pipes_custom_filter_pipe__WEBPACK_IMPORTED_MODULE_6__.CustomFilterPipe,
        _pipes_safe_html_pipe__WEBPACK_IMPORTED_MODULE_7__.SafeHtmlPipe,
        _pipes_price_display_pipe__WEBPACK_IMPORTED_MODULE_8__.PriceDisplayPipe,
        _pipes_item_price_pipe__WEBPACK_IMPORTED_MODULE_9__.ItemPricePipe,
        _pipes_status_display_pipe__WEBPACK_IMPORTED_MODULE_12__.StatusDisplayPipe,
        _pipes_date_locale_pipe__WEBPACK_IMPORTED_MODULE_15__.DateLocalePipe,
        _pipes_sub_store_name_by_id_pipe__WEBPACK_IMPORTED_MODULE_16__.SubStoreNameByIdPipe,
        _pipes_point_to_cash_pipe__WEBPACK_IMPORTED_MODULE_18__.PointToCashPipe,
        _pipes_sanitize_pipe__WEBPACK_IMPORTED_MODULE_19__.SanitizePipe,
        _pipes_combine_order_status_pipe__WEBPACK_IMPORTED_MODULE_20__.CombineOrderStatusPipe,
        _pipes_point_display_pipe__WEBPACK_IMPORTED_MODULE_1__.PointDisplay,
        _pipes_text_ellipsis_pipe__WEBPACK_IMPORTED_MODULE_21__.TextEllipsisPipe,
        _pipes_combine_order_status_pipe__WEBPACK_IMPORTED_MODULE_20__.CombineOrderStatusPipe,
        _pipes_ewallet_pipe__WEBPACK_IMPORTED_MODULE_22__.EwalletPipe,
        _pipes_number_display_pipe__WEBPACK_IMPORTED_MODULE_23__.NumberDisplayPipe,
        _pipes_form_translate_pipe__WEBPACK_IMPORTED_MODULE_24__.FormTranslatePipe,
        _pipes_form_error_message_pipe__WEBPACK_IMPORTED_MODULE_25__.FormErrorMessagePipe, _directives_ng_let_directive__WEBPACK_IMPORTED_MODULE_10__.LetDirective, _directives_throttle_click__WEBPACK_IMPORTED_MODULE_11__.ThrottleClickDirective, _directives_apply_modal_style_directive__WEBPACK_IMPORTED_MODULE_17__.ApplyModalStyleDirective, _directives_select_by_keyboard__WEBPACK_IMPORTED_MODULE_26__.SelectByKeyboardDirective] }); })();


/***/ }),

/***/ 44651:
/*!**************************************************!*\
  !*** ./projects/core/src/app/framework/index.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AQuery": () => (/* reexport safe */ _base_aquery__WEBPACK_IMPORTED_MODULE_0__.AQuery),
/* harmony export */   "AnalyticsService": () => (/* reexport safe */ _services_analytics_service__WEBPACK_IMPORTED_MODULE_23__.AnalyticsService),
/* harmony export */   "BaseApp": () => (/* reexport safe */ _base_base_app__WEBPACK_IMPORTED_MODULE_1__.BaseApp),
/* harmony export */   "BaseComponent": () => (/* reexport safe */ _base_base_component__WEBPACK_IMPORTED_MODULE_2__.BaseComponent),
/* harmony export */   "BaseContext": () => (/* reexport safe */ _base_base_context__WEBPACK_IMPORTED_MODULE_3__.BaseContext),
/* harmony export */   "BasePage": () => (/* reexport safe */ _base_base_page__WEBPACK_IMPORTED_MODULE_4__.BasePage),
/* harmony export */   "BaseService": () => (/* reexport safe */ _base_base_service__WEBPACK_IMPORTED_MODULE_5__.BaseService),
/* harmony export */   "ConfigService": () => (/* reexport safe */ _services_config_service__WEBPACK_IMPORTED_MODULE_24__.ConfigService),
/* harmony export */   "Context": () => (/* reexport safe */ _services_context_service__WEBPACK_IMPORTED_MODULE_26__.Context),
/* harmony export */   "ContextManager": () => (/* reexport safe */ _services_context_manager_service__WEBPACK_IMPORTED_MODULE_25__.ContextManager),
/* harmony export */   "CustomFilterPipe": () => (/* reexport safe */ _pipes_custom_filter_pipe__WEBPACK_IMPORTED_MODULE_15__.CustomFilterPipe),
/* harmony export */   "DataService": () => (/* reexport safe */ _services_data_service__WEBPACK_IMPORTED_MODULE_27__.DataService),
/* harmony export */   "DialogService": () => (/* reexport safe */ _services_dialog_service__WEBPACK_IMPORTED_MODULE_28__.DialogService),
/* harmony export */   "DiscountManager": () => (/* reexport safe */ _managers_discount_manager__WEBPACK_IMPORTED_MODULE_9__.DiscountManager),
/* harmony export */   "FlattenItemPipe": () => (/* reexport safe */ _pipes_flatten_item_pipe__WEBPACK_IMPORTED_MODULE_16__.FlattenItemPipe),
/* harmony export */   "FrameworkModule": () => (/* reexport safe */ _framework_module__WEBPACK_IMPORTED_MODULE_8__.FrameworkModule),
/* harmony export */   "GetDateStringLabelPipe": () => (/* reexport safe */ _pipes_getDateStringLabelPipe__WEBPACK_IMPORTED_MODULE_17__.GetDateStringLabelPipe),
/* harmony export */   "InventoryManager": () => (/* reexport safe */ _managers_inventory_manager__WEBPACK_IMPORTED_MODULE_10__.InventoryManager),
/* harmony export */   "LocationService": () => (/* reexport safe */ _services_location_service__WEBPACK_IMPORTED_MODULE_29__.LocationService),
/* harmony export */   "MemberContext": () => (/* reexport safe */ _services_member_context_service__WEBPACK_IMPORTED_MODULE_31__.MemberContext),
/* harmony export */   "MemberContextManager": () => (/* reexport safe */ _services_member_context_manager_service__WEBPACK_IMPORTED_MODULE_30__.MemberContextManager),
/* harmony export */   "MenuManager": () => (/* reexport safe */ _managers_menu_manager__WEBPACK_IMPORTED_MODULE_11__.MenuManager),
/* harmony export */   "ModifierBuilder": () => (/* reexport safe */ _base_modifier_builder__WEBPACK_IMPORTED_MODULE_6__.ModifierBuilder),
/* harmony export */   "OrderContext": () => (/* reexport safe */ _services_order_context_service__WEBPACK_IMPORTED_MODULE_32__.OrderContext),
/* harmony export */   "OrderItemBuilder": () => (/* reexport safe */ _base_orderitem_builder__WEBPACK_IMPORTED_MODULE_7__.OrderItemBuilder),
/* harmony export */   "OrderManager": () => (/* reexport safe */ _managers_order_manager__WEBPACK_IMPORTED_MODULE_12__.OrderManager),
/* harmony export */   "PriceManager": () => (/* reexport safe */ _managers_price_manager__WEBPACK_IMPORTED_MODULE_13__.PriceManager),
/* harmony export */   "RecommendationManager": () => (/* reexport safe */ _managers_recommendation_manager__WEBPACK_IMPORTED_MODULE_14__.RecommendationManager),
/* harmony export */   "RemoveItemVariationsPipe": () => (/* reexport safe */ _pipes_remove_item_variations_pipe__WEBPACK_IMPORTED_MODULE_18__.RemoveItemVariationsPipe),
/* harmony export */   "ResortOrFilterUnlockItemPipe": () => (/* reexport safe */ _pipes_resort_or_filter_unlock_item_pipe__WEBPACK_IMPORTED_MODULE_19__.ResortOrFilterUnlockItemPipe),
/* harmony export */   "SafeHtmlPipe": () => (/* reexport safe */ _pipes_safe_html_pipe__WEBPACK_IMPORTED_MODULE_20__.SafeHtmlPipe),
/* harmony export */   "SortByPipe": () => (/* reexport safe */ _pipes_sort_by_pipe__WEBPACK_IMPORTED_MODULE_21__.SortByPipe),
/* harmony export */   "StorageService": () => (/* reexport safe */ _services_storage_service__WEBPACK_IMPORTED_MODULE_33__.StorageService),
/* harmony export */   "TextToSpeechService": () => (/* reexport safe */ _services_text_to_speech_service__WEBPACK_IMPORTED_MODULE_35__.TextToSpeechService),
/* harmony export */   "ThemeColorService": () => (/* reexport safe */ _services_theme_color_service__WEBPACK_IMPORTED_MODULE_34__.ThemeColorService),
/* harmony export */   "TimeStringLabelPipe": () => (/* reexport safe */ _pipes_timeStringLabelPipe__WEBPACK_IMPORTED_MODULE_22__.TimeStringLabelPipe)
/* harmony export */ });
/* harmony import */ var _base_aquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base/aquery */ 33759);
/* harmony import */ var _base_base_app__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base/base-app */ 3308);
/* harmony import */ var _base_base_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./base/base-component */ 22963);
/* harmony import */ var _base_base_context__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./base/base-context */ 76309);
/* harmony import */ var _base_base_page__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./base/base-page */ 74522);
/* harmony import */ var _base_base_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./base/base-service */ 9110);
/* harmony import */ var _base_modifier_builder__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./base/modifier-builder */ 89071);
/* harmony import */ var _base_orderitem_builder__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./base/orderitem-builder */ 6949);
/* harmony import */ var _framework_module__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./framework.module */ 25443);
/* harmony import */ var _managers_discount_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./managers/discount-manager */ 56858);
/* harmony import */ var _managers_inventory_manager__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./managers/inventory-manager */ 84539);
/* harmony import */ var _managers_menu_manager__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./managers/menu-manager */ 4451);
/* harmony import */ var _managers_order_manager__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./managers/order-manager */ 95149);
/* harmony import */ var _managers_price_manager__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./managers/price-manager */ 31372);
/* harmony import */ var _managers_recommendation_manager__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./managers/recommendation-manager */ 91715);
/* harmony import */ var _pipes_custom_filter_pipe__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./pipes/custom-filter.pipe */ 8803);
/* harmony import */ var _pipes_flatten_item_pipe__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./pipes/flatten-item.pipe */ 96841);
/* harmony import */ var _pipes_getDateStringLabelPipe__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./pipes/getDateStringLabelPipe */ 26709);
/* harmony import */ var _pipes_remove_item_variations_pipe__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./pipes/remove-item-variations.pipe */ 58144);
/* harmony import */ var _pipes_resort_or_filter_unlock_item_pipe__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./pipes/resort-or-filter-unlock-item.pipe */ 13591);
/* harmony import */ var _pipes_safe_html_pipe__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./pipes/safe-html.pipe */ 51625);
/* harmony import */ var _pipes_sort_by_pipe__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./pipes/sort-by.pipe */ 42832);
/* harmony import */ var _pipes_timeStringLabelPipe__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./pipes/timeStringLabelPipe */ 18181);
/* harmony import */ var _services_analytics_service__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./services/analytics.service */ 4297);
/* harmony import */ var _services_config_service__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./services/config.service */ 2171);
/* harmony import */ var _services_context_manager_service__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./services/context-manager.service */ 98235);
/* harmony import */ var _services_context_service__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./services/context.service */ 73769);
/* harmony import */ var _services_data_service__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./services/data.service */ 1024);
/* harmony import */ var _services_dialog_service__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./services/dialog.service */ 69104);
/* harmony import */ var _services_location_service__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./services/location.service */ 11758);
/* harmony import */ var _services_member_context_manager_service__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./services/member-context-manager.service */ 67167);
/* harmony import */ var _services_member_context_service__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./services/member-context.service */ 2831);
/* harmony import */ var _services_order_context_service__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./services/order-context.service */ 63058);
/* harmony import */ var _services_storage_service__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./services/storage.service */ 24430);
/* harmony import */ var _services_theme_color_service__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./services/theme-color.service */ 99731);
/* harmony import */ var _services_text_to_speech_service__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./services/text-to-speech.service */ 14221);







































/***/ }),

/***/ 56858:
/*!**********************************************************************!*\
  !*** ./projects/core/src/app/framework/managers/discount-manager.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DiscountManager": () => (/* binding */ DiscountManager)
/* harmony export */ });
/* harmony import */ var aigens_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-data */ 51707);
/* harmony import */ var _menu_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./menu-manager */ 4451);
/* harmony import */ var _order_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./order-manager */ 95149);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ 3184);





/**
 * This discount manager is used to
 * calculate all discounts applied for current order
 * @function applyPromotion: apply all discounts orderly by priority,
 *           and calculate the order grand total
 * @function apply: apply one discount, check if all conditions are satisfied
 *           and then apply discount via main condition
 * **/
class DiscountManager {
    constructor(injector) {
        this.orderManager = injector.get(_order_manager__WEBPACK_IMPORTED_MODULE_2__.OrderManager);
        this.menuManager = injector.get(_menu_manager__WEBPACK_IMPORTED_MODULE_1__.MenuManager);
    }
    /**apply discount, by priority (sorted on server)
     *can apply multiple discounts
     * **/
    applyPromotions(order, promotions, orderManager) {
        order.discount = 0;
        order.discounts = [];
        let applied = 0;
        //for duplicated promos (cdc coupon) fix itemgroup_count, can support mainitem only
        //reset applied for all mainitems/ a le carte
        for (let oi of order.orderitems) {
            let group = oi.groups[0];
            oi['tmpApplied'] = 0;
            oi['discountClaimed'] = 0;
            oi.discounts = [];
            oi.discount = 0;
        }
        order.promotions = this.sortDiscountPrioInDescending(promotions);
        let _orderManager = orderManager ? orderManager : this.orderManager;
        for (let promo of promotions) {
            if (applied && promo.alone) {
                //reset the condition applicable
                for (let c of promo.conditions) {
                    c.applicable = 0;
                }
                continue;
            }
            let success = this.apply(order, promo, orderManager);
            _orderManager.calcDiscountGrandTotal(order);
            if (success && promo.benefits[0] && promo.benefits[0].isDiscount()) {
                if (promo.alone)
                    applied++;
                console.log("applied ", promo.name);
            }
        }
        // in case calculate new tax
        _orderManager.calcDiscountGrandTotal(order);
    }
    sortDiscountPrioInDescending(promos) {
        promos = promos.sort((a, b) => (b.priority - a.priority));
        return promos;
    }
    sortOrderItemInAscendingOrder(order) {
        if (order && order.orderitems) {
            order.orderitems = order.orderitems.sort((a, b) => (a.total - b.total));
        }
    }
    /**
     * Apply one single discount
     * check all conditions
     * take main condition to apply discount
     * **/
    checkPromotionConditionCanApply(order, promo, store) {
        let conditions = promo.conditions;
        let benefits = promo.benefits;
        promo.available = 0;
        let now = this.menuManager.getTime(store);
        if (promo && promo.periods && promo.periods.length > 0) {
            if (!this.menuManager.isAvailabeByPeriods(store, promo.periods, now)) {
                return false;
            }
        }
        if (!conditions || conditions.length === 0 || !benefits || benefits.length === 0 || !promo.enabled) {
            return false;
        }
        let ok = true;
        conditions.forEach(c => {
            if (c instanceof aigens_data__WEBPACK_IMPORTED_MODULE_0__.Condition) {
                if (ok && !c.isSatisfied(order, promo))
                    ok = false;
            }
            else {
                let condition = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Condition.cloneCondition(c);
                if (ok && !condition.isSatisfied(order, promo))
                    ok = false;
            }
        });
        return ok;
    }
    apply(order, promo, orderManager) {
        let _orderManager = orderManager ? orderManager : this.orderManager;
        let conditions = promo.conditions;
        let benefits = promo.benefits;
        promo.available = 0;
        console.log("applying discount...");
        console.log("conditions:", conditions);
        console.log("benefits:", benefits);
        console.log("order", order);
        console.log("discount", promo);
        let now = this.menuManager.getTime(_orderManager.store);
        if (promo && promo.periods && promo.periods.length > 0) {
            if (!this.menuManager.isAvailabeByPeriods(_orderManager.store, promo.periods, now)) {
                //reset applicable
                promo.conditions.forEach(con => {
                    con.applicable = 0;
                });
                return false;
            }
        }
        if (!conditions || conditions.length === 0 || !benefits || benefits.length === 0 || !promo.enabled)
            return false;
        if (!this.checkGroupPriority(order, promo))
            return false;
        let ok = true;
        conditions.forEach(c => {
            // if (ok && !c.isSatisfied(order, promo)) ok = false;
            if (c instanceof aigens_data__WEBPACK_IMPORTED_MODULE_0__.Condition) {
                if (ok && !c.isSatisfied(order, promo))
                    ok = false;
            }
            else {
                let condition = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Condition.cloneCondition(c);
                if (ok && !condition.isSatisfied(order, promo))
                    ok = false;
            }
        });
        if (ok) { // all conditions are satisfied
            let p = this.getStoreGrandTotalPrecision(_orderManager.store.currency);
            let c = this.getMainCondition(conditions);
            let b = promo.benefits[0];
            b.applied = false; // reset benefit.applied
            let amount = c.apply(order, promo, b, _orderManager.store, p);
            promo.available = 1;
            console.log("condition ok ", c.display);
            console.log("applying discount amount: ", amount);
            promo.level = c.level;
            if (amount > 0) { //calculable discount
                amount = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(amount, 2);
                promo.amount = amount;
                promo.quantity = 1;
                order.discounts.push(promo);
                let totalDeduct = amount;
                console.log("Total deduct: ", totalDeduct);
                let grandTotal = order.grandTotal - totalDeduct;
                let discount = order.discount + totalDeduct;
                order.grandTotal = grandTotal;
                order.discount = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(discount, p);
            }
            else if (b.applied) { //unlock a new discount, or gift discount (not calculable)
                order.discounts.push(promo);
            }
            else {
                console.log("skipping-", promo.name, ": conditions satisfied, benefit not applicable");
                ok = false; //if apply at least one discount
            }
        }
        else {
            promo.available = 0;
            // 不满足所有conditions 改变 benefit.acpplied = false
            promo && promo.benefits && promo.benefits[0] && (promo.benefits[0].applied = false);
        }
        return ok;
    }
    checkGroupPriority(order, promo) {
        let canApply = true;
        if (order.discounts.length > 0) { // filter group &
            let discountGroupMap = {};
            order.discounts.map((d) => {
                if (d.group) {
                    discountGroupMap[d.group] = discountGroupMap[d.group] ? discountGroupMap[d.group].push([d]) : discountGroupMap[d.group] = [d];
                }
            });
            if (discountGroupMap[promo.group]) {
                let sameGroupDiscounts = discountGroupMap[promo.group];
                sameGroupDiscounts.map((gd) => {
                    if (gd.priority > promo.priority) {
                        canApply = false;
                    }
                });
            }
        }
        if (!canApply) {
            if (promo.benefits && promo.benefits[0] && promo.benefits[0].applied) {
                promo.benefits[0].applied = false;
                promo.conditions[0].applicable = 0;
            }
        }
        return canApply;
    }
    getStoreGrandTotalPrecision(currency) {
        if (!currency)
            return 1;
        let c = currency.slice(0, 2);
        if ("HK" === c) {
            return 1;
        }
        else if ("SG" === c) {
            return 2;
        }
        else if ("MY" === c) {
            //return "MYR";
        }
        else if ("CN" === c) {
            return 1;
        }
        else if ("TW" === c) {
            //return "TWD";
        }
        else if ("MO" === c) {
            //return "MOP";
        }
        else if ("US" === c) {
            return 2;
        }
        else if ("CA" === c) {
            return 2;
        }
        else if ("IN" === c) {
            //return "INR";
        }
        else if ("VN" === c) {
            //return "VND";
        }
        else if ("AU" === c) {
            return 2;
        }
        else if ("NZ" === c) {
            //return "NZD";
        }
        else if ("KR" === c) {
            //return "KRW";
        }
        else if ("ID" === c) {
            //return "IDR";
        }
        else if ("TH" === c) {
            //return "THB";
        }
        else if ('EU' === c) {
            return 2;
        }
        return 1;
    }
    /**
     * Get main condition for a discount
     * when there is a condition is of item level, the first item level condition is the main condition,
     * otherwise, the first condition is the main condition
     * **/
    getMainCondition(conds) {
        let mainCond;
        conds.forEach(c => {
            if (!mainCond)
                if (c.level == "item")
                    mainCond = c;
        });
        if (!mainCond)
            mainCond = conds[0];
        return mainCond;
    }
    applyWholeOrderDiscounts(order, promotions) {
        order.discount = 0;
        order.discounts = [];
        let applied = 0;
        for (let oi of order.orderitems) {
            oi['tmpApplied'] = 0;
            oi['discountClaimed'] = 0;
            oi.discounts = [];
            oi.discount = 0;
        }
        order.promotions = this.sortDiscountPrioInDescending(promotions);
        for (let promo of promotions) {
            if (applied && promo.alone) {
                //reset the condition applicable
                for (let c of promo.conditions) {
                    c.applicable = 0;
                }
                continue;
            }
            let success = this.applyCourt(order, promo);
            // this.orderManager.calcDiscountGrandTotal(order);
            if (success && promo.benefits[0] && promo.benefits[0].isDiscount()) {
                if (promo.alone)
                    applied++;
                console.log("applied ", promo.name);
            }
        }
        return order;
        // in case calculate new tax
        // this.orderManager.calcDiscountGrandTotal(order);
    }
    applyCourt(order, promo) {
        let conditions = promo.conditions;
        let benefits = promo.benefits;
        promo.available = 0;
        console.log("applying discount...");
        console.log("conditions:", conditions);
        console.log("benefits:", benefits);
        console.log("order", order);
        console.log("discount", promo);
        let ok = true;
        conditions.forEach(c => {
            // if (ok && !c.isSatisfied(order, promo)) ok = false;
            if (c instanceof aigens_data__WEBPACK_IMPORTED_MODULE_0__.Condition) {
                if (ok && !c.isSatisfied(order, promo))
                    ok = false;
            }
            else {
                let condition = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Condition.cloneCondition(c);
                if (ok && !condition.isSatisfied(order, promo))
                    ok = false;
            }
        });
        if (ok) { // all conditions are satisfied
            let c = this.getMainCondition(conditions);
            let b = promo.benefits[0];
            b.applied = false; // reset benefit.applied
            let amount = c.apply(order, promo, b);
            console.log("condition ok ", c.display);
            console.log("applying discount amount: ", amount);
            promo.level = c.level;
            if (amount > 0) { //calculable discount
                amount = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(amount, 2);
                promo.amount = amount;
                promo.quantity = 1;
                order.discounts.push(promo);
                let totalDeduct = amount;
                console.log("Total deduct: ", totalDeduct);
                let grandTotal = order.grandTotal - totalDeduct;
                let discount = order.discount + totalDeduct;
                order.grandTotal = grandTotal;
                // let p = this.getStoreGrandTotalPrecision(this.orderManager.store.currency);
                order.discount = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(discount, 1);
            }
            else if (b.applied) { //unlock a new discount, or gift discount (not calculable)
                order.discounts.push(promo);
            }
            else {
                console.log("skipping-", promo.name, ": conditions satisfied, benefit not applicable");
                ok = false; //if apply at least one discount
            }
        }
        else {
            promo.available = 0;
        }
        return ok;
    }
    getAvailableDiscount(discounts, orderbrandId = null, getWholeDiscounts = false) {
        let arr = [];
        discounts.map((discount) => {
            if (!discount.brandIds || discount.brandIds.length === 0) { //
                getWholeDiscounts && arr.push(discount);
            }
            else {
                !getWholeDiscounts && discount.brandIds.map((brandId) => {
                    brandId === orderbrandId && arr.push(discount);
                });
            }
        });
        return arr;
    }
}
DiscountManager.ɵfac = function DiscountManager_Factory(t) { return new (t || DiscountManager)(_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_3__.Injector)); };
DiscountManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdefineInjectable"]({ token: DiscountManager, factory: DiscountManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 84539:
/*!***********************************************************************!*\
  !*** ./projects/core/src/app/framework/managers/inventory-manager.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "InventoryManager": () => (/* binding */ InventoryManager)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class InventoryManager {
    constructor() {
        this.inventory = {};
        this.version = 0;
    }
    isEmpty() {
        return Object.keys(this.inventory).length === 0;
    }
    getInv(item) {
        var q = null;
        var liveInv = this.inventory;
        if (liveInv && !this.isEmpty()) {
            q = this.getQty(liveInv, item.backendId); // liveInv[item.backendId];
            if (q == null)
                q = this.getQty(liveInv, item.id); //liveInv[item.id];
            if (q == null)
                q = -1;
        }
        else {
            q = item.inventory;
        }
        return q;
    }
    isHidden(item) {
        let qty = this.getInv(item);
        if (qty == -1000) {
            return true;
        }
        return false;
    }
    getQty(inv, itemid) {
        let qty = inv[itemid];
        if (typeof qty === 'undefined') {
            return null;
        }
        return qty;
    }
    isPublish(item) {
        let qty = this.getInv(item);
        if (qty == -1000) {
            return false;
        }
        return item.published;
    }
    isSoldout(item, qty = 1) {
        var inv = this.getInv(item);
        if (inv == -1 || inv == -999)
            return false; //-1=unlimited , -999 = preparing
        if (inv <= 0)
            return true;
        return qty > inv;
    }
    isPreparing(item) {
        var inv = this.getInv(item);
        if (inv == -999)
            return true;
        return false;
    }
    getSoldoutCount(items, qty = 1) {
        let count = 0;
        for (let item of items) {
            let soldout = this.isSoldout(item, qty);
            if (soldout) {
                count++;
            }
        }
        return count;
    }
    set(inventory, version) {
        console.log("inventory", inventory, version);
        if (!inventory)
            inventory = {};
        this.inventory = inventory;
        this.version = version;
    }
    needUpdate(version) {
        console.log("inv version:" + version + ">" + this.version);
        let update = version > this.version;
        console.log("need update inv", update);
        return update;
    }
}
InventoryManager.ɵfac = function InventoryManager_Factory(t) { return new (t || InventoryManager)(); };
InventoryManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({ token: InventoryManager, factory: InventoryManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 4451:
/*!******************************************************************!*\
  !*** ./projects/core/src/app/framework/managers/menu-manager.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MenuManager": () => (/* binding */ MenuManager)
/* harmony export */ });
/* harmony import */ var _pure_services_time_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../../pure/services/time.service */ 72570);
/* harmony import */ var _aigens_core_src_app_framework_services_menu_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aigens/core/src/app/framework/services/menu.util */ 79771);
/* harmony import */ var aigens_data__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aigens-data */ 51707);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! moment */ 84291);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _pure_services_platform_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../pure/services/platform.service */ 45485);
/* harmony import */ var _inventory_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./inventory-manager */ 84539);
/* harmony import */ var aigens_framework__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aigens-framework */ 44651);
/* harmony import */ var _aigens_core_src_app_framework_services_directory_context_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @aigens/core/src/app/framework/services/directory-context.service */ 19757);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/core */ 3184);










class MenuManager {
    constructor(injector) {
        this.showAllCats = false; //a flag in kiosk debug settings showing all categories in any cases
        this.availableMap = {}; //items' available map
        this.availablePreparingMap = {};
        this.debug = false;
        this.legacy = false;
        this.userTypes = [];
        this.needRecalMenuWhenMemberChange = false;
        this.inventoryManager = injector.get(_inventory_manager__WEBPACK_IMPORTED_MODULE_5__.InventoryManager);
        this.platformService = injector.get(_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_4__.PlatformService);
        this.memberContext = injector.get(aigens_framework__WEBPACK_IMPORTED_MODULE_6__.MemberContext);
        this.timeService = injector.get(_pure_services_time_service__WEBPACK_IMPORTED_MODULE_0__.TimeService);
        this.directoryContext = injector.get(_aigens_core_src_app_framework_services_directory_context_service__WEBPACK_IMPORTED_MODULE_7__.DirectoryContext);
    }
    //returns the current time or debug time
    getTime(store = null) {
        var _a;
        if (this.debugTime) {
            return this.debugTime;
        }
        let now = this.convertNowDateToStoreTimeZone(store && store.timezone, (_a = this.directoryContext) === null || _a === void 0 ? void 0 : _a.getUnixTime()).getTime();
        return now;
    }
    convertNowDateToStoreTimeZone(timeZone, time_num) {
        timeZone = timeZone ? timeZone : 'GMT+8';
        let timeZoneValue = timeZone.split('GMT')[1];
        let integerTimeZoneValue = parseInt(timeZoneValue) * 60;
        let now = this.timeService.getTimeObject();
        if (time_num) {
            now = new Date(time_num);
        }
        let timeZoneOffset = now.getTimezoneOffset();
        let newTime = now.getTime() + (timeZoneOffset + integerTimeZoneValue) * 60000;
        now.setTime(newTime);
        return now;
    }
    setDebugTime(time) {
        this.debugTime = time;
    }
    //available map id format
    getAvailableMapId(catId = '', itemId = '') {
        return catId + '-' + itemId;
    }
    clearAvailableMap() {
        this.availableMap = {};
        this.availablePreparingMap = {};
    }
    /*
    getAvailableCategories(store: Store, now: number, takeout:boolean = false): Category[] {



        var menu = store.menu;

        //let showAllCats = this.prefService.getBoolean("debug.show-all-categories", false);
        //let period: string = this.prefService.get("kiosk.period", "auto");


        let categories: Category[] = store.menu.getAvailableCategories(store, showAllCats, period, now);

        let inv: boolean = this.prefService.getBoolean("kiosk.enable-inventory", true);

        let result: Category[] = [];

        categories.forEach(cat => {

            let mainIg: ItemGroup = cat.groups[0];

            let mainItems: Item[] = [];
            mainIg.items.forEach(item => {

                if (this.invManager.isPublish(item) && this.isBetween(item, now)) {
                    mainItems.push(item);
                }

            })

            if(takeout){
                mainItems = mainItems.filter(i => { return !i.dinein });
            }

            if (mainItems.length > 0) {

                for (let item of mainItems) {


                    let soldout: boolean = false;

                    for (let group of item.groups) {

                        let publishs: number = 0;

                        group.items.forEach(item => {

                            if (this.invManager.isPublish(item) && this.isBetween(item, now)) {
                                publishs++;
                            }
                        });

                        let min = group.min;
                        let valid: boolean = true;

                        if (group.repeat) {
                            valid = publishs > 0;
                        } else {
                            valid = publishs >= min;
                        }


                        if (!valid) {

                            soldout = true;
                            break;
                        }
                    }

                    if (item.groups.length == 0) {
                        item.combo = false;
                    }

                    if (soldout && inv) {
                        this.invManager.soldout(item);
                    }

                }

                result.push(cat);

            }

        });

        return result;
    }

*/
    log(tag, ...others) {
        if (!this.debug) {
            return;
        }
        console.log(tag, others);
    }
    /**Get available recommendation category**/
    getAvailableRecommendation(store, now = this.getTime(store), takeout, mode) {
        if (!store || !store.menu) {
            return null;
        }
        var storeOpen = aigens_data__WEBPACK_IMPORTED_MODULE_2__.Store.isOpeningHours(store, now);
        if (!storeOpen) {
            return null;
        }
        if (!store || !store.menu) {
            return null;
        }
        var recommendation = store.menu.recommendation;
        if (!recommendation) {
            return null;
        }
        if (this.isAvailableCategory(store, recommendation, takeout, false, null, mode)) {
            return recommendation;
        }
        return null;
    }
    /**Get available gift categories**/
    getAvailableGifts(store, now = this.getTime(store), takeout, mode) {
        if (!store || !store.menu) {
            return null;
        }
        var storeOpen = aigens_data__WEBPACK_IMPORTED_MODULE_2__.Store.isOpeningHours(store, now);
        if (!storeOpen) {
            return null;
        }
        if (!store || !store.menu) {
            return null;
        }
        var gifts = store.menu.gifts;
        if (!gifts) {
            return null;
        }
        let result = [];
        gifts.forEach((u) => {
            if (this.isAvailableCategory(store, u, takeout, false, null, mode)) {
                result.push(u);
            }
        });
        return result;
    }
    /**Get available unlock categories**/
    getAvailableUnlocks(store, now = this.getTime(store), takeout, mode) {
        if (!store || !store.menu) {
            return null;
        }
        var storeOpen = aigens_data__WEBPACK_IMPORTED_MODULE_2__.Store.isOpeningHours(store, now);
        if (!storeOpen) {
            return null;
        }
        if (!store || !store.menu) {
            return null;
        }
        var unlocks = store.menu.unlocks;
        if (!unlocks) {
            return null;
        }
        let result = [];
        unlocks.forEach((u) => {
            if (this.isAvailableCategory(store, u, takeout, false, null, mode)) {
                result.push(u);
            }
        });
        return result;
    }
    /**Get category's available main items(in main group)**/
    getAvailableMainItems(store, category, takeout, time, mode) {
        var mainIg = category.groups[0];
        if (!mainIg) {
            return [];
        }
        return this.getAvailableItems(store, category, mainIg, takeout, time, mode);
    }
    /**
     * Get availble main items(parent items) in the very group
     * Get parent items available variations
     *  **/
    getAvailableItems(store, category, ig, takeout, time, mode) {
        var now = time || this.getTime(store);
        let items = ig.parentItems;
        if (!items) {
            return [];
        }
        let result = [];
        var channel = this.platformService.getChannel();
        var container = this.platformService.getContainer();
        for (let item of items) {
            if (!this.isAvailableItem(store, category, ig, item, takeout, now, mode) && this.isAvailableChannel(item, channel, container)) {
                if (item.variations && item.variations.length > 0) {
                    item.variations.forEach(v => {
                        if (this.isAvailableItem(store, category, ig, v, takeout, now, mode)) {
                            result.push(v);
                        }
                    });
                }
                continue;
            }
            if (item.variations && item.variations.length > 0) {
                let variation = [];
                item.variations.forEach(v => {
                    if (this.isAvailableItem(store, category, ig, v, takeout, now, mode)) {
                        variation.push(v);
                    }
                });
                item.variations = variation;
            }
            result.push(item);
        }
        if (result.length != items.length) {
            ig.parentItems = result;
            this.log('filtered main items', category.name, items.length + '->' + result.length);
        }
        return result;
    }
    /**
     * Check if item is available, according to rules:
     * 1. dinein-takeout mode
     * 2. inventory
     * 3. available time slots or periods
     * 4. published or not
     * 5. todo: has available required modifiers
     * 6. member tier only
     * **/
    isAvailableItem(store, category, ig, item, takeout, now, mode) {
        if (!this.isAvailableByUserGroup(item)) {
            return false;
        }
        if (!MenuManager.staticMenuMapForOh[store === null || store === void 0 ? void 0 : store.id]) {
            MenuManager.staticMenuMapForOh[store === null || store === void 0 ? void 0 : store.id] = store === null || store === void 0 ? void 0 : store.menu;
        }
        if (this.showAllCats) {
            return true;
        }
        if (item.suspended) {
            return false;
        }
        if (!this.isItemMemberTierAvailable(item, category)) {
            return false;
        }
        if (item.ohId) {
            var brandOh = null;
            if (store.brand) {
                brandOh = store.brand.openings;
            }
            if (store.menu && store.menu.itemOpenings) {
                var ohMap = store.menu.itemOpenings;
                if (ohMap[item.ohId]) {
                    var itemOhMap = ohMap[item.ohId];
                    //console.log("MenuManager.staticMenuForOh.itemOpenings[item.ohId][ohResult]", MenuManager.staticMenuForOh.itemOpenings[item.ohId]["ohResult"]);
                    let itemOpenings = (MenuManager.staticMenuMapForOh[store.id] && MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId]) || {};
                    if (!itemOpenings['ohResult']) {
                        console.log('call check isTimeOpen', item);
                        if (!aigens_data__WEBPACK_IMPORTED_MODULE_2__.OpeningHours.isTimeOpen(brandOh, itemOhMap, now)) {
                            this.log('item openings not available', category.name);
                            itemOpenings['ohResult'] = 1;
                            MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId] = itemOpenings; // 1 for false
                            return false;
                        }
                        itemOpenings['ohResult'] = 2;
                        MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId] = itemOpenings; // 2 for true
                    }
                    else if (MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId] && MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId]['ohResult'] == 2) {
                        // is ok
                    }
                    else {
                        return false;
                    }
                }
            }
        }
        else {
            //if category time not valid, don't show it
            if (!this.isAvailabeByStartEnd(item, now)) {
                this.log('item time not available', item.name);
                return false;
            }
            // if (!this.isAvailabeByPeriods(store, category.periods, now)) {
            //     this.log("cat period not available2", category.name);
            //     return false;
            // }
        }
        //TODO: add item to availableMap??
        //check dinein/takeout mode, *ignore delivery mode in kiosk
        if (!this.isAvailablebyModes(item, takeout, mode)) {
            this.log('item mode filter', item.name, item.modes);
            return false;
        }
        //skip dinein only items DEPRECATED
        /*if (takeout && item.dinein){
            this.log("dine in filter", item.name);
            return false;
        }*/
        //skip items with inventory -1000
        if (this.inventoryManager.isHidden(item)) {
            this.log('inv hidden', item.name);
            return false;
        }
        //check if item have start end time
        if (!this.isAvailabeByStartEnd(item, now)) {
            this.log('start end filter', item.name);
            return false;
        }
        if (!this.isAvailabeByPeriods(store, item.periods, now)) {
            this.log('periods filter', item.name);
            return false;
        }
        if (!this.isItemPublished(category, ig, item)) {
            this.log('cat pub filter', item.name);
            return false;
        }
        if (!this.isAvailableByMenuPeriodMode(store, item.periods, now, mode)) {
            this.log('menu period mode filter', item.name);
            return false;
        }
        return true;
    }
    /**
     * Check if item is available, according to rules:
     * 1. dinein-takeout mode
     * 2. inventory
     * 3. available time slots or periods
     * 4. remove the check published or not logic ===>> different ig has different ig.cmap, so the function isItemPublished is volatile with same item and different cat
     * 5. todo: has available required modifiers
     * 6. member tier only
     * **/
    isAvailableItemWithoutCheckItemPublish(store, category, ig, item, takeout, now, mode) {
        if (!this.isAvailableByUserGroup(item)) {
            return false;
        }
        if (!MenuManager.staticMenuMapForOh[store === null || store === void 0 ? void 0 : store.id]) {
            MenuManager.staticMenuMapForOh[store === null || store === void 0 ? void 0 : store.id] = store === null || store === void 0 ? void 0 : store.menu;
        }
        if (this.showAllCats) {
            return true;
        }
        if (item.suspended) {
            return false;
        }
        if (!this.isItemMemberTierAvailable(item, category)) {
            return false;
        }
        if (item.ohId) {
            var brandOh = null;
            if (store.brand) {
                brandOh = store.brand.openings;
            }
            if (store.menu && store.menu.itemOpenings) {
                var ohMap = store.menu.itemOpenings;
                if (ohMap[item.ohId]) {
                    var itemOhMap = ohMap[item.ohId];
                    //console.log("MenuManager.staticMenuForOh.itemOpenings[item.ohId][ohResult]", MenuManager.staticMenuForOh.itemOpenings[item.ohId]["ohResult"]);
                    let itemOpenings = (MenuManager.staticMenuMapForOh[store.id] && MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId]) || {};
                    if (!itemOpenings['ohResult']) {
                        console.log('call check isTimeOpen', item);
                        if (!aigens_data__WEBPACK_IMPORTED_MODULE_2__.OpeningHours.isTimeOpen(brandOh, itemOhMap, now)) {
                            this.log('item openings not available', category.name);
                            itemOpenings['ohResult'] = 1;
                            MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId] = itemOpenings; // 1 for false
                            return false;
                        }
                        itemOpenings['ohResult'] = 2;
                        MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId] = itemOpenings; // 2 for true
                    }
                    else if (MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId] && MenuManager.staticMenuMapForOh[store.id].itemOpenings[item.ohId]['ohResult'] == 2) {
                        // is ok
                    }
                    else {
                        return false;
                    }
                }
            }
        }
        else {
            //if category time not valid, don't show it
            if (!this.isAvailabeByStartEnd(item, now)) {
                this.log('item time not available', item.name);
                return false;
            }
            // if (!this.isAvailabeByPeriods(store, category.periods, now)) {
            //     this.log("cat period not available2", category.name);
            //     return false;
            // }
        }
        //TODO: add item to availableMap??
        //check dinein/takeout mode, *ignore delivery mode in kiosk
        if (!this.isAvailablebyModes(item, takeout, mode)) {
            this.log('item mode filter', item.name, item.modes);
            return false;
        }
        //skip dinein only items DEPRECATED
        /*if (takeout && item.dinein){
            this.log("dine in filter", item.name);
            return false;
        }*/
        //skip items with inventory -1000
        if (this.inventoryManager.isHidden(item)) {
            this.log('inv hidden', item.name);
            return false;
        }
        //check if item have start end time
        if (!this.isAvailabeByStartEnd(item, now)) {
            this.log('start end filter', item.name);
            return false;
        }
        if (!this.isAvailabeByPeriods(store, item.periods, now)) {
            this.log('periods filter', item.name);
            return false;
        }
        if (!this.isAvailableByMenuPeriodMode(store, item.periods, now, mode)) {
            this.log('menu period mode filter', item.name);
            return false;
        }
        return true;
    }
    isAvailabeByStartEnd(item, now) {
        if (!item.start && !item.end) {
            return true;
        }
        var greaterThanStart = true;
        var lessThanEnd = true;
        if (item.start) {
            greaterThanStart = now >= item.start;
        }
        if (item.end) {
            lessThanEnd = now <= item.end;
        }
        return greaterThanStart && lessThanEnd;
    }
    /**
     * Check if it is an available item group/ modifier group
     * @param modifier: if it is a modifier group
     **/
    isAvailableGroup(store, cat, group, takeout, now, modifier, mode) {
        if (modifier && group.min == 0) {
            return true;
        }
        let publishs = 0;
        let valid = true;
        if (group.items && group.items.length > 0) {
            for (let item of group.items) {
                valid = true;
                if (item.mgroups) {
                    for (let mgroup of item.mgroups) {
                        if (!this.isAvailableGroup(store, cat, mgroup, takeout, now, true, mode)) {
                            valid = false;
                            this.log('isn\'t available modifier group', cat.name, mgroup.name);
                            break;
                        }
                    }
                    if (!valid) {
                        continue;
                    }
                }
                //if(!valid) break;
                if (!this.inventoryManager.isSoldout(item) && this.isAvailableItem(store, cat, group, item, takeout, now, mode)) {
                    publishs++;
                }
            }
            ;
        }
        //if(!valid) return false;
        let min = group.min;
        if (group.repeat) {
            //valid = publishs > 0;
            if (min == 0) {
                valid = true;
            }
            else {
                valid = publishs > 0;
            }
        }
        else {
            valid = publishs >= min;
        }
        return valid;
    }
    /**
     * Check if it is an available item group/ modifier group
     * @param modifier: if it is a modifier group
     **/
    isAvailableGroupCheckPrep(store, cat, group, takeout, now, modifier, mode) {
        if (modifier && group.min == 0) {
            return true;
        }
        let publishs = 0;
        let valid = true;
        if (group.items && group.items.length > 0) {
            for (let item of group.items) {
                valid = true;
                if (item.mgroups) {
                    for (let mgroup of item.mgroups) {
                        if (!this.isAvailableGroupCheckPrep(store, cat, mgroup, takeout, now, true, mode)) {
                            valid = false;
                            this.log('isn\'t available modifier group', cat.name, mgroup.name);
                            break;
                        }
                    }
                    if (!valid) {
                        continue;
                    }
                }
                if (!this.inventoryManager.isPreparing(item) && !this.inventoryManager.isSoldout(item) && this.isAvailableItem(store, cat, group, item, takeout, now, mode)) {
                    publishs++;
                }
            }
            ;
        }
        let min = group.min;
        if (group.repeat) {
            if (min == 0) {
                valid = true;
            }
            else {
                valid = publishs > 0;
            }
        }
        else {
            valid = publishs >= min;
        }
        return valid;
    }
    /**
     * Check if it is an available combo, by checking:
     * TODO: if main item is available;
     * and if subgroups are all available.
     * store availability status in availableMap
     * **/
    isAvailableCombo(store, cat, mainItem, takeout, now, mode) {
        let mapId = this.getAvailableMapId(cat.id, mainItem.id);
        if (typeof this.availableMap[mapId] != 'undefined') {
            return this.availableMap[mapId];
        }
        // combo 分两种
        // 1.是從category 的item group 派sub-item group 下去的combo
        // 2.是main item level attach 落去的combo
        // 第二种不需要check cat.groups, 只check mainItem.groups
        let isMainItemAttachCombo = false;
        let mainGroups = mainItem.groups || [];
        for (let i = 0; i < mainGroups.length; i++) {
            if (mainGroups[i] && !mainGroups[i].modifier) {
                isMainItemAttachCombo = true;
                break;
            }
        }
        let catgroups = cat.groups;
        if (isMainItemAttachCombo || !catgroups)
            catgroups = [];
        let mainItemGroups = mainItem.groups;
        if (!mainItemGroups)
            mainItemGroups = [];
        let groups = [...catgroups, ...mainItemGroups];
        let isAvailable = true;
        for (let group of groups) {
            if (!this.isAvailableGroup(store, cat, group, takeout, now, false, mode)) {
                isAvailable = false;
                console.log("isn't available group", cat.name, group.name);
                break;
            }
        }
        this.availableMap[mapId] = isAvailable;
        return isAvailable;
    }
    isAvailableComboCheckPrep(store, cat, mainItem, takeout, now, mode) {
        const mapId = this.getAvailableMapId(cat.id, mainItem.id);
        if (mapId in this.availablePreparingMap) {
            return this.availablePreparingMap[mapId];
        }
        let isMainItemAttachCombo = false;
        let mainGroups = mainItem.groups || [];
        for (let i = 0; i < mainGroups.length; i++) {
            if (mainGroups[i] && !mainGroups[i].modifier) {
                isMainItemAttachCombo = true;
                break;
            }
        }
        let catgroups = cat.groups;
        if (isMainItemAttachCombo || !catgroups)
            catgroups = [];
        let mainItemGroups = mainItem.groups;
        if (!mainItemGroups)
            mainItemGroups = [];
        let groups = [...catgroups, ...mainItemGroups];
        let isAvailable = true;
        for (let group of groups) {
            if (!this.isAvailableGroupCheckPrep(store, cat, group, takeout, now, false, mode)) {
                isAvailable = false;
                console.log("isn't available group", cat.name, group.name);
                break;
            }
        }
        this.availablePreparingMap[mapId] = isAvailable;
        return isAvailable;
    }
    /**
     * Check if it is an available category, determinded by rules:
     * 1. category is suspended / published or not
     * 2. if category's mode is the same as order dinein/takeout mode
     * 3. category's available time slots or period
     * 4. if category has main items
     * 5. if category has member tiers
     * **/
    isAvailableCategory(store, category, takeout, checkPublish, now, mode) {
        if (!this.isAvailableByUserGroup(category)) {
            return false;
        }
        if (!this.isItemMemberTierAvailable(undefined, category)) {
            return false;
        }
        if (this.showAllCats) {
            return true;
        }
        //if not published, don't show it
        if (category.suspended) {
            return false;
        }
        if (checkPublish && !category.published) {
            return false;
        }
        if (!now) {
            now = this.getTime(store);
        }
        console.log("测试", !this.isAvailablebyModes(category, takeout, mode));
        if (!this.isAvailablebyModes(category, takeout, mode)) {
            this.log('cat mode not available', category.modes);
            return false;
        }
        if (category.openings) {
            var brandOh = null;
            if (store.brand) {
                brandOh = store.brand.openings;
            }
            if (!aigens_data__WEBPACK_IMPORTED_MODULE_2__.OpeningHours.isTimeOpen(brandOh, category.openings, now)) {
                this.log('cat openings not available', category.name);
                return false;
            }
        }
        else {
            //if category time not valid, don't show it
            if (!this.isAvailabeByStartEnd(category, now)) {
                this.log('cat time not available', category.name);
                return false;
            }
            if (!this.isAvailabeByPeriods(store, category.periods, now)) {
                this.log('cat period not available2', category.name);
                return false;
            }
            if (!this.isAvailableByMenuPeriodMode(store, category.periods, now, mode)) {
                this.log('cat menu period mode not available', category.name);
                return false;
            }
        }
        // let mainItems = this.getAvailableMainItems(store, category, takeout, now, mode);
        // if (mainItems.length == 0) {
        //     return false;
        // }
        this.processAvailableItemsInItemGroup(category.groups, store, category, takeout, now, mode);
        // check if category main group has items or not. If no items, then the category should not be available
        if (!category.groups[0] || category.groups[0].parentItems.length === 0) {
            return false;
        }
        return true;
    }
    /**
     * Get all available categories in the store
     * **/
    getAvailableCategories(store, now = this.getTime(store), takeout, mode) {
        var result = [];
        if (!store || !store.menu) {
            return result;
        }
        var storeOpen = aigens_data__WEBPACK_IMPORTED_MODULE_2__.Store.isOpeningHours(store, now);
        if (!storeOpen) {
            return result;
        }
        var cats = store.menu.categories;
        if (!cats || cats.length == 0) {
            return result;
        }
        var channel = this.platformService.getChannel();
        var container = this.platformService.getContainer();
        for (let c of cats) {
            if (this.isAvailableCategory(store, c, takeout, true, now, mode) && this.isAvailableChannel(c, channel, container)) {
                result.push(c);
            }
        }
        if (result.length != cats.length) {
            this.log('filtered cat', cats.length + '->' + result.length);
        }
        return result;
    }
    isAvailableChannel(content, channel, container) {
        var containers = content.containers;
        if (containers && containers.length > 0) {
            //there's container restriction
            return containers.indexOf(container) != -1;
        }
        var channels = content.channels;
        if (channels && channels.length > 0) {
            //there's container restriction
            return channels.indexOf(channel) != -1;
        }
        return true;
    }
    processAvailableItemsInItemGroup(groups, store, c, takeout, now, mode) {
        groups.forEach(g => {
            g.parentItems = g.parentItems.filter(it => {
                if (!this.isAvailableByUserGroup(g)) {
                    return false;
                }
                // process variation items availability
                if (it.variations && it.variations.length > 0) {
                    const variation = [];
                    it.variations.forEach(v => {
                        if (this.isAvailableItemWithoutCheckItemPublish(store, c, g, v, takeout, now, mode)) {
                            variation.push(v);
                        }
                    });
                    it.variations = variation;
                }
                return this.isAvailableItemWithoutCheckItemPublish(store, c, g, it, takeout, now, mode);
            });
            g.parentItems.forEach(it => {
                this.processAvailableItemsInItemGroup(it.groups, store, c, takeout, now, mode);
            });
        });
    }
    isAvailabeByPeriods(store, periods, now) {
        let brand = store === null || store === void 0 ? void 0 : store.brand;
        if (!periods || periods.length == 0) {
            return true;
        }
        let available = false;
        if (this.periodOverwrite && this.periodOverwrite != 'auto') {
            if (periods.indexOf(this.periodOverwrite) != -1) {
                return true;
            }
            else {
                return false;
            }
        }
        //check if cat period is ok
        for (let p of periods) {
            //special case handling where cat period is a V3 cron expression
            if (p.length > 10) {
                //result.push(c);
            }
            else {
                if (store === null || store === void 0 ? void 0 : store.periods) {
                    let period = store.periods.find(x => x.code == p);
                    if (period) {
                        if (this.isPeriodAvailable(brand ? brand.openings : null, period, now)) {
                            available = true;
                            break;
                        }
                    }
                }
            }
        }
        return available;
    }
    /**
     * Compare order mode, item period and menu period mode
     *
     * @param store
     * @param periods
     * @param now
     * @param orderMode
     */
    isAvailableByMenuPeriodMode(store, periods, now, orderMode) {
        var _a;
        if (!periods || periods.length == 0) {
            return true;
        }
        let available = false;
        let relatedMenuPeriodModes = [];
        const timeRelatedMenuPeriods = _aigens_core_src_app_framework_services_menu_util__WEBPACK_IMPORTED_MODULE_1__.MenuUtil.getRelatedMenuPeriod(now, store);
        for (let p of periods) {
            if ((_a = store === null || store === void 0 ? void 0 : store.menu) === null || _a === void 0 ? void 0 : _a.periods) {
                const period = store.menu.periods.find(x => x.code == p);
                const timeMatchMenuPeriod = timeRelatedMenuPeriods.find(f => f.code == p);
                // console.log('p*** ', period, timeMatchMenuPeriod);
                if (period && period.modes && timeMatchMenuPeriod) {
                    relatedMenuPeriodModes = relatedMenuPeriodModes.concat(period.modes);
                }
            }
        }
        if (relatedMenuPeriodModes.length == 0) {
            available = true;
        }
        else {
            available = relatedMenuPeriodModes.includes(this.debugMode || orderMode);
        }
        // console.log('**** ', relatedMenuPeriodModes, periods, orderMode, available);
        return available;
    }
    /**
     * filter by modes
     * if modes has only one channel (kiosk/byod), then it is only available in that channel.
     * then tell by dinein/takeaway
     * @param item
     * @param takeout
     * @private
     */
    isAvailablebyModes(item, takeout, mode) {
        let modes = item.modes;
        if (!modes || modes.length == 0) {
            return true;
        }
        //check kiosk/mobile first
        var device = MenuManager.device;
        if (device) {
            if (device == 'kiosk') {
                if (modes.indexOf('kiosk') == -1 && modes.indexOf('byod') >= 0) {
                    return false;
                }
            }
            else if (device == 'byod') {
                if (modes.indexOf('byod') == -1 && modes.indexOf('kiosk') >= 0) {
                    return false;
                }
            }
        }
        if (mode) {
            // takeout boolean 指示不了三种mode dinein delivery takeaway
            if (mode === 'byod') {
                // byod: old flow if(mode === 'byod'), so takeout = false;结论: byod mode 会show dinein 餐单
                return modes.indexOf('dinein') >= 0 || modes.indexOf(mode) >= 0;
            }
            else if (mode == 'preorder' || mode == 'view') {
                return modes.indexOf(this.debugMode || 'byod') >= 0;
            }
            return modes.indexOf(mode) >= 0;
        }
        return modes.indexOf(takeout ? 'takeaway' : 'dinein') >= 0;
    }
    /*
    getCategories(store: Store, ignorePeriod: boolean = false, currentPeriod: string = "auto", now: number = this.getTime()): Category[] {

        var result = [];

        if (ignorePeriod) return this.filterEmptyGroup(this.categories);

        var storePeriods = this.periods;
        if (!storePeriods || storePeriods.length == 0) return this.filterEmptyGroup(this.categories);

        var periodsMap = {};
        for (let p of this.periods) {
            periodsMap[p.code] = p;
        }

        //caught old style categories' period format
       var periodCodes = ["B","L","T","D","M"];
       if(this.categories.length > 0 && this.categories[0].periods){
           if(periodCodes.indexOf(this.categories[0].periods[0]) == -1) return this.filterEmptyGroup(this.categories);

       }


        var today = new Date(now);
        today.setHours(0, 0, 0, 0);
        //this.log(today);
        let todayTime = today.getTime();
        let brand = store.brand;

        for (let c of this.categories) {

            if (!this.isBetween(c, now)) continue;
            if (!c.published) continue;

            var periods = c.periods;
            if (periods == null) {

                if (Store.isOpeningHours(store, now)) {
                    result.push(c);
                }
            } else {

                for (let p of periods) {

                    if (currentPeriod == "auto") {

                        var period = periodsMap[p];
                        if (period) {
                            if (this.isAvailable(brand.openings, period, todayTime, now)) {
                                result.push(c);
                                break;
                            }
                        }
                    } else {

                        if (periods.indexOf(currentPeriod) > -1) {
                            result.push(c);
                            break;
                        }
                    }


                }

            }

        }


        return this.filterEmptyGroup(result);
    }  */
    /*
    setupVariations(i: Item): Item {

        let result: Item = i;

        if (i.parentId) {


            let p = this.variations[i.parentId];
            let exist: boolean = typeof p !== 'undefined';

            if (exist) {

                p.items.push(i);
            }
            else {
                let items: Array<Item> = [];

                items.push(i);

                p = {

                    items: items
                };

                this.variations[i.parentId] = p;
            }

            if(i.parentId != i.id)
                result = null;
        }



        return result;
    }*/
    checkPrestopFromStart(useTime, period) {
        var _a, _b;
        let useTimeDate = (_a = moment__WEBPACK_IMPORTED_MODULE_3__(useTime)) === null || _a === void 0 ? void 0 : _a.toDate();
        let { prestopFromStart, startTime } = ((_b = period === null || period === void 0 ? void 0 : period.openings) === null || _b === void 0 ? void 0 : _b.weekdays) && period.openings.weekdays[useTimeDate.getDay()] || {};
        if (!startTime || !prestopFromStart) {
            return true;
        }
        let now = new Date();
        let periodStartTime = useTimeDate.setHours(Number(startTime.split(':')[0]), Number(startTime.split(':')[1]), 0, 0);
        if (periodStartTime <= now.getTime()) { // 当日处于当前或超过period period， 不用check perstop
            return true;
        }
        else {
            return (periodStartTime - (prestopFromStart || 0) * 60000) > now.getTime(); // true is available
        }
    }
    isPeriodAvailable(brandOh, period, now) {
        //this.log("is avail?", period, now);
        if (period.openings) {
            this.log('isAvailable : check by opening rules');
            if (!this.checkPrestopFromStart(now, period)) {
                console.log('the period not available');
                return false;
            }
            let open = aigens_data__WEBPACK_IMPORTED_MODULE_2__.OpeningHours.isTimeOpen(brandOh, period.openings, now);
            return open;
        }
        else {
            //if (!period.start || !period.end) return false;
            return aigens_data__WEBPACK_IMPORTED_MODULE_2__.Period.isTimeOpen(period, now);
        }
    }
    isItemPublished(cat, ig, item) {
        var cmap = ig.cmap;
        if (cmap && Object.keys(cmap).length > 0) {
            var catPub = cmap[cat.id];
            if (!catPub) {
                //need to check for indexed map by adding .index
                var index = cat.groupIds.indexOf(ig.id);
                if (index >= 0) {
                    catPub = cmap[cat.id + '.' + index];
                }
            }
            if (catPub) {
                var published = catPub[item.id];
                if (published != null) {
                    if (published == false) {
                        return false;
                    }
                    else {
                        return true;
                    }
                }
                else {
                    return item.published;
                }
            }
            else {
                //if menu is legacy, by default doesn't show
                if (this.legacy) {
                    return false;
                }
                else {
                    //return true;
                    return item.published;
                }
            }
        }
        return item.published;
    }
    //patch slimmed item
    patchItem(imap, item) {
        var _a;
        if (!item['@id']) {
            //already patched
            return;
        }
        var baseId = item['@id'];
        if (!baseId) {
            return;
        }
        var base = imap[baseId];
        if (!base) {
            console.log('CRITICAL ERROR NO BASE ITEM');
            return;
        }
        //make a new item
        var merged = Object.assign({}, base);
        //marge overwrites to base
        if (item !== null && item !== undefined) {
            for (const nextKey in item) {
                // Avoid bugs when hasOwnProperty is shadowed
                if (Object.prototype.hasOwnProperty.call(item, nextKey) && item[nextKey] && (!Array.isArray(item[nextKey]) || ((_a = item[nextKey]) === null || _a === void 0 ? void 0 : _a.length) != 0)) {
                    merged[nextKey] = item[nextKey];
                }
            }
        }
        // merged = Object.assign(merged, item);
        //merge it back to item itself
        Object.assign(item, merged);
    }
    /**
     * Handle special cases in menu:
     * 1. specially handle variations
     * 2. separate recommendation/gifts/unlock categories
     * 3. find out promotion group and push into mainitems
     * 4. find out modifiers
     * 5!!!. build up groups' map, categories' map and items' map (menu.gmap, menu.cmap, menu.imap )
     * **/
    processMenu(menu, device = null) {
        this.legacy = menu.legacy;
        //set device source
        if (device) {
            MenuManager.device = device;
        }
        var gmap = {};
        var imap = {};
        var cmap = {};
        var rimap = {};
        //slim menu, setup imap first
        if (menu.items) {
            for (let item of menu.items) {
                imap[item.id] = item;
            }
        }
        var groups = menu.groups;
        if (groups && groups.length > 0) {
            for (let ig of groups) {
                gmap[ig.id] = ig;
                if (!menu.items) {
                    for (let i of ig.items) {
                        imap[i.id] = i;
                    }
                    ;
                }
                this.processVariations(ig, imap);
            }
            var cats = menu.categories.slice();
            if (menu.recommendation) {
                cats.push(menu.recommendation);
            }
            if (menu.unlocks) {
                cats = cats.concat(menu.unlocks);
            }
            if (menu.gifts) {
                cats = cats.concat(menu.gifts);
            }
            if (menu.pass) {
                cats.push(menu.pass);
            }
            for (let cat of cats) {
                cmap[cat.id] = cat;
                var igs = [];
                var i = 0;
                for (let igId of cat.groupIds) {
                    var ig = gmap[igId];
                    if (ig) {
                        igs.push(ig);
                        if (i == 0) {
                            var igPos = 0;
                            for (let item of ig.items) {
                                this.patchItem(imap, item);
                                var subids = item.groupIds;
                                if (subids && subids.length > 0) {
                                    var subs = [];
                                    for (let sgId of subids) {
                                        var sg = gmap[sgId];
                                        if (sg) {
                                            subs.push(sg);
                                        }
                                    }
                                    item.groups = subs;
                                    for (let sig of subs) {
                                        //this.log("checkingIgA", sig);
                                        this.checkIg(sig, gmap, imap);
                                    }
                                }
                                var pgroupId = item.pgroupId;
                                if (pgroupId) {
                                    var pg = gmap[pgroupId];
                                    if (pg) {
                                        item.pgroup = pg;
                                        //this.log("checkingIgB", pg);
                                        this.checkIg(pg, gmap, imap);
                                    }
                                    else {
                                        this.log('invalid pg', item);
                                    }
                                }
                                item.igPos = igPos;
                                igPos++;
                                //console.log("IG POS", item.name, igPos);
                            }
                        }
                        //this.log("checkingIgC", ig);
                        this.checkIg(ig, gmap, imap);
                        for (let item of ig.items) {
                            //ig.items updated, now update it back to imap?
                            imap[item.id] = item;
                            //reverse imap, add if not a combo
                            // if(MenuManager.isSingle(cat, ig, item)){
                            //     this.addReverse(rimap, cat, ig, item);
                            // }
                            this.addReverse(rimap, cat, ig, item);
                        }
                        i++;
                    }
                    //this.log("checking ig", ig.name);
                    //for main item group, check if main items have any groups
                }
                //this.log(cat.name, cat.groupIds, igs.length);
                cat.groups = igs;
            }
        }
        menu['gmap'] = gmap;
        menu['cmap'] = cmap;
        menu['imap'] = imap;
        menu['rimap'] = rimap;
        return menu;
    }
    static isSingle(cat, ig, item) {
        var igMode = cat.igMode;
        if ('single' == igMode) {
            return true;
        }
        else if ('combo' == igMode) {
            return false;
        }
        if (item.groupIds && item.groupIds.length > 0)
            return false;
        return true;
    }
    addReverse(rimap, cat, ig, item) {
        //we are adding 1 or 2 entries to reverse map, with item.id and item.backendID
        var itemId2 = item.backendId;
        var itemId1 = item.id;
        var entry = rimap[itemId1];
        if (!entry) {
            entry = {
                c: cat,
                ig: ig,
                i: item
            };
            rimap[itemId1] = entry;
        }
        var entry2 = rimap[itemId2];
        if (itemId2 && !entry2) {
            rimap[itemId2] = entry;
        }
    }
    /**
     * separate varations from menu's item list,
     * and push them into their parents' parent.variations
     * **/
    processVariations(ig, imap) {
        var items = ig.items;
        if (!items) {
            return;
        }
        var map = {};
        for (let item of items) {
            this.patchItem(imap, item);
            map[item.id] = item;
            map[item.id].variations = [];
        }
        var top = [];
        //keep track of which level is each item assigned to, to break recursive parents and all items are presented someway
        var L1 = {};
        var L2 = {};
        for (let item of items) {
            if (item.parentId && item.parentId != item.id) {
                var parent = map[item.parentId];
                //if parent exists and parent is not in level 2
                if (parent && !L2[parent.id]) {
                    if (!parent.variations) {
                        parent.variations = [];
                    }
                    parent.variations.push(item);
                    L2[item.id] = item;
                }
                else {
                    top.push(item);
                    L1[item.id] = item;
                }
            }
            else {
                top.push(item);
                L1[item.id] = item;
            }
        }
        /*
        for (let item of items) {
            if (item.parentId && item.parentId != item.id) {
                var parent = map[item.parentId];
                if (parent) {
                    if (!parent.variations) {
                        parent.variations = [];
                    }
                    parent.variations.push(item);
                } else {
                    result.push(item);
                }
            } else {
                result.push(item);
            }
        }
        */
        if (top.length != items.length) {
            this.log('processed variations', ig.name, items.length + '->' + top.length);
            this.log('L1', L1);
            this.log('L2', L2);
            this.log('parentItems', top);
        }
        ig.parentItems = top;
    }
    /**find out itemgroup's items' modifier groups**/
    checkIg(ig, gmap, imap) {
        if (!ig.items) {
            return;
        }
        for (let item of ig.items) {
            this.patchItem(imap, item);
            this.checkMods(item, gmap, imap);
        }
    }
    /**Check and push modifier groups**/
    checkMods(item, gmap, imap) {
        var mgIds = item.mgroupIds;
        if (mgIds && mgIds.length > 0) {
            var mgs = [];
            for (let mgId of mgIds) {
                var mg = gmap[mgId];
                if (mg) {
                    mgs.push(mg);
                }
                else {
                    this.log('missing mod ig', mgId);
                }
            }
            item.mgroups = mgs;
            // item updated, now update it back to imap?
            imap[item.id] = item;
        }
    }
    /**
     * Get available category groups, by checking:
     * 1. if category groups is published
     * 2. available time slots or periods
     * **/
    getAvailableCategoryGroups(store, takeout) {
        var result = [];
        let now = this.getTime(store);
        if (!store || !store.menu) {
            return result;
        }
        var storeOpen = aigens_data__WEBPACK_IMPORTED_MODULE_2__.Store.isOpeningHours(store, now);
        if (!storeOpen) {
            return result;
        }
        var cats = store.menu.cgroups;
        if (!cats || cats.length == 0) {
            return result;
        }
        for (let c of cats) {
            if (this.showAllCats) {
                result.push(c);
                continue;
            }
            //if not published, don't show it
            if (!c.published) {
                continue;
            }
            if (c.openings) {
                var brandOh = null;
                if (store.brand) {
                    brandOh = store.brand.openings;
                }
                if (!aigens_data__WEBPACK_IMPORTED_MODULE_2__.OpeningHours.isTimeOpen(brandOh, c.openings, now)) {
                    this.log('cat openings not available', c.name);
                    continue;
                }
            }
            else {
                //if category time not valid, don't show it
                if (!this.isAvailabeByStartEnd(c, now)) {
                    this.log('cat time not available', c.name);
                    continue;
                }
                if (!this.isAvailabeByPeriods(store, c.periods, now)) {
                    this.log('cat period not available2', c.name);
                    continue;
                }
            }
            result.push(c);
        }
        if (result.length != cats.length) {
            this.log('filtered cat groups', cats.length + '->' + result.length);
        }
        return result;
    }
    getAvailableRecommendations(store, recoms) {
        let now = this.convertNowDateToStoreTimeZone(store.timezone).getTime();
        var result = [];
        for (let rec of recoms) {
            var catAval;
            if (rec.category.type == 'recommendation') {
                catAval = this.isAvailableCategory(store, rec.category, false, false);
            }
            else {
                catAval = this.isAvailableCategory(store, rec.category, false, true);
            }
            var itemAval = this.isAvailableItem(store, rec.category, rec.itemgroup, rec.item, false, now);
            if (catAval && itemAval) {
                result.push(rec);
            }
            else {
                this.log('Item Not Available', rec.item.name);
            }
        }
        return result;
    }
    static getCategory(menu, catId) {
        var cmap = menu['cmap'];
        if (!cmap) {
            return null;
        }
        return cmap[catId];
    }
    static getItemGroup(menu, igId) {
        var gmap = menu['gmap'];
        if (!gmap) {
            return null;
        }
        return gmap[igId];
    }
    static getItem(menu, ig, itemId) {
        var items = ig.items;
        if (!items) {
            return null;
        }
        return ig.items.find((item) => {
            return item.id === itemId;
        });
    }
    updateAvailableItem(cat, mainItem, isAvailable) {
        if (!cat || !mainItem) {
            return;
        }
        const mapId = this.getAvailableMapId(cat.id, mainItem.id);
        this.availableMap[mapId] = isAvailable;
    }
    /**
     * Check whether item group is valid for specific user group
     * @param ig
     */
    isAvailableByUserGroup(ig) {
        // if (ig?.users != null) {
        //     this.needRecalMenuWhenMemberChange = true;
        //     const isMember = this.memberContext.isMember();
        //     if (isMember && !ig.users?.includes('member')) {
        //         // console.log('not available when member', ig.name);
        //         return false;
        //     } else if (!isMember && !ig.users?.includes('guest')) {
        //         // console.log('not available when guest', ig.name);
        //         return false;
        //     }
        // }
        const allowed = ig === null || ig === void 0 ? void 0 : ig.users;
        const have = this.userTypes;
        if (!allowed || allowed.length === 0) {
            return true;
        }
        for (const type of allowed) {
            if (have.indexOf(type) >= 0) {
                // console.log('ig allowed', ig?.name, allowed, have);
                return true;
            }
        }
        console.log('ig not allowed', ig === null || ig === void 0 ? void 0 : ig.name, allowed, have);
        return false;
    }
    isItemMemberTierAvailable(item, category) {
        var _a, _b, _c, _d, _e;
        const itemMemberTier = item === null || item === void 0 ? void 0 : item.memberTier;
        const isItemMemberTierValid = (itemMemberTier === null || itemMemberTier === void 0 ? void 0 : itemMemberTier.length) === 0 || itemMemberTier === undefined ? category === null || category === void 0 ? void 0 : category.memberTier : itemMemberTier;
        const memberTier = ((_b = (_a = this.memberContext.member) === null || _a === void 0 ? void 0 : _a.membership) === null || _b === void 0 ? void 0 : _b.tier) || ((_c = this.memberContext.member) === null || _c === void 0 ? void 0 : _c.tier);
        if (((isItemMemberTierValid === null || isItemMemberTierValid === void 0 ? void 0 : isItemMemberTierValid.length) > 0 && ((_e = (_d = this.memberContext) === null || _d === void 0 ? void 0 : _d.member) === null || _e === void 0 ? void 0 : _e.guest)) ||
            ((isItemMemberTierValid === null || isItemMemberTierValid === void 0 ? void 0 : isItemMemberTierValid.length) > 0 && !isItemMemberTierValid.includes(memberTier))) {
            return false;
        }
        return true;
    }
    /**
     * Check if it is an available Ad, determinded by rules:
     * 1. check Ad UserGroup
     * 2. if Ad's mode is the same as order dinein/takeout mode
     * 3. Ad's available time slots or period
     * **/
    isAvailableAd(store, ad, takeout, now, mode) {
        if (!this.isAvailableByUserGroup(ad)) {
            return false;
        }
        if (!now) {
            now = this.getTime(store);
        }
        if (!this.isAvailablebyModes(ad, takeout, mode)) {
            this.log('ad mode not available', ad.modes);
            return false;
        }
        if (ad === null || ad === void 0 ? void 0 : ad.openings) {
            var brandOh = null;
            if (store === null || store === void 0 ? void 0 : store.brand) {
                brandOh = store.brand.openings;
            }
            if (!aigens_data__WEBPACK_IMPORTED_MODULE_2__.OpeningHours.isTimeOpen(brandOh, ad === null || ad === void 0 ? void 0 : ad.openings, now)) {
                this.log('ad openings not available', ad === null || ad === void 0 ? void 0 : ad.name);
                return false;
            }
        }
        else {
            //if category time not valid, don't show it
            if (!this.isAvailabeByStartEnd(ad, now)) {
                this.log('ad time not available', ad.name);
                return false;
            }
            if (!this.isAvailabeByPeriods(store, ad === null || ad === void 0 ? void 0 : ad.periods, now)) {
                this.log('ad period not available', ad.name);
                return false;
            }
        }
        return true;
    }
}
MenuManager.staticMenuMapForOh = {};
MenuManager.device = null;
MenuManager.ɵfac = function MenuManager_Factory(t) { return new (t || MenuManager)(_angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_8__.Injector)); };
MenuManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdefineInjectable"]({ token: MenuManager, factory: MenuManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 95149:
/*!*******************************************************************!*\
  !*** ./projects/core/src/app/framework/managers/order-manager.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OrderManager": () => (/* binding */ OrderManager)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var aigens_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-data */ 51707);
/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! uuid */ 62535);
/* harmony import */ var _pure_services_platform_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../pure/services/platform.service */ 45485);
/* harmony import */ var _pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../pure/services/subscribe.service */ 47074);
/* harmony import */ var _services_analytics_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../services/analytics.service */ 4297);
/* harmony import */ var _services_config_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../services/config.service */ 2171);
/* harmony import */ var _single_order_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./single-order-manager */ 15906);
/* harmony import */ var _inventory_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./inventory-manager */ 84539);
/* harmony import */ var _aigens_core_src_app_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @aigens/core/src/app/pure/managers/setting-manager */ 74663);
/* harmony import */ var _services_storage_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../services/storage.service */ 24430);
/* harmony import */ var _services_order_context_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../services/order-context.service */ 63058);













//THIS IS multi order manager hiding as single order manager
class OrderManager {
    constructor(injector) {
        this.injector = injector;
        this.count = 0;
        this.cutlery = false;
        this.contactless = false;
        this.alipayCnNotify = false;
        this.alipayCnAuthCode = "";
        this.trackAnalytics = true;
        this.managers = [];
        this.multi = false;
        this.selectedOffers = [];
        this.promoCode = null;
        this.promoCodes = [];
        this.bundledOffer = [];
        this.marketing = false;
        this.programs = [];
        this.configService = injector.get(_services_config_service__WEBPACK_IMPORTED_MODULE_4__.ConfigService);
        this.analyticsService = injector.get(_services_analytics_service__WEBPACK_IMPORTED_MODULE_3__.AnalyticsService);
        this.subscribe = injector.get(_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_2__.SubscribeService);
        this.platformService = injector.get(_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_1__.PlatformService);
        this.inventoryManager = injector.get(_inventory_manager__WEBPACK_IMPORTED_MODULE_6__.InventoryManager);
        this.settingManager = injector.get(_aigens_core_src_app_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_7__.SettingManager);
        this.storageService = injector.get(_services_storage_service__WEBPACK_IMPORTED_MODULE_8__.StorageService);
    }
    /*
    constructor(private configService: ConfigService, private analyticsService: AnalyticsService, private subscribe: SubscribeService, private platformService: PlatformService) {

    }
    */
    get orderContextService() {
        return this.injector.get(_services_order_context_service__WEBPACK_IMPORTED_MODULE_9__.OrderContext);
    }
    getOrder() {
        return this.order;
    }
    createOrder(store, mode, options = {}, member = undefined) {
        var om = new _single_order_manager__WEBPACK_IMPORTED_MODULE_5__.SingleOrderManager(this.configService, this.analyticsService, this.subscribe);
        this.managers = [om];
        this.manager = om;
        this.multi = false;
        this.fillDefaultOptions(options);
        om.createOrder(store, mode, options);
        om.setUserPoints(member);
        console.log("created options??", options);
        this.order = om.order;
        this.store = store;
        this.mode = mode;
        return this.order;
    }
    fillDefaultOptions(options) {
        var source = this.platformService.getSource();
        var container = this.platformService.getContainer();
        if (source) {
            options['source'] = source;
        }
        if (container) {
            options['container'] = container;
        }
    }
    createSwitchCourtOrder(court, store, mode, options = {}) {
        if (this.court && this.court.id != court.id) {
            console.log("ERROR: CANNOT SUPPORT CHANGE COURT");
            return;
        }
        else {
            console.log("creating court sub order!");
        }
        this.court = court;
        this.store = store;
        this.multi = true;
        this.mode = mode;
        this.fillDefaultOptions(options);
        var om = this.findOm(store.id);
        if (!this.order) {
            this.order = this.newCourtOrder(court, mode, options);
            if (store) {
                this.order.storeId = store.id; // need use after from court mode to byod
            }
        }
        else {
            this.order.type = mode;
        }
        if (!om) {
            om = new _single_order_manager__WEBPACK_IMPORTED_MODULE_5__.SingleOrderManager(this.configService, this.analyticsService, this.subscribe);
            om.createOrder(store, mode, options);
            this.managers.push(om);
        }
        else {
            om.store = store;
        }
        // update the mode/type
        this.managers.forEach(m => {
            m.order.type = mode;
            m.mode = mode;
        });
        this.manager = om;
        this.calculateCourtOrder();
    }
    //calculate court order
    calculateCourtOrder() {
        var total = 0;
        var grandTotal = 0;
        var serviceCharge = 0;
        var tax = 0;
        var discount = 0;
        var subs = [];
        for (let om of this.managers) {
            let so = om.order;
            total += so.total;
            grandTotal += so.grandTotal;
            serviceCharge += so.serviceCharge;
            tax += so.tax;
            discount += so.discount;
            subs.push(so);
        }
        this.order.total = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(total, 2);
        this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(grandTotal, 2);
        this.order.serviceCharge = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(serviceCharge, 2);
        this.order.tax = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(tax, 2);
        this.order.discount = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(discount, 2);
        this.order.subs = subs;
        console.log("calculated court order", this.order);
    }
    /*
    private calculateCourtOrder() {

        var count = 0;
        var total = 0;
        var usedPoints = 0;
        var usedPoints_toItem = 0;// 存储 当前积分兑换item flow中使用的积分数

        var quantities = {};

        console.log('calculate order', this.order);

        for (let oi of this.order.orderitems) {

            // if (!OrderItem.isSet(oi)) {

            count += oi.quantity;
            let t = oi.quantity * oi.total;
            total += MathUtils.round(t, 2);

            var mainItemId = oi.items[0].id;
            var quantity = quantities[mainItemId];
            if (!quantity) {
                quantity = 0;
            }
            quantity += oi.quantity;
            quantities[mainItemId] = quantity;
            // } else {

            //     count += oi.quantity;
            //     let t = oi.quantity * oi.total;
            //     total += MathUtils.round(t, 2);
            //     var mainItemId = oi.items[0].id;
            //     var quantity = quantities[mainItemId];
            //     if (!quantity) quantity = 0;
            //     quantity += oi.quantity;
            //     quantities[mainItemId] = quantity;
            // }
            // oi.points is not used in byod v2
            usedPoints += (oi.points * oi.quantity);
            usedPoints_toItem += (oi.points * oi.quantity);
        }

        total = MathUtils.round(total, 2);

        this.count = count;
        this.total = total;
        this.quantities = quantities;

        this.order.grandTotal = total;
        this.order.total = total;
        if (!this.order.discount) {
            this.order.discount = 0;
        }
        this.order.handling = this.getHandling();
        // this.order.usedPoints = usedPoints;

        this.order.usedPoints_toItem = usedPoints_toItem;

        this.calculateUsedPoints(usedPoints_toItem, this.order.usedPoints_toMoney);

        this.order.serviceCharge = this.getServiceCharge();
        this.order.tax = this.getTax();
        //regenerate uuid, meaning the order is changed
        this.calcGrandTotal();
        this.order.uuid = uuidv4();

        //this.order$.next(this.order);
        //changeEmit && this.onOrderitemsChange.emit("order change");

        this.subscribe.next('order', this.order);
    }
    */
    newCourtOrder(court, mode, options = {}) {
        var order = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.Order();
        order.type = mode;
        Object.assign(order, options);
        order.courtId = court.id;
        order.orderitems = [];
        order.uuid = (0,uuid__WEBPACK_IMPORTED_MODULE_10__["default"])();
        order.deviceId = this.configService.getDeviceId() + "";
        order.takeout = false;
        order.sourceUrl = window.location.href;
        if (this.member) {
            order.member = this.member;
        }
        if (this.member && this.member.backendId) {
            order.memberNumber = Number(this.member.backendId); //Yoshinoya member
        }
        return order;
    }
    findOm(storeId) {
        for (let om of this.managers) {
            if (om.store.id == storeId) {
                return om;
            }
        }
        return null;
    }
    clear() {
        this.order = null;
        this.count = 0;
        this.member = null;
        this.users = null;
        this.mode = null;
        this.managers = [];
        this.manager = null;
        this.selectedOffers = [];
        this.promoCode = null;
        this.resetPromoCodes();
        this.subscribe.next('order', null);
        this.storageService.getStorageKeys().then(keys => {
            keys.forEach(key => {
                if (key === null || key === void 0 ? void 0 : key.startsWith("type=order")) {
                    console.log("clear order with key", key);
                    this.storageService.setStorage(key, null);
                }
            });
        });
        this.orderContextService.clearPreviousOrder();
    }
    clearOrderItems() {
        this.managers.forEach((om) => {
            om.clearOrderItems();
        });
    }
    // please use carefully
    clearLocalOrderItems(orderContext) {
        var _a;
        // only clear the localContext order not orderManager.order
        (_a = orderContext === null || orderContext === void 0 ? void 0 : orderContext.storageService) === null || _a === void 0 ? void 0 : _a.setStorage(orderContext === null || orderContext === void 0 ? void 0 : orderContext.contextId, null);
    }
    /**
     * @deprecated
     * @param actions
     * @param callback
     */
    processActions(actions, callback) {
        if (!actions) {
            return;
        }
        for (let act of actions) {
            var auto = act.auto;
            if (auto) {
                switch (act.action) {
                    case "addItem":
                        this.addSingleItemById(act.params.itemId);
                        break;
                    case "addDiscount":
                        this.setPromoCode(act.params.code);
                        break;
                    case "addOrder":
                        this.reconstructOrder(act.params.order);
                        break;
                    case "addOrderItem":
                        var orderitem = act.params.orderitem;
                        var rawOrder = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.Order();
                        rawOrder.orderitems = [orderitem];
                        this.reconstructOrder(rawOrder);
                        break;
                    default:
                        console.log("UNSUPPORTED ACTION", act);
                        break;
                }
            }
            else {
                if (callback) {
                    callback(act);
                }
            }
        }
    }
    reconstructOrder(rawOrder, continueUnlockCat = true) {
        if (this.multi) {
            var subs = rawOrder.subs;
            for (let sub of subs) {
                var om = this.findOm(sub.storeId);
                if (!om) {
                    om = new _single_order_manager__WEBPACK_IMPORTED_MODULE_5__.SingleOrderManager(this.configService, this.analyticsService, this.subscribe);
                    var store = this.court.stores.find((s) => s.id == sub.storeId);
                    if (store) {
                        om.createOrder(store, this.mode, {});
                        this.managers.push(om);
                    }
                    else {
                        console.log("FAIL TO RECONSTRUCT SUB ORDER MISSING STORE");
                    }
                }
                else {
                    console.log("have existing OM");
                }
                om.reconstructOrder(sub, true, continueUnlockCat);
            }
            //recal after added subs
            this.calculateCourtOrder();
        }
        else {
            this.manager.reconstructOrder(rawOrder, false, continueUnlockCat);
        }
    }
    findOrderItem(item, ignoreModifiers = true) {
        console.log("MULTI findOrderItem");
        return this.manager.findOrderItem(item, ignoreModifiers);
    }
    findOrderItemEgift(item, ignoreModifiers = true) {
        console.log("MULTI findOrderItem");
        return this.manager.findOrderItemEgift(item, ignoreModifiers);
    }
    //APPROVED
    addOrderItem(orderitem, isRecom = false, discountId) {
        console.log("MULTI addOrderItem");
        var result = this.manager.addOrderItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    //IHLP-30 Combo Flow Refactoring, add item to the head
    addOrderItemRefactor(orderitem, isRecom = false, discountId) {
        console.log("MULTI addOrderItem");
        var result = this.manager.addOrderItemRefactor.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    //APPROVED
    addExistingOrderItem(orderitem) {
        console.log("MULTI addExistingOrderItem");
        var result = this.manager.addExistingOrderItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    //APPROVED
    duplicateOrderItem(orderitem) {
        const result = this.manager.duplicateOrderItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    //APPROVED
    replaceOrderItem(old, oi, qty = 1) {
        console.log('MULTI replaceOrderItem');
        var result = this.manager.replaceOrderItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    createOrderItem(category, itemgroup, item) {
        console.log("MULTI createOrderItem");
        return this.manager.createOrderItem.apply(this.manager, arguments);
    }
    //APPROVED
    addSingleItem(category, itemgroup, item, ignoreModifiers = true, isRecom = false, discountId, checkItemMin) {
        console.log("MULTI addSingleItem");
        var result = this.manager.addSingleItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    //IHLP-30 Combo Flow Refactoring, add item to the head
    addSingleItemRefactor(category, itemgroup, item, ignoreModifiers = true, isRecom = false, discountId, checkItemMin) {
        console.log("MULTI addSingleItemRefactor");
        var result = this.manager.addSingleItemRefactor.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    //APPROVED
    addSingleItemById(itemId) {
        var result = this.manager.addSingleItemById.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    //APPROVED
    reverseLookupItem(itemId) {
        var result = this.manager.reverseLookupItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    //APPROVED
    refreshOrderItem(orderitem) {
        console.log("MULTI addSingleItem");
        var result = this.manager.refreshOrderItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    isSet(oi) {
        return oi.combo || aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.isSet(oi);
    }
    isCouponMainItemOi(oi) {
        let mainItem = aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getMainItem(oi);
        return (mainItem === null || mainItem === void 0 ? void 0 : mainItem.type) === 'coupon';
    }
    // order level max
    checkOrderMaxItem(addQty = 0) {
        return this.manager.checkOrderMaxItem.apply(this.manager, arguments);
    }
    // check if current qty can be added to cart without exceeding item max
    checkAddItemMax(item, addQty) {
        return this.manager.checkAddItemMax.apply(this.manager, arguments);
    }
    checkInventory(item, quantity) {
        if (!item || this.inventoryManager.getInv(item) == -1 || this.inventoryManager.getInv(item) >= quantity) {
            return true;
        }
        else {
            return false;
        }
    }
    getInv(item) {
        return this.inventoryManager.getInv(item);
    }
    isTakeout() {
        return this.mode === "takeaway";
    }
    minusItem(item, ignoreModifiers = true, checkItemMin) {
        console.log("MULTI minusItem");
        var result = this.manager.minusItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    minusUnlockItem(item, checkItemMin) {
        console.log("MULTI minusUnlockItem");
        var result = this.manager.minusUnlockItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    removeUnlockItems(unlockCat) {
        this.manager.removeUnlockItems.apply(this.manager, arguments);
    }
    removeUnlockByItemId(itemId) {
        this.manager.removeUnlockByItemId.apply(this.manager, arguments);
    }
    removeUnlockByDiscountId(discountId) {
        this.manager.removeUnlockByDiscountId.apply(this.manager, arguments);
    }
    minusOrderItem(orderitem, minusItem_all) {
        console.log('MULTI minusOrderItem');
        var result = this.manager.minusOrderItem.apply(this.manager, arguments);
        if (this.multi) {
            this.calculateCourtOrder();
        }
        return result;
    }
    isEmpty() {
        var _a, _b, _c;
        if (!this.multi) {
            return (_b = (_a = this.manager) === null || _a === void 0 ? void 0 : _a.isEmpty()) !== null && _b !== void 0 ? _b : true;
        }
        if (!this.order) {
            return true;
        }
        if (this.multi) {
            let emptyMulti = true;
            (_c = this.order.subs) === null || _c === void 0 ? void 0 : _c.forEach(s => {
                if (s.orderitems.length > 0) {
                    emptyMulti = false;
                }
            });
            return emptyMulti;
        }
        return this.order.total == 0;
    }
    getQuantity(item) {
        var _a, _b;
        return (_b = (_a = this.manager) === null || _a === void 0 ? void 0 : _a.getQuantity) === null || _b === void 0 ? void 0 : _b.apply(this.manager, arguments);
    }
    //TODO: this sounds like should be at outter level
    getPreparetionTime() {
        return this.manager.getPreparetionTime.apply(this.manager, arguments);
    }
    setDiscountCode(code) {
        this.promoCode = code;
    }
    setPromoCode(code) {
        this.promoCode = code;
    }
    setDicountCodes(code) {
        this.promoCodes.push(code);
    }
    setPromoCodes(code) {
        this.promoCodes.push(code);
    }
    resetPromoCodes() {
        this.promoCodes = [];
    }
    removeFromPromoCodes(code) {
        var _a;
        this.promoCodes = (_a = this.promoCodes) === null || _a === void 0 ? void 0 : _a.filter((promoCode) => {
            return promoCode !== code;
        });
    }
    setSeats(seats) {
        this.order.seats = seats;
    }
    setSource(source) {
        this.order.source = source;
    }
    getCount() {
        var _a, _b;
        return (_b = (_a = this.manager) === null || _a === void 0 ? void 0 : _a.count) !== null && _b !== void 0 ? _b : 0;
    }
    switchManager(storeId) {
        var _a, _b, _c;
        if (((_a = this.managers) === null || _a === void 0 ? void 0 : _a.length) > 0 && ((_c = (_b = this.manager) === null || _b === void 0 ? void 0 : _b.store) === null || _c === void 0 ? void 0 : _c.id) != storeId) {
            const om = this.findOm(storeId);
            if (om) {
                this.manager = om;
                console.log('manager is switched', this.manager);
            }
        }
    }
    getStoreFromActiveManager() {
        var _a;
        return (_a = this.manager) === null || _a === void 0 ? void 0 : _a.store;
    }
    getActiveManager() {
        return this.manager;
    }
    getManagers() {
        var _a;
        return (_a = this.managers) !== null && _a !== void 0 ? _a : [];
    }
    isAllowCheckoutZeroTotal(total) {
        var _a, _b, _c, _d;
        let allowed = false;
        let allowZeroTotalType;
        if (this.court) {
            allowZeroTotalType = this.court.allowZeroTotalType;
        }
        else {
            allowZeroTotalType = (_b = (_a = this.store) === null || _a === void 0 ? void 0 : _a.menu) === null || _b === void 0 ? void 0 : _b.allowZeroTotalType;
        }
        // if we have mode in allow zero total type, then should be allowed $0 order
        if ((allowZeroTotalType === null || allowZeroTotalType === void 0 ? void 0 : allowZeroTotalType.length) > 0) {
            if (allowZeroTotalType.includes('all') || allowZeroTotalType.includes(this.mode)) {
                allowed = true;
            }
        }
        const catType = [];
        // if we have all order items that all within points category, then should be allowed $0 order
        if (this.order) {
            (_c = this.order.orderitems) === null || _c === void 0 ? void 0 : _c.forEach(o => {
                if (o.categoryType) {
                    catType.push(o.categoryType);
                }
            });
            (_d = this.order.subs) === null || _d === void 0 ? void 0 : _d.forEach(sub => {
                var _a;
                (_a = sub.orderitems) === null || _a === void 0 ? void 0 : _a.forEach(o => {
                    if (o.categoryType) {
                        catType.push(o.categoryType);
                    }
                });
            });
            const uniqCatType = catType.filter((n, i) => catType.indexOf(n) === i);
            if (uniqCatType.includes('points') && uniqCatType.length == 1) {
                allowed = true;
            }
        }
        return !this.isEmpty() && allowed && total == 0;
    }
    // 判断offer 是否可以单独下单(不点其他orderItem)
    hasOfferAlone() {
        const offers = [...this.selectedOffers, ...this.bundledOffer];
        return offers.some(o => { var _a, _b; return (_b = (_a = o === null || o === void 0 ? void 0 : o.reward) === null || _a === void 0 ? void 0 : _a['extra']) === null || _b === void 0 ? void 0 : _b.alone; });
    }
    setMemberPoints(member) {
        var _a;
        (_a = this.manager) === null || _a === void 0 ? void 0 : _a.setUserPoints(member);
    }
    isAllItemPoints() {
        var _a, _b;
        let ois = [];
        this.order.courtId ? (_a = this.order.subs) === null || _a === void 0 ? void 0 : _a.forEach(s => { ois.push(s.orderitems); })
            : ois = (_b = this.order) === null || _b === void 0 ? void 0 : _b.orderitems;
        if (ois.length === 0) {
            return false;
        }
        else {
            return !ois.some((orderItem) => orderItem.categoryType !== 'points');
        }
    }
    saveOrderCheckpoint() {
        this.manager.saveOrderCheckpoint.apply(this.manager, arguments);
    }
    restoreLastOrderCheckpoint() {
        this.manager.restoreLastOrderCheckpoint.apply(this.manager, arguments);
    }
    clearOrderCheckpoint() {
        this.manager.clearOrderCheckpoint.apply(this.manager, arguments);
    }
}
OrderManager.ɵfac = function OrderManager_Factory(t) { return new (t || OrderManager)(_angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_11__.Injector)); };
OrderManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdefineInjectable"]({ token: OrderManager, factory: OrderManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 31372:
/*!*******************************************************************!*\
  !*** ./projects/core/src/app/framework/managers/price-manager.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PriceManager": () => (/* binding */ PriceManager)
/* harmony export */ });
/* harmony import */ var aigens_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-data */ 51707);
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash-es */ 50904);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);



/**
 * Update items' price according to different modes
 * **/
class PriceManager {
    constructor() {
        this.level = 1;
        this.priceRules = [];
        this.priceLevelChange = false;
    }
    getTime() {
        var _a;
        if (this.debugTime) {
            return this.debugTime;
        }
        // return new Date().getTime();
        return (_a = this.directoryUnixTime) !== null && _a !== void 0 ? _a : new Date().getTime();
    }
    setDebugTime(time) {
        this.debugTime = time;
    }
    pickPriceTierRule(menu, mode, member, store) {
        var _a, _b, _c;
        var level = 1;
        var priceRules = menu.priceRules;
        if (!priceRules) {
            return level;
        }
        var now = this.getTime();
        console.log("checking priceRules", priceRules);
        var topMPr;
        var topScore = -10000;
        var type = ((_b = (_a = member === null || member === void 0 ? void 0 : member.membership) === null || _a === void 0 ? void 0 : _a.memberTierPolicy) === null || _b === void 0 ? void 0 : _b.tier) || ((_c = member === null || member === void 0 ? void 0 : member.membership) === null || _c === void 0 ? void 0 : _c.tier);
        for (const pr of priceRules) {
            var score = aigens_data__WEBPACK_IMPORTED_MODULE_0__.PriceRule.getMatch(pr, now, mode, member, store, true);
            if (score > topScore) {
                if (!pr.priority) {
                    pr.priority = 0;
                }
                if ((!topMPr || (topMPr && pr.priority > topMPr.priority) && type === (pr === null || pr === void 0 ? void 0 : pr.tier))) {
                    topMPr = pr;
                    topScore = score;
                }
            }
        }
        if (topMPr) {
            level = topMPr.level;
        }
        return level;
    }
    spotPeriodLevel(store, spotData) {
        var _a, _b;
        const spotOpen = spotData === null || spotData === void 0 ? void 0 : spotData['open'];
        const spotPeriod = spotOpen && ((_a = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Store.checkTimeWithinPeriods(store, spotOpen)) === null || _a === void 0 ? void 0 : _a[0]);
        if (lodash_es__WEBPACK_IMPORTED_MODULE_1__["default"].isEmpty(spotData) || lodash_es__WEBPACK_IMPORTED_MODULE_1__["default"].isEmpty(spotPeriod)) {
            return undefined;
        }
        const spotPeriodCode = spotPeriod === null || spotPeriod === void 0 ? void 0 : spotPeriod.code;
        const currentPeriod = (_b = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Store.checkTimeWithinPeriods(store, this.getTime())) === null || _b === void 0 ? void 0 : _b[0];
        const periodOverride = currentPeriod === null || currentPeriod === void 0 ? void 0 : currentPeriod.periodOverride;
        return periodOverride === null || periodOverride === void 0 ? void 0 : periodOverride[spotPeriodCode];
    }
    pickPriceRule(menu, mode, member, store, spotData = {}) {
        var _a;
        var level = 1;
        const spotLevel = this.spotPeriodLevel(store, spotData);
        if (typeof spotLevel !== 'undefined') {
            return spotLevel;
        }
        var priceRules = (_a = menu.priceRules) === null || _a === void 0 ? void 0 : _a.filter((priceRule) => !priceRule.tier);
        if (!priceRules) {
            return level;
        }
        var now = this.getTime();
        console.log("checking priceRules", priceRules);
        var topPr;
        var topScore = -10000;
        for (const pr of priceRules) {
            var score = aigens_data__WEBPACK_IMPORTED_MODULE_0__.PriceRule.getMatch(pr, now, mode, member, store, false);
            if (score > topScore) {
                // if match, then get the highest priority
                if (!pr.priority) {
                    pr.priority = 0;
                }
                if (!topPr || (topPr && pr.priority > topPr.priority)) {
                    topPr = pr;
                    topScore = score;
                }
            }
        }
        if (topPr) {
            level = topPr.level;
        }
        return level;
    }
    updateBasePrice(menu, mode, member, store = null, spotData = {}) {
        console.log('updateBasePrice', mode, member, this.getTime());
        var newLevel = this.pickPriceRule(menu, mode, member, store, spotData);
        console.log('pick level', newLevel);
        if (newLevel == menu.priceLevel) {
            this.priceLevelChange = false;
            return;
        }
        this.priceLevelChange = true;
        this.level = newLevel;
        menu.priceLevel = newLevel;
        this.priceRules = menu.priceRules;
        var gmap = menu['gmap'];
        var keys = Object.keys(gmap);
        for (const key of keys) {
            var ig = gmap[key];
            for (const item of ig.items) {
                var priceX = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Item.getPrice(item, this.level);
                item.price = priceX;
            }
        }
    }
    updateMinMaxPrice(menu) {
        console.log("updating min max price");
        var gmap = menu['gmap'];
        if (!gmap) {
            console.log("no gmap for this menu", menu.id);
            return;
        }
        var keys = Object.keys(gmap);
        for (const key of keys) {
            var ig = gmap[key];
            var maxPrice = null;
            var minPrice = null;
            for (const item of ig.items) {
                var price = item.price;
                if (maxPrice == null || price > maxPrice)
                    maxPrice = price;
                if (minPrice == null || price < minPrice)
                    minPrice = price;
            }
            if (ig.min > 0) {
                ig.minPrice = minPrice * ig.min;
                ig.maxPrice = maxPrice * ig.min;
            }
        }
        for (const key of keys) {
            var ig = gmap[key];
            for (const item of ig.items) {
                if (item.groupIds && item.groupIds.length > 0) {
                    var price = item.price;
                    var minPrice = price;
                    var maxPrice = price;
                    for (const gid of item.groupIds) {
                        var ig = gmap[gid];
                        if (ig) {
                            if (ig.minPrice)
                                minPrice += ig.minPrice;
                            if (ig.maxPrice)
                                maxPrice += ig.maxPrice;
                        }
                    }
                    item.minPrice = minPrice;
                    item.maxPrice = maxPrice;
                }
            }
        }
    }
    pickOrderMinMax(menu, mode, member, store) {
        var priceRules = menu.priceRules;
        if (!priceRules)
            return;
        var now = this.getTime();
        console.log("checking priceRules", priceRules);
        var topPr;
        var topScore = -10000;
        for (const pr of priceRules) {
            var score = aigens_data__WEBPACK_IMPORTED_MODULE_0__.PriceRule.getMatch(pr, now, mode, member, store, false);
            if (score > topScore) {
                topPr = pr;
                topScore = score;
            }
            console.log('score', score, pr.name);
        }
        return topPr;
    }
    memberTierPrice(menu, mode, member, store = null) {
        var _a, _b, _c, _d;
        const memberTier = ((_b = (_a = member === null || member === void 0 ? void 0 : member.membership) === null || _a === void 0 ? void 0 : _a.memberTierPolicy) === null || _b === void 0 ? void 0 : _b.tier) || ((_c = member === null || member === void 0 ? void 0 : member.membership) === null || _c === void 0 ? void 0 : _c.tier);
        if (memberTier) {
            var tierLevel = this.pickPriceTierRule(menu, mode, member, store);
            var originalLevel = this.pickPriceRule(menu, mode, member, store);
            var gmap = menu['gmap'];
            var keys = Object.keys(gmap);
            for (const key of keys) {
                var ig = gmap[key];
                for (const item of ig.items) {
                    if (((_d = item.memberTier) === null || _d === void 0 ? void 0 : _d.includes(memberTier)) && tierLevel !== 0 && tierLevel !== originalLevel) {
                        var priceX = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Item.getPrice(item, tierLevel);
                        var priceY = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Item.getPrice(item, originalLevel);
                        item.price = priceX;
                        item['originalPrice'] = priceY;
                    }
                }
            }
        }
    }
}
PriceManager.ɵfac = function PriceManager_Factory(t) { return new (t || PriceManager)(); };
PriceManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineInjectable"]({ token: PriceManager, factory: PriceManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 91715:
/*!****************************************************************************!*\
  !*** ./projects/core/src/app/framework/managers/recommendation-manager.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RecommendationManager": () => (/* binding */ RecommendationManager)
/* harmony export */ });
/* harmony import */ var aigens_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-data */ 51707);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! .. */ 44651);



/**
 * Get AI recommendated item for Aigens member
 * **/
class RecommendationManager {
    constructor(menuManager, orderManager, inventoryManager) {
        this.menuManager = menuManager;
        this.orderManager = orderManager;
        this.inventoryManager = inventoryManager;
        this.debug = false;
    }
    shouldRecommend(brand, store, menu) {
        var enabled = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Brand.hasFeature(brand, "recommend");
        return enabled;
    }
    /* sort cateogry by top-5 item average score */
    sortCategories(categories, member = null, behavior = null, numTop = 5) {
        var likes = this.compileLikes(behavior);
        let categoryScores = [];
        for (let i = 0; i < categories.length; i++) {
            let catScore = this.calculateCategoryAvgScore(categories[i], member, behavior, likes, numTop);
            categoryScores.push({
                index: i,
                score: catScore.avgScore,
                topItem: catScore.topItem
            });
        }
        categoryScores.sort((a, b) => b.score - a.score); //descending order
        console.log('scores of original categories: ', categoryScores);
        let sortedCats = [];
        let topItems = [];
        for (let i = 0; i < categories.length; i++) {
            sortedCats.push(categories[categoryScores[i].index]);
            topItems.push(categoryScores[i].topItem);
        }
        return { cats: sortedCats, topItems: topItems };
    }
    // calculate the average rating score of top-5(default) items in a category
    calculateCategoryAvgScore(category, member, behavior, likes, numTop = 5) {
        var scores = [];
        var numItems = 0;
        var topItem;
        var maxScore = 0;
        for (let grp of category.groups) {
            numItems = numItems + grp.items.length;
            for (let item of grp.items) {
                let score = this.calculateScore(member, behavior, item, likes).score;
                scores.push(score);
                if (score > maxScore) {
                    maxScore = score;
                    topItem = item;
                }
            }
        }
        scores.sort((a, b) => b - a); //descending order
        numItems = numItems > numTop ? numTop : numItems;
        let sumScores = 0;
        for (let i = 0; i < numItems; i++) {
            sumScores += scores[i];
        }
        let avgScore = sumScores / numItems;
        return { avgScore: avgScore, topItem: topItem };
    }
    makeItemRecommendations(menu, item, member, behavior, type = "main", limit) {
        if (!menu || !item || !behavior)
            return [];
        var itemRelation = menu.itemRelation;
        if (!itemRelation)
            return [];
        var basics = this.makeRecommendations(menu, member, behavior, type, limit);
        var rmap = itemRelation[item.id] || itemRelation[item.backendId];
        var weights = {};
        if (behavior) {
            weights = behavior.weights || {};
        }
        var itemRelationWeight = weights["itemRelation"] || 5;
        this.log("rmap", rmap);
        for (let r of basics) {
            var targetItem = r.item;
            var weight;
            if (rmap) {
                weight = rmap[targetItem.id] || rmap[targetItem.backendId];
            }
            else {
                var reverse = itemRelation[targetItem.id] || itemRelation[targetItem.backendId];
                if (reverse) {
                    weight = reverse[item.id] || reverse[item.backendId];
                }
                this.log("reverse", reverse);
            }
            if (weight) {
                this.log("weight", targetItem.name, weight);
            }
            else {
                weight = 0;
            }
            var relationScore = weight * itemRelationWeight;
            var reason = {
                type: "itemRelation",
                value: weight,
                score: relationScore
            };
            r.reasons.push(reason);
            r.relationScore = relationScore;
            r.score += relationScore;
        }
        basics.sort(this.compareRecommendation);
        return basics;
    }
    //types, single, main, default main
    makeRecommendations(menu, member, behavior, type = "main", limit, currentTime) {
        if (!menu || !behavior)
            return [];
        this.log("behavior", behavior);
        if (!currentTime) {
            currentTime = new Date().getTime();
        }
        var likes = this.compileLikes(behavior);
        var result = [];
        let categories;
        if (menu.recommendation) {
            categories = menu.categories.concat(menu.recommendation);
        }
        else {
            categories = menu.categories;
        }
        for (let cat of categories) {
            if (!cat.groups)
                continue;
            if (!this.menuManager.isAvailableCategory(this.orderManager.store, cat, this.orderManager.mode === 'takeaway', true, currentTime, this.orderManager.mode)) {
                continue;
            }
            //only consider main items
            var ig = cat.groups[0];
            if (!ig.items)
                continue;
            //if single only, and cat have usb groups, skip
            if ("single" == type && cat.groups.length > 1)
                continue;
            for (let item of ig.items) {
                if (!this.menuManager.isAvailableItem(this.orderManager.store, cat, ig, item, this.orderManager.mode === 'takeaway', currentTime, this.orderManager.mode)) {
                    continue;
                }
                if (this.inventoryManager.isSoldout(item)) {
                    continue;
                }
                if ("single" == type && item.groupIds && item.groupIds.length > 1) {
                    //if single only, and item have sub groups, skip
                    continue;
                }
                //free item should not be recommended
                if (item.price <= 1) {
                    this.log("skipping no price", item);
                    continue;
                }
                var r = this.calculateScore(member, behavior, item, likes);
                r.category = cat;
                r.itemgroup = ig;
                r.item = item;
                let isExist = result.some((res) => {
                    return item && res && res.item && item.id === res.item.id;
                });
                !isExist && result.push(r);
            }
        }
        result.sort(this.compareRecommendation);
        this.log("low level recom sorted", result);
        if (limit && result.length > limit) {
            result.splice(limit);
        }
        console.log("result", result);
        return result;
    }
    compileLikes(behavior) {
        var likes = {};
        if (!behavior)
            return likes;
        for (var key in behavior) {
            if ('weights' != key) {
                this.addLikes(likes, behavior[key]);
            }
        }
        //this.log("likes2", likes);
        return likes;
    }
    //types, single, main, default main
    sortItems(items, member = null, behavior = null) {
        //this.log("behavior", behavior);
        var likes = this.compileLikes(behavior);
        var result = [];
        for (let item of items) {
            var r = this.calculateScore(member, behavior, item, likes);
            r.item = item;
            result.push(r);
        }
        result.sort(this.compareRecommendation);
        let sorted = result.map(r => r.item);
        //this.log("sort results", sorted);
        return sorted;
    }
    groupRecommendations(recs, sort = "full") {
        var map = {};
        for (let rec of recs) {
            var item = rec.item;
            var cleanName = this.cleanName(item.name);
            var prefId = rec.item['preferenceId'];
            if (!prefId) {
                prefId = cleanName;
            }
            var prefg = map[prefId];
            if (!prefg) {
                prefg = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.RecommendationGroup();
                prefg.name = cleanName;
                prefg.preferenceId = prefId;
                prefg.recommendations = [];
                prefg.scores = {};
                map[prefId] = prefg;
            }
            prefg.recommendations.push(rec);
            this.setIfHigher(prefg.scores, "full", rec.score);
            var featuredScore = rec.featuredScore;
            if (!featuredScore)
                featuredScore = 0;
            var finalScore = rec.score + featuredScore * 100;
            this.setIfHigher(prefg.scores, "featuredFull", finalScore);
            for (let reason of rec.reasons) {
                this.setIfHigher(prefg.scores, reason.type, reason.score);
            }
        }
        var result = [];
        for (var key in map) {
            result.push(map[key]);
        }
        if (sort == 'full') {
            sort = 'featuredFull';
        }
        result = this.sortRecommendationGroups(result, sort);
        this.log("rec groups", result);
        return result;
    }
    sortRecommendationGroups(rgroups, sort) {
        //this.log("sorting by", sort);
        if (!rgroups || rgroups.length == 0)
            return [];
        var result = rgroups.slice();
        result.sort((a, b) => (a.scores[sort] > b.scores[sort]) ? -1 : ((b.scores[sort] > a.scores[sort]) ? 1 : 0));
        return result;
    }
    addLikes(likes, segments) {
        if (!segments)
            return;
        for (let s of segments) {
            s.options = segments.length;
            likes[s.name] = s;
        }
    }
    calculateScore(member, behavior, item, likes = {}) {
        var rating = item.rating;
        if (!rating)
            rating = 2.5;
        var popularity = item.popularity;
        if (!popularity)
            popularity = 2.5;
        var segmentScore = 0;
        var ratingScore = 0;
        var popularityScore = 0;
        var aiValue = 0;
        var reasons = [];
        var segments = [];
        if (item.segments) {
            for (var seg of item.segments) {
                var profile = likes[seg];
                if (profile) {
                    var intensity = profile.intensity;
                    if (intensity) {
                        segmentScore += intensity / 100;
                        segments.push(seg);
                    }
                    var prop = profile.prop;
                    if (prop) {
                        //we want the score value to max at 5
                        aiValue += prop / 20;
                    }
                    else {
                        //if propbability is not defined, we assumed the base line prob, which is 100 divide by number of options
                        prop = 100 / profile.options;
                        aiValue += prop / 20;
                    }
                }
            }
            //take the average?
            aiValue = aiValue / item.segments.length;
        }
        //need to weight the segment scores, because this will favor food with many segments too much
        var segmentCount = segments.length;
        if (segmentCount > 0) {
            var segmentWeight = 1 + ((segmentCount - 1) / 10);
            segmentScore = (segmentScore / segmentCount) * segmentWeight;
        }
        var weights = {};
        if (behavior) {
            weights = behavior.weights || {};
        }
        var prefWeight = weights["preference"] || 0.3;
        var ratingWeight = weights["rating"] || 0.4;
        var popularWeight = weights["popularity"] || 0.3;
        var autoWeight = weights["auto"] || 0.3;
        var pref = segmentScore * 5.0;
        var prefScore = pref * prefWeight;
        reasons.push({
            type: "preference",
            value: segments,
            score: prefScore
        });
        ratingScore = rating * ratingWeight;
        reasons.push({
            type: "rating",
            value: rating,
            score: ratingScore
        });
        popularityScore = popularity * popularWeight;
        reasons.push({
            type: "popularity",
            value: popularity,
            score: popularityScore
        });
        var aiScore = aiValue * autoWeight;
        reasons.push({
            type: "ai",
            value: aiValue,
            score: aiScore
        });
        var result = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.Recommendation();
        var featuredScore = item.featuredRating;
        if (featuredScore && this.shouldFeatured(member, item)) {
            result.featuredScore = featuredScore;
            reasons.push({
                type: "featured",
                value: featuredScore,
                score: featuredScore
            });
        }
        result.score = prefScore + ratingScore + popularityScore + aiScore;
        result.reasons = reasons;
        return result;
    }
    compareRecommendation(a, b) {
        var fs1 = a.featuredScore ? a.featuredScore : 0;
        var fs2 = b.featuredScore ? b.featuredScore : 0;
        if (fs1 || fs2) {
            return (fs1 > fs2) ? -1 : ((fs2 > fs1) ? 1 : 0);
        }
        return (a.score > b.score) ? -1 : ((b.score > a.score) ? 1 : 0);
    }
    shouldFeatured(member, item) {
        if (!item.featuredUsers || item.featuredRating == 0)
            return false;
        if (member && member.id > 10 && item.featuredUsers.indexOf('member') >= 0) {
            return true;
        }
        else if (!member && item.featuredUsers.indexOf('guest') >= 0) {
            return true;
        }
        return false;
    }
    setIfHigher(scores, type, value) {
        var existing = scores[type];
        if (!existing || value > existing) {
            scores[type] = value;
        }
    }
    cleanName(name) {
        var result = name.replace(/ *\([^)]*\) */g, "");
        return result;
    }
    log(tag, ...others) {
        if (!this.debug)
            return;
        console.log(tag, others);
    }
}
RecommendationManager.ɵfac = function RecommendationManager_Factory(t) { return new (t || RecommendationManager)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](___WEBPACK_IMPORTED_MODULE_1__.MenuManager), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](___WEBPACK_IMPORTED_MODULE_1__.OrderManager), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](___WEBPACK_IMPORTED_MODULE_1__.InventoryManager)); };
RecommendationManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineInjectable"]({ token: RecommendationManager, factory: RecommendationManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 15906:
/*!**************************************************************************!*\
  !*** ./projects/core/src/app/framework/managers/single-order-manager.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SingleOrderManager": () => (/* binding */ SingleOrderManager)
/* harmony export */ });
/* harmony import */ var aigens_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-data */ 51707);
/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! uuid */ 62535);
/* harmony import */ var _base_orderitem_builder__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/orderitem-builder */ 6949);
/* harmony import */ var _menu_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./menu-manager */ 4451);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _services_config_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../services/config.service */ 2171);
/* harmony import */ var _services_analytics_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../services/analytics.service */ 4297);
/* harmony import */ var _pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../pure/services/subscribe.service */ 47074);








/**
 * Manage order's data(items, discounts, calculation, etc.)
 * Manage order's life cycle (create, update, clear)
 * **/
class SingleOrderManager {
    constructor(configService, analyticsService, subscribe) {
        this.configService = configService;
        this.analyticsService = analyticsService;
        this.subscribe = subscribe;
        this.count = 0;
        this.total = 0;
        //cache of main item quantities
        this.quantities = {};
        this.stores = [];
        this.cutlery = false;
        this.contactless = false;
        this.menuSettings = {};
        this.letter = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        this.trackAnalytics = true;
        /**
         * To store a copy of original order to be restored later
         */
        this.checkpointOrder = null;
    }
    getOrder() {
        return this.order;
    }
    setOrder(order) {
        this.order = order;
        this.calculate();
    }
    setStation(station) {
        this.order.stationId = station;
        this.order.station = this.order.stationId;
    }
    //createOrder(store: Store, takeout: boolean = false, orderId: string = null, type = null, session?, sourceUrl?) {
    createOrder(store, mode, options = {}) {
        var _a;
        this.order = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.Order();
        this.store = store;
        this.mode = mode;
        this.order.type = mode;
        Object.assign(this.order, options);
        console.log('creating order');
        this.order.storeId = store.id;
        this.order.orderitems = [];
        this.order.uuid = (0,uuid__WEBPACK_IMPORTED_MODULE_6__["default"])();
        this.order.deviceId = this.configService.getDeviceId() + "";
        this.order.takeout = false;
        this.order.sourceUrl = window.location.href;
        if (this.member) {
            this.order.member = this.member;
        }
        if (this.member && this.member.backendId) {
            this.order.memberNumber = Number(this.member.backendId); //Yoshinoya member
        }
        /*
        if (store && store.menu) {
            this.setDiscounts(store.menu);
        } //CMS discounts
        */
        this.upselling = true;
        this.menuSettings = ((_a = this.store.menu) === null || _a === void 0 ? void 0 : _a.settings) || {};
    }
    // DANGER: should change orderManager.mode as well
    // takeoutChange(takeout: boolean) {
    //     this.order.takeout = takeout;
    // }
    setUserPoints(member) {
        if (!this.order || !member || !member['membership']) {
            return;
        }
        var points = member.membership.usablePoints;
        if (points) {
            this.order.usablePoints = points;
        }
    }
    setBrandId(id) {
        if (this.order) {
            this.order.brandId = id;
        }
    }
    /*
    setDiscounts(menu: Menu) {
        let discounts: Discount[] = [];

        if (menu.discounts) {
            discounts = menu.discounts;
        }

        this.order.promotions = [];

        discounts.forEach(d => {
            let promo = new Discount();
            promo.level = d.level;
            promo.benefits = [];
            if (d.benefits) {
                d.benefits.forEach(b => {
                    if (b.type == 'unlock' && menu.unlocks) {
                        promo.unlocks = menu.unlocks;
                    }
                    if (b.type == 'gift' && menu.gifts) {
                        promo.gifts = menu.gifts;
                    }
                    promo.benefits.push(Benefit.cloneBenefit(b));
                });
            }
            promo.conditions = [];
            if (d.conditions) {
                d.conditions.forEach(c => {
                    promo.conditions.push(Condition.cloneCondition(c));
                });
            }
            promo.name = d.name;
            promo.amount = d.amount;
            promo.available = d.available;
            promo.backendId = d.backendId;
            promo.id = d.id;
            promo.enabled = d.enabled;
            promo.desc = d.desc;
            promo.quantity = d.quantity;
            promo.backendType = d.backendType;
            promo.periods = d.periods;
            promo.alone = d.alone;
            promo.priority = d.priority;
            promo.group = d.group;

            this.order.promotions.push(promo);
        });
    }

    setNewDiscounts(discounts: Discount[], menu?: Menu) {
        this.order.promotions = [];

        discounts.forEach(d => {
            let promo = new Discount();
            promo.level = d.level;
            promo.benefits = [];

            if (d.benefits) {
                d.benefits.forEach(b => {
                    if (menu && b.type == 'unlock' && menu.unlocks) {
                        promo.unlocks = menu.unlocks;
                    }
                    if (menu && b.type == 'gift' && menu.gifts) {
                        promo.gifts = menu.gifts;
                    }
                    promo.benefits.push(Benefit.cloneBenefit(b));
                });
            }
            promo.conditions = [];
            if (d.conditions) {
                d.conditions.forEach(c => {

                    promo.conditions.push(Condition.cloneCondition(c));
                });
            }
            promo.name = d.name;
            promo.amount = d.amount;
            promo.available = d.available;
            promo.backendId = d.backendId;
            promo.id = d.id;
            promo.enabled = d.enabled;
            promo.desc = d.desc;
            promo.quantity = d.quantity;
            promo.periods = d.periods;
            promo.group = d.group;
            promo.alone = d.alone;
            promo.priority = d.priority;

            this.order.promotions.push(promo);
        });
    }
    */
    calcDiscountGrandTotal(order) {
        this.calculateOrder(order);
        // this.order.grandTotal = MathUtils.round(this.order.total + this.order.handling + this.order.exTax - this.order.discount, 2);
    }
    setStores(stores, masterId) {
        this.stores = stores;
        if (this.order) {
            this.order.multi = true;
        }
        if (masterId) {
            this.master = this.getStore(masterId);
        }
    }
    setNoUpselling() {
        this.upselling = false;
    }
    setMember(member) {
        this.member = member;
        if (this.order) {
            this.order.member = member;
            if (member.backendId) {
                this.order.memberNumber = Number(member.backendId); //Yoshinoya
            }
        }
        console.log('set member:', member);
    }
    setDiscountCode(code) {
        this.order.promoCode = code;
    }
    setPromoCode(code) {
        this.order.promoCode = code;
    }
    setDicountCodes(code) {
        this.order.promoCodes.push(code);
    }
    setPromoCodes(code) {
        this.order.promoCodes.push(code);
    }
    resetPromoCodes() {
        this.order.promoCodes = [];
    }
    setSeats(seats) {
        this.order.seats = seats;
    }
    setSource(source) {
        this.order.source = source;
    }
    isUsablePointsEnough(item) {
        let usablePoints = this.order ? this.order.usablePoints : 0;
        let usedPoints = this.order ? this.order.usedPoints : 0;
        let points = item.points ? item.points : 0;
        return usablePoints >= usedPoints + points;
    }
    //APPROVED
    refreshOrderItem(orderitem) {
        aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.flattenItems(orderitem);
        this.calculateOrderItem(orderitem);
        this.calculateOrder(this.order);
        console.log(this.order);
    }
    //APPROVED
    addOrderItem(orderitem, isRecom = false, discountId) {
        if (!this.isUsablePointsEnough(orderitem)) {
            throw { name: 'points-not-enough', layout: 'toast' };
        }
        aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.flattenItems(orderitem);
        orderitem.setRecommended(isRecom);
        orderitem.setDicountcode(discountId);
        this.order.orderitems.push(orderitem);
        this.calculateOrderItem(orderitem);
        this.calculateOrder(this.order);
        if (this.trackAnalytics) {
            this.analyticsService.trackAddToCart(orderitem);
        }
    }
    //IHLP-30 Combo Flow Refactoring: IHLP-25 requirement, add item to the head
    addOrderItemRefactor(orderitem, isRecom = false, discountId) {
        if (!this.isUsablePointsEnough(orderitem)) {
            throw { name: 'points-not-enough', layout: 'toast' };
        }
        aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.flattenItems(orderitem);
        orderitem.setRecommended(isRecom);
        orderitem.setDicountcode(discountId);
        this.order.orderitems.unshift(orderitem);
        this.calculateOrderItem(orderitem);
        this.calculateOrder(this.order);
        if (this.trackAnalytics) {
            this.analyticsService.trackAddToCart(orderitem);
        }
    }
    //APPROVED
    addExistingOrderItem(orderitem) {
        if (!this.isUsablePointsEnough(orderitem)) {
            throw { name: 'points-not-enough', layout: 'toast' };
        }
        orderitem.quantity++;
        this.calculateOrderItem(orderitem);
        this.calculateOrder(this.order);
        if (this.trackAnalytics) {
            var index = this.order.orderitems.indexOf(orderitem);
            if (index !== -1) {
                this.analyticsService.trackAddToCart(orderitem);
            }
        }
    }
    //APPROVED
    duplicateOrderItem(orderitem) {
        if (!this.isUsablePointsEnough(orderitem)) {
            throw { name: 'points-not-enough', layout: 'toast' };
        }
        var oi = _base_orderitem_builder__WEBPACK_IMPORTED_MODULE_1__.OrderItemBuilder.cloneOrderItem(orderitem, true);
        this.addOrderItem(oi);
        return oi;
    }
    //APPROVED
    replaceOrderItem(old, oi, qty = 1) {
        old.groups = oi.groups;
        old.quantity = qty;
        aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.flattenItems(old);
        this.calculateOrderItem(old);
        this.calculateOrder(this.order);
        console.log(this.order);
        //this.$itemChange.next({ orderItem: oi, type: 'edit' });
    }
    createOrderItem(category, itemgroup, item) {
        let builder = new _base_orderitem_builder__WEBPACK_IMPORTED_MODULE_1__.OrderItemBuilder(this.store);
        builder.setCategory(category);
        builder.setItem(itemgroup, item, 0);
        let oi = builder.build();
        return oi;
    }
    //APPROVED
    addSingleItem(category, itemgroup, item, ignoreModifiers = true, isRecom = false, discountId, checkItemMin) {
        console.log('addSingleItem');
        if (!this.isUsablePointsEnough(item)) {
            throw { name: 'points-not-enough', layout: 'toast' };
        }
        var orderitem = this.findOrderItem(item, ignoreModifiers);
        if (!orderitem || item.type == 'coupon') {
            var builder = new _base_orderitem_builder__WEBPACK_IMPORTED_MODULE_1__.OrderItemBuilder(this.store);
            builder.setCategory(category);
            builder.setItem(itemgroup, item, 0);
            var oi;
            if (checkItemMin && item && item.min && item.min > 1) {
                // 第一次加入的item quality = item.min
                oi = builder.build(item.min);
            }
            else {
                oi = builder.build();
            }
            this.addOrderItem(oi, isRecom, discountId);
            //this.$itemChange.next({ orderItem: oi, type: 'add', quantity: oi.quantity });
            return oi;
        }
        else {
            orderitem.quantity++;
            this.calculateOrderItem(orderitem);
            this.calculateOrder(this.order);
            //this.$itemChange.next({ orderItem: orderitem, type: 'add', quantity: 1 });
            return orderitem;
        }
    }
    //IHLP-30 Combo Flow Refactoring, add item to the head
    addSingleItemRefactor(category, itemgroup, item, ignoreModifiers = true, isRecom = false, discountId, checkItemMin) {
        console.log('addSingleItemRefactor');
        if (!this.isUsablePointsEnough(item)) {
            throw { name: 'points-not-enough', layout: 'toast' };
        }
        var builder = new _base_orderitem_builder__WEBPACK_IMPORTED_MODULE_1__.OrderItemBuilder(this.store);
        builder.setCategory(category);
        builder.setItem(itemgroup, item, 0);
        var oi;
        if (checkItemMin && item && item.min && item.min > 1) {
            // 第一次加入的item quality = item.min
            oi = builder.build(item.min);
        }
        else {
            oi = builder.build();
        }
        this.addOrderItemRefactor(oi, isRecom, discountId);
        //this.$itemChange.next({ orderItem: oi, type: 'add', quantity: oi.quantity });
        return oi;
    }
    addSingleItemById(itemId) {
        console.log("adding item by string id", itemId);
        /*
        var rimap = this.store?.menu['rimap'];
        if(!rimap){
            console.log("no rimap");
            return null;
        }

        var e = rimap[itemId];
        if(!e){
            console.log("no reverse item entry", itemId);
            return null;
        }
        */
        var e = this.reverseLookupItem(itemId);
        if (!e) {
            console.log("no reverse item entry", itemId);
            return null;
        }
        return this.addSingleItem(e.c, e.ig, e.i);
    }
    reverseLookupItem(itemId) {
        var _a;
        var rimap = (_a = this.store) === null || _a === void 0 ? void 0 : _a.menu['rimap'];
        if (!rimap) {
            console.log("no rimap");
            return null;
        }
        var e = rimap[itemId];
        return e;
    }
    setItemQuantity(category, itemgroup, item, quantity, isRecom = false, discountId, checkItemMin) {
        if (!this.isUsablePointsEnough(item)) {
            throw { name: 'points-not-enough', layout: 'toast' };
        }
        var orderitem = this.findOrderItem(item, true);
        if (!orderitem) {
            if (quantity <= 0) {
                return null;
            }
            var builder = new _base_orderitem_builder__WEBPACK_IMPORTED_MODULE_1__.OrderItemBuilder(this.store);
            builder.setCategory(category);
            builder.setItem(itemgroup, item, 0);
            var oi;
            if (checkItemMin && item && item.min && item.min > 1) {
                // 第一次加入的item quality = item.min
                oi = builder.build(Math.max(item.min, quantity));
            }
            else {
                oi = builder.build(quantity);
            }
            this.addOrderItem(oi, isRecom, discountId);
            //this.$itemChange.next({ orderItem: oi, type: 'add', quantity: oi.quantity });
            return oi;
        }
        else {
            if (quantity <= 0) {
                this.removeObject(orderitem, this.order.orderitems);
                if (this.trackAnalytics) {
                    this.analyticsService.trackRemoveFromCart(orderitem);
                }
            }
            orderitem.quantity = quantity;
            this.calculateOrderItem(orderitem);
            this.calculateOrder(this.order);
            //this.$itemChange.next({ orderItem: orderitem, type: 'edit' });
            return orderitem;
        }
    }
    minusItem(item, ignoreModifiers = true, includesCombo = false, checkItemMin) {
        var orderitem = this.findOrderItem(item, ignoreModifiers, includesCombo);
        if (orderitem) {
            let minusItem_all = false;
            if (checkItemMin && item && item.min && item.min > 1 && orderitem.quantity === item.min) {
                minusItem_all = true;
            }
            this.minusOrderItem(orderitem, minusItem_all);
            //this.$itemChange.next({ orderItem: orderitem, type: 'delete' });
        }
    }
    // remove the combo-orderitem which is top by mainItem
    minusUnlockItem(mainItem, checkItemMin) {
        this.minusItem(mainItem, true, true, checkItemMin);
    }
    minusOrderItem(orderitem, minusItem_all) {
        if (orderitem) {
            orderitem.quantity--;
            minusItem_all && (orderitem.quantity = 0);
            if (orderitem.quantity <= 0) {
                this.removeObject(orderitem, this.order.orderitems);
            }
            if (this.trackAnalytics) {
                this.analyticsService.trackRemoveFromCart(orderitem);
            }
            this.calculateOrder(this.order);
        }
    }
    // remove UnlockItem
    removeUnlockItems(unlockCat) {
        var _a;
        let unlockCatOrderItems = [];
        (_a = this.order) === null || _a === void 0 ? void 0 : _a.orderitems.forEach(oi => {
            if ((aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem === null || aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem === void 0 ? void 0 : aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.isUnlockOrderItem(oi)) && (oi === null || oi === void 0 ? void 0 : oi.categoryId) === (unlockCat === null || unlockCat === void 0 ? void 0 : unlockCat.id)) {
                unlockCatOrderItems.push(oi);
            }
        });
        unlockCatOrderItems.map((oi) => { this.minusOrderItem(oi, true); });
        this.calculateOrder(this.order);
    }
    findOrderItem(item, ignoreModifiers = true, includesCombo = false) {
        for (let oi of this.order.orderitems) {
            var groups = oi.groups;
            if (groups.length == 1 || includesCombo) { // 原始logic 不能通过 combo-item 找到对应的 comboOrderItem; now it will return 最顶层的与 mainItem.id 相同的 orderItem
                var items = groups[0].items;
                if (item.id == items[0].id) {
                    if (ignoreModifiers) {
                        return oi;
                    }
                    else {
                        let mgroups = items[0].mgroups;
                        if (!mgroups || mgroups.length == 0) {
                            return oi;
                        }
                    }
                }
            }
        }
        return null;
    }
    findOrderItemEgift(item, ignoreModifiers = true, includesCombo = false) {
        for (let oi of this.order.orderitems) {
            var groups = oi.groups;
            if (groups.length == 1 || includesCombo) { // 原始logic 不能通过 combo-item 找到对应的 comboOrderItem; now it will return 最顶层的与 mainItem.id 相同的 orderItem
                var items = groups[0].items;
                if (item.id == items[0].id && item.custom.recipient === items[0].custom.recipient) {
                    if (ignoreModifiers) {
                        return oi;
                    }
                    else {
                        let mgroups = items[0].mgroups;
                        if (!mgroups || mgroups.length == 0) {
                            return oi;
                        }
                    }
                }
            }
        }
        return null;
    }
    getQuantity(item) {
        var result = this.quantities[item.id];
        if (!result) {
            result = 0;
        }
        return result;
    }
    calculate(changeEmit = true) {
        this.calculateOrder(this.order, changeEmit);
    }
    settingOrderType(type) {
        if (!this.order) {
            return;
        }
        this.order.type = type;
        this.order.takeout = type == 'takeaway';
    }
    isTakeout() {
        return this.mode === 'takeaway';
    }
    isEmpty() {
        if (!this.order || !this.order.orderitems) {
            return true;
        }
        return this.order.orderitems.length == 0;
    }
    clear() {
        this.order = null;
        this.count = 0;
        this.total = 0;
        this.quantities = {};
        this.member = null;
        this.users = null;
        this.mode = null;
        if (this.subscribe) {
            this.subscribe.next('order', null);
        }
    }
    clearOrderItems() {
        var list = this.order.orderitems;
        this.order.orderitems = [];
        this.calculate();
        //this.order$.next(this.order);
        //this.$itemChange.next(null);
        if (this.trackAnalytics) {
            for (let oi of list) {
                this.analyticsService.trackRemoveFromCart(oi);
            }
        }
    }
    getStore(storeId) {
        let t = this.store;
        if (this.stores) {
            for (let store of this.stores) {
                if (store.id == storeId) {
                    t = store;
                    break;
                }
            }
        }
        return t;
    }
    getMultiOrders(order, masterId) {
        if (!order.multi) {
            return [order];
        }
        else {
            let index = 0;
            let t = JSON.parse(JSON.stringify(order));
            t.orderitems = [];
            let result = new Map();
            order.orderitems.forEach(oi => {
                if (result && result.has(oi.storeId)) {
                    let temp = result.get(oi.storeId);
                    temp.orderitems.push(oi);
                    console.log('push updated order', temp);
                    result.set(oi.storeId, temp);
                }
                else {
                    let temp = JSON.parse(JSON.stringify(t));
                    temp.backendId = temp.orderNo;
                    temp.orderNo = this.getOrderNumber(temp.orderNo, index);
                    temp.orderitems.push(oi);
                    temp.storeId = oi.storeId;
                    temp.uuid = (0,uuid__WEBPACK_IMPORTED_MODULE_6__["default"])();
                    console.log('push order', temp);
                    result.set(oi.storeId, temp);
                    index++;
                }
            });
            let temp = [];
            let i = 0;
            result.forEach(order => {
                let master = this.getStore(masterId);
                let store = this.getStore(order.storeId);
                let first = i == 0;
                order = this.calculateOrderSafe(order, master, first);
                order.printers = store.printers;
                temp.push(order);
                i++;
            });
            console.log('multi Order return,', temp);
            return temp;
        }
    }
    isOnlyPointsItem() {
        let orderItems = (this.order && this.order.orderitems) || [];
        if (orderItems.length == 0) {
            return false;
        }
        let result = orderItems.some(oi => {
            if (!oi || !oi.categoryType || oi.categoryType != 'points') {
                return true;
            }
            return false;
        });
        return !result;
    }
    //calculate the net total need to pay
    getNetAmount() {
        let result = 0;
        let master = this.getMasterStore();
        let settings = this.menuSettings;
        let point = this.pointsFactor * this.order.usedPoints;
        if (isNaN(point) || point === null) {
            point = 0;
        }
        if (settings && settings.checkoutTrimDecimals && settings.checkoutTrimDecimalsMode) {
            let precision = this.menuSettings.checkoutTrimDecimalsPlace;
            if ((typeof precision) !== 'number') {
                precision = this.getStoreGrandTotalPrecision(master.currency);
            }
            if (this.menuSettings.checkoutTrimDecimalsMode === 'rounddown') {
                result = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.floor(this.order.grandTotal - point, precision);
            }
            else if (this.menuSettings.checkoutTrimDecimalsMode === 'roundup') {
                result = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.ceil(this.order.grandTotal - point, precision);
            }
            else if (this.menuSettings.checkoutTrimDecimalsMode === 'roundhalfup') {
                result = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(this.order.grandTotal - point, precision);
            }
            else if (this.menuSettings.checkoutTrimDecimalsMode === 'roundtonear5') {
                result = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.roundToNearest5(this.order.grandTotal - point, precision);
            }
            else {
                console.warn('invalid checkoutTrimDecimalsMode setting', this.menuSettings);
                result = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(this.order.grandTotal - point, precision);
            }
        }
        else {
            let p = this.getStoreGrandTotalPrecision(master.currency);
            result = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(this.order.grandTotal - point, p);
        }
        return result;
    }
    getOfferItemPriceSafe() {
        var price = 0;
        if (this.order && this.order.offers) {
            for (let offer of this.order.offers) {
                for (let orderItem of offer.orderitems) {
                    price = price + orderItem.total;
                }
            }
        }
        this.setStoreGrandTotalFormat();
        /*
        let settings = this.menuSettings;

        if (settings && settings.checkoutTrimDecimalsMode) {
            this.setStoreGrandTotalFormat(this.order.grandTotal);
        }*/
        return price;
    }
    removeObject(object, array) {
        var idx = array.indexOf(object);
        if (idx != -1) {
            array.splice(idx, 1);
        }
    }
    calculateOrder(order, changeEmit = true) {
        var count = 0;
        var total = 0;
        var usedPoints = 0;
        var usedPointsForItem = 0; // 存储 当前积分兑换item flow中使用的积分数
        var quantities = {};
        console.log('calculate order', this.order);
        for (let oi of this.order.orderitems) {
            // if (!OrderItem.isSet(oi)) {
            count += oi.quantity;
            let t = oi.quantity * oi.total;
            total += aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(t, 2);
            var mainItemId = oi.items[0].id;
            var quantity = quantities[mainItemId];
            if (!quantity) {
                quantity = 0;
            }
            quantity += oi.quantity;
            quantities[mainItemId] = quantity;
            // } else {
            //     count += oi.quantity;
            //     let t = oi.quantity * oi.total;
            //     total += MathUtils.round(t, 2);
            //     var mainItemId = oi.items[0].id;
            //     var quantity = quantities[mainItemId];
            //     if (!quantity) quantity = 0;
            //     quantity += oi.quantity;
            //     quantities[mainItemId] = quantity;
            // }
            // oi.points is not used in byod v2
            usedPoints += (oi.points * oi.quantity);
            usedPointsForItem += (oi.points * oi.quantity);
        }
        total = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(total, 2);
        this.count = count;
        this.total = total;
        this.quantities = quantities;
        this.order.grandTotal = total;
        this.order.total = total;
        if (!this.order.discount) {
            this.order.discount = 0;
        }
        this.order.handling = this.getHandling();
        // this.order.usedPoints = usedPoints;
        this.order.usedPointsForItem = usedPointsForItem;
        this.calculateUsedPoints(usedPointsForItem, this.order.usedPointsToMoney);
        this.order.serviceCharge = this.getServiceCharge();
        this.order.tax = this.getTax();
        //regenerate uuid, meaning the order is changed
        this.calcGrandTotal();
        this.order.uuid = (0,uuid__WEBPACK_IMPORTED_MODULE_6__["default"])();
        //this.order$.next(this.order);
        //changeEmit && this.onOrderitemsChange.emit("order change");
        if (this.subscribe) {
            this.subscribe.next('order', this.order);
        }
    }
    calculateUsedPoints(usedPointsForItem, usedPointsToMoney) {
        !usedPointsForItem && (usedPointsForItem = 0);
        !usedPointsToMoney && (usedPointsToMoney = 0);
        if (usedPointsForItem === 0 && usedPointsToMoney === 0) {
            this.order.usedPoints = 0;
            return;
        } //只有v3 才有 usedPointsToItem and usedPointsToMoney,防止干扰v2 v1
        this.order.usedPoints = usedPointsForItem + usedPointsToMoney; // 目前v3 usedPoints只有兑换item 和 抵消部分价钱
    }
    calculateOrderSafe(order, store, first) {
        var count = 0;
        var total = 0;
        var quantities = {};
        console.log('calculate order', order);
        for (let oi of order.orderitems) {
            if (!aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.isSet(oi)) {
                count += oi.quantity;
                let t = oi.quantity * oi.total;
                total += aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(t, 2);
                var mainItemId = oi.items[0].id;
                var quantity = quantities[mainItemId];
                if (!quantity) {
                    quantity = 0;
                }
                quantity += oi.quantity;
                quantities[mainItemId] = quantity;
            }
            else {
                count += oi.quantity;
                let t = oi.quantity * oi.total;
                total += aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(t, 2);
            }
        }
        total = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(total, 2);
        order.grandTotal = total;
        order.total = total;
        if (!order.discount) {
            order.discount = 0;
        }
        order.handling = this.getHandlingSafe(order, store, first);
        order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(order.total + order.handling - order.discount, 2);
        order.tax = this.getTaxSafe(order, store);
        //regenerate uuid, meaning the order is changed
        order.uuid = (0,uuid__WEBPACK_IMPORTED_MODULE_6__["default"])();
        // console.log("listener", this.listener);
        // if (this.listener) {
        //     this.listener.onOrderChanged(this.order);
        // }
        return order;
    }
    getSafeNum(value) {
        return (isNaN(value) || value === null) ? 0 : value;
    }
    getPrecision(defaultPrecision = 0) {
        let precision = defaultPrecision;
        try {
            let master = this.getMasterStore();
            let settings = this.menuSettings;
            if (settings && settings.checkoutTrimDecimals && (typeof settings.checkoutTrimDecimalsPlace) === 'number') {
                if ((typeof settings.checkoutTrimDecimalsPlace) === 'number') {
                    return this.menuSettings.checkoutTrimDecimalsPlace;
                }
            }
            precision = this.getStoreGrandTotalPrecision(master.currency);
        }
        catch (error) {
        }
        return precision;
    }
    calcGrandTotal() {
        let master = this.getMasterStore();
        let settings = this.menuSettings;
        let p = this.getStoreGrandTotalPrecision(master.currency);
        let taxExclusiveAmount = 0;
        if (this.order && this.order.taxes && this.order.taxes.length > 0) {
            this.order.taxes.forEach((taxR) => {
                if (!taxR.inclusive) {
                    taxExclusiveAmount += taxR.amount;
                }
            });
        }
        else {
            taxExclusiveAmount = this.order.tax;
        }
        let rawGrandTotal = this.getSafeNum(this.order.total) - this.getSafeNum(this.order.discount) + this.getSafeNum(this.order.handling) + this.getSafeNum(this.order.serviceCharge) + this.getSafeNum(taxExclusiveAmount) + this.getSafeNum(this.order.shipping);
        if (settings && settings.checkoutTrimDecimals && settings.checkoutTrimDecimalsMode) {
            let precision = this.menuSettings.checkoutTrimDecimalsPlace;
            if ((typeof precision) !== 'number') {
                precision = this.getStoreGrandTotalPrecision(master.currency);
            }
            if (this.menuSettings.checkoutTrimDecimalsMode === 'rounddown') {
                //this.order.discount = Math.floor(this.order.discount);
                this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.floor(rawGrandTotal, precision);
            }
            else if (this.menuSettings.checkoutTrimDecimalsMode === 'roundup') {
                this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.ceil(rawGrandTotal, precision);
            }
            else if (this.menuSettings.checkoutTrimDecimalsMode === 'roundhalfup') {
                this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(rawGrandTotal, precision);
            }
            else if (this.menuSettings.checkoutTrimDecimalsMode === 'roundtonear5') {
                this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.roundToNearest5(rawGrandTotal, precision);
            }
            else {
                console.warn('invalid checkoutTrimDecimalsMode setting', this.menuSettings);
                this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(rawGrandTotal, precision);
            }
        }
        else {
            this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(rawGrandTotal, p);
        }
        this.order.grandTotal = this.order.grandTotal > 0 ? this.order.grandTotal : 0;
        let overpay = 0;
        this.order.discounts.forEach((discount) => {
            if (discount.overpay) {
                overpay += discount.overpay;
            }
        });
        this.order.overpay = overpay;
    }
    // order.discount and order.handling which are calculate.json return are differnet form ng-core
    // frontend force to cover the order.handlin and order.discount in this.orderManager.order
    calcGrandTotalServer() {
        this.calcGrandTotal();
    }
    setStoreGrandTotalFormat() {
        let taxExclusiveAmount = 0;
        if (this.order && this.order.taxes && this.order.taxes.length > 0) {
            this.order.taxes.forEach((taxR) => {
                if (!taxR.inclusive) {
                    taxExclusiveAmount += taxR.amount;
                }
            });
        }
        else {
            taxExclusiveAmount = this.order.tax;
        }
        let precision = this.menuSettings.checkoutTrimDecimalsPlace;
        if ((typeof precision) !== 'number') {
            let master = this.getMasterStore();
            precision = this.getStoreGrandTotalPrecision(master.currency);
        }
        if (this.menuSettings.checkoutTrimDecimalsMode === 'rounddown') {
            //this.order.discount = Math.floor(this.order.discount);
            this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.floor(this.order.total - this.order.discount + this.order.handling + this.order.serviceCharge + taxExclusiveAmount + this.order.shipping, precision);
        }
        else if (this.menuSettings.checkoutTrimDecimalsMode === 'roundup') {
            this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.ceil(this.order.total - this.order.discount + this.order.handling + this.order.serviceCharge + taxExclusiveAmount + this.order.shipping, precision);
        }
        else if (this.menuSettings.checkoutTrimDecimalsMode === 'roundhalfup') {
            this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(this.order.total - this.order.discount + this.order.handling + this.order.serviceCharge + taxExclusiveAmount + this.order.shipping, precision);
        }
        else if (this.menuSettings.checkoutTrimDecimalsMode === 'roundtonear5') {
            this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.roundToNearest5(this.order.total - this.order.discount + this.order.handling + this.order.serviceCharge + taxExclusiveAmount + this.order.shipping, precision);
        }
        else {
            this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(this.order.total - this.order.discount + this.order.handling + this.order.serviceCharge + taxExclusiveAmount + this.order.shipping, precision);
        }
    }
    getStoreGrandTotalPrecision(currency) {
        if (!currency) {
            return 1;
        }
        let c = currency.slice(0, 2);
        if ('HK' === c) {
            return 1;
        }
        else if ('SG' === c) {
            return 2;
        }
        else if ('MY' === c) {
            return 2;
        }
        else if ('CN' === c) {
            return 2;
        }
        else if ('TW' === c) {
            //return "TWD";
        }
        else if ('MO' === c) {
            //return "MOP";
        }
        else if ('US' === c) {
            return 2;
        }
        else if ('CA' === c) {
            return 2;
        }
        else if ('IN' === c) {
            //return "INR";
        }
        else if ('VN' === c) {
            //return "VND";
        }
        else if ('AU' === c) {
            return 2;
        }
        else if ('NZ' === c) {
            //return "NZD";
        }
        else if ('KR' === c) {
            //return "KRW";
        }
        else if ('ID' === c) {
            //return "IDR";
        }
        else if ('TH' === c) {
            //return "THB";
        }
        else if ('EU' === c) {
            return 2;
        }
        return 1;
    }
    getHandling() {
        let handling = 0;
        if (this.isEmpty()) {
            return handling;
        }
        handling += this.handleTakeawayCharge();
        handling += this.handleDeliveryCharge();
        return handling;
    }
    getHandlingSafe(order, store, first) {
        let handling = 0;
        if (this.isEmpty()) {
            return handling;
        }
        handling += this.handleTakeawayChargeSafe(order, store, first);
        handling += this.handleDeliveryChargeSafe(order, store, first);
        return handling;
    }
    initOrdersMes(orders = [], wholeDiscounts, orderManagerMap) {
        let ordersMes = {
            total: 0,
            tax: 0,
            serviceCharge: 0,
            grandTotal: 0,
            discount: 0,
            pointsFactor: 0,
            pointEarned: 0,
            currencySign: '',
            orderitems: [],
            promotions: [],
            promoCodes: [],
            discounts: [],
            takeout: false
        };
        // hardcode currencySign = store.currencySign (which the first order in)
        if (orderManagerMap[orders[0].storeId]) {
            ordersMes.currencySign = orderManagerMap[orders[0].storeId].store.currencySign;
        }
        orders.forEach((order) => {
            ordersMes.total += order.total;
            ordersMes.tax += order.tax;
            ordersMes.serviceCharge += order.serviceCharge;
            ordersMes.grandTotal += order.grandTotal;
            ordersMes.orderitems = ordersMes.orderitems.concat(order.orderitems);
            ordersMes.promotions = wholeDiscounts;
            // todo pointsFactor pointEarned
        });
        ordersMes.takeout = orders && orders[0] && orders[0].takeout; // condition.type === "ordertype" 时需要用到这个takeout属性
        return ordersMes;
    }
    getMasterStore() {
        if (!this.master) {
            return this.store;
        }
        return this.master;
    }
    handleTakeawayCharge() {
        var _a;
        let handling = 0;
        if (this.order.type == 'takeaway' || (this.order.type == 'kiosk' && this.order.takeout)) {
            let pickupCharge = 0;
            let pickupItemCharge = 0;
            let master = this.getMasterStore();
            if (master.menu) {
                pickupCharge = master.menu.pickupCharge;
                pickupItemCharge = master.menu.pickupItemCharge;
            }
            handling = pickupCharge;
            if (pickupItemCharge > 0) {
                this.order.orderitems.forEach(oi => {
                    let mainItem = aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getMainItem(oi);
                    if (mainItem.packing && mainItem.packing > 0) {
                        oi.handling = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(oi.quantity * pickupItemCharge * mainItem.packing, 2);
                        handling += oi.handling;
                    }
                    // else
                    // {
                    //     //if do not set packing, default
                    //     oi.handling = MathUtils.round(oi.quantity * pickupItemCharge, 2);
                    //     handling += oi.handling;
                    // }
                });
            }
            this.order.orderitems.forEach(oi => {
                let mainItem = aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getMainItem(oi);
                if (mainItem.handling) {
                    oi.handling = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(oi.quantity * mainItem.handling, 2);
                    handling += oi.handling;
                }
            });
            handling = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(handling, 2);
            //this.order.grandTotal = Number((this.order.total + this.order.handling).toFixed(2));
            console.log('order pickupItemCharge', this.count * pickupItemCharge);
            console.log('order pickupCharge', pickupCharge);
            //add package handling as item
            let packageCode = (_a = master.menu) === null || _a === void 0 ? void 0 : _a.settings.packageCode;
            let menu = master.menu;
            let category;
            if (packageCode) {
                let unlocks = menu.unlocks;
                let packageitem = null;
                unlocks && unlocks.forEach(cat => {
                    for (let item of cat.groups[0].items) {
                        if (item.backendId === packageCode) {
                            packageitem = item;
                            category = cat;
                            break;
                        }
                    }
                });
                if (packageitem) {
                    let count = 0;
                    this.order.orderitems.forEach(oi => {
                        let mainItem = aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getMainItem(oi);
                        let packageUnit = 0;
                        packageUnit = mainItem.packing ? mainItem.packing : 0;
                        if (mainItem.backendId !== packageCode) {
                            count += (oi.quantity) * packageUnit;
                        }
                    });
                    var orderitem = this.findOrderItem(packageitem, true);
                    if (orderitem) {
                        orderitem.quantity = count;
                    }
                    else {
                        while (count--) {
                            this.addSingleItem(category, category.groups[0], packageitem);
                        }
                    }
                }
            }
        }
        return handling;
    }
    handleDeliveryCharge() {
        let handling = 0;
        if (this.order.type == 'delivery') {
            let deliveryCharge = 0;
            let master = this.getMasterStore();
            if (master.menu) {
                deliveryCharge = master.menu.deliveryCharge;
            }
            handling = deliveryCharge;
            //this.order.grandTotal = Number((this.order.total + this.order.handling).toFixed(2));
            console.log('order deliveryCharge', deliveryCharge);
        }
        return handling;
    }
    handleTakeawayChargeSafe(order, store, first) {
        let handling = 0;
        if (order.type == 'takeaway' || (order.type == 'kiosk' && order.takeout)) {
            let pickupCharge = 0;
            let pickupItemCharge = 0;
            if (store.menu) {
                pickupItemCharge = store.menu.pickupItemCharge;
                if (first) {
                    pickupCharge = store.menu.pickupCharge;
                }
            }
            handling = pickupCharge;
            if (pickupItemCharge > 0) {
                this.order.orderitems.forEach(oi => {
                    oi.handling = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(oi.quantity * pickupItemCharge, 2);
                    handling += oi.handling;
                });
            }
            order.orderitems.forEach(oi => {
                let mainItem = aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getMainItem(oi);
                if (mainItem.handling) {
                    oi.handling = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(oi.quantity * mainItem.handling, 2);
                    handling += oi.handling;
                }
            });
            handling = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(handling, 2);
            //this.order.grandTotal = Number((this.order.total + this.order.handling).toFixed(2));
            //console.log("order pickupItemCharge", count * pickupItemCharge);
            //console.log("order pickupCharge", pickupCharge);
        }
        return handling;
    }
    handleDeliveryChargeSafe(order, store, first) {
        let handling = 0;
        if (order.type == 'delivery') {
            let deliveryCharge = 0;
            if (store.menu && first) {
                deliveryCharge = store.menu.deliveryCharge;
            }
            handling = deliveryCharge;
            //this.order.grandTotal = Number((this.order.total + this.order.handling).toFixed(2));
            console.log('order deliveryCharge', deliveryCharge);
        }
        return handling;
    }
    calculateExTax(rule, item, oIQty, taxBreakDown) {
        let amount1 = this.addSubTax(rule.rate1, rule.alias1, item, oIQty, taxBreakDown, rule);
        let amount2 = this.addSubTax(rule.rate2, rule.alias2, item, oIQty, taxBreakDown, rule);
        let amount3 = this.addSubTax(rule.rate3, rule.alias3, item, oIQty, taxBreakDown, rule);
        // let result = amount1 + amount2 + amount3;
        // let percent = MathUtils.round( result / item.price, 2);
        // console.log("item "+ item.name + ", tax: " + percent *100 + "%");
    }
    addSubTax(taxRate, taxAlias, item, oIQty, taxBreakDown, taxRule) {
        let amount;
        if (!taxRule || !taxRule.inclusive) {
            amount = oIQty * item.quantity * (item.price - item.discount) * taxRate; //NOT handle discounted price
        }
        else {
            amount = oIQty * item.quantity * (item.price - item.discount) * taxRate / (1 + taxRate); //NOT handle discounted price
        }
        if (!amount) {
            return 0;
        }
        let now = taxBreakDown.get(taxAlias);
        let nowTaxAmount = 0;
        let nowTotal = 0;
        if (now) {
            nowTaxAmount = now.amount;
            nowTotal = now.total;
        }
        let precision = this.getPrecision();
        taxBreakDown.set(taxAlias, {
            amount: nowTaxAmount + amount,
            inclusive: taxRule.inclusive,
            total: aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(nowTotal + (oIQty * item.quantity * (item.price - item.discount)), precision),
            rate: taxRate,
            name: taxRule.name
        });
        return amount;
    }
    getServiceCharge() {
        let serviceCharge = 0;
        let master = this.getMasterStore();
        if (master.menu && master.menu.settings && master.menu.settings.serviceChargeApplyOrderType) {
            // if serviceChargeApplyOrderType is set and is not currently in use
            if (master.menu.settings.serviceChargeApplyOrderType !== this.order.type) {
                return 0;
            }
        }
        if (master.menu && master.menu.serviceCharge && master.menu.serviceCharge > 0) {
            var serviceChargeRate = (master.menu.serviceCharge / 100);
            //serviceChargeRate = MathUtils.round(serviceChargeRate, 2);
            //todo?? not first discount
            // let discountableTotal = condition.discounted ? order.grandTotal : order.total;
            let itemCanServiceChargeTotal = 0;
            this.order.orderitems.forEach(oi => {
                let oiServiceCharge = 0;
                oi.items.forEach(item => {
                    if (item.serviceChargeable) {
                        let sc = item.price * (item.quantity * oi.quantity);
                        itemCanServiceChargeTotal += sc;
                        oiServiceCharge += sc;
                    }
                });
                oi.serviceCharge = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(oiServiceCharge * serviceChargeRate, 2);
            });
            let serviceChargeTotal;
            if (master.menu && master.menu.settings && master.menu.settings.serviceChargeApplyAfterDiscounted) {
                serviceChargeTotal = (itemCanServiceChargeTotal - (this.order.discount * itemCanServiceChargeTotal / this.order.grandTotal)) * serviceChargeRate;
            }
            else {
                serviceChargeTotal = itemCanServiceChargeTotal * serviceChargeRate;
            }
            var serviceChargeAmount = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(serviceChargeTotal, 2);
            this.order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(this.order.grandTotal + serviceChargeAmount, 2);
            console.log('order service charge amount and rate', serviceChargeAmount, serviceChargeRate);
            return serviceChargeAmount;
        }
        else {
            return 0;
        }
    }
    getTax() {
        var _a, _b, _c;
        let tax = 0;
        let master = this.getMasterStore();
        if (master.menu && master.menu.taxRules && master.menu.taxRules.length > 0) {
            var taxRules = master.menu.taxRules;
            let tempRule = [];
            //tax rule priority
            //mode (server filter) => priority => inclusive?
            if (taxRules && taxRules.length > 0) {
                taxRules = taxRules.sort((a, b) => b.priority - a.priority);
                let p = taxRules[0].priority;
                tempRule = taxRules.filter(r => r.priority == p);
                taxRules = tempRule;
            }
            // taxRules = taxRules.filter(r => !r.inclusive);
            let rules = new Map();
            taxRules.forEach(rule => {
                if (rule.itemType && !rules.has(rule.itemType)) {
                    rules.set(rule.itemType, rule);
                }
            });
            console.log('Tax Rules: ', rules);
            let taxBreakDown = new Map();
            this.order.orderitems.forEach(oi => {
                let items = aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getFlattenItems(oi, true);
                for (let item of items) {
                    //if (!item.taxGroup) continue;
                    let itemType = '';
                    if (!item.taxGroup) {
                        itemType = 'all';
                    }
                    else {
                        itemType = item.taxGroup;
                    }
                    if (rules.has(itemType)) {
                        let rule = rules.get(itemType);
                        this.calculateExTax(rule, item, oi.quantity, taxBreakDown);
                    }
                    else {
                        console.log('Missing Tax Type: ', itemType);
                    }
                }
            });
            let serviceChargeTaxable = this.menuSettings.serviceChargeTaxable;
            if (this.order.serviceCharge != null && this.order.serviceCharge > 0 && serviceChargeTaxable) {
                let serviceItem = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.Item();
                serviceItem.name = 'Service Charge';
                serviceItem.price = this.order.serviceCharge;
                serviceItem.quantity = 1;
                let rule = rules.get('all');
                if (rule != null) {
                    this.calculateExTax(rule, serviceItem, 1, taxBreakDown);
                }
            }
            let handlingChargeTaxable = this.menuSettings.handlingChargeTaxable;
            if (this.order.handling != null && this.order.handling > 0 && handlingChargeTaxable) {
                let handlingChargeItem = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.Item();
                handlingChargeItem.name = 'Handling Charge';
                handlingChargeItem.price = this.order.handling;
                handlingChargeItem.quantity = 1;
                let rule = rules.get('all');
                if (rule != null) {
                    this.calculateExTax(rule, handlingChargeItem, 1, taxBreakDown);
                }
            }
            // Handle  tax calculation is after the points as payment. When this flag is enabled, tax calculation goes first then points as payment
            if (!this.menuSettings.pointsAsPaymentAfterTax) {
                let pointsRedeemItem = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.Item();
                pointsRedeemItem.name = 'points Redeem';
                let point = this.pointsFactor * this.order.usedPoints;
                if (isNaN(point) || point === null) {
                    point = 0;
                }
                if (point !== 0) {
                    pointsRedeemItem.price = -point;
                    pointsRedeemItem.quantity = 1;
                    let rule = rules.get('all');
                    if (rule != null) {
                        this.calculateExTax(rule, pointsRedeemItem, 1, taxBreakDown);
                    }
                }
            }
            // Handle order level discount
            // discount is just a negative priced item
            const taxIgnoreDiscount = (_c = (_b = (_a = this.store) === null || _a === void 0 ? void 0 : _a.menu) === null || _b === void 0 ? void 0 : _b.settings) === null || _c === void 0 ? void 0 : _c.taxIgnoreDiscount;
            if (this.order.discount > 0 && !taxIgnoreDiscount) {
                let discountItem = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.Item();
                discountItem.name = 'Discount';
                if (this.order.discount > this.order.grandTotal) {
                    discountItem.price = 0;
                }
                else {
                    discountItem.price = -this.order.discount;
                }
                discountItem.quantity = 1;
                let rule = rules.get('all');
                if (rule != null) {
                    this.calculateExTax(rule, discountItem, 1, taxBreakDown);
                }
            }
            // Handle order level discount end
            this.order.taxes = [];
            let precision = this.getPrecision();
            taxBreakDown.forEach((obj, key, map) => {
                let amount = obj['amount'];
                let line = {
                    //name: key,
                    name: obj['name'],
                    // value: amount, // legacy field?
                    amount: aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(amount, precision),
                    inclusive: obj['inclusive'],
                    total: obj['total'],
                    rate: obj['rate'],
                };
                if (!obj['inclusive']) {
                    tax += amount;
                }
                this.order.taxes.push(line);
            });
            tax = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(tax, precision);
            // this.order.grandTotal = MathUtils.round(this.order.grandTotal + tax, 2);
            console.log('order taxes', this.order.taxes);
        }
        else {
            if (master.menu && !master.menu.taxIncluded) {
                tax = master.menu.tax;
                if (!tax || !Number(tax)) {
                    tax = 0;
                }
                if (tax > 0) {
                    let gst = (this.order.grandTotal / (100 + tax)) * tax;
                    tax = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(gst, 2);
                }
            }
        }
        console.log('order tax', tax);
        return tax;
    }
    setShippingFee(shipping) {
        this.order.shipping = shipping;
    }
    getTaxSafe(order, store) {
        let tax = 0;
        if (store.menu && store.menu.taxRules && store.menu.taxRules.length > 0) {
            var taxRules = store.menu.taxRules;
            let rules = new Map();
            taxRules.forEach(rule => {
                if (rule.itemType && !rules.has(rule.itemType)) {
                    rules.set(rule.itemType, rule);
                }
            });
            let taxBreakDown = new Map();
            order.orderitems.forEach(oi => {
                let items = aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.getFlattenItems(oi, true);
                for (let item of items) {
                    if (!item.taxGroup) {
                        continue;
                    }
                    let itemType = item.taxGroup;
                    if (rules.has(itemType)) {
                        let rule = rules.get(itemType);
                        this.calculateExTax(rule, item, oi.quantity, taxBreakDown);
                    }
                    else {
                        console.log('Missing Tax Type: ', itemType);
                    }
                }
            });
            order.taxes = [];
            taxBreakDown.forEach((value, key, map) => {
                let amount = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(value, 2);
                let line = {
                    name: key,
                    value: amount
                };
                tax += value;
                order.taxes.push(line);
            });
            tax = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(tax, 2);
            order.grandTotal = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(order.grandTotal + tax, 2);
            console.log('order taxes', order.taxes);
        }
        else {
            if (store.menu) {
                tax = store.menu.tax;
            }
            if (!tax || !Number(tax)) {
                tax = 0;
            }
            if (tax > 0) {
                let gst = (order.grandTotal / (100 + tax)) * tax;
                tax = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(gst, 2);
            }
        }
        console.log('order tax', tax);
        return tax;
    }
    calculateOrderItem(orderitem) {
        var total = 0;
        for (let item of orderitem.items) {
            var q = item.quantity;
            if (!!item.baseQty) {
                if ((q - (item === null || item === void 0 ? void 0 : item.baseQty)) > 0) {
                    q = (q - (item === null || item === void 0 ? void 0 : item.baseQty));
                }
                else {
                    q = 0;
                }
            }
            //if (!q || q < 0) q = 1;
            let t = item.price * q;
            total += aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(t, 2);
        }
        orderitem.total = aigens_data__WEBPACK_IMPORTED_MODULE_0__.MathUtils.round(total, 2);
    }
    getOrderNumber(orderNumber, index) {
        if (index == -1) {
            return orderNumber;
        }
        let suffix = this.letter.charAt(index);
        return orderNumber + suffix;
    }
    //APPROVED
    //CALL this to add raw order to the new order, filling with proper menu etc
    reconstructOrder(rawOrder, subOrder = false, continueUnlockCat = true) {
        var _a, _b;
        console.log('reconstruct from order', rawOrder, continueUnlockCat);
        if (!rawOrder) {
            return;
        }
        var orderitems = rawOrder.orderitems;
        if (!orderitems) {
            return;
        }
        this.trackAnalytics = false;
        try {
            var menu = this.store.menu;
            //clear all the orderitems when loading suborder
            if (subOrder && this.order) {
                this.order.orderitems = [];
            }
            if (menu) {
                for (let oi of orderitems) {
                    var builder = new _base_orderitem_builder__WEBPACK_IMPORTED_MODULE_1__.OrderItemBuilder(this.store);
                    var realCat = _menu_manager__WEBPACK_IMPORTED_MODULE_2__.MenuManager.getCategory(menu, oi.categoryId);
                    if ((realCat === null || realCat === void 0 ? void 0 : realCat.type) === 'unlock' || oi.categoryType === 'unlockItem') {
                        if (continueUnlockCat) {
                            continue;
                        }
                    }
                    builder.setCategory(realCat);
                    var igIndex = 0;
                    for (let ig of oi.groups) {
                        var realIg = _menu_manager__WEBPACK_IMPORTED_MODULE_2__.MenuManager.getItemGroup(menu, ig.id);
                        for (let item of ig.items) {
                            var realItem = _menu_manager__WEBPACK_IMPORTED_MODULE_2__.MenuManager.getItem(menu, realIg, item.id);
                            //do we need to copy from real item?
                            item.price = realItem.price;
                            item.min = realItem === null || realItem === void 0 ? void 0 : realItem.min;
                            item.max = realItem === null || realItem === void 0 ? void 0 : realItem.max;
                            item.baseQty = realItem.baseQty;
                            item.absentId = realItem.absentId;
                            item.backendId = realItem === null || realItem === void 0 ? void 0 : realItem.backendId;
                            item.setLayout = realItem === null || realItem === void 0 ? void 0 : realItem.setLayout;
                            builder.setItem(realIg, item, igIndex, item.quantity, true, true);
                            var newOi = builder.build();
                            newOi.combo = !!(oi === null || oi === void 0 ? void 0 : oi.combo);
                            if (!newOi)
                                continue;
                            newOi.quantity = oi.quantity;
                            //TODO: NEED TO RECONSTRUCT MODIFIER!!!
                        }
                        igIndex++;
                    }
                    console.log('newOi', newOi);
                    if (!newOi)
                        continue;
                    this.addOrderItem(newOi, oi.recommended == true, oi.discountId);
                }
                if (((_b = (_a = this.order) === null || _a === void 0 ? void 0 : _a.orderitems) === null || _b === void 0 ? void 0 : _b.length) > 0 && (rawOrder === null || rawOrder === void 0 ? void 0 : rawOrder.uuid)) {
                    // 读取本地的 cache Order, 但需要保持 uuid 一致，server 边需要keep 住同一张单（from Peter）
                    this.order.uuid = rawOrder === null || rawOrder === void 0 ? void 0 : rawOrder.uuid;
                }
            }
            else if (subOrder) {
                //court order that doesnt have menu, just construct oi with what we have
                for (let oi of orderitems) {
                    if (aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.isUnlockOrderItem(oi)) { // skip reconstruct of unlock item
                        continue;
                    }
                    var newOi = new aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem();
                    Object.assign(newOi, oi);
                    this.addOrderItem(newOi, oi.recommended == true, oi.discountId);
                }
            }
        }
        catch (ex) {
            console.log(ex);
        }
        this.trackAnalytics = true;
    }
    isSet(oi) {
        return oi.combo || aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.isSet(oi);
    }
    // order level max
    checkOrderMaxItem(addQty = 0) {
        var _a, _b;
        // const orderManager: OrderManager = this.multOrderManager.enableMutlOrder && storeId ? this.multOrderManager.getOrderManager(storeId) : this.orderManager;
        const maxItems = (_b = (_a = this.store) === null || _a === void 0 ? void 0 : _a.menu) === null || _b === void 0 ? void 0 : _b.maxItems;
        const infinity = maxItems === 0;
        return (maxItems < (this.count + addQty) && !infinity && (this.mode == 'byod' || this.mode == "preorder"));
    }
    // // item level max
    // checkItemMax(item: Item): boolean {
    //     return this.checkAddItemMax(item, 0);
    // }
    // check if current qty can be added to cart without exceeding item max
    checkAddItemMax(item, addQty) {
        if (!item) {
            return true;
        }
        let currentQua = this.getQuantity(item);
        currentQua += addQty;
        if (item && item.max === 0) {
            return false;
        }
        return !(currentQua <= item.max);
    }
    getPreparetionTime() {
        let order = this.getOrder();
        let pos = this.store && this.store.pos;
        let preparetionTime = 15;
        if (pos) {
            // if preparetionTime is 0 should still use the default(by ray).
            if (order) {
                preparetionTime = this.calculateFoodTime(order, pos);
            }
            else {
                preparetionTime = pos.basePrep;
            }
        }
        // unit 分钟
        return preparetionTime;
    }
    calculateFoodTime(order, pos) {
        let baseMin = pos.basePrep;
        let total = order.grandTotal;
        let scaleAmount = pos['prepScale'];
        let scale = 0;
        if (scaleAmount > 0) {
            scale = total / scaleAmount;
        }
        let prepTime = baseMin + scale * baseMin;
        return prepTime;
    }
    removeUnlockByItemId(itemId) {
        var _a;
        const unlockCatOrderItems = [];
        (_a = this.order) === null || _a === void 0 ? void 0 : _a.orderitems.forEach(oi => {
            var _a;
            if ((aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem === null || aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem === void 0 ? void 0 : aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.isUnlockOrderItem(oi)) && ((_a = oi === null || oi === void 0 ? void 0 : oi.items) === null || _a === void 0 ? void 0 : _a.length) > 0 && (oi === null || oi === void 0 ? void 0 : oi.items[0].id) == itemId) {
                unlockCatOrderItems.push(oi);
            }
        });
        unlockCatOrderItems.map((oi) => {
            this.minusOrderItem(oi, true);
        });
        this.calculateOrder(this.order);
    }
    removeUnlockByDiscountId(discountId) {
        var _a;
        const unlockCatOrderItems = [];
        (_a = this.order) === null || _a === void 0 ? void 0 : _a.orderitems.forEach(oi => {
            if ((aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem === null || aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem === void 0 ? void 0 : aigens_data__WEBPACK_IMPORTED_MODULE_0__.OrderItem.isUnlockOrderItem(oi)) && oi.discountId == discountId) {
                unlockCatOrderItems.push(oi);
            }
        });
        unlockCatOrderItems.map((oi) => {
            this.minusOrderItem(oi, true);
        });
        this.calculateOrder(this.order);
    }
    saveOrderCheckpoint() {
        const cleanOrder = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Order.toOrderData(this.order);
        this.checkpointOrder = cleanOrder;
    }
    restoreLastOrderCheckpoint() {
        if (!this.checkpointOrder) {
            return;
        }
        this.order.orderitems = [];
        this.reconstructOrder(this.checkpointOrder);
        this.clearOrderCheckpoint();
    }
    clearOrderCheckpoint() {
        this.checkpointOrder = null;
    }
}
SingleOrderManager.ɵfac = function SingleOrderManager_Factory(t) { return new (t || SingleOrderManager)(_angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵinject"](_services_config_service__WEBPACK_IMPORTED_MODULE_3__.ConfigService), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵinject"](_services_analytics_service__WEBPACK_IMPORTED_MODULE_4__.AnalyticsService), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵinject"](_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_5__.SubscribeService)); };
SingleOrderManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdefineInjectable"]({ token: SingleOrderManager, factory: SingleOrderManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 84925:
/*!****************************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/combine-order-status.pipe.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CombineOrderStatusPipe": () => (/* binding */ CombineOrderStatusPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class CombineOrderStatusPipe {
    constructor() {
        this.statusList = [
            'pending',
            'paying',
            'paid',
            'scheduled',
            'sending',
            'received',
            'ready',
            'completed',
        ];
    }
    getStatusLevel(status) {
        return this.statusList.indexOf(status);
    }
    getLowestStatus(order) {
        var _a;
        let minLevel = 999;
        (_a = order === null || order === void 0 ? void 0 : order.subs) === null || _a === void 0 ? void 0 : _a.forEach((sub) => {
            const level = this.getStatusLevel(sub.status);
            if (level > -1 && level < minLevel) {
                minLevel = level;
            }
        });
        if (minLevel >= this.statusList.length || minLevel < 0) {
            return null;
        }
        return this.statusList[minLevel];
    }
    transform(order) {
        var _a, _b, _c;
        if (((_a = order === null || order === void 0 ? void 0 : order.subs) === null || _a === void 0 ? void 0 : _a.length) <= 0) {
            return (_b = order === null || order === void 0 ? void 0 : order.status) !== null && _b !== void 0 ? _b : '';
        }
        const lowestStatus = this.getLowestStatus(order);
        if (lowestStatus) {
            return lowestStatus;
        }
        return (_c = order === null || order === void 0 ? void 0 : order.status) !== null && _c !== void 0 ? _c : '';
    }
}
CombineOrderStatusPipe.ɵfac = function CombineOrderStatusPipe_Factory(t) { return new (t || CombineOrderStatusPipe)(); };
CombineOrderStatusPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "combineOrderStatus", type: CombineOrderStatusPipe, pure: false });


/***/ }),

/***/ 8803:
/*!*********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/custom-filter.pipe.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CustomFilterPipe": () => (/* binding */ CustomFilterPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class CustomFilterPipe {
    transform(values, callback, reverse, enable) {
        if (!enable) {
            return values;
        }
        if (typeof callback === 'function') {
            let temp = values.filter(a => reverse ? !callback(a) : callback(a));
            console.log(temp.length);
            return temp;
        }
        return values;
    }
}
CustomFilterPipe.ɵfac = function CustomFilterPipe_Factory(t) { return new (t || CustomFilterPipe)(); };
CustomFilterPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "filter", type: CustomFilterPipe, pure: true });


/***/ }),

/***/ 63754:
/*!*******************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/date-locale.pipe.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DateLocalePipe": () => (/* binding */ DateLocalePipe)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);


class DateLocalePipe {
    constructor() {
        this.localeMap = {
            'zh': 'zh',
            'zh-cn': 'zh'
        };
    }
    transform(value, locale = 'en', pattern = 'mediumDate', timezone = null) {
        var _a;
        const code = (_a = this.localeMap[locale]) !== null && _a !== void 0 ? _a : 'en';
        const datePipe = new _angular_common__WEBPACK_IMPORTED_MODULE_0__.DatePipe(code, timezone);
        return datePipe.transform(value, pattern) != undefined ? datePipe.transform(value, pattern) : null;
    }
}
DateLocalePipe.ɵfac = function DateLocalePipe_Factory(t) { return new (t || DateLocalePipe)(); };
DateLocalePipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefinePipe"]({ name: "dateLocale", type: DateLocalePipe, pure: true });


/***/ }),

/***/ 33270:
/*!***************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/ewallet.pipe.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EwalletPipe": () => (/* binding */ EwalletPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _services_context_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../services/context.service */ 73769);
/* harmony import */ var _number_display_pipe__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./number-display.pipe */ 94062);
/* harmony import */ var _services_ewallet_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../services/ewallet.service */ 67481);




class EwalletPipe {
    // to do(ewallet) Topup
    constructor(context, numberDisplay, ewalletService) {
        this.context = context;
        this.numberDisplay = numberDisplay;
        this.ewalletService = ewalletService;
    }
    transform(member) {
        var _a;
        console.log('ecreditBalance member:', member);
        // return this.ewalletService.getMemberEwallectCurrencySign() + str;
        const total = (_a = this.ewalletService) === null || _a === void 0 ? void 0 : _a.getDisplayEwalletNumber();
        return this.ewalletService.getMemberEwallectCurrencySign() + this.numberDisplay.transform(total);
    }
}
EwalletPipe.ɵfac = function EwalletPipe_Factory(t) { return new (t || EwalletPipe)(_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdirectiveInject"](_services_context_service__WEBPACK_IMPORTED_MODULE_0__.Context, 16), _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdirectiveInject"](_number_display_pipe__WEBPACK_IMPORTED_MODULE_1__.NumberDisplayPipe, 16), _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdirectiveInject"](_services_ewallet_service__WEBPACK_IMPORTED_MODULE_2__.EwalletService, 16)); };
EwalletPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdefinePipe"]({ name: "ewallet", type: EwalletPipe, pure: true });


/***/ }),

/***/ 96841:
/*!********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/flatten-item.pipe.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FlattenItemPipe": () => (/* binding */ FlattenItemPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class FlattenItemPipe {
    constructor() {
    }
    transform(orderItem, includeMods = true) {
        let result = [];
        // assume server flatten result is correct
        if (orderItem.items) {
            result = orderItem.items;
        }
        else if (orderItem.groups && orderItem.groups.length) {
            //flatten groups within 1 depth
            orderItem.groups.forEach(group => {
                var _a;
                (_a = group === null || group === void 0 ? void 0 : group.items) === null || _a === void 0 ? void 0 : _a.forEach(item => {
                    result.push(item);
                    if (includeMods && (item === null || item === void 0 ? void 0 : item['mgroups'])) {
                        item === null || item === void 0 ? void 0 : item['mgroups'].forEach(mg => {
                            result.push(...mg.items);
                        });
                    }
                });
            });
        }
        else {
            console.warn('the order item input seems to be empty?', orderItem);
        }
        return result;
    }
}
FlattenItemPipe.ɵfac = function FlattenItemPipe_Factory(t) { return new (t || FlattenItemPipe)(); };
FlattenItemPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "flattenItem", type: FlattenItemPipe, pure: true });


/***/ }),

/***/ 83183:
/*!**************************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/form-error-message.pipe.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FormErrorMessagePipe": () => (/* binding */ FormErrorMessagePipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ngx-translate/core */ 33935);


class FormErrorMessagePipe {
    constructor(translation) {
        this.translation = translation;
    }
    transform(content) {
        const translate = this.translation.instant(content);
        const isTranslationFound = translate !== content;
        if (!isTranslationFound) {
            let defaultTranslation = 'form.errorMsg';
            if (content.includes('regex')) {
                defaultTranslation += '.regex';
                return this.translation.instant(defaultTranslation);
            }
            return this.translation.instant(`${defaultTranslation}.default`);
        }
        return translate;
    }
}
FormErrorMessagePipe.ɵfac = function FormErrorMessagePipe_Factory(t) { return new (t || FormErrorMessagePipe)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.TranslateService, 16)); };
FormErrorMessagePipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "formErrorMessage", type: FormErrorMessagePipe, pure: true });


/***/ }),

/***/ 69745:
/*!**********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/form-translate.pipe.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FormTranslatePipe": () => (/* binding */ FormTranslatePipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ngx-translate/core */ 33935);


class FormTranslatePipe {
    constructor(translation) {
        this.translation = translation;
    }
    transform(content, lang, field = "name", formName = 'register') {
        const formKey = `forms.${formName}.${content['title']}.${field}`;
        return `${this.translation.instant(formKey) === formKey ? this.serverTranslate(content, lang, field) : this.translation.instant(formKey)}`;
    }
    serverTranslate(content, lang, field = "name") {
        if (!content)
            return "";
        //return value.name;
        return this.lookup(content, lang, field);
    }
    lookup(content, lang, field) {
        var result = null;
        if (lang) {
            result = content[field + "_" + lang];
        }
        if (!result) {
            result = content[field];
        }
        return result;
    }
}
FormTranslatePipe.ɵfac = function FormTranslatePipe_Factory(t) { return new (t || FormTranslatePipe)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.TranslateService, 16)); };
FormTranslatePipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "formTranslate", type: FormTranslatePipe, pure: true });


/***/ }),

/***/ 26709:
/*!*************************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/getDateStringLabelPipe.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "GetDateStringLabelPipe": () => (/* binding */ GetDateStringLabelPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

// 自定义管道 getDateStringLabel
class GetDateStringLabelPipe {
    transform(milliseconds) {
        const date = new Date(milliseconds);
        let timeString = date.getFullYear().toString() + '-';
        if ((date.getMonth() + 1) <= 9) {
            timeString = timeString + '0' + (date.getMonth() + 1).toString() + '-';
        }
        else {
            timeString = timeString + (date.getMonth() + 1).toString() + '-';
        }
        if (date.getDate() <= 9) {
            timeString = timeString + '0' + date.getDate().toString();
        }
        else {
            timeString = timeString + date.getDate().toString();
        }
        return timeString;
    }
}
GetDateStringLabelPipe.ɵfac = function GetDateStringLabelPipe_Factory(t) { return new (t || GetDateStringLabelPipe)(); };
GetDateStringLabelPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "getDateStringLabel", type: GetDateStringLabelPipe, pure: true });


/***/ }),

/***/ 51432:
/*!******************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/item-price.pipe.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ItemPricePipe": () => (/* binding */ ItemPricePipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/common */ 36362);


class ItemPricePipe {
    constructor(decimalPipe) {
        this.decimalPipe = decimalPipe;
    }
    transform(item, quantity = 0) {
        if (quantity > 0) {
            return (item === null || item === void 0 ? void 0 : item.price) * quantity;
        }
        else {
            return (item === null || item === void 0 ? void 0 : item.price) * 1;
        }
    }
}
ItemPricePipe.ɵfac = function ItemPricePipe_Factory(t) { return new (t || ItemPricePipe)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_common__WEBPACK_IMPORTED_MODULE_1__.DecimalPipe, 16)); };
ItemPricePipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "itemPrice", type: ItemPricePipe, pure: true });


/***/ }),

/***/ 94062:
/*!**********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/number-display.pipe.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NumberDisplayPipe": () => (/* binding */ NumberDisplayPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class NumberDisplayPipe {
    constructor() {
    }
    // 数字 每隔3位用逗号分开 1,234,560
    transform(input) {
        var _a, _b;
        console.log('numberDisplay', input);
        // 判断是正数还是负数
        const flag = (input || input === 0) ? true : false;
        const arr = typeof input === 'number' ? (_b = (_a = Math.abs(input)) === null || _a === void 0 ? void 0 : _a.toString()) === null || _b === void 0 ? void 0 : _b.split('.') : input === null || input === void 0 ? void 0 : input.split('.');
        let left = arr[0];
        const right = arr[1] ? arr[1] : 0;
        let tmp = '';
        while (left.length > 3) {
            tmp = ',' + left.slice(-3) + tmp;
            left = left.slice(0, left.length - 3);
        }
        if (right === 0) {
            return flag ? left + tmp : '-' + left + tmp;
        }
        return flag ? left + tmp + '.' + right : '-' + left + tmp + '.' + right;
    }
}
NumberDisplayPipe.ɵfac = function NumberDisplayPipe_Factory(t) { return new (t || NumberDisplayPipe)(); };
NumberDisplayPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "numberDisplay", type: NumberDisplayPipe, pure: true });


/***/ }),

/***/ 21963:
/*!*********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/point-display.pipe.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PointDisplay": () => (/* binding */ PointDisplay)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ngx-translate/core */ 33935);


class PointDisplay {
    constructor(translation) {
        this.translation = translation;
    }
    transform(point) {
        return `${point}  ${this.translation.instant('byod.components.item-card.points')}`;
    }
}
PointDisplay.ɵfac = function PointDisplay_Factory(t) { return new (t || PointDisplay)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.TranslateService, 16)); };
PointDisplay.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "pointDisplay", type: PointDisplay, pure: true });


/***/ }),

/***/ 74133:
/*!*********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/point-to-cash.pipe.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PointToCashPipe": () => (/* binding */ PointToCashPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _services_context_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../services/context.service */ 73769);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ 36362);



class PointToCashPipe {
    constructor(context, currencyPipe) {
        this.context = context;
        this.currencyPipe = currencyPipe;
        this.redeemPointFactor = 1;
        this.smallestPointsUnit = 1;
        this.pointRatio = 1;
        this.initCrmPoint();
        this.calculateDisplayScale();
    }
    initCrmPoint() {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t;
        this.redeemPointFactor = (_f = (_c = (_b = (_a = this.context) === null || _a === void 0 ? void 0 : _a.membership) === null || _b === void 0 ? void 0 : _b['redeemPointFactor']) !== null && _c !== void 0 ? _c : (_e = (_d = this.context) === null || _d === void 0 ? void 0 : _d.crm) === null || _e === void 0 ? void 0 : _e.redeemPointFactor) !== null && _f !== void 0 ? _f : 1;
        this.smallestPointsUnit = (_m = (_j = (_h = (_g = this.context) === null || _g === void 0 ? void 0 : _g.membership) === null || _h === void 0 ? void 0 : _h['smallestPointsUnit']) !== null && _j !== void 0 ? _j : (_l = (_k = this.context) === null || _k === void 0 ? void 0 : _k.crm) === null || _l === void 0 ? void 0 : _l.smallestPointsUnit) !== null && _m !== void 0 ? _m : 1;
        this.pointRatio = (_t = (_q = (_p = (_o = this.context) === null || _o === void 0 ? void 0 : _o.membership) === null || _p === void 0 ? void 0 : _p['pointToMoneyRatio']) !== null && _q !== void 0 ? _q : (_s = (_r = this.context) === null || _r === void 0 ? void 0 : _r.crm) === null || _s === void 0 ? void 0 : _s.pointToMoneyRatio) !== null && _t !== void 0 ? _t : 1;
        if (this.smallestPointsUnit <= 0) {
            this.smallestPointsUnit = 1;
        }
    }
    convertPointToAmount(points) {
        return (points / this.smallestPointsUnit) / this.pointRatio;
    }
    calculateDisplayScale() {
        // take log10 to get the digits in zero: log10(1) = 0, log10(100) = 2
        const log10 = Math.log10 || function (x) {
            return Math.log(x) * Math.LOG10E;
        };
        const digits = log10(this.smallestPointsUnit);
        this.pointsDigitsInfo = `1.${digits}-${digits}`;
    }
    roundToPointFactor(points) {
        var _a;
        const redeemPointFactor = (_a = this.redeemPointFactor) !== null && _a !== void 0 ? _a : 1;
        return Math.floor(points / redeemPointFactor) * redeemPointFactor;
    }
    transform(points) {
        const roundedPoint = this.roundToPointFactor(points);
        const finalAmount = this.convertPointToAmount(roundedPoint);
        return this.currencyPipe.transform(finalAmount, this.context.currency, 'symbol-narrow', this.pointsDigitsInfo);
    }
}
PointToCashPipe.ɵfac = function PointToCashPipe_Factory(t) { return new (t || PointToCashPipe)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_services_context_service__WEBPACK_IMPORTED_MODULE_0__.Context, 16), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_angular_common__WEBPACK_IMPORTED_MODULE_2__.CurrencyPipe, 16)); };
PointToCashPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefinePipe"]({ name: "pointToCash", type: PointToCashPipe, pure: true });


/***/ }),

/***/ 93985:
/*!*********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/price-display.pipe.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PriceDisplayPipe": () => (/* binding */ PriceDisplayPipe),
/* harmony export */   "PriceDisplayPipeOptions": () => (/* binding */ PriceDisplayPipeOptions)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../pure/managers/setting-manager */ 74663);



class PriceDisplayPipeOptions {
    constructor() {
        this.spacing = ' '; // the spacing put between the currency sign and price
        this.hideZeroItemPrice = false;
        this.force = false; // ignore the hideZeroItemPrice flag
    }
}
class PriceDisplayPipe {
    constructor(decimalPipe, settingManager) {
        this.decimalPipe = decimalPipe;
        this.settingManager = settingManager;
        this.signPositions = { '$': 0, '¥': 0, 'S$': 0, 'RM': 0, 'Rp': 0, '€': 2 }; // 用数字标记货币符号相对于价格的位置，0表示符号在前，1表示符号在数字中间，2表示符号在后
    }
    /**
     *
     * @param price price to deal with
     * @param shouldDisplaySign display the currency sign or not, set true by default
     * @param spacing the spacing put between the currency sign and price
     * @param sign the currency sign
     * @param force: ignore the hideZeroItemPrice flag
     * @param prefix
     * @param suffix
     */
    transform(price = 0, shouldDisplaySign = true, context, checkHideZero = false, spacing = ' ') {
        var _a, _b, _c, _d, _e;
        const p = this.settingManager.get('itemPricePrecision', -1);
        let currencySign = ((_a = context === null || context === void 0 ? void 0 : context.currencySign) !== null && _a !== void 0 ? _a : (_b = context === null || context === void 0 ? void 0 : context.store) === null || _b === void 0 ? void 0 : _b.currencySign) || '$';
        let hideZero = (_e = (_d = (_c = context === null || context === void 0 ? void 0 : context.store) === null || _c === void 0 ? void 0 : _c.menu) === null || _d === void 0 ? void 0 : _d.settings) === null || _e === void 0 ? void 0 : _e.hideZeroItemPrice;
        let options = {};
        // const p = options.itemPricePrecision;
        // const hideZero = this.orderService?.store?.menu?.settings?.hideZeroItemPrice;
        // const hideZero = options.hideZeroItemPrice;
        // const spacing = options?.spacing || ' ';
        if (checkHideZero && price === 0 && this.settingManager.get('menu.hideZeroItemPrice', false)) {
            return '';
        }
        let displayedPrice;
        if (p < 0) { // as per doc config, if itemPricePrecision == -1, then it will not control
            displayedPrice = this.decimalPipe.transform(price);
        }
        else {
            const dc = p >= 0 ? '1.' + p + '-' + p : '1.0-2';
            displayedPrice = this.decimalPipe.transform(price, dc);
        }
        if (shouldDisplaySign) {
            // let currencySign = sign || this.orderService.sign || this.orderService.store.currencySign || '';
            // let currencySign = options.sign || '';
            if (this.signPositions[currencySign] === 0) {
                return currencySign + spacing + displayedPrice;
            }
            else if (this.signPositions[currencySign] === 1) {
                return displayedPrice; // 货币符号在中间时，暂时没有修改格式
            }
            else if (this.signPositions[currencySign] === 2) {
                return displayedPrice + spacing + currencySign;
            }
            else {
                return currencySign + spacing + displayedPrice; // 没set 默认在前
            }
        }
        else {
            return displayedPrice;
        }
    }
}
PriceDisplayPipe.ɵfac = function PriceDisplayPipe_Factory(t) { return new (t || PriceDisplayPipe)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_angular_common__WEBPACK_IMPORTED_MODULE_2__.DecimalPipe, 16), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_0__.SettingManager, 16)); };
PriceDisplayPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefinePipe"]({ name: "priceDisplay", type: PriceDisplayPipe, pure: true });


/***/ }),

/***/ 58144:
/*!******************************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/remove-item-variations.pipe.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RemoveItemVariationsPipe": () => (/* binding */ RemoveItemVariationsPipe)
/* harmony export */ });
/* harmony import */ var aigens_ng_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-ng-core */ 51707);
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash-es */ 38163);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);



class RemoveItemVariationsPipe {
    constructor() {
    }
    // remove the item variations
    transform(items) {
        let resultItems = [];
        items === null || items === void 0 ? void 0 : items.forEach(item => {
            let item_new = lodash_es__WEBPACK_IMPORTED_MODULE_1__["default"](item);
            if (item === null || item === void 0 ? void 0 : item.variations) {
                item_new.variations = [];
            }
            resultItems.push(item_new);
        });
        return resultItems;
    }
}
RemoveItemVariationsPipe.ɵfac = function RemoveItemVariationsPipe_Factory(t) { return new (t || RemoveItemVariationsPipe)(); };
RemoveItemVariationsPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefinePipe"]({ name: "removeItemVariations", type: RemoveItemVariationsPipe, pure: true });


/***/ }),

/***/ 13591:
/*!************************************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/resort-or-filter-unlock-item.pipe.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ResortOrFilterUnlockItemPipe": () => (/* binding */ ResortOrFilterUnlockItemPipe)
/* harmony export */ });
/* harmony import */ var aigens_ng_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-ng-core */ 51707);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);


class ResortOrFilterUnlockItemPipe {
    constructor() {
    }
    // resort the unlock item or hide them in shop cart
    transform(orderItems, filter = false) {
        let normalOIs = [];
        let unlockOIs = [];
        // console.log('resortOrFilterUnlockItem');
        // resort the unlock item position in Array
        if (orderItems) {
            orderItems.forEach(oi => {
                if (!oi)
                    return;
                if (aigens_ng_core__WEBPACK_IMPORTED_MODULE_0__.OrderItem === null || aigens_ng_core__WEBPACK_IMPORTED_MODULE_0__.OrderItem === void 0 ? void 0 : aigens_ng_core__WEBPACK_IMPORTED_MODULE_0__.OrderItem.isUnlockOrderItem(oi)) {
                    if (filter)
                        return; // hide the unlock item in shop cart
                    unlockOIs.push(oi);
                }
                else {
                    normalOIs.push(oi);
                }
            });
        }
        else {
            console.warn('the order item input seems to be empty?', orderItems);
        }
        return normalOIs.concat(unlockOIs);
    }
}
ResortOrFilterUnlockItemPipe.ɵfac = function ResortOrFilterUnlockItemPipe_Factory(t) { return new (t || ResortOrFilterUnlockItemPipe)(); };
ResortOrFilterUnlockItemPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefinePipe"]({ name: "resortOrFilterUnlockItem", type: ResortOrFilterUnlockItemPipe, pure: true });


/***/ }),

/***/ 51625:
/*!*****************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/safe-html.pipe.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SafeHtmlPipe": () => (/* binding */ SafeHtmlPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser */ 50318);


/**
 * Generated class for the SafeHtmlPipe pipe.
 *
 * See https://angular.io/api/core/Pipe for more info on Angular Pipes.
 */
class SafeHtmlPipe {
    /**
     * Takes a value and makes it lowercase.
     */
    constructor(sanitized) {
        this.sanitized = sanitized;
    }
    transform(value) {
        // console.log(this.sanitized.bypassSecurityTrustHtml(value));
        return this.sanitized.bypassSecurityTrustHtml(value);
    }
}
SafeHtmlPipe.ɵfac = function SafeHtmlPipe_Factory(t) { return new (t || SafeHtmlPipe)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__.DomSanitizer, 16)); };
SafeHtmlPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "safeHtml", type: SafeHtmlPipe, pure: true });


/***/ }),

/***/ 20322:
/*!****************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/sanitize.pipe.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SanitizePipe": () => (/* binding */ SanitizePipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser */ 50318);


class SanitizePipe {
    constructor(sanitizer) {
        this.sanitizer = sanitizer;
    }
    transform(url) {
        return this.sanitizer.bypassSecurityTrustResourceUrl(url);
    }
}
SanitizePipe.ɵfac = function SanitizePipe_Factory(t) { return new (t || SanitizePipe)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__.DomSanitizer, 16)); };
SanitizePipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "sanitize", type: SanitizePipe, pure: true });


/***/ }),

/***/ 42832:
/*!***************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/sort-by.pipe.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SortByPipe": () => (/* binding */ SortByPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class SortByPipe {
    constructor() {
    }
    transform(input) {
        if (!input) {
            return [];
        }
        else if (input.length < 1) {
            return input;
        }
        else {
            return input.sort((a, b) => {
                return a['name'] > b['name'] ? 1 : -1;
            });
        }
    }
}
SortByPipe.ɵfac = function SortByPipe_Factory(t) { return new (t || SortByPipe)(); };
SortByPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "sortBy", type: SortByPipe, pure: true });


/***/ }),

/***/ 18073:
/*!**********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/status-display.pipe.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "StatusDisplayPipe": () => (/* binding */ StatusDisplayPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ngx-translate/core */ 33935);


class StatusDisplayPipe {
    constructor(t) {
        this.t = t;
    }
    transform(status, mode, lang = 'en', context) {
        var _a, _b, _c;
        let statusDisplay = '';
        let type = mode;
        // byod fallback
        if (type === 'pos') {
            type = 'byod';
        }
        if (!status) {
            return null;
        }
        const orderStatusDisplayMap = ((_c = (_b = (_a = context === null || context === void 0 ? void 0 : context.brand) === null || _a === void 0 ? void 0 : _a['config']) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.general) || null;
        if (lang.startsWith('zh')) {
            if (orderStatusDisplayMap && orderStatusDisplayMap[status] && orderStatusDisplayMap[status]['nameZh'] &&
                orderStatusDisplayMap[status]['nameZh'] !== '') {
                statusDisplay = orderStatusDisplayMap[status]['nameZh'];
                return statusDisplay;
            }
            else {
                const translateWord = 'status.' + type + '.' + status;
                statusDisplay = this.t.instant(translateWord);
                return statusDisplay;
            }
        }
        else if (lang === 'en') {
            if (orderStatusDisplayMap && orderStatusDisplayMap[status] && orderStatusDisplayMap[status]['nameEn'] &&
                orderStatusDisplayMap[status]['nameEn'] !== '') {
                statusDisplay = orderStatusDisplayMap[status]['nameEn'];
                return statusDisplay;
            }
            else {
                const translateWord = 'status.' + type + '.' + status;
                statusDisplay = this.t.instant(translateWord);
                return statusDisplay;
            }
        }
        else {
            const translateWord = 'status.' + type + '.' + status;
            statusDisplay = this.t.instant(translateWord);
            return statusDisplay;
        }
    }
}
StatusDisplayPipe.ɵfac = function StatusDisplayPipe_Factory(t) { return new (t || StatusDisplayPipe)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.TranslateService, 16)); };
StatusDisplayPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "statusDisplay", type: StatusDisplayPipe, pure: true });


/***/ }),

/***/ 24778:
/*!****************************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/sub-store-name-by-id.pipe.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SubStoreNameByIdPipe": () => (/* binding */ SubStoreNameByIdPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class SubStoreNameByIdPipe {
    transform(subStoreId, lang = "en", field = "name") {
        // console.log("asdasd123");
        var _a, _b, _c, _d;
        let storeName = "";
        if (!subStoreId) {
            return "";
        }
        let store = (_d = (_c = (_b = (_a = window === null || window === void 0 ? void 0 : window['aigens']) === null || _a === void 0 ? void 0 : _a.context) === null || _b === void 0 ? void 0 : _b.court) === null || _c === void 0 ? void 0 : _c.stores) === null || _d === void 0 ? void 0 : _d.find(x => x.id == subStoreId);
        if (store) {
            //var lang = window['aigens']?.context?.userLang;
            //console.log("i18n pipe", content, field,  lang);
            if (lang && lang != 'en') {
                storeName = store[field + "_" + lang];
            }
            else {
                storeName = store.name;
            }
        }
        return storeName;
    }
}
SubStoreNameByIdPipe.ɵfac = function SubStoreNameByIdPipe_Factory(t) { return new (t || SubStoreNameByIdPipe)(); };
SubStoreNameByIdPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "subStoreName", type: SubStoreNameByIdPipe, pure: true });


/***/ }),

/***/ 74043:
/*!*********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/text-ellipsis.pipe.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TextEllipsisPipe": () => (/* binding */ TextEllipsisPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class TextEllipsisPipe {
    constructor() {
    }
    transform(text, maxCharacters = 20, ellipsis = '...') {
        if (!text) {
            return '';
        }
        return text.length > maxCharacters ? text.substring(0, maxCharacters) + ellipsis : text;
    }
}
TextEllipsisPipe.ɵfac = function TextEllipsisPipe_Factory(t) { return new (t || TextEllipsisPipe)(); };
TextEllipsisPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "textEllipsisPipe", type: TextEllipsisPipe, pure: true });


/***/ }),

/***/ 18181:
/*!**********************************************************************!*\
  !*** ./projects/core/src/app/framework/pipes/timeStringLabelPipe.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TimeStringLabelPipe": () => (/* binding */ TimeStringLabelPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

// 自定义管道 timeStringLabel
// 创建的管道的类
class TimeStringLabelPipe {
    transform(pickUpTime, withSecond = false) {
        let date;
        if (pickUpTime) {
            date = new Date(pickUpTime);
        }
        else {
            date = new Date();
        }
        let timeString = date.getHours() + ':';
        if (date.getMinutes() === 0) {
            timeString = timeString + '00';
        }
        else if (date.getMinutes() <= 9) {
            timeString = timeString + '0' + date.getMinutes();
        }
        else {
            timeString = timeString + date.getMinutes();
        }
        if (withSecond) {
            timeString = timeString + ':';
            if (date.getSeconds() === 0) {
                timeString = timeString + '00';
            }
            else if (date.getSeconds() <= 9) {
                timeString = timeString + '0' + date.getSeconds();
            }
            else {
                timeString = timeString + date.getSeconds();
            }
        }
        return timeString;
    }
}
TimeStringLabelPipe.ɵfac = function TimeStringLabelPipe_Factory(t) { return new (t || TimeStringLabelPipe)(); };
TimeStringLabelPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "timeStringLabel", type: TimeStringLabelPipe, pure: true });


/***/ }),

/***/ 4297:
/*!***********************************************************************!*\
  !*** ./projects/core/src/app/framework/services/analytics.service.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AnalyticsService": () => (/* binding */ AnalyticsService)
/* harmony export */ });
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var aigens_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-framework */ 44651);
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../data */ 51707);
/* harmony import */ var _pure_base_page_params__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../pure/base/page-params */ 8744);
/* harmony import */ var _pure_services_platform_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../pure/services/platform.service */ 45485);
/* harmony import */ var _pure_services_sentry_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../pure/services/sentry.service */ 38792);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/core */ 3184);








class AnalyticsService {
    constructor(injector) {
        this.storeId = null;
        this.disabled = false;
        this.raw = false;
        this.startedABTest = false;
        this.aq = new aigens_framework__WEBPACK_IMPORTED_MODULE_0__.AQuery(injector);
        this.navParams = new _pure_base_page_params__WEBPACK_IMPORTED_MODULE_2__.PageParams();
        this.router = injector.get(_angular_router__WEBPACK_IMPORTED_MODULE_5__.Router);
        this.context = injector.get(aigens_framework__WEBPACK_IMPORTED_MODULE_0__.Context);
        this.configService = injector.get(aigens_framework__WEBPACK_IMPORTED_MODULE_0__.ConfigService);
        this.route = injector.get(_angular_router__WEBPACK_IMPORTED_MODULE_5__.ActivatedRoute);
        this.platformService = injector.get(_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_3__.PlatformService);
        this.sentryService = injector.get(_pure_services_sentry_service__WEBPACK_IMPORTED_MODULE_4__.SentryService);
        this.listenRoute();
        console.log("AnalyticsService constructor");
    }
    track(...args) {
        if (this.disabled) {
            return;
        }
        //IHLP-71 modified. Due to ...args may produce "RangeError: Maximum call stack size exceeded"
        if (this.raw) {
            this.trackRaw(...args); //IHLP-71 modified. Previous it is ...args
        }
        else {
            this.trackJs(...args); //IHLP-71 modified. Previous it is ...args
        }
    }
    trackJs(...args) {
        //Peter: don't put any print log inside this code, kiosk was really slow due to print log
        const gtag = window['gtag'];
        if (gtag) {
            const event = args[2]; //IHLP-71 modified. Previous it is args[2]
            this.addContext(event);
            gtag(...args);
            console.log('trackJs');
        }
    }
    trackRaw(...args) {
        console.log('raw', args); //IHLP-71 modified. Previous it is args
        const url = 'https://www.google-analytics.com/mp/collect?measurement_id=G-PDEP9178P4&api_secret=eekr9qRYRwqI0qhZclWyjQ';
        const eventName = args[1]; //IHLP-71 modified. Previous it is args[1]
        const event = args[2]; //IHLP-71 modified. Previous it is args[2]
        this.addContext(event);
        const body = {
            client_id: '1234567890',
            events: [
                {
                    name: eventName,
                    params: event
                }
            ]
        };
        console.log('track raw');
        const aq = this.aq;
        aq.url = url;
        aq.method = 'post';
        aq.body = body;
        // some payments require attribute(jo.charge)
        return aq.auth(false).getJson().subscribe((data => {
            console.log('raw result', data);
        }));
    }
    addContext(event) {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j;
        if (this.context.groupId) {
            event.groupId = this.context.groupId + '';
        }
        if (this.context.brandId) {
            event.brandId = this.context.brandId + '';
        }
        if (this.storeId || ((_a = this.context) === null || _a === void 0 ? void 0 : _a.storeId)) {
            event.storeId = ((_b = this.storeId) !== null && _b !== void 0 ? _b : (_c = this.context) === null || _c === void 0 ? void 0 : _c.storeId) + '';
        }
        if (this.context.courtId) {
            event.courtId = this.context.courtId + '';
        }
        if (this.mode) {
            event.mode = this.mode + '';
        }
        if ((_e = (_d = this.context) === null || _d === void 0 ? void 0 : _d.brand) === null || _e === void 0 ? void 0 : _e.orderModeSelection) {
            event.order_mode_selection = ((_g = (_f = this.context) === null || _f === void 0 ? void 0 : _f.brand) === null || _g === void 0 ? void 0 : _g.orderModeSelection) + '';
        }
        const channel = this.platformService.getChannel();
        const container = this.platformService.getContainer();
        const qrId = this.platformService.getQrId();
        if (channel) {
            event.channel = channel;
        }
        if (container) {
            event.container = container;
        }
        if (qrId) {
            event['qrId'] = qrId;
        }
        const appInfo = this.platformService.getAppInfoInstant();
        if (appInfo === null || appInfo === void 0 ? void 0 : appInfo.id) {
            event['app_id'] = appInfo.id;
            event['app_version'] = appInfo.version;
            event['app_name'] = appInfo.name;
        }
        this.navParams.querys = (_h = this.route.snapshot) === null || _h === void 0 ? void 0 : _h.queryParams;
        this.navParams.params = (_j = this.route.snapshot) === null || _j === void 0 ? void 0 : _j.params;
        // const on_premise = this.platformService.onpremise; //this.navParams.get('onpremise') ?? false;
        // event.on_premise = Boolean(on_premise);
        event.on_premise = this.platformService.onpremise;
        const member = this.context.member;
        const mid = (member === null || member === void 0 ? void 0 : member.id) || this.configService.getCookie('mid');
        if (mid && !event['user_id']) {
            event['user_id'] = mid + '';
        }
        let converted = false;
        if (member === null || member === void 0 ? void 0 : member.converted) {
            converted = true;
        }
        event['converted'] = converted;
        event['platform'] = this.platformService.getNativePlatform();
        const backendId = member === null || member === void 0 ? void 0 : member.backendId;
        if (backendId) {
            event['user_bid'] = backendId;
        }
        const alipayId = member === null || member === void 0 ? void 0 : member.alipayId;
        if (!event['container_user'] && alipayId) {
            event['container_user'] = alipayId;
        }
        const version = this.platformService.getVersion();
        event['version'] = version || 'unknown';
        event['currency'] = this.context.currency;
        event['source'] = 'v4';
        event['debug_mode'] = !this.configService.isPrd();
    }
    listenRoute() {
        this.router.events.subscribe((event) => {
            if (event instanceof _angular_router__WEBPACK_IMPORTED_MODULE_5__.ActivationEnd) {
                const snapshot = event.snapshot;
                const data = snapshot.data;
                // this.trackRoute(data.screen);
                if (data && data.screen) {
                    this.trackScreen('PWA', data.screen);
                }
            }
        });
    }
    trackScreen(appName, screenName) {
        console.log('tracking screen', appName, screenName);
        // SPA screen view
        try {
            this.track('event', 'screen_view', {
                screen_name: screenName,
                page_title: screenName,
                app_name: appName
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    trackRoute(pageName) {
        console.log('tracking route!!');
        // page view
        try {
            const path = window.location.pathname;
            this.track('event', 'page_view', {
                content_id: path,
                page_title: pageName
            });
        }
        catch (error) {
            console.log(error);
        }
        // old route: Remove me
        try {
            const path = window.location.pathname;
            this.track('event', 'route', {
                content_id: path
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    trackDialog(dialogName) {
        try {
            const path = window.location.pathname;
            this.track('event', 'dialog', {
                content_id: dialogName,
                path
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user selects a dining mode
     * @param mode
     */
    trackStartOrder(mode) {
        try {
            this.setMode(mode);
            this.track('event', 'start_order', {
                mode
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user selects a dining mode
     * @param mode
     */
    trackSelectMode(mode) {
        try {
            this.setMode(mode);
            this.track('event', 'select_mode', {
                mode
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    trackStartAB() {
        if (this.startedABTest) {
            return;
        }
        try {
            this.startedABTest = true;
            this.track('event', 'optimize.activate', {});
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user views location list (even if there's zero locations available)
     */
    trackViewLocationList() {
        try {
            this.track('event', 'view_location_list', {});
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user selects a store
     */
    trackSelectLocation() {
        try {
            this.track('event', 'select_location', {});
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user submits address for delivery (before selecting a nearby store)
     * @param order
     * @param courier
     * @returns
     */
    trackAddShippingInfo(order, courier) {
        if (!courier) {
            return;
        }
        try {
            this.track('event', 'add_shipping_info', {
                shipping_tier: courier.partner,
                currency: this.context.currency,
                value: order.shipping
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user submits contact & payment method
     */
    trackAddContactInfo() {
        try {
            this.track('event', 'add_contact_info', {});
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a users submits payment information & clicks "complete order"
     * @param paymentConfig
     */
    trackAddPaymentInfo(paymentConfig) {
        try {
            this.track('event', 'add_payment_info', {
                payment_type: paymentConfig.method,
                gateway: paymentConfig.gateway,
                sub: paymentConfig.sub
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user selects a category
     * @param cat
     */
    trackSelectCategory(cat) {
        try {
            const catId = cat.backendId || cat.id;
            const jo = {
                category_name: cat.name,
                category_id: catId
            };
            this.track('event', 'select_category', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user sees a category
     * @param cat
     */
    trackViewCategory(cat) {
        try {
            const catId = cat.backendId || cat.id;
            const jo = {
                category_name: cat.name,
                category_id: catId
            };
            this.track('event', 'view_category', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user selects an item list
     * @param cat
     * @param ig
     */
    trackSelectItemList(cat, ig) {
        try {
            const igId = ig.backendId || ig.id;
            const items = this.makeViewItemsJo(cat, ig);
            const jo = {
                item_list_name: ig.name,
                item_list_id: igId,
                items
            };
            this.track('event', 'select_item_list', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user sees a list of items
     * @param cat
     * @param ig
     */
    trackViewItemList(cat, ig) {
        try {
            const igId = ig.backendId || ig.id;
            const items = this.makeViewItemsJo(cat, ig);
            const jo = {
                item_list_name: ig.name,
                item_list_id: igId,
                items
            };
            this.track('event', 'view_item_list', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When an item is selected from a list
     * @param cat
     * @param ig
     * @param item
     */
    trackSelectItem(cat, ig, item) {
        try {
            const igId = ig.backendId || ig.id;
            const catId = cat.backendId || cat.id;
            this.track('event', 'select_item', {
                items: [this.makeItemJo(cat, ig, item, false)]
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When 50% of an item image is viewable (on active screen)
     * @param cat
     * @param ig
     */
    trackViewItems(cat, ig) {
        try {
            const igId = ig.backendId || ig.id;
            const catId = cat.backendId || cat.id;
            const itemJos = [];
            for (const item of ig.items) {
                itemJos.push(this.makeViewItemJo(cat, ig, item));
            }
            this.track('event', 'view_item', {
                items: itemJos,
                item_list_name: ig.name,
                item_list_id: igId
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When 50% of an item image is viewable (on active screen)
     * @param cat
     * @param ig
     */
    trackViewItem(item, cat, ig) {
        try {
            const igId = ig.backendId || ig.id;
            const catId = cat.backendId || cat.id;
            const cleanItem = this.makeViewItemJo(cat, ig, item);
            this.track('event', 'view_item', {
                items: [cleanItem],
                item_list_name: ig.name,
                item_list_id: igId
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    makeViewItemsJo(cat, ig) {
        const itemJos = [];
        for (const item of ig.items) {
            itemJos.push(this.makeViewItemJo(cat, ig, item));
        }
        return itemJos;
    }
    makeViewItemJo(cat, ig, item) {
        const itemId = item.sku || item.backendId || item.id;
        const igId = ig.backendId || ig.id;
        const catId = cat.backendId || cat.id;
        let igPos = 0;
        if (item.igPos >= 0) {
            igPos = item.igPos;
        }
        const jo = {
            item_id: itemId,
            item_name: item.name,
            category_name: cat.name,
            category_id: catId,
            // item_category: catId,
            // item_category_name: cat.name,
            item_list_name: ig.name,
            item_list_id: igId,
            index: igPos
        };
        return jo;
    }
    makeItemJo(cat, ig, item, includeAddon = true) {
        const itemId = item.sku || item.backendId || item.id;
        const igId = ig.backendId || ig.id;
        const catId = cat.backendId || cat.id;
        const q = item.quantity > 0 ? item.quantity : 1;
        let igPos = 0;
        if (item.igPos >= 0) {
            igPos = item.igPos;
        }
        let addon = {};
        if (includeAddon) {
            addon = Object.assign({ addon1: 'N/A', addon2: 'N/A', addon3: 'N/A', addon4: 'N/A' }, this.makeModifierItemJo(item));
        }
        const jo = Object.assign({ item_id: itemId, item_name: item.name, category_name: cat.name, category_id: catId, 
            // item_category: catId,
            // item_category_name: cat.name,
            item_list_name: ig.name, item_list_id: igId, price: item.price, currency: this.context.currency, quantity: q, index: igPos }, addon);
        return jo;
    }
    makeModifierItemJo(item) {
        var _a, _b, _c;
        console.log('makeModifierItemJo', item.mgroups);
        if (!item.mgroups || ((_a = item.mgroups) === null || _a === void 0 ? void 0 : _a.length) <= 0) {
            return {};
        }
        const addons = {};
        (_c = (_b = item.mgroups[0]) === null || _b === void 0 ? void 0 : _b.items) === null || _c === void 0 ? void 0 : _c.forEach((modifier, index) => {
            addons['addon' + (index + 1)] = modifier.name;
        });
        return addons;
    }
    /**
     * When a user adds an item to cart
     * @param orderitem
     */
    trackAddToCart(orderitem) {
        try {
            console.log('trackAddToCart', orderitem);
            const jo = this.makeOrderItemJo(orderitem);
            this.track('event', 'add_to_cart', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user removes items from the cart
     * @param orderitem
     */
    trackRemoveFromCart(orderitem) {
        try {
            const jo = this.makeOrderItemJo(orderitem);
            this.track('event', 'remove_from_cart', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user views the cart
     * @param order
     */
    trackViewCart(order) {
        try {
            const jo = this.makeOrderJo(order);
            this.track('event', 'view_cart', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    makeOrderJo(order) {
        const jo = {
            currency: this.context.currency,
            value: order.total
        };
        const items = [];
        for (const oi of order.orderitems) {
            const oiJo = this.makeOrderItemJo(oi);
            items.push(...oiJo.items);
        }
        jo.items = items;
        return jo;
    }
    /**
     * When a user clicks "checkout" on cart pane
     * @param order
     */
    trackBeginCheckout(order) {
        try {
            const jo = this.makeOrderJo(order);
            this.track('event', 'begin_checkout', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user clicks "continue" after upselling prompt
     * @param order
     */
    trackContinueCheckout(order) {
        try {
            const jo = this.makeOrderJo(order);
            this.track('event', 'continue_to_checkout', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user applies promo code
     */
    trackApplyPromoCode(currentPromoCode) {
        try {
            this.track('event', 'apply_promo_code', {
                promo_code: currentPromoCode
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    makePurchaseOrderJo(order) {
        const jo = {
            currency: this.context.currency,
            total: order.total,
            value: order.grandTotal,
            transaction_id: order.id,
            shipping: order.shipping,
            tax: order.tax,
            coupon: order.discountCode,
            discount: order.discount,
            service: order.service,
            handling: order.handling,
            business: order.business,
            tips: order.tips,
            container_user: order.containerUser,
            user_id: order.memberId
        };
        const items = [];
        for (const oi of order.orderitems) {
            _data__WEBPACK_IMPORTED_MODULE_1__.OrderItem.flattenItems(oi);
            const oiJo = this.makeOrderItemJo(oi);
            items.push(...oiJo.items);
        }
        jo.items = items;
        return jo;
    }
    checkSetDup(type, key) {
        const set = type + '-ga';
        let dups = this.configService.getLocal(set) || [];
        const index = dups.indexOf(key);
        if (index != -1) {
            console.log('duplicated event', type, key);
            return false;
        }
        dups.push(key);
        if (dups.length > 10) {
            dups = dups.slice(dups.length - 10, dups.length);
        }
        this.configService.setLocal(set, dups);
        return true;
    }
    /**
     * (N/A for some payment methods) When a user clicks confirm button
     * @param order
     */
    trackPurchase(order) {
        try {
            if (!this.checkSetDup('purchase', order.id)) {
                return;
            }
            const jo = this.makePurchaseOrderJo(order);
            this.track('event', 'purchase', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user completes a purchase & lands onto order status page
     * @param order
     */
    trackPaymentSuccess(order) {
        try {
            if (!this.checkSetDup('payment_success', order.id)) {
                return;
            }
            const jo = this.makePurchaseOrderJo(order);
            this.track('event', 'payment_success', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When the order status on the order status page is success
     * @param order
     */
    trackOrderSuccess(order) {
        try {
            if (!this.checkSetDup('order_success', order.id)) {
                return;
            }
            const jo = this.makePurchaseOrderJo(order);
            this.track('event', 'order_success', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user is asked to enter shipping address OR to select a store
     */
    trackLocationStart() {
        try {
            this.track('event', 'location_start', {});
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user select a preferred payment method
     */
    trackSelectedPaymentMethod(method, gateway, order) {
        try {
            if (!method || !gateway) {
                return;
            }
            const jo = this.makeOrderJo(order);
            jo['payment_method'] = method;
            jo['payment_gateway'] = gateway;
            this.track('event', 'select_payment_method', jo);
            this.sentryService.setTag('payment_method', method);
            this.sentryService.setTag('payment_gateway', gateway);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user login
     */
    trackLogin(method, from = null) {
        try {
            this.track('event', 'login', {
                method,
                from
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user signup
     */
    trackSignUp(method, from = null) {
        try {
            const jo = {
                method,
                from
            };
            this.track('event', 'sign_up', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user clicks on view rewards in checkout page
     */
    trackViewRewards() {
        try {
            this.track('event', 'view_rewards', {});
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When a user signup
     */
    trackSelectReward(selectedRewardId) {
        try {
            const jo = { selected_reward_id: selectedRewardId };
            this.track('event', 'select_reward', jo);
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When user view ads, will have ads array as attribute
     */
    trackViewAds(ads, trigger) {
        try {
            const adsJo = ads.map((ad, index) => {
                return this.makeAdJo(ad, trigger, index);
            });
            this.track('event', 'view_content', {
                ads: adsJo
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When user clicks on an ad
     * @param ad
     * @param trigger
     * @param index
     */
    trackSelectAd(ad, trigger, index) {
        try {
            this.track('event', 'select_ad', Object.assign({}, this.makeAdJo(ad, trigger, index)));
        }
        catch (error) {
            console.log(error);
        }
    }
    makeAdJo(ad, trigger, index) {
        return {
            ad_name: ad.name,
            ad_id: ad.id,
            trigger,
            index
        };
    }
    /**
     * When user click on change store on order page
     */
    trackClickOpenDirectory() {
        try {
            this.track('event', 'click_open_directory', {});
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When user click on change time on order page
     */
    trackClickOpenTimeSelection() {
        try {
            this.track('event', 'click_open_time_selection', {});
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When user confirm an address when add new address
     */
    trackDeliveryAddressComfirmed() {
        try {
            this.track('event', 'delivery_address_confirmed', {});
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When user changed advance time
     * @param date
     * @param startTime
     * @param endTime
     */
    trackChangeAdvanceTime(date, startTime, endTime) {
        try {
            this.track('event', 'change_advance_time', {
                startTime,
                endTime,
                date
            });
        }
        catch (error) {
            console.log(error);
        }
    }
    /**
     * When user click to start complete profile for quick registration
     */
    trackClickCompleteProfile() {
        this.track('event', 'click_complete_profile', {});
    }
    /**
     * When user completed their profile for quick registation
     */
    trackCompletedProfile() {
        this.track('event', 'completed_profile', {});
    }
    /**
     * When user click on forgot password in login page
     * @param method
     */
    trackClickForgotPassword(method) {
        this.track('event', 'click_forgot_password', { method });
    }
    /**
     * When user click on request otp in register page
     * @param method
     * @param from
     */
    trackRequestOtp(method, from = null) {
        this.track('event', 'request_otp', { method, from });
    }
    /**
     * When user verify their otp in register page
     * @param method
     * @param from
     */
    trackVerifyOtp(method, from = null) {
        this.track('event', 'verify_otp', { method, from });
    }
    /**
     * Track different actions in combo page, action: 'add', 'minus', 'add_to_cart', 'enlarge_image'
     * @param action
     * @param item
     */
    trackItemDialogAction(action, item) {
        var _a;
        this.track('event', 'item_dialog_action', {
            action,
            item_id: item.id,
            item_name: item.name,
            type: ((_a = item === null || item === void 0 ? void 0 : item.groups) === null || _a === void 0 ? void 0 : _a.length) > 0 ? 'combo' : 'alacarte'
        });
    }
    makeOrderItemJo(orderitem) {
        let cat = orderitem.category;
        if (!cat) {
            cat = new _data__WEBPACK_IMPORTED_MODULE_1__.Category();
            cat.id = orderitem.categoryId;
        }
        const q = orderitem.quantity || 1;
        const jo = {
            currency: this.context.currency
        };
        const itemList = [];
        for (const ig of orderitem.groups) {
            const items = ig.items;
            for (const item of items) {
                const itemJo = this.makeItemJo(cat, ig, item);
                // itemJo.index = orderitem.itemPosition;
                itemJo.quantity = itemJo.quantity * q;
                itemList.push(itemJo);
            }
        }
        jo.items = itemList;
        jo.value = orderitem.total * q;
        return jo;
    }
    setMode(mode) {
        this.mode = mode;
        this.sentryService.setTag("mode", mode);
    }
    setCurrentStoreId(storeId) {
        this.storeId = storeId;
        this.sentryService.setTag("storeId", storeId);
    }
}
AnalyticsService.ɵfac = function AnalyticsService_Factory(t) { return new (t || AnalyticsService)(_angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_6__.Injector)); };
AnalyticsService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdefineInjectable"]({ token: AnalyticsService, factory: AnalyticsService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 20819:
/*!************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/api-bridge.service.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ApiBridgeService": () => (/* binding */ ApiBridgeService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _pure_services_platform_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../pure/services/platform.service */ 45485);
/* harmony import */ var _config_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config.service */ 2171);




class ApiBridgeService {
    constructor(injector, platformService, configService) {
        this.platformService = platformService;
        this.configService = configService;
        this.rules = [
            {
                method: "get",
                match: "/api/v1/menu/store/",
                replace: "/api/v2/menu/store/",
                channels: ["kiosk"],
                disabled: true
            }
        ];
    }
    channelOk(channel, rule) {
        var channels = rule.channels;
        if (channels) {
            return channels.indexOf(channel) >= 0;
        }
        return true;
    }
    translateUrl(fromUrl, aq) {
        //console.log("translating path", fromUrl, aq);
        //TEST ONLY, not enabled at PRD
        if (this.configService.isPrd())
            return fromUrl;
        var channel = this.platformService.getChannel();
        var result = fromUrl;
        const u = new URL(fromUrl);
        const path = u.pathname;
        for (let proxy of this.rules) {
            if (proxy.disabled) {
                continue;
            }
            if (!this.channelOk(channel, proxy)) {
                continue;
            }
            if (aq.method == proxy.method && path.indexOf(proxy.match) >= 0) {
                console.log("translating proxy path match", proxy);
                result = fromUrl.replace(proxy.match, proxy.replace);
                console.log("translated path", result);
                break;
            }
        }
        return result;
    }
}
ApiBridgeService.ɵfac = function ApiBridgeService_Factory(t) { return new (t || ApiBridgeService)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_2__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_0__.PlatformService), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_config_service__WEBPACK_IMPORTED_MODULE_1__.ConfigService)); };
ApiBridgeService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineInjectable"]({ token: ApiBridgeService, factory: ApiBridgeService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 2171:
/*!********************************************************************!*\
  !*** ./projects/core/src/app/framework/services/config.service.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConfigService": () => (/* binding */ ConfigService)
/* harmony export */ });
/* harmony import */ var localforage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! localforage */ 26477);
/* harmony import */ var localforage__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(localforage__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ 62535);
/* harmony import */ var _pure_services_common_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../pure/services/common.service */ 43872);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var ngx_cookie_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngx-cookie-service */ 53694);
/* harmony import */ var _pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../pure/services/subscribe.service */ 47074);
/* harmony import */ var _pure_services_platform_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../pure/services/platform.service */ 45485);







class ConfigService {
    constructor(cookieService, ss, platformService) {
        this.cookieService = cookieService;
        this.platformService = platformService;
        this.sessionId = null;
        this.loaded = {};
        this.loadedElement = {};
        this.stationId = null;
        ss.bind(this, ['sessionId']);
        console.log("ConfigService construct", window['aigens']);
        // this.config = new Config();
        var config = window['appConfig'];
        if (config) {
            this.config = config;
            this.pickRegion(config);
        }
        this.initFromContext();
    }
    initFromContext() {
        var aigens = window['aigens'];
        //TODO: Find a better way to set up profile
        if (!aigens.profile) {
            aigens.profile = {
                "api": "https://aigensstoretest.appspot.com"
            };
        }
        // aigens.profile.api = 'https://fairwood-test.appspot.com';
        // aigens.profile.api =  'https://aigensstoretest.appspot.com';
        if (aigens && aigens.profile && !this.isConsole()) {
            this.configRegion = 'profile';
            var p = Object.assign({}, aigens.profile);
            //if cn network, use api2 if available
            if (this.platformService.network == 'cn') {
                if (p.api2) {
                    p.api = p.api2;
                    p.api2 = null;
                }
            }
            this.config = {
                'profile': p
            };
            console.log("DYNAMIC PROFILE", p);
        }
    }
    //adhoc fix....
    isConsole() {
        var _a;
        var referer = (_a = window['aigens']) === null || _a === void 0 ? void 0 : _a.referer;
        if (referer && referer.indexOf('console') != -1) {
            return true;
        }
        return false;
    }
    setConfig(config) {
        this.config = config;
    }
    setRegion(name) {
        this.configRegion = name;
        this.setLocal('config.region', name);
    }
    pickRegion(config) {
        var domain = window.location.hostname;
        var region = config.domains[domain];
        if (region) {
            this.setRegion(region);
        }
    }
    restoreRegion() {
        console.log('restore Region');
        this.configRegion = this.getLocal('config.region');
    }
    getRegion() {
        return this.configRegion;
    }
    get(name) {
        const map = this.getConfig();
        return map[name];
    }
    getConfig() {
        let map = null;
        if (this.configRegion) {
            map = this.config[this.configRegion];
        }
        // console.log('config', map);
        if (!map) {
            // console.log('using default config');
            map = this.config.default;
        }
        return map;
    }
    getApi() {
        if (this.host) {
            return this.host;
        }
        return this.get('api');
    }
    getBackendApi() {
        var host = this.get("backend");
        if (!host) {
            return this.getApi();
        }
        return host;
    }
    putPreference(key, value) {
        //this.storage.set(key, value);
    }
    isDev() {
        // return "dev" == this.config.default['name'];
        return 'dev' == this.get('name');
    }
    isExperiment() {
        // return "dev" == this.config.default['name'];
        return this.isDev() || 'test' == this.get('name');
    }
    isLocalhost() {
        return window.location.hostname == 'localhost';
    }
    isPrd() {
        return this.get('production');
    }
    getSessionId() {
        return this.sessionId; // || this.getLocal("session");
    }
    getLocale() {
        return this.getLocal("locale");
    }
    setLocale(lang) {
        return this.setLocal("locale", lang);
    }
    getAnonSessionId() {
        var session = this.sessionId || this.getLocal("session");
        if (!session) {
            session = (0,uuid__WEBPACK_IMPORTED_MODULE_4__["default"])();
            this.setLocal("session", session);
            this.sessionId = session;
        }
        return session;
    }
    getDeviceId() {
        var deviceId = this.getLocal("deviceId");
        if (!deviceId) {
            deviceId = (0,uuid__WEBPACK_IMPORTED_MODULE_4__["default"])();
            this.setLocal("deviceId", deviceId);
        }
        return deviceId;
    }
    // pass deviceId from app (by core sdk)
    setDeviceId(deviceId) {
        if (!deviceId)
            return;
        this.setLocal("deviceId", deviceId);
    }
    setCookie(name, value) {
        this.cookieService.set(name, value);
    }
    getCookie(name) {
        return this.cookieService.get(name);
    }
    setLocal(key, object) {
        _pure_services_common_service__WEBPACK_IMPORTED_MODULE_1__.CommonService.setLocal(key, object);
    }
    getLocal(key) {
        return _pure_services_common_service__WEBPACK_IMPORTED_MODULE_1__.CommonService.getLocal(key);
    }
    clearAll() {
        this.setCookie("sid", null);
        this.setLocal("sid", null);
        this.setLocal("aigens.member", null);
        this.setLocal("member", null);
        this.setLocal("session.expire", null);
        this.sessionId = null;
    }
    setSessionStorage(key, object) {
        _pure_services_common_service__WEBPACK_IMPORTED_MODULE_1__.CommonService.setSessionStorage(key, object);
    }
    getsessionStorage(key) {
        return _pure_services_common_service__WEBPACK_IMPORTED_MODULE_1__.CommonService.getSessionStorage(key);
    }
    setStorage(key, object) {
        return localforage__WEBPACK_IMPORTED_MODULE_0__.setItem(key, object);
    }
    getStorage(key) {
        return localforage__WEBPACK_IMPORTED_MODULE_0__.getItem(key);
    }
    loadScript(url, callback = () => { }, param) {
        if (this.loaded[url] && url.indexOf('session.js') == -1) {
            // console.log("script already loaded!!!", url);
            if (callback) {
                callback();
            }
            return;
        }
        else if (this.loaded[url] && url.indexOf('session.js') != -1) {
            // to re-init the mpgs session script
            this.loadedElement[url].remove();
            this.loadedElement[url] = null;
            this.loaded[url] = false;
        }
        // Adding the script tag to the head as suggested before
        const head = document.getElementsByTagName('head')[0];
        const script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = url;
        if (param) {
            for (const key in param) {
                script.setAttribute(key, param[key]);
            }
        }
        script.onload = () => {
            this.loaded[url] = true;
            if (callback) {
                // script.onreadystatechange = callback;
                callback();
            }
        };
        // Fire the loading
        const temp = head.appendChild(script);
        this.loadedElement[url] = temp;
    }
    loadJavaScript(url, param = {}) {
        return new Promise((resolve, reject) => {
            if (this.loaded[url] && url.indexOf('session.js') === -1) {
                console.log(url + 'had already loaded');
                resolve(true);
                return;
            }
            else if (this.loaded[url] && url.indexOf('session.js') !== -1) {
                // to re-init the mpgs session script
                this.loadedElement[url].remove();
                this.loadedElement[url] = null;
                this.loaded[url] = false;
            }
            const head = document.getElementsByTagName('head')[0];
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = url;
            if (param) {
                for (const key in param) {
                    script.setAttribute(key, param[key]);
                }
            }
            script.onload = () => {
                console.log(url + 'now loaded');
                this.loaded[url] = true;
                resolve(true);
            };
            head.appendChild(script);
            const temp = head.appendChild(script);
            this.loadedElement[url] = temp;
        });
    }
    // for mpgs2 remove the old session.js which already import in this,loaded Map
    removeJavaScriptJs(url) {
        if (this.loaded[url] && url.indexOf('session.js') !== -1) {
            // to re-init the mpgs session script
            this.loadedElement[url].remove();
            this.loadedElement[url] = null;
            this.loaded[url] = false;
        }
    }
    loadScriptJS(path, callback, param, forceLoad, removeOldJs, removeCallback) {
        if (this.loaded[path] && !forceLoad) {
            console.log('script already loaded!!!', path);
            callback();
            return;
        }
        if (this.loaded[path] && forceLoad) {
            // 已经存在js 但强迫重新load时：是否remove 原有的js节点 and then reload(google login btn render需要remove and then 重新加载js)
            if (removeOldJs) {
                removeCallback && removeCallback();
            }
        }
        const head = document.getElementsByTagName('head')[0];
        const script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = path;
        if (param) {
            for (const key in param) {
                script.setAttribute(key, param[key]);
            }
        }
        script.onload = () => {
            this.loaded[path] = true;
            if (callback) {
                // script.onreadystatechange = callback;
                callback();
            }
        };
        head.appendChild(script);
    }
    loadCSS(url, callback, param) {
        const link = document.createElement('link');
        link.setAttribute('rel', 'stylesheet');
        link.setAttribute('href', url);
        if (param) {
            for (const key in param) {
                link.setAttribute(key, param[key]);
            }
        }
        link.onload = () => {
            this.loaded[url] = true;
            if (callback) {
                callback();
            }
        };
        document.getElementsByTagName('head')[0].appendChild(link);
    }
    getVersionCode() {
        return this.get('version');
    }
    // returns the current time or debug time
    getTime() {
        var _a, _b;
        if (((_b = (_a = this.config) === null || _a === void 0 ? void 0 : _a.default) === null || _b === void 0 ? void 0 : _b.name) == 'pos') {
            return new Date().getTime();
        }
        if (this.debugTime) {
            return this.debugTime;
        }
        return new Date().getTime();
    }
    setDebugTime(time) {
        this.debugTime = time;
    }
    // some logic copy from v3
    clearSessionId() {
        this.setSessionId(null);
    }
    deleteCookie(name) {
        this.cookieService.delete(name, '/');
    }
    setSessionId(sessionId) {
        this.sessionId = sessionId;
        this.setLocal("session", sessionId);
    }
    setStationId(stationId) {
        this.stationId = stationId;
        this.setLocal("session", stationId);
    }
    getStationId() {
        return this.stationId;
    }
    getUserToken() {
        // return Cookie.get("_ut");
        return this.getCookie('_ut');
    }
    getAnimationOff() {
        return this.getLocal("animationOff") || false;
    }
    setAnimationOff(isOff) {
        this.setLocal("animationOff", isOff);
    }
    getAutoExpand() {
        let isAutoExpand = this.getLocal("autoExpand");
        console.log('isAutoExpand1', isAutoExpand);
        if (typeof isAutoExpand == 'undefined') {
            isAutoExpand = true;
        }
        console.log('isAutoExpand2', isAutoExpand);
        return isAutoExpand;
    }
    setAutoExpand(isOn) {
        console.log('setAutoExpand', isOn);
        this.setLocal("autoExpand", isOn);
    }
    getDoubleConfirm() {
        return this.getLocal("doubleConfirm") || false;
    }
    setDoubleConfirm(isOn) {
        console.log('doubleConfirm', isOn);
        return this.setLocal("doubleConfirm", isOn);
    }
    setAutoModifier(isOn) {
        console.log('setAutoModifier', isOn);
        this.setLocal("autoModifier", isOn);
    }
    getAutoModifier() {
        let isAutoModifier = this.getLocal("autoModifier");
        console.log('isAutoModifier1', isAutoModifier);
        if (typeof isAutoModifier == 'undefined') {
            isAutoModifier = false;
        }
        console.log('isAutoModifier2', isAutoModifier);
        return isAutoModifier;
    }
    setApiKey(apiKey) {
        console.log('setApiKey', apiKey);
        this.apiKey = apiKey;
        this.setLocal("apiKey", apiKey);
    }
    getApiKey() {
        return this.apiKey;
    }
}
ConfigService.ɵfac = function ConfigService_Factory(t) { return new (t || ConfigService)(_angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](ngx_cookie_service__WEBPACK_IMPORTED_MODULE_6__.CookieService), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_2__.SubscribeService), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_3__.PlatformService)); };
ConfigService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵdefineInjectable"]({ token: ConfigService, factory: ConfigService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 98235:
/*!*****************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/context-manager.service.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ContextManager": () => (/* binding */ ContextManager)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var aigens_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-framework */ 44651);
/* harmony import */ var _config_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config.service */ 2171);



class ContextManager {
    constructor(context, dataService, themeService, storageService, configService) {
        this.context = context;
        this.dataService = dataService;
        this.themeService = themeService;
        this.storageService = storageService;
        this.configService = configService;
    }
    autoContext(fields, params, callback) {
        var update = false;
        if (this.context.brandId != params.brandId) {
            console.log("different brandId");
            update = true;
        }
        if (!this.haveAllFields(fields, this.context.fields)) {
            console.log("missing fields fetching context", fields, this.context.fields);
            update = true;
        }
        if (!update) {
            console.log("context have all fields and correct brand");
            if (callback)
                callback(this.context);
            return;
        }
        console.log("reloading context", fields, params);
        this.loadContext(fields, params, false, callback);
    }
    haveAllFields(fields, existing) {
        if (!existing)
            return false;
        for (let f of fields) {
            if (existing.indexOf(f) == -1) {
                console.log("context missing field", f);
                return false;
            }
        }
        return true;
    }
    loadContext(fields, contextIds, refresh, callback) {
        const url = '/api/v1/asset/context.json';
        var params = contextIds;
        if (fields) {
            params['fields'] = fields.join();
        }
        params['locale'] = 'multi'; // add this to avoid new context (order-context) created with different key
        this.dataService.get(url, params).subscribe(data => {
            console.log('context', data);
            if (window['aigens']) {
                Object.assign(window['aigens'].context, data);
            }
            this.context.setContextData(data);
            this.themeService.setThemeByContext();
            callback && callback(this.context);
        }, err => {
            console.log(err);
            callback && callback(null);
        });
    }
    loadEmbeddedContext(url, refresh, callback) {
        this.readUrlCache(url).then((cached) => {
            if (cached) {
                console.log("Serving CACHED App Context");
                this.setContextAndCallback(url, cached, callback);
            }
            //always go fetch again
            this.dataService.get(url, {}, !refresh).subscribe({
                next: data => {
                    if (!cached) {
                        this.setContextAndCallback(url, data, callback);
                    }
                    this.saveEmbddedContext(url, data);
                },
                error: err => {
                    console.log(err);
                    callback && callback(null);
                }
            });
        });
    }
    saveEmbddedContext(url, data) {
        if (data === null || data === void 0 ? void 0 : data.app) {
            this.saveUrlCache(url, data);
            console.log("init json saved silently in background");
        }
        return;
    }
    setContextAndCallback(url, data, callback) {
        if (data) {
            //inject new content into aigens object
            var aigens = window['aigens'] || {};
            Object.assign(aigens, data);
            //aigens is set, now reset the profile
            this.configService.initFromContext();
            this.context.initFromContext();
            //this.memberContext.initFromContext();
            //this.orderContext.initFromContext();
        }
        this.context.setContextData(data.context);
        this.themeService.setThemeByContext();
        callback && callback(data);
    }
    saveUrlCache(url, jo) {
        var key = "type=cache&url=" + url;
        console.log("SAVING URL CACHE", key);
        this.storageService.setStorage(key, jo);
    }
    readUrlCache(url) {
        var key = "type=cache&url=" + url;
        return this.storageService.getStorage(key);
    }
}
ContextManager.ɵfac = function ContextManager_Factory(t) { return new (t || ContextManager)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](aigens_framework__WEBPACK_IMPORTED_MODULE_0__.Context), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](aigens_framework__WEBPACK_IMPORTED_MODULE_0__.DataService), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](aigens_framework__WEBPACK_IMPORTED_MODULE_0__.ThemeColorService), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](aigens_framework__WEBPACK_IMPORTED_MODULE_0__.StorageService), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_config_service__WEBPACK_IMPORTED_MODULE_1__.ConfigService)); };
ContextManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineInjectable"]({ token: ContextManager, factory: ContextManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 73769:
/*!*********************************************************************!*\
  !*** ./projects/core/src/app/framework/services/context.service.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Context": () => (/* binding */ Context)
/* harmony export */ });
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash-es */ 94894);
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash-es */ 45269);
/* harmony import */ var _base_base_context__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../base/base-context */ 76309);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);





class Context extends _base_base_context__WEBPACK_IMPORTED_MODULE_0__.BaseContext {
    constructor(injector) {
        super(injector);
        this.userLang = "en";
        this.currencySign = "$";
        this.embed = false;
        this.admin = false;
        this.payments = [];
        this.t = injector.get(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.TranslateService);
        console.log("constructing context, this should only happen once");
        this.initFromContext();
        this.bind(["member", "membership", "sessionId"]);
    }
    initFromContext() {
        this.initFromJs();
        this.setTranslation();
    }
    initFromJs() {
        if (!window['aigens']) {
            window['aigens'] = {};
        }
        var aigens = window['aigens'];
        if (aigens && aigens.context) {
            this.version = aigens.version;
            this.setContextData(aigens.context);
        }
    }
    //clear the context, likely due to logout or switching to different brand
    clear() {
        /*
        this.membership = null;
        this.groupId = null;
        this.group = null;
        this.brandId = null;
        this.brand = null;
        this.store = null;
        this.storeId = null;
        this.courtId = null;
        this.court = null;
        this.currencySign = null;
        this.currency = null;
        this.crm = null;
        this.form = null;
        this.payments = null;
        this.sessionId = null;
        */
    }
    logout() {
        console.log('logout');
        this.setLocal("member", null);
        this.setLocal("session", null);
        this.next("member", null);
        this.next("membership", null);
        this.next("sessionId", null);
        this.sentryService.removeMember();
        this.save();
    }
    makeSaveData() {
        if (!this.groupId) {
            console.log("cannot save incomplete context");
            return null;
        }
        var data = {
            member: this.member,
            membership: this.membership,
            userLang: this.userLang,
            contentLang: this.contentLang,
            language: this.language,
            languages: this.languages,
            country: this.country,
            group: this.group,
            groupId: this.groupId,
            brandId: this.brandId,
            brand: this.brand,
            store: this.store,
            storeId: this.storeId,
            court: this.court,
            courtId: this.courtId,
            currencySign: this.currencySign,
            currency: this.currency,
            crm: this.crm,
            form: this.form,
            sessionId: this.sessionId,
            payments: this.payments,
            agreements: this.agreements,
            config: this.config,
            locale: this.locale,
            defaultStoreMode: this.defaultStoreMode
        };
        return data;
    }
    restoreSavedData(data) {
        console.log("init context doesn't restore saved data");
    }
    /**
     * @deprecated Use settingManager.get() instead
     */
    getDeviceConfig(key) {
        var _a;
        var result = null;
        if ((_a = this.config) === null || _a === void 0 ? void 0 : _a.data) {
            var config = this.config.data;
            result = (0,lodash_es__WEBPACK_IMPORTED_MODULE_2__["default"])(config, key);
        }
        return result;
    }
    setTranslation() {
        var _a, _b, _c, _d;
        let userLang;
        const languages = (_b = (_a = window['aigens']) === null || _a === void 0 ? void 0 : _a.context) === null || _b === void 0 ? void 0 : _b.languages;
        if (!languages || (languages === null || languages === void 0 ? void 0 : languages.includes(this.getLocal('locale')))) {
            userLang = this.getLocal('locale');
        }
        var lang = userLang || ((_d = (_c = window['aigens']) === null || _c === void 0 ? void 0 : _c.context) === null || _d === void 0 ? void 0 : _d.language) || 'en';
        this.setLocal('locale', lang);
        this.t.onLangChange.subscribe((res) => {
            this.mergeTranslation();
        });
        this.t.setDefaultLang('en');
        this.t.use(lang);
        this.userLang = userLang;
        this.mergeTranslation(); // initial merge the translations, in case just one lang and no onLangChange trigger
        console.log("lang setup done");
    }
    mergeTranslation() {
        var _a, _b;
        var lang = this.t.currentLang;
        var currentTrans = this.t.translations[lang];
        //console.log("current lang", lang);
        //console.log("currentTrans", currentTrans);
        this.userLang = lang;
        var overwrites = (_b = (_a = this.config) === null || _a === void 0 ? void 0 : _a.data) === null || _b === void 0 ? void 0 : _b.translations;
        if (overwrites) {
            var newTrans = overwrites[lang];
            //console.log("overwrites", newTrans);
            if (newTrans) {
                (0,lodash_es__WEBPACK_IMPORTED_MODULE_3__["default"])(currentTrans, newTrans);
            }
            //console.log("mergedTrans", currentTrans);
        }
    }
    setMember(member) {
        this.member = member;
        this.setLocal("member", member);
        if (member === null || member === void 0 ? void 0 : member.membership) {
            this.membership = member === null || member === void 0 ? void 0 : member.membership;
        }
        this.next("member", member);
        try {
            this.sentryService.setMember(member);
        }
        catch (err) {
            console.log(err);
        }
    }
    isSignedIn() {
        return this.member && this.member.sessionId && !this.member.guest;
    }
    setContextData(data) {
        var _a;
        if (!data) {
            return;
        }
        const context = this;
        // invalid data
        if (!data.groupId) {
            console.log("INVALID CONTEXT", data);
            return;
        }
        Object.assign(context, data);
        context.contentLang = context.language;
        context.settings = (_a = context.config) === null || _a === void 0 ? void 0 : _a.data;
        this.contextId = this.makeGenericKey(data, "init", data.locale);
        context.save();
    }
    switchStore(brand, store) {
        if (this.brand && this.brand.id != store.brandId) {
            console.log("CANNOT SWITCH store due to brand mismatch");
            return;
        }
        this.store = store;
        this.storeId = store.id;
        this.switchBrand(brand);
    }
    switchBrand(brand) {
        if (this.group && this.group.id != brand.groupId) {
            console.log("CANNOT SWITCH brand due to group mismatch");
            return;
        }
        this.brand = brand;
        this.brandId = brand.id;
    }
}
Context.ɵfac = function Context_Factory(t) { return new (t || Context)(_angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_4__.Injector)); };
Context.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineInjectable"]({ token: Context, factory: Context.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 1024:
/*!******************************************************************!*\
  !*** ./projects/core/src/app/framework/services/data.service.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DataService": () => (/* binding */ DataService)
/* harmony export */ });
/* harmony import */ var _pure_services_time_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../../pure/services/time.service */ 72570);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ 10745);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ 50635);
/* harmony import */ var _base_aquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/aquery */ 33759);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);






class DataService {
    constructor(injector) {
        this.CACHE = {};
        this.aq = new _base_aquery__WEBPACK_IMPORTED_MODULE_1__.AQuery(injector);
        this.timeService = injector.get(_pure_services_time_service__WEBPACK_IMPORTED_MODULE_0__.TimeService);
    }
    get(url, params = {}, useCache = false, syncTime = false) {
        var cacheKey = this.makeCacheKey(url, params);
        ;
        //check if cache have the value
        if (useCache) {
            var result = this.CACHE[cacheKey];
            if (result) {
                console.log("cache hit");
                return (0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(result);
            }
        }
        var aq = this.aq;
        aq.url = url;
        aq.method = "get";
        aq.params = params;
        //bypass service worker for API get
        /*
        aq.headers = {
            "ngsw-bypass": "true"
        };
        */
        return aq.auth(true).getJson().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.map)(jo => {
            var data = jo['data'];
            if (syncTime) {
                const time = jo['time'];
                if (time) {
                    this.timeService.setServerVerifiedTime(time);
                }
            }
            if (useCache && data) {
                this.CACHE[cacheKey] = data;
            }
            else {
                //if cache do exist, update the cache reguardless
                if (this.CACHE[cacheKey]) {
                    this.CACHE[cacheKey] = data;
                }
            }
            return data;
        }));
    }
    makeCacheKey(url, params) {
        var key = url + "?" + new URLSearchParams(params).toString();
        console.log("cache key", key);
        return key;
    }
    getRaw(url, params = {}, auth = false) {
        var aq = this.aq;
        aq.url = url;
        aq.method = "get";
        aq.params = params;
        return aq.auth(auth).getJson();
    }
    getRawWithHeaders(url, params = {}, auth = false, headers) {
        var aq = this.aq;
        aq.url = url;
        aq.method = "get";
        aq.params = params;
        aq.headers = headers;
        return aq.auth(auth).getJson();
    }
    postWithBody(url, body, params = {}, auth = true) {
        var aq = this.aq;
        aq.url = url;
        aq.method = "post";
        aq.body = body;
        aq.params = params;
        // some payments require attribute(jo.charge)
        return aq.auth(auth).getJson().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.map)(jo => jo /*['data']*/));
    }
    postWithHeaders(url, body, params = {}, headers = null, auth = true) {
        var aq = this.aq;
        aq.url = url;
        aq.method = "post";
        aq.body = body;
        aq.params = params;
        if (headers) {
            aq.headers = headers;
        }
        return aq.auth(auth).getJson().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.map)(jo => jo /*['data']*/));
    }
    put(url, body, auth = true) {
        var aq = this.aq;
        aq.url = url;
        aq.method = "put";
        aq.body = body;
        return aq.auth(auth).getJson().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.map)(jo => jo['data']));
    }
    putWithParams(url, params) {
        var aq = this.aq;
        aq.url = url;
        aq.method = 'put';
        aq.params = params;
        return aq.auth(true).getJson().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.map)(jo => jo['data']));
    }
    postWithParams(url, params, headers = null) {
        var aq = this.aq;
        aq.url = url;
        aq.method = "post";
        aq.params = params;
        if (headers) {
            aq.headers = headers;
        }
        return aq.auth(true).getJson().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.map)(jo => jo['data']));
    }
    postWithBodyAndParamsAndHeaders(url, body, params, headers = null, shouldAuth = false) {
        var aq = this.aq;
        aq.url = url;
        aq.method = "post";
        aq.params = params;
        if (headers) {
            aq.headers = headers;
        }
        if (body) {
            aq.body = body;
        }
        return aq.auth(shouldAuth).getJson().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.map)(jo => jo));
    }
    deleteWithParams(url, params) {
        var aq = this.aq;
        aq.url = url;
        aq.method = 'delete';
        aq.params = params;
        return aq.auth(true).getJson().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.map)(jo => jo['data']));
    }
    postFile(url, file, params = {}) {
        var aq = this.aq;
        aq.url = url;
        aq.method = 'post';
        aq.file = file;
        aq.params = params;
        return aq.auth(true).getJson();
    }
}
DataService.ɵfac = function DataService_Factory(t) { return new (t || DataService)(_angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_4__.Injector)); };
DataService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineInjectable"]({ token: DataService, factory: DataService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 69104:
/*!********************************************************************!*\
  !*** ./projects/core/src/app/framework/services/dialog.service.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogService": () => (/* binding */ DialogService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var _pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../pure/services/routing.service */ 28759);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ 3184);





class DialogService {
    constructor(injector) {
        this.busy = false;
        this.t = injector.get(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.TranslateService);
        this.routingService = injector.get(_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__.RoutingService);
    }
    setDialogController(dialogCtr) {
        this.dialogCtr = dialogCtr;
    }
    getDialogController() {
        return this.dialogCtr;
    }
    setSnackBar(snackBar) {
        this.snackBar = snackBar;
    }
    setSuperLoaderComponent(component) {
        this.superLoaderComponent = component;
    }
    setAlertComponent(component) {
        this.alertComponent = component;
    }
    setConfirmComponent(component) {
        this.confirmComponent = component;
    }
    setConfirmCancleComponent(component) {
        this.confirmCancelDialogComponent = component;
    }
    showError(err, handleSessionExpired = true) {
        console.log(err);
        // this.loading(false);
        this.superloading(false);
        if (err.status == 0) {
            this.showAlert('', this.t.instant('global.network-error'));
        }
        else if (err.status == 401 && handleSessionExpired) {
            // this.showConfirm('Authentication Error', 'Insufficient permission or session expired. ' + '(' + err.error + ')', null, null, () => {
            //     this.goLogin();
            // });
            return this.showAlert(this.t.instant('global.auth-error'), this.t.instant('global.auth-error-msg'), (type) => {
                if (this.logoutHandler) {
                    this.logoutHandler();
                }
            });
        }
        else if (err.message) {
            return this.showAlert('', err.message);
        }
        else {
            return this.showAlert(err.status, err.error);
        }
    }
    showAlert(title, message, callback = (clickedType) => { }, showCancel = false, disableBgClose = false, configs = {}, error) {
        if (!this.dialogCtr) {
            window.alert(message);
            callback && callback('confirm');
            return;
        }
        const customModalClass = ['alert-dialog'];
        if (configs === null || configs === void 0 ? void 0 : configs.panelClass) {
            customModalClass.push(configs === null || configs === void 0 ? void 0 : configs.panelClass);
        }
        const alert = this.dialogCtr.open(this.alertComponent, Object.assign({ data: { title, message, error, showCancel }, disableClose: disableBgClose, panelClass: customModalClass }, configs));
        alert.afterClosed().subscribe((respone) => {
            switch (respone) {
                case 'confirm':
                case 'cancel':
                    callback && callback(respone);
                    break;
                default:
                    callback && callback('bg');
                    break;
            }
        });
        return alert;
    }
    showToast(message, duration = 2000, position = 'bottom', clsName = []) {
        if (!this.snackBar) {
            alert(message);
            return;
        }
        this.snackBar.open(message, null, {
            duration,
            verticalPosition: position,
            panelClass: ['snackbar', ...clsName], // add this to styling the snack bar , ::ng-deep .snackbar
        });
    }
    showConfirm(title, message, options = {}) {
        const cancel = options.cancelText || this.t.instant('buttons.cancel');
        const ok = options.okText || this.t.instant('buttons.ok');
        const customModalClass = ['confirm-dialog'];
        if (options === null || options === void 0 ? void 0 : options.panelClass) {
            customModalClass.push(options === null || options === void 0 ? void 0 : options.panelClass);
        }
        const dialogRef = this.dialogCtr.open(this.confirmComponent, { data: { title, message, cancel: cancel, ok: ok, callback: options.callback }, panelClass: customModalClass });
        return dialogRef.afterClosed();
    }
    showConfirmRef(title, message, options = {}) {
        const cancel = options.cancelText || this.t.instant('buttons.cancel');
        const ok = options.okText || this.t.instant('buttons.ok');
        const customModalClass = ['confirm-dialog'];
        if (options === null || options === void 0 ? void 0 : options.panelClass) {
            customModalClass.push(options === null || options === void 0 ? void 0 : options.panelClass);
        }
        const dialogRef = this.dialogCtr.open(this.confirmComponent, { data: { title, message, cancel: cancel, ok: ok, callback: options.callback }, panelClass: customModalClass });
        return dialogRef;
    }
    showConfirmCancle(title, message, options = {}) {
        const cancel = options.cancelText || this.t.instant('buttons.cancel');
        const ok = options.okText || this.t.instant('buttons.ok');
        const customModalClass = ['confirm-dialog'];
        if (options === null || options === void 0 ? void 0 : options.panelClass) {
            customModalClass.push(options === null || options === void 0 ? void 0 : options.panelClass);
        }
        const dialogRef = this.dialogCtr.open(this.confirmCancelDialogComponent, { data: { title, message, cancel: cancel, ok: ok, callback: options.callback }, panelClass: customModalClass });
        return dialogRef.afterClosed();
    }
    showSnack(message, action, fn) {
        const bar = this.snackBar.open(message, action, {
            duration: 5000
        });
        bar.onAction().subscribe(fn);
    }
    loading(show, message = null) {
        //this.context.app.loading(show, message);
    }
    setBusy(busy) {
        this.busy = busy;
    }
    superloading(show) {
        if (show) {
            if (this.dialogCtr && this.superLoaderComponent) {
                if (this.superLoader) {
                    // has an exiting loading showing, dont create new;
                }
                else {
                    this.superLoader = this.dialogCtr.open(this.superLoaderComponent, { data: {}, disableClose: true });
                }
            }
        }
        else {
            if (this.superLoader) {
                this.superLoader.close();
                this.superLoader = null;
            }
        }
    }
    dismissPreLoader() {
        /*
        var w = window as any;

        if (w.dismissPreLoader) {
            w.dismissPreLoader();
        }
        */
        this.routingService.dismissPreLoader();
    }
    openDialog(component, data = {}, options = {}) {
        var input = { data: data };
        input = Object.assign(input, options);
        const dialogRef = this.dialogCtr.open(component, input);
        return dialogRef;
    }
    //IMPLEMENT ME
    openLazyDialog(componentName, data, options = {}) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_2__.__awaiter)(this, void 0, void 0, function* () {
            console.log("openLazyDialog not implemented");
            return null;
        });
    }
    openLazyFullDialog(componentName, data, options = {}) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_2__.__awaiter)(this, void 0, void 0, function* () {
            console.log("openLazyFullDialog not implemented");
            return null;
        });
    }
    openComponent(component, data = {}, options = {}, callback = null) {
        var input = { data: data };
        input = Object.assign(input, options);
        if (callback) {
            data.callback = callback;
        }
        console.log("open COmp check input: ", input, options);
        const dialogRef = this.dialogCtr.open(component, input);
        return dialogRef;
    }
    openAux(path, data = {}, options = {}, callback = null) {
        if (callback) {
            data.callback = callback;
        }
        this.routingService.navigateModal(path, data, options);
    }
    closeAll() {
        console.log("closing all", this.dialogCtr);
        this.dialogCtr.closeAll();
    }
    submitAuxDialog(result = {}, forceClose = false) {
        var profile = this.routingService.getAuxProfile();
        console.log('profile: ', profile);
        var input = profile.input;
        var extras = profile.extras;
        var autoClose = (extras === null || extras === void 0 ? void 0 : extras.autoClose) != false || forceClose;
        console.log("autoClose", autoClose);
        if (autoClose) {
            this.routingService.navigateCloseAllModal();
            if (input === null || input === void 0 ? void 0 : input.callback) {
                //IMPORTANT to not callback immediately, because dialog might not have closed and can cause issue if callback open another dialog
                setTimeout(() => {
                    input.callback(result);
                }, 20);
            }
        }
        else {
            if (input === null || input === void 0 ? void 0 : input.callback) {
                input.callback(result);
            }
        }
    }
}
DialogService.ɵfac = function DialogService_Factory(t) { return new (t || DialogService)(_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_3__.Injector)); };
DialogService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdefineInjectable"]({ token: DialogService, factory: DialogService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 19757:
/*!*******************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/directory-context.service.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DirectoryContext": () => (/* binding */ DirectoryContext)
/* harmony export */ });
/* harmony import */ var _aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/routing.service */ 28759);
/* harmony import */ var _aigens_core_src_app_data_data_directory_state_model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aigens/core/src/app/data/data/directory-state.model */ 22682);
/* harmony import */ var aigens_data__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aigens-data */ 51707);
/* harmony import */ var aigens_framework__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aigens-framework */ 44651);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! moment */ 84291);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! rxjs */ 76317);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _aigens_core_src_app_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aigens/core/src/app/pure/managers/setting-manager */ 74663);
/* harmony import */ var _core_src_app_pure_services_time_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./../../../../../core/src/app/pure/services/time.service */ 72570);










class DirectoryContext extends aigens_framework__WEBPACK_IMPORTED_MODULE_3__.BaseContext {
    constructor(injector, settingManager, timeService) {
        super(injector);
        this.settingManager = settingManager;
        this.timeService = timeService;
        this.DINE_IN = 'dinein';
        this.TAKEAWAY = 'takeaway';
        this.DELIVERY = 'delivery';
        this.CATERING = 'catering';
        this.WEB = 'web';
        this.PREORDER = 'preorder';
        this.VIEW_MODE_SELECT_DELIVERY_ADDRESS = 'selectDeliveryAddress';
        this.VIEW_MODE_SELECT_STORE = 'selectStore';
        this.TIME_FORMAT = 'DD MMM';
        this.position$ = new rxjs__WEBPACK_IMPORTED_MODULE_7__.BehaviorSubject(null);
        this.nav = [];
        this.changeLocationMode = false;
        this.autoSelectSingleStore = false;
        this.replaceUrlNavToOrderPage = null;
        this._isCatering = false;
        // @ts-ignore
        this.sharedData = {};
        /**
         * temporary state is a convenient share state during user interaction in the directory module
         * it is NOT safe to use by outer module
         */
        this.tempState = new _aigens_core_src_app_data_data_directory_state_model__WEBPACK_IMPORTED_MODULE_1__.DirectoryState();
        this.fromStoreHome = false;
        this.fromHomeType = '';
        /**
         * Use to maintain search state in directory
         */
        this.searchState = null;
        this.context = injector.get(aigens_framework__WEBPACK_IMPORTED_MODULE_3__.Context);
        console.log('constructing dir context, this should only happen once');
        this.routingService = injector.get(_aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__.RoutingService);
        this.configService = injector.get(aigens_framework__WEBPACK_IMPORTED_MODULE_3__.ConfigService);
        if (this.context.courtId) {
            this.contextId = `type=directory&groupId=${this.context.groupId}&courtId=${this.context.courtId}`;
        }
        else {
            this.contextId = `type=directory&groupId=${this.context.groupId}&brandId=${this.context.brandId}`;
        }
    }
    setPosition(pos) {
        if (!pos) {
            return;
        }
        if (this.position != null) {
            if (pos.longitude === this.position.longitude && pos.latitude === this.position.latitude) {
                return;
            }
        }
        this.position = pos;
        console.log('prov position: ', this.position);
        this.position$.next(pos);
    }
    // clear the context, likely due to logout or switching to different brand
    clear() {
        this.resetTempState();
        this.state = null;
        this.stores = [];
    }
    makeSaveData() {
        return this.state;
    }
    restoreSavedData(data) {
        this.state = data;
    }
    /**
     * Called when we need to fetch dir state from storage
     * Use case: user enter to order page directly, so dir state need to be fetch
     *
     */
    restoreFromStorage(orderMode, spot, storeId, brandId, callback) {
        // restore directory state context from storage
        this.restore(res => {
            // if no state on storage then create it and mark it as ASAP
            if (!this.state) {
                this.state = new _aigens_core_src_app_data_data_directory_state_model__WEBPACK_IMPORTED_MODULE_1__.DirectoryState();
                this.state.asap = true;
            }
            if (this.state.storeId != storeId) {
                if (orderMode == this.DELIVERY) {
                    this.state.deliveryAddress = null;
                }
            }
            this.state.mode = orderMode || this.state.mode;
            this.state.storeId = storeId || this.state.storeId;
            // force to ASAP if mode other than TA / Delivery / Dine in / time is outdate / dine in with spot
            if ((orderMode != this.TAKEAWAY && orderMode != this.DINE_IN && orderMode != this.DELIVERY) ||
                (orderMode == this.DINE_IN && spot) || this.isSelectedTimeOutdated()) {
                this.state.asap = true;
                this.state.scheduleDate = null;
                this.state.scheduleTime = null;
                this.state.humanScheduleTime = null;
            }
            // reset delivery related state for non delivery mode
            if (this.state.mode != this.DELIVERY) {
                this.state.deliveryAddress = null;
            }
            // if debug time is defined, then override the state
            if (this.debugTimestamp) {
                this.state.asap = false;
                this.state.scheduleDate = moment__WEBPACK_IMPORTED_MODULE_4__(this.debugTimestamp).format('YYYY-MM-DD');
                const sl = new aigens_data__WEBPACK_IMPORTED_MODULE_2__.Slot();
                sl.startTime = moment__WEBPACK_IMPORTED_MODULE_4__(this.debugTimestamp).format('HH:mm');
                this.state.scheduleTime = sl;
                this.state.humanScheduleTime = moment__WEBPACK_IMPORTED_MODULE_4__(this.debugTimestamp).format('DD MMM HH:mm');
            }
            if (callback) {
                callback();
            }
            this.save();
        });
    }
    resetTempState() {
        this.tempState = {
            mode: null,
            deliveryAddress: null,
            expectedDeliveryTime: null,
            storeId: null,
            scheduleDate: null,
            scheduleTime: null,
            asap: false,
            humanScheduleTime: null,
            store: null
        };
    }
    getUnixTime(varState = null) {
        // if param is not define, then fetch from final state by default
        // make a copy and convert to string for safe process
        // No need to create new objects , If the object is too large, it will get stuck in JSON.stringify
        // const dirState = (this.state || varState) ? JSON.parse(JSON.stringify(varState ? varState : this.state)) : null;
        const dirState = (this.state || varState) ? (varState ? varState : this.state) : null;
        if (dirState === null || dirState === void 0 ? void 0 : dirState.asap) {
            // TODO: replace the function completly
            return this.timeService.getTime();
        }
        else {
            try {
                const temp = moment__WEBPACK_IMPORTED_MODULE_4__(dirState.scheduleDate).format('DD MMM YYYY') + ' ' + dirState.scheduleTime.startTime;
                return moment__WEBPACK_IMPORTED_MODULE_4__(temp, 'DD MMM YYYY hh:mm').valueOf();
            }
            catch (_a) {
                return moment__WEBPACK_IMPORTED_MODULE_4__().valueOf();
            }
        }
    }
    getLastNav() {
        if (this.tempState.mode === this.DELIVERY) {
            if (this.nav.length > 0) {
                return this.nav[this.nav.length - 1];
            }
        }
        return '';
    }
    /**
     * Clone final state to temp state. To avoid misbehavior
     */
    cloneStateToTemp() {
        this.tempState = JSON.parse(JSON.stringify(this.state));
    }
    isSelectedTimeOutdated() {
        if (!this.state.asap) { // scheduled order
            // scheduled time selection is in past
            return this.getUnixTime(this.state) < moment__WEBPACK_IMPORTED_MODULE_4__().valueOf();
        }
        return false;
    }
    setNoServiceOk() {
        this.sharedData.noServiceCode = 'ok';
    }
    isHideTodayOrder() {
        return this.settingManager.get('hideTodayOrder', false);
    }
    setIsCatering(isCatering) {
        this._isCatering = isCatering;
    }
    isCatering() {
        return this._isCatering;
    }
    publishDefaultSharedData(store, mode, spot) {
        const { totalAdvOrderDays, canAdvanceOrder } = this.canAdvanceOrder(mode, spot);
        this.sharedData.canAdvanceOrder = canAdvanceOrder;
        this.sharedData.isStoreOpen = aigens_data__WEBPACK_IMPORTED_MODULE_2__.Store.isOpeningHours(store, this.getUnixTime());
        if (!this.sharedData.isStoreOpen) {
            this.sharedData.noServiceCode = 'openinghours';
        }
        this.publishSharedData();
    }
    publishSharedData() {
        this.next('sharedData', this.sharedData);
    }
    canAdvanceOrder(mode, spot) {
        const enableStoreLevelAdvanceOrder = this.settingManager.get('enableStoreLevelAdvanceOrder', false);
        if (this.fromStoreHome && !enableStoreLevelAdvanceOrder && !(mode == this.DINE_IN && spot)) {
            // If mode is catering, allow to change date and time
            if (mode === this.CATERING) {
                return { totalAdvOrderDays: 0, canAdvanceOrder: true };
            }
            return { totalAdvOrderDays: 0, canAdvanceOrder: false };
        }
        let canAdvanceOrder = true;
        // get advance order days from config
        let configAdvKeyV4;
        switch (mode) {
            case this.TAKEAWAY:
                configAdvKeyV4 = 'takeawaySamePeriodAdvanceOrder';
                break;
            case this.DELIVERY:
                configAdvKeyV4 = 'deliverySamePeriodAdvanceOrder';
                break;
            case this.DINE_IN:
                configAdvKeyV4 = spot ? 'dineinWithSpotSamePeriodAdvanceOrder' : 'dineinSamePeriodAdvanceOrder';
                break;
        }
        ;
        let configAdvKeyV3;
        switch (mode) {
            case this.TAKEAWAY:
                configAdvKeyV3 = 'advanceTakeawayDays';
                break;
            case this.DELIVERY:
                configAdvKeyV3 = 'advanceDeliveryDays';
                break;
            case this.DINE_IN:
                configAdvKeyV3 = spot ? 'advanceDineinWithSpotDays' : 'advanceDineinDays';
                break;
        }
        ;
        if (!(configAdvKeyV4 || configAdvKeyV3)) {
            return { totalAdvOrderDays: 0, canAdvanceOrder: false };
        }
        let totalAdvOrderDaysV3 = this.settingManager.get(configAdvKeyV3, null);
        let totalAdvOrderDays = this.settingManager.get(configAdvKeyV4, totalAdvOrderDaysV3);
        // if no config, then date can only be today and time can only be ASAP
        if (totalAdvOrderDays == null) {
            totalAdvOrderDays = 0;
            canAdvanceOrder = false;
        }
        return { totalAdvOrderDays, canAdvanceOrder };
    }
    isTimeStateChange(oldState) {
        if (this.state.asap != oldState.asap) {
            return true;
        }
        if (this.getUnixTime() != this.getUnixTime(oldState)) {
            return true;
        }
        return false;
    }
}
DirectoryContext.ɵfac = function DirectoryContext_Factory(t) { return new (t || DirectoryContext)(_angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_8__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵinject"](_aigens_core_src_app_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_5__.SettingManager), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵinject"](_core_src_app_pure_services_time_service__WEBPACK_IMPORTED_MODULE_6__.TimeService)); };
DirectoryContext.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdefineInjectable"]({ token: DirectoryContext, factory: DirectoryContext.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 57278:
/*!***************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/error-handler.service.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ErrorHandlerService": () => (/* binding */ ErrorHandlerService)
/* harmony export */ });
/* harmony import */ var _dialog_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dialog.service */ 69104);
/* harmony import */ var _pure_services_base_error_handler_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../pure/services/base-error-handler.service */ 67558);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ngx-translate/core */ 33935);





class ErrorHandlerService extends _pure_services_base_error_handler_service__WEBPACK_IMPORTED_MODULE_1__.BaseErrorHandlerService {
    constructor(injector, zone, t) {
        super(injector);
        this.injector = injector;
        this.zone = zone;
        this.t = t;
    }
    handleError(error) {
        super.handleError(error);
        this.customErrorHandler(error);
    }
    /**
     * Need to get DialogService from injector rather than constructor injection to avoid cyclic dependency error
     * @returns {}
     * ref: https://github.com/ngneat/hot-toast/issues/70
     */
    get dialogService() {
        return this.injector.get(_dialog_service__WEBPACK_IMPORTED_MODULE_0__.DialogService);
    }
    customErrorHandler(param) {
        const name = param === null || param === void 0 ? void 0 : param.name;
        const layout = param === null || param === void 0 ? void 0 : param.layout;
        const isDefaultLayout = layout === 'dialog';
        const error = new Error();
        error.message = this.t.instant(`error-codes.${name}.message`);
        error.name = this.t.instant(`error-codes.${name}.title`);
        if (!isDefaultLayout) {
            layout === 'toast' && this.errorToast(error.message, 1000, 'bottom');
            layout === 'page' && '';
            return;
        }
        this.errorDialog(error.name, error.message);
    }
    errorDialog(name, message) {
        this.zone.run(() => this.dialogService.showAlert(name, message));
    }
    errorToast(message, time, position) {
        this.zone.run(() => this.dialogService.showToast(message, time, position));
    }
}
ErrorHandlerService.ɵfac = function ErrorHandlerService_Factory(t) { return new (t || ErrorHandlerService)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_2__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_2__.NgZone), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__.TranslateService)); };
ErrorHandlerService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineInjectable"]({ token: ErrorHandlerService, factory: ErrorHandlerService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 67481:
/*!*********************************************************************!*\
  !*** ./projects/core/src/app/framework/services/ewallet.service.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EwalletService": () => (/* binding */ EwalletService)
/* harmony export */ });
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs */ 90833);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _data_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data.service */ 1024);
/* harmony import */ var _member_context_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./member-context.service */ 2831);
/* harmony import */ var _member_context_manager_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./member-context-manager.service */ 67167);
/* harmony import */ var _config_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./config.service */ 2171);






class EwalletService {
    constructor(dataService, context, memberContextManager, config) {
        this.dataService = dataService;
        this.context = context;
        this.memberContextManager = memberContextManager;
        this.config = config;
        this.ewalletMode = 'takeaway';
    }
    setVirtualStoreId(storeId) {
        this.virtualStoreId = storeId;
    }
    setEwalletGroupId(groupId = '500-IGecredit') {
        this.ewalletGroupId = groupId;
    }
    getFreeInputMax() {
        var _a, _b, _c;
        return (_c = (_b = (_a = this.virtualStore) === null || _a === void 0 ? void 0 : _a.crm) === null || _b === void 0 ? void 0 : _b['ecreditPolicy']) === null || _c === void 0 ? void 0 : _c.freeInputMax;
    }
    setEwalletMode(mode) {
        this.ewalletMode = mode;
    }
    setVirtualStore(store) {
        this.virtualStore = store;
    }
    setEwalletTopUpItem(item) {
        this.ewalletTopUpItem = item;
    }
    setEcreditPolicy(ecreditPolicy) {
        this.ecreditPolicy = ecreditPolicy;
    }
    getEcreditRatio(isUseContextStoreCurrencyUnit = false) {
        var _a, _b, _c, _d;
        let unit = ((_a = this.ecredit) === null || _a === void 0 ? void 0 : _a.smallestCurrencyUnit) || ((_b = this.virtualStore) === null || _b === void 0 ? void 0 : _b['smallestCurrencyUnit']);
        if (isUseContextStoreCurrencyUnit && !unit && unit !== 0) {
            unit = (_d = (_c = this.context) === null || _c === void 0 ? void 0 : _c.store) === null || _d === void 0 ? void 0 : _d['smallestCurrencyUnit']; // fallback context store smallestCurrencyUnit
        }
        return (unit || unit === 0) ? Math.pow(10, -unit) : 1;
    }
    getTopUpPoints() {
        var _a;
        // return this.ewalletTopUpItem?.points || 0;
        return ((_a = this.ewalletTopUpItem) === null || _a === void 0 ? void 0 : _a.price) / this.getEcreditRatio();
    }
    getVirtualStoreId() {
        return this.virtualStoreId;
    }
    getVirtualStore() {
        if (!this.virtualStoreId) {
            return new rxjs__WEBPACK_IMPORTED_MODULE_4__.Observable(null);
        }
        const url = '/api/v1/menu/store/' + this.virtualStoreId + '.json';
        const params = {
            menu: this.ewalletMode || 'takeaway',
            locale: 'multi',
            // nocache: true
        };
        return this.dataService.getRaw(url, params);
    }
    getEwalletItems() {
        return this.ewalletItems || [];
    }
    updateMember(complete = () => { }, error = () => { }) {
        if (!this.context.member) {
            error();
            return;
        }
        const url = '/api/v1/crm/member.json';
        const params = {
            brandId: this.context.brand.id,
            fetchAllSc: this.crmHasFeature('stampcard'),
        };
        this.dataService.get(url, params).subscribe((data) => {
            console.log(data);
            // this.context.setMember(data);
            this.memberContextManager.updateMemberData(data);
            complete();
        }, (err) => {
            var _a;
            console.log(err);
            if (err.status === 401) {
                (_a = this.context) === null || _a === void 0 ? void 0 : _a.logout();
            }
            error();
        });
    }
    crmHasFeature(feature) {
        return (this.context.crm &&
            this.context.crm.features &&
            this.context.crm.features.indexOf(feature) >= 0);
    }
    // update the ecredit balance
    handleEwallet(order) {
        var _a, _b, _c;
        // may be call member.json to update the member
        this.context.member.ecredit.balance = order === null || order === void 0 ? void 0 : order['afterEcredit'];
        if ((_a = this.context) === null || _a === void 0 ? void 0 : _a.member) {
            const sid = this.config.getSessionId();
            // this.memberContextManager?.setMemberData( sid ? {...this.context?.member, sessionId: sid } : this.context?.member);
            this.memberContextManager.updateMemberData(sid ? Object.assign(Object.assign({}, (_b = this.context) === null || _b === void 0 ? void 0 : _b.member), { sessionId: sid }) : (_c = this.context) === null || _c === void 0 ? void 0 : _c.member);
        }
    }
    get ecredit() {
        var _a, _b, _c, _d, _e;
        return ((_b = (_a = this.context) === null || _a === void 0 ? void 0 : _a.member) === null || _b === void 0 ? void 0 : _b.ecredit) || ((_e = (_d = (_c = this.context) === null || _c === void 0 ? void 0 : _c.membership) === null || _d === void 0 ? void 0 : _d.member) === null || _e === void 0 ? void 0 : _e.ecredit);
    }
    getMemberEwallectTotal() {
        var _a;
        return ((_a = this.ecredit) === null || _a === void 0 ? void 0 : _a.balance) || 0;
    }
    // display ewallet total
    getDisplayEwalletNumber() {
        return this.transformEwalletBalanceToPrice(this.getMemberEwallectTotal());
    }
    // display ewallet currency(HKD)
    getMemberEwallectCurrency() {
        var _a, _b;
        return ((_a = this.ecredit) === null || _a === void 0 ? void 0 : _a.currency) || ((_b = this.context) === null || _b === void 0 ? void 0 : _b.currency);
    }
    // display ewallet currencySign($)
    getMemberEwallectCurrencySign() {
        var _a, _b;
        return ((_a = this.ecredit) === null || _a === void 0 ? void 0 : _a.currencySign) || ((_b = this.context) === null || _b === void 0 ? void 0 : _b.currencySign);
    }
    // display ewallet top up item price
    getTopUpItemPriceByPoints(points) {
        return this.transformEwalletBalanceToPrice(points);
    }
    transformEwalletBalanceToPrice(val) {
        const res = val * this.getEcreditRatio();
        const result = (res === null || res === void 0 ? void 0 : res.toString().indexOf('.')) ? parseFloat(res === null || res === void 0 ? void 0 : res.toFixed(2)) : res;
        return result;
    }
}
EwalletService.ɵfac = function EwalletService_Factory(t) { return new (t || EwalletService)(_angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_data_service__WEBPACK_IMPORTED_MODULE_0__.DataService), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_member_context_service__WEBPACK_IMPORTED_MODULE_1__.MemberContext), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_member_context_manager_service__WEBPACK_IMPORTED_MODULE_2__.MemberContextManager), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_config_service__WEBPACK_IMPORTED_MODULE_3__.ConfigService)); };
EwalletService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵdefineInjectable"]({ token: EwalletService, factory: EwalletService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 11758:
/*!**********************************************************************!*\
  !*** ./projects/core/src/app/framework/services/location.service.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LocationService": () => (/* binding */ LocationService)
/* harmony export */ });
/* harmony import */ var _pure_services_common_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../pure/services/common.service */ 43872);
/* harmony import */ var _capacitor_geolocation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @capacitor/geolocation */ 7621);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);



class LocationService {
    constructor() {
        this.DEBUG_GPS = {
            latitude: 22.3193,
            longitude: 114.1694
        };
    }
    round(num, decimals) {
        var x = Math.pow(10, decimals);
        return Math.round(num * x) / x;
    }
    getLast() {
        return _pure_services_common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.getLocal("lastGps");
    }
    getGps(callback) {
        if (!(navigator === null || navigator === void 0 ? void 0 : navigator.geolocation)) {
            callback(null);
            return;
        }
        // Please use Geolocation plugin, If on Web it will use : navigator.geolocation.getCurrentPosition as well , but on native , it will use native code.
        _capacitor_geolocation__WEBPACK_IMPORTED_MODULE_1__.Geolocation.getCurrentPosition({
            enableHighAccuracy: false,
            timeout: 10000,
            maximumAge: Infinity
        }).then(pos => {
            const result = {
                latitude: this.round(pos.coords.latitude, 4),
                longitude: this.round(pos.coords.longitude, 4)
            };
            if (result.latitude) {
                _pure_services_common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.setLocal("lastGps", result);
                callback(result);
            }
            else {
                callback(null);
            }
        }).catch(err => {
            console.error(err);
            callback(null);
        });
        // navigator.geolocation.getCurrentPosition(
        //     (pos) => {
        //         const result = {
        //             latitude: this.round(pos.coords.latitude, 4),
        //             longitude: this.round(pos.coords.longitude, 4)
        //         }
        //         if(result.latitude){
        //             CommonService.setLocal("lastGps", result);
        //             callback(result);
        //         }else{
        //             callback(null);
        //         }
        //     }, (err) => {
        //         console.error(err);
        //         callback(null);
        //     },
        //     {
        //         enableHighAccuracy: false,
        //         timeout: 10000,
        //         maximumAge: Infinity
        //     }
        // );
    }
    requestPermissions() {
        console.warn("web does not have this method");
    }
}
LocationService.ɵfac = function LocationService_Factory(t) { return new (t || LocationService)(); };
LocationService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineInjectable"]({ token: LocationService, factory: LocationService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 67167:
/*!************************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/member-context-manager.service.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MemberContextManager": () => (/* binding */ MemberContextManager)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _context_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./context.service */ 73769);
/* harmony import */ var _member_context_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./member-context.service */ 2831);
/* harmony import */ var _config_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config.service */ 2171);
/* harmony import */ var _data_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./data.service */ 1024);
/* harmony import */ var _pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../pure/services/subscribe.service */ 47074);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ngx-translate/core */ 33935);







class MemberContextManager {
    constructor(context, memberContext, configService, dataService, subscribe, t
    /* private platformService: PlatformService, private miniService: MiniAppService, */ ) {
        this.context = context;
        this.memberContext = memberContext;
        this.configService = configService;
        this.dataService = dataService;
        this.subscribe = subscribe;
        this.t = t;
        this.handleObservable();
    }
    handleObservable() {
        this.subscribe.getObservable(this.subscribe.SDK_MEMBER_CONTEXT).subscribe({
            next: (member) => {
                if (!member)
                    return;
                this.configService.clearAll();
                // console.log("SDK_MEMBER_CONTEXT member2", member);
                if (member === null || member === void 0 ? void 0 : member.sessionId) {
                    this.setMemberData(member);
                }
                const deviceId = member === null || member === void 0 ? void 0 : member.deviceId;
                if (deviceId) {
                    this.configService.setDeviceId(deviceId);
                }
                const name = member === null || member === void 0 ? void 0 : member.name;
                if (name) {
                    this.configService.setLocal('aigens-guest-name', name);
                }
                const email = member === null || member === void 0 ? void 0 : member.email;
                if (email) {
                    this.configService.setLocal('aigens-guest-email', email);
                }
                const phone = member === null || member === void 0 ? void 0 : member.phone;
                if (phone) {
                    this.configService.setLocal('aigens-guest-phone', phone);
                }
                const lang = member === null || member === void 0 ? void 0 : member.language;
                if (lang) {
                    this.t.use(lang);
                    this.configService.setLocale(lang);
                    this.t.setDefaultLang(lang);
                    this.t.currentLang = lang;
                }
            },
            error: (error) => {
                console.log("error:", error);
            }
        });
    }
    checkDeviceLogin() {
        console.log("checking member", this.memberContext.member);
        if (!this.memberContext.isSignedIn()) {
            if (!this.isAliApp()) {
                console.log("logging in as device guest");
                this.deviceLogin();
            }
            else {
                // inside miniapp, dont do deviceLogin for now, chope/alipaycn, to use the container member
                console.log("under miniapp, use container member later");
            }
        }
        else {
            if (this.memberContext.isGuest()) {
                console.log("already signed in as guest");
            }
            else {
                console.log("already signed in as user");
            }
        }
    }
    deviceLogin(callback) {
        console.log("device login!");
        const url = '/api/v1/store/devicelogin.json';
        var deviceId = this.configService.getDeviceId();
        var params = {
            deviceId: deviceId
        };
        this.dataService.postWithParams(url, params).subscribe(data => {
            console.log("login data", data);
            if (data) {
                this.setMemberData(data);
                callback && callback(this.memberContext.member);
            }
        }, err => {
            console.log(err);
            callback && callback(null);
        });
    }
    setMemberData(data) {
        this.memberContext.clearMember();
        this.memberContext.member = data;
        if (data === null || data === void 0 ? void 0 : data.membership) {
            this.memberContext.membership = data.membership;
        }
        this.configService.setSessionId(data.sessionId);
        this.context.setMember(data);
        this.memberContext.save();
        // if (this.platformService.isAliApp() && data?.source == 'aliplus') {
        //     this.miniService.saveMemberToMiniapp(data, () => {
        //         console.log("saveMemberToMiniapp done");
        //     });
        // }
    }
    updateMemberData(data) {
        this.memberContext.member = data;
        if (data === null || data === void 0 ? void 0 : data.membership) {
            this.memberContext.membership = data.membership;
        }
        this.context.setMember(data);
        this.memberContext.save();
    }
    // replace this.platformService.isAliApp()
    isAliApp() {
        var ua = navigator.userAgent.toLowerCase();
        var terms = ["miniprogram", "alipayide"];
        for (let t of terms) {
            if (ua.indexOf(t) >= 0) {
                return true;
            }
        }
        return false;
    }
}
MemberContextManager.ɵfac = function MemberContextManager_Factory(t) { return new (t || MemberContextManager)(_angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_context_service__WEBPACK_IMPORTED_MODULE_0__.Context), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_member_context_service__WEBPACK_IMPORTED_MODULE_1__.MemberContext), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_config_service__WEBPACK_IMPORTED_MODULE_2__.ConfigService), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_data_service__WEBPACK_IMPORTED_MODULE_3__.DataService), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_4__.SubscribeService), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_ngx_translate_core__WEBPACK_IMPORTED_MODULE_6__.TranslateService)); };
MemberContextManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵdefineInjectable"]({ token: MemberContextManager, factory: MemberContextManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 2831:
/*!****************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/member-context.service.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MemberContext": () => (/* binding */ MemberContext)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var aigens_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-data */ 51707);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ 84291);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../pure/managers/setting-manager */ 74663);
/* harmony import */ var _base_base_context__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/base-context */ 76309);
/* harmony import */ var _config_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./config.service */ 2171);
/* harmony import */ var _context_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./context.service */ 73769);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/core */ 3184);

// import { MiniAppService } from '@aigens/miniapp/src/app/miniapp/standard/services/mini-app.service';





// import { PlatformService } from '../../pure/services/platform.service';




class MemberContext extends _base_base_context__WEBPACK_IMPORTED_MODULE_3__.BaseContext {
    // private platformService: PlatformService;
    // private miniService: MiniAppService;
    constructor(injector) {
        super(injector);
        this.availableRewards = [];
        this.currencySign = '$';
        this.refresh = false;
        this.admin = false;
        this.inboxMessage = [];
        this.rewards = [];
        this.payments = [];
        this.privateMessages = [];
        this.publicNotices = [];
        this.deferredPrompt = null;
        // For payment scheme , If you use payment at app (not includes byod), please set. iOS & android need add scheme also.
        this.appName = '';
        this.loginFlow = [];
        this.memberListeners = [];
        this.listenerIds = [];
        console.log('constructing member context, this should only happen once');
        // this.contextSubscribe = new Subject();
        this.configService = injector.get(_config_service__WEBPACK_IMPORTED_MODULE_4__.ConfigService);
        this.context = injector.get(_context_service__WEBPACK_IMPORTED_MODULE_5__.Context);
        this.settingManager = injector.get(_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_2__.SettingManager);
        this.t = injector.get(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_6__.TranslateService);
        // this.platformService = injector.get(PlatformService);
        // this.miniService = injector.get(MiniAppService);
        this.initFromContext();
        this.bind(['member', 'membership']);
        this.restore();
        this.subscribeEvent();
    }
    copyFromContext(context) {
        this.form = context.form;
        this.brand = context.brand;
        this.group = context.group;
        this.court = context.court;
        this.store = context.store;
        this.location = context.location;
        this.crm = context.crm;
        this.brandId = context.brandId;
        this.groupId = context.groupId;
        this.storeId = context.storeId;
        this.courtId = context.courtId;
        this.currency = context.currency;
        this.currencySign = context.currencySign;
        this.userLang = context.userLang;
    }
    initFromContext() {
        const aigens = window['aigens'];
        if (aigens && aigens.context) {
            const context = aigens.context;
            this.copyFromContext(context);
            let contextId = 'type=member';
            const crm = context.crm;
            if (crm) {
                contextId += '&crm=' + crm.type;
                if (crm.source) {
                    contextId += '&source=' + crm.source;
                }
            }
            this.contextId = contextId;
            // this.contextSubscribe.next();
        }
    }
    setMember(member) {
        var _a;
        this.member = member;
        if (member && member.membership) {
            this.membership = member.membership;
        }
        // save member obj data to local storage
        this.setLocal('member', this.member);
        if (this.member.sessionId) {
            this.configService.setSessionId(this.member.sessionId);
        }
        const memberFlow = (this.isMember() && ((_a = this.member) === null || _a === void 0 ? void 0 : _a["flow"])) || null;
        this.loginFlow = !!memberFlow ? memberFlow.split(',') : this.loginFlow;
        this.next('member', member);
    }
    getMember() {
        return this.member;
    }
    isGuest() {
        const member = this.member;
        return !member || !!(member && member.guest);
    }
    isMember() {
        const member = this.member;
        return !!(member && !member.guest);
    }
    setAvailableRewards(rewards) {
        this.availableRewards = rewards;
        this.save();
    }
    getAvailableRewards() {
        return this.availableRewards || [];
    }
    // clear the context, likely due to logout or switching to different brand
    clear() {
        console.log('clear member context');
        this.membership = null;
        this.group = null;
        this.brandId = null;
        this.brand = null;
        this.store = null;
        this.storeId = null;
        this.court = null;
        this.currencySign = null;
        this.currency = null;
        this.crm = null;
        this.form = null;
        this.payments = null;
        this.directoryData = null;
        this.availableRewards = [];
        this.loginFlow = [];
        this.userLang = null;
    }
    clearMember() {
        this.member = null;
        this.membership = null;
        this.configService.clearSessionId();
    }
    logout() {
        console.log('logout');
        this.member = null;
        this.membership = null;
        this.context.logout();
        this.privateMessages = [];
        this.publicNotices = [];
        this.availableRewards = [];
        this.loginFlow = [];
        // this.contextSubscribe.next();
        this.save();
    }
    makeSaveData() {
        var _a;
        if (this.isGuest()) {
            this.loginFlow = [];
        }
        const memberFlow = (this.isMember() && ((_a = this.member) === null || _a === void 0 ? void 0 : _a["flow"])) || null;
        this.loginFlow = !!memberFlow ? memberFlow.split(',') : this.loginFlow;
        const data = {
            member: this.member,
            membership: this.membership,
            userLang: this.userLang,
            contentLang: this.contentLang,
            availableRewards: this.availableRewards || [],
            loginFlow: this.loginFlow || [],
            session: this.configService.sessionId
        };
        console.log('saving member data', data);
        return data;
    }
    // in order to test (login repeatedly)
    getLocalContext() {
        const localContext = JSON.parse(localStorage.getItem('context'));
        if (localContext) {
            this.setLocalContext(localContext);
        }
    }
    setLocalContext(localContext) {
        console.log('setLocalContext');
        if (!localContext || !localContext.membership || !localContext.member) {
            return;
        }
        for (const key in localContext) {
            localContext && localContext[key] && (this[key] = localContext[key]);
        }
    }
    // async getMiniMember() {
    //     return new Promise<any>((resolve, reject) => {
    //         this.miniService.getContainerMember((member) => {
    //             console.log("restore with container member", member);
    //             if (member) {
    //                 resolve(member)
    //             }
    //             reject();
    //         });
    //     });
    // }
    restoreSavedData(data) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this, void 0, void 0, function* () {
            // if (data?.member?.source == "aliplus" && this.platformService.isAliApp()) {
            //     try {
            //         let miniMember = await this.getMiniMember();
            //         if (miniMember) {
            //             data['member'] = miniMember;
            //             this.setMember(miniMember)
            //         }
            //     } catch (error) {
            //         console.log("restoreSavedData mini member err", error)
            //     }
            // }
            console.log('RESTORE MEMBER CONTEXT', data);
            Object.assign(this, data);
            // let urlLocale = this.getQuery("locale");
            // if ((data?.userLang && window['aigens']?.context?.languages?.includes(data?.userLang))
            //     || (urlLocale && window['aigens']?.context?.languages?.includes(urlLocale))) {
            //     this.setLang(urlLocale || data.userLang)
            // }
            // else {
            //     this.setLang("en")
            // }
        });
    }
    getQuery(name) {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        return urlParams.get(name);
    }
    subscribeEvent() {
        this.subscribeService.getObservable('language').subscribe((lang) => {
            this.setLang(lang);
        });
        this.subscribeService.getObservable('member').subscribe((member) => {
            var _a;
            console.log("member change:", member);
            const memberFlow = (this.isMember() && ((_a = this.member) === null || _a === void 0 ? void 0 : _a["flow"])) || null;
            this.loginFlow = !!memberFlow ? memberFlow.split(',') : this.loginFlow;
        });
    }
    setLang(storeLang) {
        this.t.use(storeLang);
        this.configService.setLocale(storeLang);
        this.userLang = storeLang;
        this.language = storeLang;
        this.contentLang = storeLang;
        window['aigens'].context.userLang = storeLang;
        window['aigens'].context.language = window['aigens'].context.userLang;
        window['aigens'].context.contentLang = window['aigens'].context.userLang;
        // Object.assign(this, this.makeSaveData());
        // this.save();
    }
    save() {
        super.save();
    }
    isSignedIn() {
        // return !!(this.member /* && this.membership */ && this.member?.method !== 'device');
        if (this.configService.getSessionId()) {
            return true;
        }
        return false;
    }
    canRegister() {
        const crm = this.crm;
        if (!crm) {
            return false;
        }
        if (!crm.recruitable) {
            return false;
        }
        if (!crm.recruitStart || !crm.recruitEnd) {
            return true;
        }
        return moment__WEBPACK_IMPORTED_MODULE_1__().isBetween(crm.recruitStart, crm.recruitEnd, 'day');
    }
    canLogin(mode = null) {
        if (this.settingManager.get('hideLoginBtn', false)) {
            return false;
        }
        return this.crmAvailable(mode);
    }
    crmAvailable(mode = null) {
        const crm = this.crm;
        if (!crm) {
            return false;
        }
        if (this.brand && !aigens_data__WEBPACK_IMPORTED_MODULE_0__.Brand.hasFeature(this.brand, 'login')) {
            return false;
        }
        if (this.court && !aigens_data__WEBPACK_IMPORTED_MODULE_0__.Court.hasFeature(this.court, 'login')) {
            return false;
        }
        if (crm['disabled']) {
            return false;
        }
        if (crm.modes == null || crm.modes.length === 0) {
            return true;
        }
        if (!mode) {
            return true;
        }
        return crm.modes.indexOf(mode) >= 0;
    }
    getDeviceId() {
        return this.configService.getDeviceId();
    }
    isLimitedMember() {
        var _a, _b;
        return this.isMember() && (((_a = this.loginFlow) === null || _a === void 0 ? void 0 : _a.indexOf('verify')) >= 0 || ((_b = this === null || this === void 0 ? void 0 : this.loginFlow) === null || _b === void 0 ? void 0 : _b.indexOf('fillprofile')) >= 0);
    }
    setMemberListener(listener) {
        const listenerId_ = this.genListenerId();
        listener.listenerId = listenerId_;
        this.memberListeners.push(listener);
        return listenerId_;
    }
    fireMemberChange(member) {
        if (this.memberListeners && this.memberListeners.length) {
            this.memberListeners.forEach(listener => {
                listener.onMemberChange(member);
            });
        }
    }
    unsubscribeMemberListener(listenerId) {
        if (!listenerId) {
            return;
        }
        if (this.listenerIds.indexOf(listenerId) < 0) {
            console.warn('not include listenerId');
            return;
        }
        const i = this.listenerIds.indexOf(listenerId);
        this.listenerIds.splice(i, 1);
        this.freedListener(this.memberListeners, listenerId);
    }
    genListenerId() {
        let id = 100;
        if (this.listenerIds.length > 0) {
            id = this.listenerIds[this.listenerIds.length - 1] + 1;
        }
        this.listenerIds.push(id);
        return id;
    }
    freedListener(listeners, listenerID) {
        listeners.find((listener, index) => {
            if (listener.listenerId === listenerID) {
                listeners.splice(index, 1);
                return true;
            }
            return false;
        });
    }
}
MemberContext.ɵfac = function MemberContext_Factory(t) { return new (t || MemberContext)(_angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_8__.Injector)); };
MemberContext.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdefineInjectable"]({ token: MemberContext, factory: MemberContext.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 79771:
/*!***************************************************************!*\
  !*** ./projects/core/src/app/framework/services/menu.util.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MenuUtil": () => (/* binding */ MenuUtil)
/* harmony export */ });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ 84291);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);

class MenuUtil {
    static getRelatedMenuPeriod(timestamp, store) {
        const useTime = new Date(timestamp || new Date());
        const processPeriods = MenuUtil.getValidPeriod(timestamp, store);
        return processPeriods.filter(f => useTime >= (f === null || f === void 0 ? void 0 : f.startNum) && useTime <= (f === null || f === void 0 ? void 0 : f.endNum));
    }
    static getValidPeriod(timestamp, store) {
        var _a;
        const useTime = new Date(timestamp || new Date()); // 当chooseOtp 为null 时，用当前时间
        // filter 原始数据中set startTime === endTime 的period (有些时段特殊不set start or end 但可用) (特别处理:filter start=0 end= 0 的情况)
        let periods = store && store.menu && store.menu.periods &&
            store.menu.periods.filter(period => period && (!period.start && period.start !== 0) || (!period.end && period.end !== 0) || (period.start && period.end && period.start !== period.end));
        if (periods && periods.length > 0) {
            periods = JSON.parse(JSON.stringify(periods));
        }
        const processPeriods = (_a = periods === null || periods === void 0 ? void 0 : periods.map(period => MenuUtil.syncPeriodWithOpeningStore(period, useTime, store))) === null || _a === void 0 ? void 0 : _a.filter(f => f != null);
        if (processPeriods) {
            // get cross day periods
            const cdp = processPeriods === null || processPeriods === void 0 ? void 0 : processPeriods.filter(f => (f === null || f === void 0 ? void 0 : f.start) > (f === null || f === void 0 ? void 0 : f.end));
            const x = processPeriods[0];
            // add cross day period into beginning of periods
            cdp.reverse().forEach(o => {
                const temp = JSON.parse(JSON.stringify(o));
                temp.startTime = '23:59';
                temp.endTime = temp.originalEndTime;
                temp.cloneFromId = o.id;
                o.prestop = 0;
                temp.endNum = this.toTime(temp.endTime, useTime.getTime()) + (60 * 60 * 24 * 1000);
                temp.startNum = this.toTime(temp.startTime, useTime.getTime());
                processPeriods.unshift(temp);
            });
        }
        return processPeriods || [];
    }
    static isModeAvailableWithinMenuPeriod(timestamp, store, mode) {
        var _a;
        const x = this.getRelatedMenuPeriod(timestamp, store);
        return !((x === null || x === void 0 ? void 0 : x.length) > 0 && x[0].modes && !((_a = x[0].modes) === null || _a === void 0 ? void 0 : _a.includes(mode)));
    }
    static syncPeriodWithOpeningStore(period, useTime, store) {
        var _a;
        const useTime_weekDay = useTime.getDay(); // 当前选的day 是星期（0：星期天
        // console.log('period  ' + period.code + ':' + period.startTime + '--' + period.endTime);
        // 先check period.openings 然后赋值 period.startTime and period.endTime
        period = this.coverPeriod(period, useTime_weekDay);
        // console.log('用period进阶数据openings覆盖   ' + period.code + ":" + period.startTime + "--" + period.endTime);
        // 在check period.startTime and period.endTime
        if (!period.startTime || !period.endTime) {
            return;
        }
        let periodStartNum = this.toTime(period.startTime, useTime.getTime());
        let periodEndNum = this.toTime(period.endTime, useTime.getTime());
        // cross day
        if (periodStartNum > periodEndNum) {
            periodEndNum = moment__WEBPACK_IMPORTED_MODULE_0__(periodEndNum).add(1, 'days').valueOf();
        }
        // period.startNum = periodStart_num;
        // period.endNum = periodEnd_num;
        // 阶段的时间与 店铺营业时间做比较，重新赋值end_num
        let storeOpening_start, storeOpening_end;
        let proceed = false;
        if ((_a = store === null || store === void 0 ? void 0 : store.openings) === null || _a === void 0 ? void 0 : _a.always) { // 24 hours
            // console.log('always open');
            storeOpening_start = '00:00';
            storeOpening_end = '23:59';
            proceed = true;
        }
        else {
            const storeOpening = this.getStoreOpeningsByDay(store, useTime_weekDay);
            // console.log('storeOpening ', storeOpening, useTime_weekDay, storeOpening.type);
            storeOpening_start = storeOpening && storeOpening.startTime; // 店铺开店时间 如:'8:00'
            storeOpening_end = storeOpening && storeOpening.endTime; // 店铺结束时间 如:'22:00'
            if (storeOpening.type === 'close') {
                return;
            }
            proceed = storeOpening && storeOpening.type && storeOpening.type === 'open' && storeOpening_start && storeOpening_end;
        }
        // console.log('店铺营业时间段:' + storeOpening_start + '--' + storeOpening_end);
        // this.openings = storeOpening_start + '--' + storeOpening_end;
        if (proceed) {
            let storeOpeningStartNum = this.toTime(storeOpening_start, useTime.getTime());
            let storeOpeningEndNum = this.toTime(storeOpening_end, useTime.getTime());
            // cross day
            if (storeOpeningStartNum > storeOpeningEndNum) {
                storeOpeningEndNum = moment__WEBPACK_IMPORTED_MODULE_0__(storeOpeningEndNum).add(1, 'days').valueOf();
            }
            if (storeOpeningStartNum > periodStartNum) {
                // console.log('storeOpeningStartNum > periodStartNum ', storeOpeningStartNum, periodStartNum);
                periodStartNum = storeOpeningStartNum;
            }
            if (periodEndNum > storeOpeningEndNum) {
                // console.log('periodEndNum > storeOpeningEndNum ', storeOpeningEndNum, periodEndNum);
                periodEndNum = storeOpeningEndNum;
            }
        }
        if (periodEndNum <= periodStartNum) {
            return; // filter 原始数据中set period.startTime 在营业结束时间之后的 period
        }
        // 'HH:mm'
        period.originalEndTime = period.endTime;
        period.startTime = moment__WEBPACK_IMPORTED_MODULE_0__(periodStartNum).format('HH:mm');
        period.endTime = moment__WEBPACK_IMPORTED_MODULE_0__(periodEndNum).format('HH:mm');
        period.startNum = periodStartNum;
        period.endNum = periodEndNum;
        // console.log('period ' + period.code + ':' + period.startTime + '--' + period.endTime);
        return period;
    }
    static toTime(timeString, day) {
        const temp = moment__WEBPACK_IMPORTED_MODULE_0__(timeString, 'HH:mm');
        const now = moment__WEBPACK_IMPORTED_MODULE_0__(day);
        temp.year(now.year());
        temp.month(now.month());
        temp.dayOfYear(now.dayOfYear());
        // console.log('temp', temp);
        return +temp;
    }
    static getStoreOpeningsByDay(store, useTime_weekDay) {
        if (store && store.openings && store.openings.weekdays) {
            return store.openings.weekdays[useTime_weekDay];
        }
        return [];
    }
    static coverPeriod(period, useTime_weekDay) {
        const weekdays = period && period.openings && period.openings.weekdays;
        if (!weekdays || !weekdays[useTime_weekDay]) {
            return period;
        }
        // mark if period is closed
        if (weekdays[useTime_weekDay].type !== 'open') {
            period.startTime = null;
            period.endTime = null;
            return period;
        }
        weekdays[useTime_weekDay].startTime && (period.startTime = weekdays[useTime_weekDay].startTime);
        weekdays[useTime_weekDay].endTime && (period.endTime = weekdays[useTime_weekDay].endTime);
        return period;
    }
}


/***/ }),

/***/ 63058:
/*!***************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/order-context.service.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OrderContext": () => (/* binding */ OrderContext)
/* harmony export */ });
/* harmony import */ var aigens_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-data */ 51707);
/* harmony import */ var _base_base_context__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/base-context */ 76309);
/* harmony import */ var _managers_menu_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../managers/menu-manager */ 4451);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var aigens_framework__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aigens-framework */ 44651);
/* harmony import */ var _pure_services_deep_link_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../pure/services/deep-link.service */ 13661);
/* harmony import */ var _aigens_core_src_app_framework_services_pre_order_context_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aigens/core/src/app/framework/services/pre-order-context.service */ 63406);
/* harmony import */ var _ewallet_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ewallet.service */ 67481);









class OrderContext extends _base_base_context__WEBPACK_IMPORTED_MODULE_1__.BaseContext {
    constructor(injector, orderManager, deeplinkService, preOrderContext, ewalletService) {
        super(injector);
        this.injector = injector;
        this.orderManager = orderManager;
        this.deeplinkService = deeplinkService;
        this.preOrderContext = preOrderContext;
        this.ewalletService = ewalletService;
        this.currenCatGroup = null;
        this.cgroups = [];
        this.payments = [];
        this.personalMenu = false;
        this.submitingRedirectForm = false; // save the result about whether sumbit redirect form to prevent the double order
        this.fixedStoreId = false;
        this.confirmedStore = false;
        this.confirmedMode = false;
        this.viewMode = false;
        this.lastStoreId = null;
        this.threeSecureVerifyBody = null; // for SecureVerifyPageComponent to use iframe
        this.verified = [];
        this.cacheCourtStoreMap = {};
        console.log('constructing order context, this should only happen once');
        this.initFromContext();
    }
    initFromContext() {
        var _a;
        var aigens = window['aigens'];
        if (aigens && aigens.context) {
            var context = aigens.context;
            if (context.store) {
                this.store = context.store;
                this.storeId = this.store.id;
            }
            this.contextId = this.makeGenericKey(context, 'order', context.locale);
        }
        this.restore();
        // for calling ewallet virtual storeId.json
        if (this.mode) {
            console.log('setEwalletMode for virtual storeId.json');
            (_a = this.ewalletService) === null || _a === void 0 ? void 0 : _a.setEwalletMode(this.mode);
        }
    }
    clearPreviousOrder() {
        this.previousOrder = null;
    }
    checkRestoreOrder() {
        var _a;
        var existingOrder = this.previousOrder;
        if (this.mode == 'byod' && !existingOrder && this.preOrderContext.order && this.preOrderContext.storeId == this.storeId) {
            existingOrder = this.preOrderContext.order;
        }
        console.log('checkRestoreOrder', existingOrder, this.mode);
        if (existingOrder) {
            if (existingOrder.type == this.mode) {
                if (existingOrder.storeId && existingOrder.storeId == this.store.id) {
                    this.orderManager.reconstructOrder(existingOrder);
                    console.log('reconsructred store order', this.orderManager.order);
                }
                else if (existingOrder.courtId && existingOrder.courtId == ((_a = this.court) === null || _a === void 0 ? void 0 : _a.id)) {
                    this.orderManager.reconstructOrder(existingOrder);
                    console.log('reconsructred court order', this.orderManager.order);
                }
            }
            else if (existingOrder.type == 'preorder') {
                this.deeplinkService.addPendingPreorder(existingOrder, false);
            }
        }
        this.previousOrder = null;
    }
    getCompletedOrder(orderId) {
        if (this.completedOrder && this.completedOrder.id == orderId) {
            return this.completedOrder;
        }
        return null;
    }
    getOrderByStoreId(storeId) {
        var _a;
        const stores = ((_a = this.court) === null || _a === void 0 ? void 0 : _a.stores) || [];
        if (this.cacheCourtStoreMap[storeId]) {
            return this.cacheCourtStoreMap[storeId];
        }
        else {
            const store = stores.find((s) => s.id === storeId);
            if (store) {
                this.cacheCourtStoreMap[storeId] = store;
            }
            return store;
        }
    }
    setMenu(store, fromCache = false) {
        var _a, _b;
        this.store = store;
        const menu = store.menu;
        if (!fromCache || this.lastStoreId !== ((_a = this.store) === null || _a === void 0 ? void 0 : _a.id)) {
            const mm = new _managers_menu_manager__WEBPACK_IMPORTED_MODULE_2__.MenuManager(this.injector);
            mm.processMenu(menu);
            // this.reconfig();
        }
        this.reconfig();
        this.menu = menu;
        this.availableCategories = menu.categories;
        this.lastStoreId = (_b = this.store) === null || _b === void 0 ? void 0 : _b.id;
    }
    // it should run after the check all cat isAvailable
    initMenuCatGroup() {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j;
        // console.log('catGroup HTML TEMPLATE', this.availableCategories);
        if ((_b = (_a = this.store) === null || _a === void 0 ? void 0 : _a.menu) === null || _b === void 0 ? void 0 : _b.catGroup) {
            this.cgroups = (_f = (_e = (_d = (_c = this.store) === null || _c === void 0 ? void 0 : _c.menu) === null || _d === void 0 ? void 0 : _d.cgroups) === null || _e === void 0 ? void 0 : _e.map(cgroup => {
                var _a;
                return (Object.assign(Object.assign({}, cgroup), { categoryIds: (_a = cgroup === null || cgroup === void 0 ? void 0 : cgroup.categoryIds) === null || _a === void 0 ? void 0 : _a.filter(catid => !!this.findCatById(catid)) }));
            })) === null || _f === void 0 ? void 0 : _f.filter(c => { var _a; return ((_a = c === null || c === void 0 ? void 0 : c.categoryIds) === null || _a === void 0 ? void 0 : _a.length) > 0; }); // 过滤当前 categoryIds = []的 cgroup
            // all cats not assigned to any cat-group will be placed under the other Group
            // other group logic start
            const otherGroupCats = this.availableCategories.filter(currentCat => {
                let isInCGroups = false;
                this.cgroups.map(cgroup => {
                    var _a;
                    if ((_a = cgroup.categoryIds) === null || _a === void 0 ? void 0 : _a.includes(currentCat === null || currentCat === void 0 ? void 0 : currentCat.id) /* && currentCat?.id !== '4aef9384-53ec-4fe3-bef4-b06e8f5e0389'*/) {
                        isInCGroups = true;
                    }
                });
                return !isInCGroups;
            });
            console.log('catGroup HTML TEMPLATE:', otherGroupCats);
            const otherCGroup = {
                name: 'Other group',
                categoryIds: otherGroupCats.map(cat => cat === null || cat === void 0 ? void 0 : cat.id)
            };
            console.log('catGroup HTML TEMPLATE:', otherCGroup);
            if (((_g = otherCGroup === null || otherCGroup === void 0 ? void 0 : otherCGroup.categoryIds) === null || _g === void 0 ? void 0 : _g.length) > 0) {
                (_h = this.cgroups) === null || _h === void 0 ? void 0 : _h.push(otherCGroup);
            }
            // other group logic end
            console.log('catGroup HTML TEMPLATE:', this.cgroups);
            // console.log('catGroup HTML TEMPLATE:', this.store.menu?.cgroups);
            // console.log('catGroup HTML TEMPLATE:', otherGroupCats);
            this.currenCatGroup = (_j = this.cgroups) === null || _j === void 0 ? void 0 : _j[0];
        }
    }
    findCatById(catId) {
        var _a;
        return (_a = this.availableCategories) === null || _a === void 0 ? void 0 : _a.find(cat => /*cat?.id !== '4aef9384-53ec-4fe3-bef4-b06e8f5e0389' &&*/ (cat === null || cat === void 0 ? void 0 : cat.id) === catId);
    }
    reconfig() {
        this.brand = this.store.brand;
        this.payments = this.brand.payments || [];
    }
    //clear the context, likely due to logout or switching to different brand
    clear() {
        this.store = null;
        this.storeId = null;
        this.menu = null;
        this.currentCategory = null;
        this.availableCategories = null;
        this.cgroups = null;
    }
    makeSaveData() {
        var _a;
        if (this.copyOrder) {
            return this.copyOrder;
        }
        var order = this.orderManager.order;
        if (!order) {
            return null;
        }
        var slimOrder = aigens_data__WEBPACK_IMPORTED_MODULE_0__.Order.toOrderData(order);
        var data = {
            order: slimOrder
        };
        if (this.court) {
            data['courtId'] = this.court.id;
        }
        else {
            data['storeId'] = this.storeId;
        }
        if (((_a = this.verified) === null || _a === void 0 ? void 0 : _a.length) > 0) {
            data['verified'] = this.verified;
        }
        return data;
    }
    restoreSavedData(data) {
        console.log('OrderContext restoreSavedData', data);
        if (data === null || data === void 0 ? void 0 : data.verified) {
            this.verified = data.verified;
        }
        if (data.order) {
            this.previousOrder = data.order;
            console.log('restored previous order', this.previousOrder);
        }
    }
    copyOrderDataToContextId(storeId, mode) {
        const currentOrder = JSON.parse(JSON.stringify(this.makeSaveData()));
        if (currentOrder) {
            currentOrder.storeId = storeId;
            currentOrder.order.storeId = storeId;
            currentOrder.order.type = mode;
            this.copyOrder = currentOrder;
            this.save();
            this.copyOrder = null;
        }
        return currentOrder;
    }
    setResponsePostedOrderJson(orderJson) {
        // this.responsePostedOrderJson_ = orderJson;
        this.next('responsePostedOrderJson', orderJson);
    }
    clearResponsePostedOrderJson() {
        this.next('responsePostedOrderJson', null);
    }
    setCheckoutPageHandleParams(pramas) {
        console.log('set checkoutPageHandleParams');
        // this.miniAppService?.echoLog(['run setCheckoutPageHandleParams, it should go to orderDetailsPage'], () => { });
        this.next('checkoutPageHandleParams', pramas);
    }
    clearCheckoutPageHandleParams() {
        console.log('clear checkoutPageHandleParams');
        this.next('checkoutPageHandleParams', null);
    }
    checkCanPayByEwalletBalance() {
        var _a, _b, _c;
        const ewalletTotal = (_a = this.ewalletService) === null || _a === void 0 ? void 0 : _a.getMemberEwallectTotal();
        const currenOrderSpendBalance = (_c = (_b = this.orderManager) === null || _b === void 0 ? void 0 : _b.order) === null || _c === void 0 ? void 0 : _c.eqvEcreditAmt;
        // console.log('ewalletTotal', this.orderManager?.order?.eqvEcreditAmt);
        return ewalletTotal >= currenOrderSpendBalance;
    }
    isVerified(cat = undefined, item = undefined) {
        var _a, _b, _c;
        if (item !== undefined && ((_a = item.verificationGroupIds) === null || _a === void 0 ? void 0 : _a.length) > 0) {
            const verificationIds = item === null || item === void 0 ? void 0 : item.verificationGroupIds;
            if (this.verified.length === 0 && (verificationIds === null || verificationIds === void 0 ? void 0 : verificationIds.length) > 0) {
                return false;
            }
            if (((_b = this.verified) === null || _b === void 0 ? void 0 : _b.length) > 0 && (verificationIds === null || verificationIds === void 0 ? void 0 : verificationIds.length) > 0) {
                if (!this.isMatchAll(verificationIds, this.verified)) {
                    return false;
                }
            }
        }
        if (cat !== undefined) {
            if ((cat === null || cat === void 0 ? void 0 : cat.warning) && !(cat === null || cat === void 0 ? void 0 : cat.isWarningViewed)) {
                return false;
            }
            const verificationIds = cat === null || cat === void 0 ? void 0 : cat.verificationGroupIds;
            if (this.verified.length === 0 && (verificationIds === null || verificationIds === void 0 ? void 0 : verificationIds.length) > 0) {
                return false;
            }
            if (((_c = this.verified) === null || _c === void 0 ? void 0 : _c.length) > 0 && (verificationIds === null || verificationIds === void 0 ? void 0 : verificationIds.length) > 0) {
                if (!this.isMatchAll(verificationIds, this.verified)) {
                    return false;
                }
            }
        }
        return true;
    }
    /*
    getMenuDeviceConfig(key: string): any {

        var result = null;

        if (this.menu?.config) {

            let config = this.menu?.config;
            result = get(config, key);
        }

        return result;
    }
    */
    isMatchAll(arr1, arr2) {
        if (arr2.length < arr1.length) {
            return false;
        }
        for (let i = 0; i < arr1.length; i++) {
            const isExist = arr2 === null || arr2 === void 0 ? void 0 : arr2.includes(arr1[i]);
            if (!isExist) {
                return false;
            }
        }
        return true;
    }
}
OrderContext.ɵfac = function OrderContext_Factory(t) { return new (t || OrderContext)(_angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_7__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵinject"](aigens_framework__WEBPACK_IMPORTED_MODULE_3__.OrderManager), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵinject"](_pure_services_deep_link_service__WEBPACK_IMPORTED_MODULE_4__.DeepLinkService), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵinject"](_aigens_core_src_app_framework_services_pre_order_context_service__WEBPACK_IMPORTED_MODULE_5__.PreOrderContext), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵinject"](_ewallet_service__WEBPACK_IMPORTED_MODULE_6__.EwalletService)); };
OrderContext.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdefineInjectable"]({ token: OrderContext, factory: OrderContext.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 63406:
/*!*******************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/pre-order-context.service.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PreOrderContext": () => (/* binding */ PreOrderContext)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ 78611);
/* harmony import */ var _base_base_context__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../base/base-context */ 76309);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ 3184);





class PreOrderContext extends _base_base_context__WEBPACK_IMPORTED_MODULE_0__.BaseContext {
    constructor(injector) {
        super(injector);
        this.injector = injector;
        this.hasPreOrderContext = true;
        console.log('constructing PRE order context, this should only happen once');
        this.initFromContext();
    }
    initFromContext() {
        var aigens = window['aigens'];
        if (aigens && aigens.context) {
            var context = aigens.context;
            this.contextId = this.makeGenericKey(context, 'preorder', context.locale);
        }
        this.restore();
    }
    clear() {
        this.storeId = null;
        this.data = null;
        this.order = null;
    }
    makeSaveData() {
        return this.data;
    }
    restoreSavedData(data) {
        var _a;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function* () {
            console.log('PreorderContext restoreSavedData', data);
            if (data.order) {
                this.order = data.order;
            }
            if (this.order === undefined && data.uuid) {
                this.orderId = data === null || data === void 0 ? void 0 : data.uuid;
                yield (0,rxjs__WEBPACK_IMPORTED_MODULE_2__.lastValueFrom)(this.getOrder()).then((x) => {
                    this.order = x;
                    return x;
                });
                this.next('order', this.order);
            }
            console.log('restored PRE order', this.order);
            this.storeId = (data === null || data === void 0 ? void 0 : data.storeId) || ((_a = this.order) === null || _a === void 0 ? void 0 : _a.storeId);
        });
    }
    getOrder() {
        const url = `/api/v1/menu/order/${this.orderId}.json`;
        let param = {};
        param['locale'] = 'multi';
        return this.dataService.get(url, param);
    }
}
PreOrderContext.ɵfac = function PreOrderContext_Factory(t) { return new (t || PreOrderContext)(_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_3__.Injector)); };
PreOrderContext.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdefineInjectable"]({ token: PreOrderContext, factory: PreOrderContext.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 24430:
/*!*********************************************************************!*\
  !*** ./projects/core/src/app/framework/services/storage.service.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "StorageService": () => (/* binding */ StorageService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var localforage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! localforage */ 26477);
/* harmony import */ var localforage__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(localforage__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var lzutf8__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lzutf8 */ 51457);
/* harmony import */ var lzutf8__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lzutf8__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _pure_services_common_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../pure/services/common.service */ 43872);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);






//var LZUTF8 = require('lzutf8');
//WARNING: DO NOT MODIFY THIS CLASS
//WARNING: DO NOT ADD DEPENDENCY
class StorageService {
    constructor(injector) {
        this.dev = false;
        console.log('new storage service');
        this.dev = window.location.hostname == 'localhost';
        this.initForage();
    }
    initForage() {
        localforage__WEBPACK_IMPORTED_MODULE_0__.config({
            name: 'aigens',
            storeName: 'context'
        });
    }
    setLocal(key, object) {
        _pure_services_common_service__WEBPACK_IMPORTED_MODULE_2__.CommonService.setLocal(key, object);
    }
    getLocal(key) {
        return _pure_services_common_service__WEBPACK_IMPORTED_MODULE_2__.CommonService.getLocal(key);
    }
    setStorage(key, object, compress = false) {
        /**
         * Sometimes we need to prohibit writing to storage
         * * If get storage takes 3 seconds, get to order and then write into storage.
         * * It takes 1 second to remove order, and there will be a problem. The order is deleted, but it still exists in storage, so we need to write an attribute to prohibit writing to storage.
         * ** 假如get storage 需要 3秒, get 到 order 再写入 storage
         * ** remove order 需要1秒, 就会出现一个问题. 订单被删除了, storage 中仍存在, 所以需要写一个属性去禁止写入 storage.
         */
        if (StorageService.prohibitWritingToStorage) {
            return Promise.resolve(null);
        }
        if (object == null) {
            localforage__WEBPACK_IMPORTED_MODULE_0__.removeItem(key);
            return null;
        }
        if (compress) {
            return this.setStorageCompress(key, object);
        }
        else {
            return localforage__WEBPACK_IMPORTED_MODULE_0__.setItem(key, object);
        }
    }
    removeItem(key) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__awaiter)(this, void 0, void 0, function* () {
            if (!key)
                return;
            yield localforage__WEBPACK_IMPORTED_MODULE_0__.removeItem(key);
        });
    }
    getStorageKeys() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__awaiter)(this, void 0, void 0, function* () {
            return (yield localforage__WEBPACK_IMPORTED_MODULE_0__.keys()) || [];
        });
    }
    getStorage(key, compress = false) {
        if (compress) {
            return this.getStorageCompress(key);
        }
        else {
            return localforage__WEBPACK_IMPORTED_MODULE_0__.getItem(key);
        }
    }
    setStorageCompress(key, object) {
        var promise = new Promise((resolve, reject) => {
            var str = JSON.stringify(object);
            console.log("before compress", str.length);
            lzutf8__WEBPACK_IMPORTED_MODULE_1__.compressAsync(str, { outputEncoding: "StorageBinaryString" }, function (result, error) {
                if (error === undefined) {
                    console.log("after compress", result.length);
                    localforage__WEBPACK_IMPORTED_MODULE_0__.setItem(key, result);
                    resolve(result);
                }
                else {
                    console.log("Compression error", error);
                    reject(error.message);
                }
            });
        });
        return promise;
    }
    getStorageCompress(key) {
        var promise = new Promise((resolve, reject) => {
            localforage__WEBPACK_IMPORTED_MODULE_0__.getItem(key, (error, value) => {
                if (error) {
                    resolve(null);
                }
                else {
                    console.log("compressed length", value['length']);
                    lzutf8__WEBPACK_IMPORTED_MODULE_1__.decompressAsync(value, { inputEncoding: "StorageBinaryString" }, function (result, error) {
                        if (error === undefined) {
                            console.log("decompressed length", result.length);
                            var obj = JSON.parse(result);
                            resolve(obj);
                        }
                        else {
                            console.log("Decompression error", error);
                            resolve(null);
                        }
                    });
                }
            });
        });
        return promise;
    }
}
StorageService.prohibitWritingToStorage = false;
StorageService.ɵfac = function StorageService_Factory(t) { return new (t || StorageService)(_angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_4__.Injector)); };
StorageService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineInjectable"]({ token: StorageService, factory: StorageService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 14221:
/*!****************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/text-to-speech.service.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TextToSpeechService": () => (/* binding */ TextToSpeechService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _capacitor_community_text_to_speech__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @capacitor-community/text-to-speech */ 32778);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);




class TextToSpeechService {
    constructor(injector) {
        this.speechSynthesisAvailable = false;
        this.speak = (options) => (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function* () {
            try {
                return yield _capacitor_community_text_to_speech__WEBPACK_IMPORTED_MODULE_0__.TextToSpeech.speak(options);
            }
            catch (error) {
                console.error(error);
            }
        });
        this.stop = () => (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function* () {
            yield _capacitor_community_text_to_speech__WEBPACK_IMPORTED_MODULE_0__.TextToSpeech.stop();
        });
        this.getSupportedLanguages = () => (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function* () {
            return yield _capacitor_community_text_to_speech__WEBPACK_IMPORTED_MODULE_0__.TextToSpeech.getSupportedLanguages();
        });
        this.getSupportedVoices = () => (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function* () {
            return _capacitor_community_text_to_speech__WEBPACK_IMPORTED_MODULE_0__.TextToSpeech.getSupportedVoices();
        });
        this.isLanguageSupported = (lang) => (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function* () {
            return yield _capacitor_community_text_to_speech__WEBPACK_IMPORTED_MODULE_0__.TextToSpeech.isLanguageSupported({ lang });
        });
    }
    isAvailable() {
        return true;
    }
}
TextToSpeechService.ɵfac = function TextToSpeechService_Factory(t) { return new (t || TextToSpeechService)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_2__.Injector)); };
TextToSpeechService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineInjectable"]({ token: TextToSpeechService, factory: TextToSpeechService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 99731:
/*!*************************************************************************!*\
  !*** ./projects/core/src/app/framework/services/theme-color.service.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ThemeColorService": () => (/* binding */ ThemeColorService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ctrl_tinycolor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ctrl/tinycolor */ 69701);
/* harmony import */ var angular_material_css_vars__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! angular-material-css-vars */ 33017);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/router */ 52816);





class ThemeColorService {
    constructor(injector, materialCssVarsService, route) {
        this.materialCssVarsService = materialCssVarsService;
        this.route = route;
        this.hues = [
            { value: '50', viewValue: '50' },
            { value: '100', viewValue: '100' },
            { value: '200', viewValue: '200' },
            { value: '300', viewValue: '300' },
            { value: '400', viewValue: '400' },
            { value: '500', viewValue: '500' },
            { value: '600', viewValue: '600' },
            { value: '700', viewValue: '700' },
            { value: '800', viewValue: '800' },
            { value: '900', viewValue: '900' },
            /*
            { value: 'A100', viewValue: 'A100' },
            { value: 'A200', viewValue: 'A200' },
            { value: 'A400', viewValue: 'A400' },
            { value: 'A700', viewValue: 'A700' },
            */
        ];
        //this method prevent setting the vars, and use our format instead
        this._setStyle = (vars) => {
            var csss = this.materialCssVarsService;
            var colorMap = this.colorMap;
            vars.forEach(s => {
                //this is the line we save the variables
                colorMap[s.name] = s.val;
                //console.log("setting val", s, s.val);
                //this is the line from original source code
                csss.renderer.setStyle(csss.ROOT, s.name, s.val, _angular_core__WEBPACK_IMPORTED_MODULE_0__.RendererStyleFlags2.DashCase);
            });
        };
        //some bug with the lib that these values sometimes are not set, so we set them
        let root = document.documentElement;
        root.style.setProperty('--light-primary-text', '255, 255, 255');
        root.style.setProperty('--dark-primary-text', '0, 0, 0');
        this.materialCssVarsService.setAutoContrastEnabled(true);
        this.materialCssVarsService['_calculateContrastColorsForCurrentValues'] = this._calculateContrastColorsForCurrentValues;
        this.materialCssVarsService['_setStyle'] = this._setStyle;
    }
    //this method overwrite the contrast color calculation
    _calculateContrastColorsForCurrentValues(palettePrefix) {
        var csss = this;
        return csss.cfg.sortedHues.map((hue) => {
            const hueVarVal = csss._getCssVarValue(`${palettePrefix}${hue}`);
            const c = new _ctrl_tinycolor__WEBPACK_IMPORTED_MODULE_1__.TinyColor(`rgb(${hueVarVal})`);
            const isDark = c.getBrightness() < 155;
            const contrastColorVar = isDark
                ? '--light-primary-text'
                : '--dark-primary-text';
            //console.log("calculate", hue, contrastColorVar);
            return {
                contrastColorVar,
                hue,
            };
        });
    }
    setThemeByColors(brandColors) {
        if (!brandColors)
            return;
        this.colorMap = {};
        //console.log("theme colors", brandColors);
        let { primary = "#3f51b5", secondary = "#ff4081", warn = "#f44336", isDark = false } = brandColors;
        isDark && this.materialCssVarsService.setDarkTheme(isDark);
        primary && this.materialCssVarsService.setPrimaryColor(primary);
        secondary && this.materialCssVarsService.setAccentColor(secondary);
        warn && this.materialCssVarsService.setWarnColor(warn);
        this.computeVars();
    }
    setThemeByContent(brand) {
        if (!brand)
            return;
        //console.log("setThemeByContent", brand);
        if (brand.id == this.currentContentId) {
            console.log("skip theme due to same brandId");
            return;
        }
        this.currentContentId = brand.id;
        var brandColors = brand.colors || {};
        // temporary fix issue with null theme color from server
        // TODO: this issue should be fixed from server return default value of theme color
        if (!brandColors.primary) {
            brandColors = {
                "bg": "#eb5a4b",
                "primary": "#eb5a4b",
                "secondary": "#FF4081",
                "warn": "#F44336"
            };
        }
        this.setThemeByColors(brandColors);
    }
    setThemeByContext() {
        const ai = window['aigens'];
        if (ai && ai.context) {
            this.route.queryParams.subscribe(params => {
                if (params.groupId) { // group mode, using theme from group
                    this.setThemeByContent(ai.context.group);
                }
                else if (params.courtId) { // court mode, using theme from court
                    this.setThemeByContent(ai.context.court);
                }
                else { // no req param, could be on brand home / court home / group home
                    const brand = ai.context.court || ai.context.brand || ai.context.group;
                    this.setThemeByContent(brand);
                }
            });
        }
    }
    /*
    hexToColor(hex){
        var rgb = this.hexToRgb(hex);
        var c = new Color(rgb.r, rgb.g, rgb.b);
        return c;
    }*/
    hexToRgb(hex) {
        // Expand shorthand form (e.g. "03F") to full form (e.g. "0033FF")
        var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
        hex = hex.replace(shorthandRegex, function (m, r, g, b) {
            return r + r + g + g + b + b;
        });
        var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? {
            r: parseInt(result[1], 16),
            g: parseInt(result[2], 16),
            b: parseInt(result[3], 16)
        } : null;
    }
    computeVars() {
        //console.log("computing color with map", this.colorMap);
        var groups = [
            {
                name: 'primary',
                namec: 'primary-contrast',
                short: "P",
                shortc: "PC",
                items: []
            },
            {
                name: 'accent',
                namec: 'accent-contrast',
                short: "A",
                shortc: "AC",
                items: []
            },
            {
                name: 'warn',
                namec: 'warn-contrast',
                short: "W",
                shortc: "WC",
                items: []
            }
        ];
        let root = document.documentElement;
        var cs = this.colorMap;
        var newCss = [];
        var i = 0;
        //--palette-accent-contrast-600
        for (let group of groups) {
            for (let h of this.hues) {
                var name = "--palette-" + group.name + "-" + h.value;
                var namec = "--palette-" + group.name + "-contrast-" + h.value;
                var rgb = cs[name];
                var rgbc = cs[namec];
                if (rgbc == 'var(--light-primary-text)') {
                    rgbc = 'white';
                }
                else if (rgbc == 'var(--dark-primary-text)') {
                    rgbc = 'black';
                }
                else if (!rgbc) {
                    rgbc = 'white';
                }
                if (rgb) {
                    var hex = this.rgbToHex(rgb);
                    var hexc = this.rgbToHex(rgbc);
                    var newName = "--" + group.short + h.value;
                    var newNameC = "--" + group.short + "C" + h.value;
                    var dis = newName;
                    var disc = newNameC;
                    if (h.value == '500') {
                        dis = dis.replace('500', '');
                        disc = disc.replace('500', '');
                    }
                    var item = {
                        name: newName,
                        namec: newNameC,
                        dis: dis,
                        disc: disc,
                        value: hex,
                        valuec: hexc,
                        hue: h.value,
                        cls: group.short + h.value
                    };
                    newCss.push(item);
                    group.items.push(item);
                }
            }
            i++;
        }
        console.log("css groups", groups);
        for (let css of newCss) {
            root.style.setProperty(css.name, css.value);
            root.style.setProperty(css.namec, css.valuec);
            if (css.hue == '500') {
                root.style.setProperty(css.name.replace('500', ''), css.value);
                root.style.setProperty(css.namec.replace('500', ''), css.valuec);
            }
        }
        this.cssGroups = groups;
    }
    componentToHex(c) {
        var hex = c.toString(16);
        return hex.length == 1 ? "0" + hex : hex;
    }
    rgbToHex(rgbStr) {
        var splits = rgbStr.split(',');
        if (splits.length <= 1)
            return rgbStr;
        var r = parseInt(splits[0]);
        var g = parseInt(splits[1]);
        var b = parseInt(splits[2]);
        return "#" + this.componentToHex(r) + this.componentToHex(g) + this.componentToHex(b);
    }
}
ThemeColorService.ɵfac = function ThemeColorService_Factory(t) { return new (t || ThemeColorService)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](angular_material_css_vars__WEBPACK_IMPORTED_MODULE_2__.MaterialCssVarsService), _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](_angular_router__WEBPACK_IMPORTED_MODULE_3__.ActivatedRoute)); };
ThemeColorService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({ token: ThemeColorService, factory: ThemeColorService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 8744:
/*!********************************************************!*\
  !*** ./projects/core/src/app/pure/base/page-params.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PageParams": () => (/* binding */ PageParams)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class PageParams {
    constructor() {
        this.params = {};
        this.querys = {};
        this.input = {};
    }
    set(params) {
        this.params = params;
    }
    get(name) {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j;
        var result = null;
        if (this.input) {
            result = (_a = this.input) === null || _a === void 0 ? void 0 : _a[name];
        }
        if (this.route) {
            //console.log('get', name);
            //console.log('route', this.route);
            var snapshot = (_b = this.route) === null || _b === void 0 ? void 0 : _b.snapshot;
            if (!result) {
                result = (_c = snapshot === null || snapshot === void 0 ? void 0 : snapshot.params) === null || _c === void 0 ? void 0 : _c[name];
            }
            //checking parent route as well
            if (!result) {
                result = (_e = (_d = snapshot === null || snapshot === void 0 ? void 0 : snapshot.parent) === null || _d === void 0 ? void 0 : _d.params) === null || _e === void 0 ? void 0 : _e[name];
            }
            if (!result) {
                result = (_f = snapshot === null || snapshot === void 0 ? void 0 : snapshot.queryParams) === null || _f === void 0 ? void 0 : _f[name];
            }
            var hash = snapshot === null || snapshot === void 0 ? void 0 : snapshot.fragment;
            if (!result && hash) {
                try {
                    console.log("HASH", hash);
                    const urlParams = new URLSearchParams(hash);
                    result = urlParams.get(name);
                }
                catch (e) {
                    console.log(e);
                }
            }
        }
        else {
            if (!result) {
                result = (_g = this.params) === null || _g === void 0 ? void 0 : _g[name];
            }
            if (!result) {
                result = (_h = this.querys) === null || _h === void 0 ? void 0 : _h[name];
            }
        }
        if (!result) {
            result = (_j = history === null || history === void 0 ? void 0 : history.state) === null || _j === void 0 ? void 0 : _j[name];
        }
        return result;
    }
}
PageParams.ɵfac = function PageParams_Factory(t) { return new (t || PageParams)(); };
PageParams.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({ token: PageParams, factory: PageParams.ɵfac });


/***/ }),

/***/ 75585:
/*!***********************************************************!*\
  !*** ./projects/core/src/app/pure/base/reuse-strategy.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CustomRouteReuseStrategy": () => (/* binding */ CustomRouteReuseStrategy)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/common */ 36362);



class CustomRouteReuseStrategy {
    constructor(ls) {
        this.isDebug = false;
        this.backward = false;
        console.log("CustomRouteReuseStrategy constructor");
        var cache = window['reuseCache'];
        if (!cache) {
            cache = {};
            window['reuseCache'] = cache;
        }
        this.handlers = cache;
        this.id = new Date().getTime();
        ls.onPopState((event) => {
            this.backward = true;
            console.log('GOING BACK', event, window.location.pathname, event.state);
            setTimeout(() => {
                console.log("back completed");
                this.backward = false;
            }, 10);
        });
    }
    debug(msg, result, route = null) {
        if (this.isDebug) {
            if (route) {
                console.log(msg, result, this.getUrl(route), Object.keys(this.handlers).length);
            }
            else {
                console.log(msg, result, Object.keys(this.handlers).length);
            }
            if (this.backward) {
                console.log("backward");
            }
            else {
                console.log("forward");
            }
        }
    }
    clearAll() {
        //this.handlers = {};
        console.log("check HANDLERS:", this.handlers);
        var handlers = this.handlers;
        for (var member in handlers)
            delete handlers[member];
        this.debug("clearing reuse", "");
    }
    clear(url) {
        delete this.handlers[url];
    }
    /**
     * Determines if this route (and its subtree) should be detached to be reused later
     * @param route
     */
    shouldDetach(route) {
        //console.log('[router-reuse] checking if this route should be re used or not', route);
        if (!route.routeConfig || route.routeConfig.loadChildren) {
            return false;
        }
        /** Whether this route should be re used or not */
        let shouldReuse = false;
        if (route.routeConfig.data) {
            route.routeConfig.data.reuse ? shouldReuse = true : shouldReuse = false;
            var url = this.getUrl(route);
            //console.log("shouldDetach data", route.routeConfig.data);
            if (this.backward) {
                console.log("should not save because it's backing");
                shouldReuse = false;
                this.clear(url);
            }
            this.debug("should detach", shouldReuse, route);
            this.backFrom = url;
        }
        return shouldReuse;
        //return true;
    }
    /**
     * Stores the detached route.
     */
    store(route, handler) {
        //console.log('[router-reuse] storing handler');
        if (handler) {
            var url = this.getUrl(route);
            this.debug("store saving resue", "true", route);
            this.handlers[url] = handler;
        }
    }
    /**
     * Determines if this route (and its subtree) should be reattached
     * @param route Stores the detached route.
     */
    shouldAttach(route) {
        //console.log('[router-reuse] checking if it should be re attached');
        var url = this.getUrl(route);
        //if going forward, DO NOT cache anything
        if (!this.backward) {
            this.debug("should not attach when forward", result, route);
            return false;
        }
        var result = !!this.handlers[url];
        if (this.backward) {
            this.backTo = url;
        }
        this.debug("should attach", result, route);
        return result;
    }
    /**
     * Retrieves the previously stored route
     */
    retrieve(route) {
        //console.log('[router-reuse] retrieve');
        var _a;
        if (!route.routeConfig || route.routeConfig.loadChildren || route.routeConfig.children) {
            return null;
        }
        ;
        var url = this.getUrl(route);
        var result = this.handlers[url];
        if (result) {
            //delete this.handlers[url];
            console.log("reuse success", url);
            this.debug("reuse", "true", route);
            var comp = (_a = result.componentRef) === null || _a === void 0 ? void 0 : _a.instance;
            //console.log("reused component", comp);
            if (comp && comp.ngOnAttach) {
                if (!result.attachCalled) {
                    result.attachCalled = true;
                    console.log("attached callback");
                    comp.ngOnAttach();
                }
                else {
                    console.log("skipping attached callback");
                }
            }
        }
        return result;
    }
    /**
     * Determines if a route should be reused
     * @param future
     * @param current
     */
    shouldReuseRoute(future, current) {
        //console.log('[router-reuse] shouldReuseRoute');//, future, current);
        const defaultReuse = (future.routeConfig === current.routeConfig);
        return defaultReuse;
    }
    getUrl(route) {
        var result = route.pathFromRoot
            .map(v => v.url.map(segment => segment.toString()).join('/'))
            .filter(url => !!url)
            .join('/');
        //console.log('router-reuse url', result);
        return result;
    }
}
CustomRouteReuseStrategy.ɵfac = function CustomRouteReuseStrategy_Factory(t) { return new (t || CustomRouteReuseStrategy)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](_angular_common__WEBPACK_IMPORTED_MODULE_1__.LocationStrategy)); };
CustomRouteReuseStrategy.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({ token: CustomRouteReuseStrategy, factory: CustomRouteReuseStrategy.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 74663:
/*!****************************************************************!*\
  !*** ./projects/core/src/app/pure/managers/setting-manager.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SettingManager": () => (/* binding */ SettingManager)
/* harmony export */ });
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash-es */ 94894);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);


class SettingManager {
    constructor() {
        this.merged = {};
        this.context = window['aigens'].context;
        this.initByContext();
    }
    initByContext(storeConfig = {}) {
        var _a, _b;
        this.merged = {};
        // var configData = this.context?.config?.data; // this.context?.config is from initJs config
        var configData = Object.assign(((_b = (_a = this.context) === null || _a === void 0 ? void 0 : _a.config) === null || _b === void 0 ? void 0 : _b.data) || {}, storeConfig); // use storeConfig to overwrite initJs config
        Object.assign(this.merged, configData);
        this.merged.brand = this.context.brand;
        this.merged.form = this.context.form;
    }
    setStoreMenu(store) {
        var _a, _b, _c;
        this.initByContext((_a = store === null || store === void 0 ? void 0 : store.menu) === null || _a === void 0 ? void 0 : _a.config); // reset merged to make sure we get correct current store config
        this.merged.menu = (_b = store.menu) === null || _b === void 0 ? void 0 : _b.settings;
        this.merged.pos = store.pos;
        const storeConfig = (_c = store.menu) === null || _c === void 0 ? void 0 : _c.config;
        Object.assign(this.merged, storeConfig);
        console.log("setStoreMenu", store);
    }
    merge(config) {
        console.log("income config", config);
        //merge kiosk's station config into merged object
        Object.assign(this.merged, config);
        console.log("full config", this.merged);
    }
    get(path, defValue) {
        if (path.indexOf('basic.') == 0) {
            path = path.substring(6);
        }
        var result = (0,lodash_es__WEBPACK_IMPORTED_MODULE_0__["default"])(this.merged, path);
        if (typeof (result) == "undefined" || result == null) {
            result = defValue;
        }
        //console.log("RES", path, result);
        return result;
    }
    setForm(form) {
        console.log('CALLED MERGED SESSION FORM');
        if (form) {
            console.log('SESSION FORM FOUND');
            this.merged.form = form;
        }
        console.log('SESSION FORM MERGED', this.merged.form);
    }
}
SettingManager.ɵfac = function SettingManager_Factory(t) { return new (t || SettingManager)(); };
SettingManager.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineInjectable"]({ token: SettingManager, factory: SettingManager.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 32083:
/*!***********************************************************!*\
  !*** ./projects/core/src/app/pure/services/ad.service.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AdService": () => (/* binding */ AdService)
/* harmony export */ });
/* harmony import */ var _common_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./common.service */ 43872);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _subscribe_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./subscribe.service */ 47074);
/* harmony import */ var _aigens_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/platform.service */ 45485);




class AdService {
    constructor(context, platformService) {
        var _a, _b, _c, _d;
        this.context = context;
        this.platformService = platformService;
        this.sessionSeenMap = {};
        this.onceSeenMap = {};
        this.onceSeenMap = (_b = _common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.getLocal(`${(_a = this.context) === null || _a === void 0 ? void 0 : _a['brandId']}-freq-once-ad`)) !== null && _b !== void 0 ? _b : {};
        this.sessionSeenMap = (_d = _common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.getSessionStorage(`${(_c = this.context) === null || _c === void 0 ? void 0 : _c['brandId']}-freq-session-ad`)) !== null && _d !== void 0 ? _d : {};
    }
    /**
     * Method for filtering ads.
     * options can be vary. Please take a look detail code about attributes that we can set
     *
     * @param ads
     * @param triggerName
     * @param options
     */
    filterAds(ads, triggerName, options) {
        let result = ads;
        result = result.filter(ad => {
            var _a, _b, _c;
            if (!ad.openings || ad.openings.always) {
                return true;
            }
            const now = new Date();
            const currentTime = (('0' + now.getHours().toString()).slice(-2) + ':' + now.getMinutes().toString());
            const start = (_a = ad.openings) === null || _a === void 0 ? void 0 : _a.weekdays[now.getDay()].startTime;
            const end = (_b = ad.openings) === null || _b === void 0 ? void 0 : _b.weekdays[now.getDay()].endTime;
            const status = (_c = ad.openings) === null || _c === void 0 ? void 0 : _c.weekdays[now.getDay()].type;
            return currentTime >= start && currentTime <= end;
        });
        if (options === null || options === void 0 ? void 0 : options.checkFreq) {
            result = ads.filter((ad) => {
                return this.checkAdFreq(ad);
            });
        }
        if (options === null || options === void 0 ? void 0 : options.checkBrandOnly) {
            if (options === null || options === void 0 ? void 0 : options.isBrandOnly) {
                result = result.filter(ad => ad.brandOnly);
            }
            else {
                result = result.filter(ad => !ad.brandOnly);
            }
        }
        result = result.filter(ad => {
            var _a;
            if ((options === null || options === void 0 ? void 0 : options.checkBanner) && !((_a = ad.images) === null || _a === void 0 ? void 0 : _a.banner)) {
                return false;
            }
            const trigger = ad.trigger || [];
            return trigger.includes(triggerName);
        });
        // if (options?.orderMode) { // commented, to make sure always filter by order mode
        result = result.filter(ad => {
            if (ad.modes && ad.modes.length > 0) {
                return ad.modes.includes(options === null || options === void 0 ? void 0 : options.orderMode);
            }
            return true;
        });
        // }
        // if (options?.checkSignIn) { // commented, to make sure always filter by users
        result = result.filter(ad => {
            if (!ad.users || ad.users.length <= 0) {
                return true;
            }
            if ((options === null || options === void 0 ? void 0 : options.isSignIn) == null) {
                return false;
            }
            if ((options === null || options === void 0 ? void 0 : options.isSignIn) && ad.users.indexOf('member') >= 0) {
                return true;
            }
            if (!(options === null || options === void 0 ? void 0 : options.isSignIn) && ad.users.indexOf('guest') >= 0) {
                return true;
            }
            return false;
        });
        // }
        // if (options?.storeId) { // commented, to make sure always filter by store id
        result = result.filter(ad => {
            const stores = (ad.storeIds || []).map(o => String(o));
            if (stores.length == 0) {
                return true;
            }
            return stores.includes(options === null || options === void 0 ? void 0 : options.storeId);
        });
        // }
        // filter ads by devices
        result = result.filter(ad => {
            if (!ad.devices || ad.devices.length == 0) {
                return true;
            }
            return ad.devices.includes(this.platformService.platform);
        });
        result = this.sortAds(result);
        return result;
    }
    checkAdFreq(ad) {
        if (!(ad === null || ad === void 0 ? void 0 : ad.frequency) || (ad === null || ad === void 0 ? void 0 : ad.frequency) === 'always') {
            return true;
        }
        if (ad.frequency === 'session') {
            return !(ad.id in this.sessionSeenMap && this.sessionSeenMap[ad.id]);
        }
        return !(ad.id in this.onceSeenMap && this.onceSeenMap[ad.id]);
    }
    markAdsAsSeen(ads) {
        var _a, _b;
        ads.forEach((ad) => {
            this.makeAdAsSeen(ad);
        });
        _common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.setLocal(`${(_a = this.context) === null || _a === void 0 ? void 0 : _a['brandId']}-freq-once-ad`, this.onceSeenMap);
        _common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.setSessionStorage(`${(_b = this.context) === null || _b === void 0 ? void 0 : _b['brandId']}-freq-session-ad`, this.sessionSeenMap);
    }
    makeAdAsSeen(ad) {
        if (!(ad === null || ad === void 0 ? void 0 : ad.frequency) || (ad === null || ad === void 0 ? void 0 : ad.frequency) === 'always') {
            return;
        }
        if (ad.frequency === 'session') {
            this.sessionSeenMap[ad.id] = true;
            console.log(this.sessionSeenMap);
        }
        if (ad.frequency === 'once') {
            this.onceSeenMap[ad.id] = true;
            console.log(this.onceSeenMap);
        }
    }
    sortAds(ads) {
        let result = ads;
        result = result.sort((a, b) => {
            if (a['featured']) {
                return -1;
            }
            if (b['featured']) {
                return 1;
            }
            return (a === null || a === void 0 ? void 0 : a.start) > (b === null || b === void 0 ? void 0 : b.start) ? -1 : 1;
        });
        result = result.sort((a, b) => {
            var _a, _b;
            const aVal = (_a = a.priority) !== null && _a !== void 0 ? _a : 0;
            const bVal = (_b = b.priority) !== null && _b !== void 0 ? _b : 0;
            return bVal - aVal;
        });
        return result;
    }
}
AdService.ɵfac = function AdService_Factory(t) { return new (t || AdService)(_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵinject"](_subscribe_service__WEBPACK_IMPORTED_MODULE_1__.SubscribeService), _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵinject"](_aigens_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_2__.PlatformService)); };
AdService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdefineInjectable"]({ token: AdService, factory: AdService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 67558:
/*!***************************************************************************!*\
  !*** ./projects/core/src/app/pure/services/base-error-handler.service.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BaseErrorHandlerService": () => (/* binding */ BaseErrorHandlerService)
/* harmony export */ });
/* harmony import */ var _sentry_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./sentry.service */ 38792);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);



class BaseErrorHandlerService {
    constructor(injector) {
        this.sentryService = injector.get(_sentry_service__WEBPACK_IMPORTED_MODULE_0__.SentryService);
    }
    handleError(error) {
        console.error(error.name, error);
        this.sentryService.captureException(error);
    }
}
BaseErrorHandlerService.ɵfac = function BaseErrorHandlerService_Factory(t) { return new (t || BaseErrorHandlerService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_1__.Injector)); };
BaseErrorHandlerService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineInjectable"]({ token: BaseErrorHandlerService, factory: BaseErrorHandlerService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 43872:
/*!***************************************************************!*\
  !*** ./projects/core/src/app/pure/services/common.service.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CommonService": () => (/* binding */ CommonService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);


class CommonService {
    constructor(injector) {
    }
    static getLocal(key) {
        try {
            const str = localStorage.getItem(key);
            if (str == null || str == 'undefined') {
                return null;
            }
            return JSON.parse(str);
        }
        catch (e) {
            console.log(e);
        }
        return null;
    }
    static setLocal(key, object) {
        try {
            localStorage.setItem(key, JSON.stringify(object));
        }
        catch (e) {
            console.log(e);
        }
    }
    static getSessionStorage(key) {
        try {
            const str = sessionStorage.getItem(key);
            if (str == null || str === 'undefined') {
                return null;
            }
            return JSON.parse(str);
        }
        catch (e) {
            console.log(e);
        }
        return null;
    }
    static setSessionStorage(key, object) {
        try {
            sessionStorage.setItem(key, JSON.stringify(object));
        }
        catch (e) {
            console.log(e);
        }
    }
    static deserialize(str) {
        try {
            if (str == null || str == 'undefined') {
                return null;
            }
            return JSON.parse(str);
        }
        catch (e) {
            console.log(e);
        }
        return null;
    }
    static serialize(object) {
        return JSON.stringify(object);
    }
}
CommonService.ɵfac = function CommonService_Factory(t) { return new (t || CommonService)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injector)); };
CommonService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({ token: CommonService, factory: CommonService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 13661:
/*!******************************************************************!*\
  !*** ./projects/core/src/app/pure/services/deep-link.service.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DeepLinkService": () => (/* binding */ DeepLinkService)
/* harmony export */ });
/* harmony import */ var _common_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./common.service */ 43872);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _subscribe_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./subscribe.service */ 47074);
/* harmony import */ var _platform_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./platform.service */ 45485);
/* harmony import */ var _lazy_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./lazy.service */ 60040);






//WARNING: DO NOT MODIFY THIS CLASS
//WARNING: DO NOT ADD DEPENDENCY
class DeepLinkService {
    constructor(route, router, subscribeService, platformService, lazyService) {
        this.route = route;
        this.router = router;
        this.subscribeService = subscribeService;
        this.platformService = platformService;
        this.lazyService = lazyService;
        this.orderActions = [];
        this.defaultTarget = 'orderPage';
        // If there are deeplink actions in URL, will process immediately (listening router event) by calling deeplinkManager.run
        // We can delay the immediate process by set it = false in the page constructor. And let the page to do run process by itself.
        // deeplinkManager.run should run once in a time
        this.processActionsInFirstRoute = true;
    }
    popOrderActions() {
        var result = this.orderActions;
        this.orderActions = [];
        return result;
    }
    processUrl(removeParams = false) {
        var params = this.route.snapshot.queryParams;
        var keepParams = {};
        var count = 0;
        for (const field in params) {
            const value = params[field];
            switch (field) {
                case 'addItemId':
                    this.addItemIds(value);
                    count++;
                    break;
                case 'addDiscountCode':
                    this.addDiscountCodes(value);
                    count++;
                    break;
                case 'addDiscount':
                    this.addDiscount(value);
                    count++;
                    break;
                case 'addOfferId':
                    this.addOfferId(value);
                    count++;
                    break;
                case 'sessionId':
                case 'sid':
                    this.addSid(value);
                    count++;
                    break;
                case 'addCouponCode':
                    this.addPendingCouponCode(value, true, 'any');
                    count++;
                    break;
                /*
                Uncomment this when miniapp is stable
                case "random":

                    count++;
                    break;
                */
                default:
                    keepParams[field] = value;
                    break;
            }
        }
        if (removeParams && count > 0) {
            this.removeParams(keepParams);
        }
        console.log('pending order actions', this.orderActions);
    }
    removeParams(keepParams) {
        console.log('keeping params', keepParams);
        this.router.navigate([], {
            relativeTo: this.route,
            queryParams: keepParams,
            replaceUrl: true,
        });
    }
    addSid(sid) {
        console.log('setting cookie for sid!', sid);
        // if (!sid) return;
        _common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.setLocal('session', sid);
    }
    addItemIds(itemIds) {
        console.log('addItemIds', itemIds);
        var splits = itemIds.split(',');
        for (let itemId of splits) {
            this.addPendingItem(itemId, false);
        }
    }
    addPendingItem(itemId, autoExecute, isRecommend = false, target = this.defaultTarget) {
        var action = {
            action: 'addItem',
            params: {
                itemId: itemId,
                isRecommend,
            },
            auto: autoExecute,
            target
        };
        // this.orderActions.push(action);
        this.pushToOrderActions(action);
    }
    /**
     * Add search result item to pending action.
     * Usually it happens if in menu first flow and not confirmed, then user want to add item from the search result.
     *
     * @param itemId
     * @param autoExecute
     */
    addPendingSearchItem(item, autoExecute, target = this.defaultTarget) {
        const action = {
            action: 'addSearchItem',
            params: {
                itemId: item.id,
                itemObj: item
            },
            auto: autoExecute,
            target
        };
        this.orderActions = [action];
    }
    /**
     * @description: the result about checking offer.reward.discount.conditons will be return by calulation.json
     *  some benefits about offer.reward.discount  will be return by caculation.json
     * @return {*}
     * @param offer
     * @param autoExecute
     * @param flow
     * @param offerId
     * @param target
     */
    addPendingCrmOffer(offer, autoExecute, flow = 'order', offerId, target = this.defaultTarget) {
        var action = {
            action: 'addCrmOffer',
            params: {
                offer,
                flow,
                offerId,
            },
            auto: autoExecute,
            target
        };
        // this.orderActions.push(action);
        this.pushToOrderActions(action);
    }
    addDiscountCodes(codes) {
        console.log('addDiscountCodes', codes);
        var splits = codes.split(',');
        for (let code of splits) {
            this.addPendingDiscountCodes(code, false);
        }
    }
    addDiscount(discount) {
        console.log('addDiscount', discount);
        this.addPendingDiscount(discount, false);
    }
    addPendingDiscount(discount, autoExecute, flow = 'order', target = this.defaultTarget) {
        // flow = order   -> go to order page   , flow = "checkout" -> go to cart page
        var action = {
            action: 'addDiscount',
            params: {
                discount: discount,
                flow: flow,
            },
            auto: autoExecute,
            target
        };
        // this.orderActions.push(action);
        this.pushToOrderActions(action);
    }
    addPendingDiscountCodes(code, autoExecute, target = this.defaultTarget) {
        var action = {
            action: 'addDiscountCodes',
            params: {
                code: code,
            },
            auto: autoExecute,
            target
        };
        // this.orderActions.push(action);
        this.pushToOrderActions(action);
    }
    addPendingOrder(order, autoExecute, target = this.defaultTarget) {
        var action = {
            action: 'addOrder',
            params: {
                order: order,
            },
            auto: autoExecute,
            target
        };
        // this.orderActions.push(action);
        this.pushToOrderActions(action);
    }
    addPendingOrderItem(orderitem, autoExecute, target = this.defaultTarget) {
        var action = {
            action: 'addOrderItem',
            params: {
                orderitem: orderitem,
            },
            auto: autoExecute,
            target
        };
        // this.orderActions.push(action);
        this.pushToOrderActions(action);
    }
    addPendingPreorder(order, autoExecute, target = this.defaultTarget) {
        var action = {
            action: 'addPreorder',
            params: {
                order: order,
            },
            auto: autoExecute,
            target
        };
        // this.orderActions.push(action);
        this.pushToOrderActions(action);
    }
    addPendingNavigation(uri, autoExecute, target = this.defaultTarget) {
        var action = {
            action: 'navigation',
            params: {
                uri
            },
            auto: autoExecute,
            target
        };
        this.pushToOrderActions(action);
    }
    addPendingCouponCode(code, autoExecute, target = this.defaultTarget) {
        var action = {
            action: 'addCouponCode',
            params: {
                code
            },
            auto: autoExecute,
            target
        };
        this.pushToOrderActions(action);
    }
    removePendingActions() {
        this.orderActions = [];
    }
    addOfferId(offerId) {
        console.log('addOfferId', offerId);
        let offerIdSplit = offerId.split(',');
        for (let offerId of offerIdSplit) {
            console.log('deeplink offer', offerId);
            this.addPendingCrmOffer(null, false, 'order', offerId);
        }
    }
    // '{deviceId=aa8caf7598efcc65, source=600001, addItemId=null, memberCode=null, universalLink=https://fairwoodappsit.fairwood.com.hk/aigens, addDiscountCode=null, sessionId=, addOfferId=null, pushId=null}'
    javaMapTojsObject(obj) {
        if (!obj)
            return {};
        let r = {};
        if (obj.startsWith('{'))
            obj = obj.replace('{', '');
        if (obj.endsWith('}'))
            obj = obj.substring(obj.length - 1, 0);
        obj = obj && obj.trim() || "";
        if (~obj.indexOf(',')) {
            const seps = obj.split(',');
            seps.forEach(sep => {
                sep = sep && sep.trim() || "";
                if (~sep.indexOf('=')) {
                    const Ss = sep.split('=');
                    const Ss_0 = Ss[0];
                    // let Ss_1 = Ss[1].trim();
                    let Ss_1_ = sep.substring(Ss_0.length + 1);
                    let Ss_1 = Ss_1_ && Ss_1_.trim() || "";
                    try {
                        Ss_1 = JSON.parse(Ss_1);
                    }
                    catch (error) {
                    }
                    r[Ss_0.trim()] = Ss_1;
                }
            });
        }
        else if (~obj.indexOf('=')) {
            const v = obj.split('=');
            const vs_0 = v[0];
            let vs_1_ = obj.substring(vs_0.length + 1);
            let vs_1 = vs_1_ && vs_1_.trim() || "";
            try {
                vs_1 = JSON.parse(vs_1);
            }
            catch (error) {
            }
            r[vs_0.trim()] = vs_1;
        }
        return r;
    }
    javaDeeplinkMapTojsObject(obj) {
        if (!obj)
            return {};
        let r = {};
        if (obj.startsWith('{'))
            obj = obj.replace('{', '');
        if (obj.endsWith('}'))
            obj = obj.substring(obj.length - 1, 0);
        const pre = "add";
        const appPre = ", add";
        if (~obj.indexOf(appPre)) {
            const seps = obj.split(appPre);
            seps.forEach(sep => {
                if (~sep.indexOf('=')) {
                    const index = sep.indexOf("=");
                    let Ss_0 = sep.substring(index, -1);
                    let Ss_1 = sep.substring(index + 1).trim();
                    try {
                        Ss_1 = JSON.parse(Ss_1);
                    }
                    catch (error) {
                    }
                    if (!Ss_0.startsWith(pre))
                        Ss_0 = `${pre}${Ss_0}`;
                    r[Ss_0.trim()] = Ss_1;
                }
            });
        }
        else if (~obj.indexOf('=')) {
            const index = obj.indexOf("=");
            let vs_0 = obj.substring(index, -1);
            let vs_1 = obj.substring(index + 1).trim();
            try {
                vs_1 = JSON.parse(vs_1);
            }
            catch (error) {
            }
            if (!vs_0.startsWith(pre))
                vs_0 = `${pre}${vs_0}`;
            r[vs_0.trim()] = vs_1;
        }
        return r;
    }
    checkContainerMember() {
        if (this.platformService.isSDK()) {
            var containerService = this.lazyService.getService("ContainerService");
            if (!containerService)
                return;
            containerService === null || containerService === void 0 ? void 0 : containerService.init();
            containerService.getMember().then((m) => {
                let member = (m === null || m === void 0 ? void 0 : m.member) || {};
                if (typeof member === 'string') {
                    console.log("is string member");
                    try {
                        member = this.javaMapTojsObject(member);
                    }
                    catch (error) {
                    }
                }
                console.log("container member", m, member);
                // member.sessionId = "eb1408b9-06f0-46fd-887a-b8101c421d97";
                // console.log("SDK_MEMBER_CONTEXT member1 ", member);
                // this.configService.clearAll();
                // var sid = member?.sessionId;
                if (m) { // no need to check sid if null, just need to check if sdk, because sid=null means outside the app is logged-out
                    // this.memberContextManager.setMemberData(member);
                    this.addSid(member.sessionId);
                }
                // // deviceId from app
                // const deviceId = member?.deviceId;
                // if (deviceId) {
                //     this.configService.setDeviceId(deviceId);
                // }
                // const name = member?.name;
                // if (name) {
                //     this.configService.setLocal('aigens-guest-name', name);
                // }
                // const email = member?.email;
                // if (email) {
                //     this.configService.setLocal('aigens-guest-email', email);
                // }
                // const phone = member?.phone;
                // if (phone) {
                //     this.configService.setLocal('aigens-guest-phone', phone);
                // }
                // let member:Dictionary<String, Any> = [
                //     "memberCode" : "<crmMemberId>",
                //     "source" : "<merchant>",
                //     "sessionId" : "<sessionId>",
                //     "pushId": "<applePushToken>",
                //     "deviceId": "<deviceId>",
                //     "universalLink": "<start with https://xxxx>",
                //     "appleMerchantId": "<YourAppleMerchantId>",
                //     "cachedOrderContext": true
                //     "name": "xx",
                //     "email": "xxd",
                //     "phone": "xxx",
                //      "closedData": string (object)
                // ]
                if (member === null || member === void 0 ? void 0 : member.closedData) {
                    try {
                        member.closedData = JSON.parse(member === null || member === void 0 ? void 0 : member.closedData);
                    }
                    catch (error) {
                    }
                }
                this.deeplinkMember = member;
                window['cachedOrderContext'] = (member === null || member === void 0 ? void 0 : member.cachedOrderContext) == false ? false : true;
                this.subscribeService.next(this.subscribeService.SDK_MEMBER_CONTEXT, member);
            });
            containerService.getDeeplink().then(d => {
                if (!DeepLinkService.CanParseSdkDepplink)
                    return;
                console.log("deeplink:", d);
                let deeplink = (d === null || d === void 0 ? void 0 : d.deeplink) || {};
                if (typeof deeplink === 'string') {
                    try {
                        deeplink = this.javaDeeplinkMapTojsObject(deeplink);
                    }
                    catch (error) {
                    }
                }
                // const addItemId = deeplink?.addItemId || "600001-288-67340191";
                const addItemId = deeplink === null || deeplink === void 0 ? void 0 : deeplink.addItemId;
                if (addItemId)
                    this.addItemIds(addItemId);
                const addDiscountCode = deeplink === null || deeplink === void 0 ? void 0 : deeplink.addDiscountCode;
                // const addDiscountCode = deeplink?.addDiscountCode || "e096a44f-4a3d-41b1-9ce6-8369500d9e98";
                if (addDiscountCode)
                    this.addDiscountCodes(addDiscountCode);
                const addOfferId = deeplink === null || deeplink === void 0 ? void 0 : deeplink.addOfferId;
                // const addOfferId = deeplink?.addOfferId || "5649565948575744-383180002";
                if (addOfferId)
                    this.addOfferId(addOfferId);
                const addCouponCode = deeplink === null || deeplink === void 0 ? void 0 : deeplink.addCouponCode;
                if (addCouponCode)
                    this.addPendingCouponCode(addCouponCode, true, 'any');
                const addReorder = deeplink === null || deeplink === void 0 ? void 0 : deeplink.addReorder;
                console.log("deeplink:", deeplink);
                if (addReorder) {
                    let order = addReorder;
                    try {
                        if (typeof addReorder == 'string') {
                            order = JSON.parse(addReorder);
                        }
                    }
                    catch (error) {
                        order = null;
                        console.log('addReorder error:', error);
                    }
                    if (order) {
                        this.addPendingOrder(order, false);
                    }
                }
            });
        }
    }
    pushToOrderActions(action) {
        action.id = Math.random(); // add id with unique identifier
        this.orderActions.push(action);
    }
    /**
     * Filter order action by target and remove it from deeplink action list
     *
     * if strict is true (default false) then it will only get action with the target only. Otherwise, will fetch all.
     */
    getOrderActionsByTarget(target, strict = false) {
        let filteredActions = [];
        if (strict) {
            filteredActions = this.orderActions.filter(f => f.target == target);
        }
        else {
            filteredActions = this.orderActions.filter(f => f.target == target || f.target == 'any');
        }
        // remove filtered actions from list
        this.orderActions = this.orderActions.filter(f => !filteredActions.find(fa => fa.id == f.id));
        console.log('to be executed DL actions = ', filteredActions);
        console.log('rest of DL actions = ', this.orderActions);
        return filteredActions;
    }
}
DeepLinkService.AFTER_LOGIN_SUCCESS_TARGET = 'afterLoginSuccess';
// 如果是callback的link就不用再處理, 說明打開時已經處理過
DeepLinkService.CanParseSdkDepplink = true;
DeepLinkService.ɵfac = function DeepLinkService_Factory(t) { return new (t || DeepLinkService)(_angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵinject"](_angular_router__WEBPACK_IMPORTED_MODULE_5__.ActivatedRoute), _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵinject"](_angular_router__WEBPACK_IMPORTED_MODULE_5__.Router), _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵinject"](_subscribe_service__WEBPACK_IMPORTED_MODULE_1__.SubscribeService), _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵinject"](_platform_service__WEBPACK_IMPORTED_MODULE_2__.PlatformService), _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵinject"](_lazy_service__WEBPACK_IMPORTED_MODULE_3__.LazyService)); };
DeepLinkService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineInjectable"]({ token: DeepLinkService, factory: DeepLinkService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 60040:
/*!*************************************************************!*\
  !*** ./projects/core/src/app/pure/services/lazy.service.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LazyService": () => (/* binding */ LazyService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);


//WARNING: DO NOT MODIFY THIS CLASS
//WARNING: DO NOT ADD DEPENDENCY
class LazyService {
    constructor(injector) {
        this.injector = injector;
    }
    setService(name, service) {
        LazyService.loadedServices[name] = service;
        console.log("setting lazy loaded service", name);
    }
    getService(name) {
        return LazyService.loadedServices[name];
    }
}
LazyService.loadedModules = {};
LazyService.loadedServices = {};
LazyService.ɵfac = function LazyService_Factory(t) { return new (t || LazyService)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injector)); };
LazyService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({ token: LazyService, factory: LazyService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 69574:
/*!************************************************************************!*\
  !*** ./projects/core/src/app/pure/services/navigation-menu.service.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NavigationMenuService": () => (/* binding */ NavigationMenuService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _subscribe_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./subscribe.service */ 47074);
/* harmony import */ var _platform_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./platform.service */ 45485);



const DEFAULT_SIDE_MENU = [
    {
        title: 'app.tabs.home',
        route: '/app/home/brand/@brandId',
        icon: { name: 'nav-bar-home-outline' },
        match: 'home',
        channels: ['app'],
        isHome: true
    },
    {
        title: 'app.tabs.inbox',
        route: '/app/inbox/brand/@brandId',
        icon: { name: 'side-menu-inbox-outline' },
        channels: ['app'],
        features: ['crm:inbox'],
        crmEnabled: true,
        match: 'inbox'
    },
    {
        title: 'app.tabs.news',
        route: '/app/news/brand/@brandId',
        icon: { name: 'side-menu-news-outline' },
        channels: ['app'],
        features: ['crm:news'],
        match: 'news'
    },
    {
        title: 'app.tabs.ordering',
        route: '/app/ordering/brand/@brandId',
        icon: { name: 'nav-bar-ordering-outline' },
        channels: ['app'],
        features: ['brand:byod'],
        match: 'ordering'
    },
    {
        title: 'app.tabs.stores',
        route: '/app/stores/brand/@brandId',
        icon: { name: 'nav-bar-store-list-outline' },
        channels: ['app'],
        match: 'stores'
    },
    {
        title: 'app.tabs.reward',
        route: '/app/rewards/brand/@brandId',
        icon: { name: 'nav-bar-reward-outline' },
        channels: ['app'],
        features: ['brand:reward'],
        crmEnabled: true,
        match: 'rewards'
    },
    {
        title: 'app.tabs.stamps',
        route: '/app/stamps/brand/@brandId',
        icon: { name: 'side-menu-stamps-outline' },
        channels: ['app'],
        features: ['crm:stampcard'],
        crmEnabled: true,
        match: 'stamps'
    },
    {
        title: 'app.tabs.membership',
        route: '/app/membership/brand/@brandId',
        icon: { name: 'nav-bar-member-outline' },
        channels: ['app'],
        features: ['brand:crm'],
        crmEnabled: true,
        match: 'membership',
    },
    {
        title: 'app.tabs.order-history',
        route: '/app/reorder/brand/@brandId',
        icon: { name: 'nav-bar-order-history-outline' },
        channels: ['app'],
        features: ['brand:byod'],
        match: 'reorder'
    },
    {
        title: 'app.tabs.settings',
        route: '/app/settings/brand/@brandId',
        icon: { name: 'side-menu-settings-outline' },
        channels: ['app'],
        match: 'settings'
    },
    {
        title: 'app.tabs.customer-survey',
        link: 'surveyApp',
        icon: { name: 'side-menu-customer-survey-outline' },
        channels: ['app'],
    },
    {
        title: 'directory.components.side-menu.home',
        route: '#home',
        channels: ['web', 'mobile'],
    },
    {
        title: 'directory.components.side-menu.ordering',
        route: '#ordering',
        channels: ['web', 'mobile'],
    },
    {
        title: 'directory.components.side-menu.rewards',
        route: 'modal:crm/brand/@brandId/reward',
        channels: ['web', 'mobile'],
        back: true,
        crmEnabled: true,
        displayUserGroups: ['member'],
        features: ['brand:reward'],
    },
    {
        title: 'directory.components.side-menu.news',
        route: 'modal:crm/brand/@brandId/news',
        channels: ['web', 'mobile'],
        back: true,
        features: ['crm:news'],
    },
    {
        title: 'directory.components.side-menu.stamp',
        route: 'modal:crm/brand/@brandId/stamp',
        channels: ['web', 'mobile'],
        back: true,
        features: ['crm:stampcard'],
        crmEnabled: true,
        displayUserGroups: ['member']
    },
    {
        title: 'directory.components.side-menu.inbox',
        route: 'modal:crm/brand/@brandId/inbox',
        channels: ['web', 'mobile'],
        back: true,
        features: ['crm:inbox'],
        crmEnabled: true,
        displayUserGroups: ['member']
    },
    {
        title: 'directory.components.side-menu.order-history',
        route: '#orderHistory',
        channels: ['web', 'mobile'],
        features: ['brand:byod'],
    },
    {
        title: 'directory.components.side-menu.queue',
        route: 'modal:directory/queue',
        channels: ['web', 'mobile'],
        back: true,
        features: ['brand:queuing'],
    },
    {
        title: 'directory.components.side-menu.referral',
        route: 'modal:crm/brand/@brandId/membership/referral',
        channels: ['web', 'mobile'],
        back: true,
        features: ['crm:referral'],
    },
    // {
    //     title: 'directory.components.side-menu.settings',
    //     route: 'modal:crm/brand/@brandId/settings',
    //     channels: ['web', 'mobile'],
    //     back: true,
    // },
];
const DEFAULT_COURT_SIDE_MENU = [
    {
        title: 'directory.components.side-menu.home',
        route: '#home',
        channels: ['web', 'mobile'],
    },
    {
        title: 'directory.components.side-menu.ordering',
        route: 'modal:directory/court/@courtId',
        channels: ['web', 'mobile'],
    },
    {
        title: 'directory.components.side-menu.order-history',
        route: '#orderHistory',
        channels: ['web', 'mobile'],
    }
];
const DEFAULT_SIDE_MENU_STICKY = [
    {
        title: 'directory.components.side-menu.login-or-signup',
        route: '#login',
        channels: ['web', 'mobile'],
        crmEnabled: true,
        displayUserGroups: ['guest']
    },
    {
        title: 'directory.components.side-menu.login-or-signup',
        route: '#login',
        channels: ['app'],
        icon: { name: 'side-menu-login-outline' },
        crmEnabled: true,
        displayUserGroups: ['guest']
    }
];
const DEFAULT_TABBAR = [
    // App
    {
        title: 'app.tabs.home',
        route: '/app/home/brand/@brandId',
        icon: { name: 'nav-bar-home-outline' },
        channels: ['app'],
        match: 'home',
        isHome: true,
    },
    {
        title: 'app.tabs.membership',
        route: '/app/membership/brand/@brandId',
        icon: { name: 'nav-bar-member-outline' },
        channels: ['app'],
        match: 'membership'
    },
    {
        title: 'app.tabs.ordering',
        route: '/app/ordering/brand/@brandId',
        icon: { name: 'nav-bar-ordering-outline' },
        channels: ['app'],
        match: 'ordering'
    },
    {
        title: 'app.tabs.stores',
        route: '/app/stores/brand/@brandId',
        icon: { name: 'nav-bar-store-list-outline' },
        channels: ['app'],
        match: 'stores'
    },
    {
        title: 'app.tabs.order-history',
        route: '/app/reorder/brand/@brandId',
        icon: { name: 'nav-bar-order-history-outline' },
        channels: ['app'],
        match: 'reorder'
    },
    // Miniapp
    {
        title: 'miniapp.tabs.home',
        route: '/miniapp/home/brand/@brandId',
        icon: { name: 'miniapp-home' },
        channels: ['miniapp'],
        match: 'home',
        isHome: true,
    },
    {
        title: 'miniapp.tabs.coupons',
        route: '/miniapp/coupons/brand/@brandId',
        icon: { name: 'miniapp-reward' },
        channels: ['miniapp'],
        match: 'coupons'
    },
    {
        title: 'miniapp.tabs.order',
        route: '/miniapp/selectmode/brand/@brandId',
        icon: { name: 'miniapp-ordering' },
        channels: ['miniapp'],
        match: 'selectmode'
    },
    {
        title: 'miniapp.tabs.reorder',
        route: '/miniapp/reorder/brand/@brandId',
        icon: { name: 'miniapp-history' },
        channels: ['miniapp'],
        match: 'reorder'
    },
    {
        title: 'miniapp.tabs.account',
        route: '/miniapp/account/brand/@brandId',
        icon: { name: 'miniapp-member' },
        channels: ['miniapp'],
        match: 'account'
    },
];
class NavigationMenuService {
    constructor(context, platformService) {
        this.context = context;
        this.platformService = platformService;
    }
    isMatchChannel(item, chennel) {
        var _a;
        if (!item.channels || ((_a = item.channels) === null || _a === void 0 ? void 0 : _a.length) <= 0) {
            return true;
        }
        return item.channels.indexOf(chennel) >= 0;
    }
    patchTabs(items) {
        const newItems = [...items];
        newItems.forEach((item) => {
            var _a;
            if (item.route) {
                item.route = this.patchRoute(item);
            }
            if (((_a = item.children) === null || _a === void 0 ? void 0 : _a.length) > 0) {
                item.children = this.patchTabs(item.children);
            }
        });
        return newItems;
    }
    patchRoute(item) {
        var _a, _b, _c;
        return item.route.replace(/@brandId/g, '' + ((_a = this.context) === null || _a === void 0 ? void 0 : _a['brandId'])).replace(/@groupId/g, '' + ((_b = this.context) === null || _b === void 0 ? void 0 : _b['groupId'])).replace(/@courtId/g, '' + ((_c = this.context) === null || _c === void 0 ? void 0 : _c['courtId']));
    }
    paramsToObject(url = '') {
        var _a, _b;
        try {
            const paramsString = (_a = url.match(/\?\S+=\S+/g)) !== null && _a !== void 0 ? _a : '';
            if (paramsString.length <= 0) {
                return {};
            }
            const entries = new URLSearchParams((_b = paramsString[0]) === null || _b === void 0 ? void 0 : _b.slice(1));
            const result = {};
            for (const [key, value] of entries) { // each 'entry' is a [key, value] tupple
                result[key] = value;
            }
            return result;
        }
        catch (e) {
            return {};
        }
    }
    getNavParams(url = '', key = '') {
        var _a;
        const queryParams = this.paramsToObject(url);
        if (key in queryParams) {
            return queryParams[key];
        }
        const splited = url.replace(/\?\S+=\S+/g, '').split('/');
        const keyIndex = splited.indexOf(key);
        if (keyIndex < 0 || keyIndex >= splited.length) {
            return null;
        }
        return (_a = splited[keyIndex + 1]) !== null && _a !== void 0 ? _a : null;
    }
    getTabbarItems(channel) {
        var _a;
        const nav = this.getDeviceConfig('nav');
        const tabbar = (_a = nav === null || nav === void 0 ? void 0 : nav.tabbar) !== null && _a !== void 0 ? _a : DEFAULT_TABBAR;
        if (!tabbar) {
            return [];
        }
        const items = tabbar.filter(item => this.isMatchChannel(item, channel));
        return this.patchTabs(items);
    }
    getSideMenuItems(channel) {
        var _a;
        const nav = this.getDeviceConfig('nav');
        const sideMenu = (_a = nav === null || nav === void 0 ? void 0 : nav['side-menu']) !== null && _a !== void 0 ? _a : DEFAULT_SIDE_MENU;
        if (!sideMenu) {
            return [];
        }
        const items = sideMenu.filter(item => this.isMatchChannel(item, channel));
        return this.patchTabs(items);
    }
    getSideMenuStickyItems(channel) {
        var _a;
        const nav = this.getDeviceConfig('nav');
        const sideMenu = (_a = nav === null || nav === void 0 ? void 0 : nav['side-menu-sticky']) !== null && _a !== void 0 ? _a : DEFAULT_SIDE_MENU_STICKY;
        if (!sideMenu) {
            return [];
        }
        const items = sideMenu.filter(item => this.isMatchChannel(item, channel));
        return this.patchTabs(items);
    }
    getHomeItems(channel) {
        return this.patchTabs([]);
    }
    matchUserGroups(item, isMember = false) {
        if (!item.displayUserGroups || item.displayUserGroups.length < 0) {
            return true;
        }
        if (item.displayUserGroups.indexOf('guest') >= 0 && !isMember) {
            return true;
        }
        if (item.displayUserGroups.indexOf('member') >= 0 && isMember) {
            return true;
        }
        return false;
    }
    shouldDisplay(item, isMember = false, currentUrl = '') {
        var _a, _b, _c;
        if (!this.matchUserGroups(item, isMember)) {
            return false;
        }
        const currentMode = this.getNavParams(currentUrl, 'mode');
        if (!currentMode && item.requireMode) {
            return false;
        }
        if (currentMode && ((_a = item.modes) === null || _a === void 0 ? void 0 : _a.length) > 0) {
            if (item.modes.indexOf(currentMode) < 0) {
                return false;
            }
        }
        if (item.crmEnabled && !this.crmAvailable(currentUrl)) {
            return false;
        }
        if (!this.checkFeatures(item)) {
            return false;
        }
        if (!item.route) {
            if (item.link) {
                if (!(item.link in ((_b = this.context['brand']) === null || _b === void 0 ? void 0 : _b['links']))) {
                    return false;
                }
            }
            else if (!(item === null || item === void 0 ? void 0 : item.children) || ((_c = item === null || item === void 0 ? void 0 : item.children) === null || _c === void 0 ? void 0 : _c.length) <= 0) {
                return false;
            }
        }
        return true;
    }
    getUrl(item) {
        var _a, _b, _c;
        let url = item === null || item === void 0 ? void 0 : item.route;
        if (item.link) {
            url = (_c = (_b = (_a = this.context['brand']) === null || _a === void 0 ? void 0 : _a['links']) === null || _b === void 0 ? void 0 : _b[item.link]) === null || _c === void 0 ? void 0 : _c['url'];
        }
        if (!url) {
            console.error('URL not found');
            return '';
        }
        return url;
    }
    getHomePath(channel) {
        var _a;
        let menuItems = this.getSideMenuItems(channel);
        let homeItem = menuItems.find((item) => {
            return item === null || item === void 0 ? void 0 : item.isHome;
        });
        if (homeItem) {
            return homeItem === null || homeItem === void 0 ? void 0 : homeItem.route;
        }
        menuItems = this.getTabbarItems(channel);
        homeItem = menuItems.find((item) => {
            return item === null || item === void 0 ? void 0 : item.isHome;
        });
        return (_a = homeItem === null || homeItem === void 0 ? void 0 : homeItem.route) !== null && _a !== void 0 ? _a : null;
    }
    hasRouteMatch(item, currentUrl = '') {
        if (item.match instanceof RegExp) {
            return !!currentUrl.match(item.match);
        }
        if (this.platformService.isSDK() && item.sdkMatch) {
            if (item.sdkMatch instanceof RegExp) {
                return !!currentUrl.match(item.sdkMatch);
            }
            const sdkMatches = (item.sdkMatch).split(',');
            return sdkMatches.some(match => {
                return currentUrl.indexOf(match) >= 0;
            });
        }
        const matches = ((item === null || item === void 0 ? void 0 : item.match) || "").split(',');
        return (item === null || item === void 0 ? void 0 : item.match) && matches.some(match => {
            return currentUrl.indexOf(match) >= 0;
        });
        // return currentUrl.indexOf(item.match) >= 0;
    }
    isRoot(currentUrl, channel) {
        const items = this.getTabbarItems(channel);
        const back = this.getNavParams(currentUrl, 'back');
        return !back && items.some((item) => {
            return this.hasRouteMatch(item, currentUrl);
        });
    }
    isRequireLogin(item, isMember = false) {
        var _a;
        if (isMember) {
            return false;
        }
        return (_a = item === null || item === void 0 ? void 0 : item.member) !== null && _a !== void 0 ? _a : false;
    }
    crmAvailable(currentUrl = '') {
        var _a, _b;
        if (((_b = (_a = this.context['brand']) === null || _a === void 0 ? void 0 : _a.features) === null || _b === void 0 ? void 0 : _b.indexOf('login')) < 0) {
            return false;
        }
        const crm = this.context['crm'];
        if (!crm) {
            return false;
        }
        if (crm === null || crm === void 0 ? void 0 : crm['disabled']) {
            return false;
        }
        if (crm.modes == null || crm.modes.length === 0) {
            return true;
        }
        const mode = this.getNavParams(currentUrl, 'mode');
        if (!mode) {
            return true;
        }
        return crm.modes.indexOf(mode) >= 0;
    }
    checkFeatures(item) {
        var _a;
        if (!item.features || ((_a = item.features) === null || _a === void 0 ? void 0 : _a.length) <= 0) {
            return true;
        }
        const brandFeature = [];
        const crmFeatures = [];
        item.features.forEach((featureItem) => {
            const [key, name] = featureItem.split(':');
            if (key === 'brand') {
                brandFeature.push(name);
            }
            else if (key === 'crm') {
                crmFeatures.push(name);
            }
        });
        const brandMatch = (brandFeature === null || brandFeature === void 0 ? void 0 : brandFeature.length) <= 0 || (brandFeature === null || brandFeature === void 0 ? void 0 : brandFeature.every((feature) => {
            var _a, _b;
            return ((_b = (_a = this.context['brand']) === null || _a === void 0 ? void 0 : _a.features) === null || _b === void 0 ? void 0 : _b.indexOf(feature)) >= 0;
        }));
        if (!brandMatch) {
            return false;
        }
        const crmMatch = (crmFeatures === null || crmFeatures === void 0 ? void 0 : crmFeatures.length) <= 0 || (crmFeatures === null || crmFeatures === void 0 ? void 0 : crmFeatures.every((feature) => {
            var _a, _b;
            return ((_b = (_a = this.context['crm']) === null || _a === void 0 ? void 0 : _a.features) === null || _b === void 0 ? void 0 : _b.indexOf(feature)) >= 0;
        }));
        if (!crmMatch) {
            return false;
        }
        return true;
    }
    getDeviceConfig(key) {
        var _a, _b, _c, _d;
        return (_d = (_c = (_b = (_a = this.context) === null || _a === void 0 ? void 0 : _a['config']) === null || _b === void 0 ? void 0 : _b.data) === null || _c === void 0 ? void 0 : _c[key]) !== null && _d !== void 0 ? _d : null;
    }
}
NavigationMenuService.ɵfac = function NavigationMenuService_Factory(t) { return new (t || NavigationMenuService)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_subscribe_service__WEBPACK_IMPORTED_MODULE_0__.SubscribeService), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵinject"](_platform_service__WEBPACK_IMPORTED_MODULE_1__.PlatformService)); };
NavigationMenuService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineInjectable"]({ token: NavigationMenuService, factory: NavigationMenuService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 45485:
/*!*****************************************************************!*\
  !*** ./projects/core/src/app/pure/services/platform.service.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PlatformService": () => (/* binding */ PlatformService)
/* harmony export */ });
/* harmony import */ var _angular_cdk_layout__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/cdk/layout */ 39910);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);



//WARNING: DO NOT MODIFY THIS CLASS
//WARNING: DO NOT ADD DEPENDENCY
class PlatformService {
    constructor(injector) {
        this.platform = "mobile";
        this.platformClasses = "mobile";
        this.platformLimited = false;
        this.menuChannel = 'mobile';
        this.webp = false;
        this.onpremise = false;
        this.enums = ["mobile", "tablet", "desktop"];
        this.breakpointObserver = injector.get(_angular_cdk_layout__WEBPACK_IMPORTED_MODULE_0__.BreakpointObserver);
        this.appRef = injector.get(_angular_core__WEBPACK_IMPORTED_MODULE_1__.ApplicationRef);
        //special handling to remember network = cn
        if (this.haveQuery("network=cn") || window.location.host.indexOf(".cn") != -1) {
            this.network = "cn";
            var aigens = window['aigens'];
            if (aigens) {
                aigens.network = "cn";
            }
        }
        //recognize onpremise flag
        if (this.haveQuery("onpremise=true")) {
            this.setReferral("scan");
            this.onpremise = true;
        }
        this.qrId = this.getQueryParam("qrId");
        this.alipayAppId = this.getQueryParam("alipayAppId");
        var channel = this.getQueryParam("channel");
        if (channel && !this.isSDK()) {
            this.menuChannel = channel;
            this.source = channel;
        }
        var container = this.getQueryParam("container");
        if (container) {
            this.container = container;
        }
        console.log("PlatformService construct", this.network, this.referral, this.qrId);
        this.checkWebp();
        this.breakpointObserver.observe([
            _angular_cdk_layout__WEBPACK_IMPORTED_MODULE_0__.Breakpoints.HandsetPortrait,
            _angular_cdk_layout__WEBPACK_IMPORTED_MODULE_0__.Breakpoints.HandsetLandscape,
            _angular_cdk_layout__WEBPACK_IMPORTED_MODULE_0__.Breakpoints.TabletPortrait,
            _angular_cdk_layout__WEBPACK_IMPORTED_MODULE_0__.Breakpoints.TabletLandscape,
            _angular_cdk_layout__WEBPACK_IMPORTED_MODULE_0__.Breakpoints.Web
        ]).subscribe(result => {
            if (result.matches) {
                //console.log("BREAKPOINTS", result);
                this.updateLayout();
            }
        });
        this.updateLayout();
    }
    setReferral(referral) {
        this.referral = referral;
        var aigens = window['aigens'];
        if (aigens) {
            aigens.referral = referral;
        }
    }
    isMobile() {
        var width = window.innerWidth;
        return width < 600;
    }
    isTablet() {
        var width = window.innerWidth;
        return width >= 600 && width < 840;
    }
    isSmallTabletHeight() {
        var height = window.innerHeight;
        return height >= 500 && height < 875;
    }
    isDesktop() {
        var width = window.innerWidth;
        return width >= 840;
    }
    isKiosk() {
        return this.platform == 'kiosk';
    }
    isTestBuild() {
        return (0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.isDevMode)();
    }
    isNative() {
        return false;
    }
    isSDK() {
        return window['isSDK'] == true;
    }
    static isSDK() {
        return window['isSDK'] == true;
    }
    getNativePlatform() {
        return "web";
    }
    getAppInfo() {
        return Promise.resolve({});
    }
    getAppInfoInstant() {
        return null;
    }
    getNativeAppId() {
        return null;
    }
    getVersion() {
        var aigens = window['aigens'];
        if (aigens === null || aigens === void 0 ? void 0 : aigens.version) {
            return aigens.version;
        }
        return "unknown";
    }
    isEmbedded() {
        //return true;
        //check if current web app is embedded by other containers
        return this.isAliApp();
    }
    haveQuery(keyValue) {
        var search = window.location.search;
        if (search && search.indexOf(keyValue) >= 0) {
            return true;
        }
        return false;
    }
    getQueryParam(name) {
        var p = null;
        try {
            const urlParams = new URLSearchParams(window.location.search);
            p = urlParams.get(name);
        }
        catch (e) {
        }
        return p;
    }
    isOnPremise() {
        if (!this.referral) {
            return false;
        }
        return "scan" == this.referral;
    }
    getMenuChannel() {
        if (this.isAliApp())
            return "miniapp";
        if (this.isSDK())
            return 'app';
        if (this.menuChannel)
            return this.menuChannel;
        return "mobile";
    }
    //channel is null for non specific, it's not same as source
    getChannel() {
        if (this.isAliApp() || this.getSource() == 'miniapp') {
            return "miniapp";
        }
        else if (this.isSDK()) {
            return 'app';
        }
        return this.menuChannel || null;
    }
    getSource() {
        if (this.isSDK())
            return 'app';
        if (this.source)
            return this.source;
        if (this.isAliApp()) {
            return "miniapp";
        }
        return "mobile";
    }
    getReferral() {
        if (this.referral)
            return this.referral;
        return null;
    }
    getQrId() {
        if (this.qrId)
            return this.qrId;
        return null;
    }
    setContainer(container) {
        this.container = container;
        localStorage.setItem("miniContainer", container);
    }
    //TODO: fix me not hardcode hope
    getContainer() {
        if (this.container)
            return this.container;
        if (this.isAliApp()) {
            let localStorageContainer = localStorage.getItem("miniContainer");
            if (localStorageContainer)
                return localStorageContainer;
            if (this.getQueryParam("container")) {
                this.setContainer(this.getQueryParam("container"));
                return this.getQueryParam("container"); // assume miniapp DSL already added &network=cn&channel=miniapp&container= in URL
            }
        }
        return null;
    }
    getAlipayAppId() {
        if (this.alipayAppId)
            return this.alipayAppId;
        if (this.getQueryParam("alipayAppId")) {
            return this.getQueryParam("alipayAppId");
        }
        return null;
    }
    isAliApp() {
        var ua = navigator.userAgent.toLowerCase();
        var terms = ["miniprogram", "alipayide"];
        for (let t of terms) {
            if (ua.indexOf(t) >= 0) {
                return true;
            }
        }
        return false;
    }
    redrawUI() {
        this.appRef.tick();
    }
    updateLayout() {
        var pt = "mobile";
        if (this.isDesktop()) {
            pt = "desktop";
        }
        else if (this.isTablet()) {
            pt = "tablet";
        }
        //if the platform is alipayApp
        if (this.isAliApp()) {
            pt = 'mobile';
        }
        if (pt != this.platform) {
            this.setPlatform(pt);
        }
    }
    setPlatform(pt) {
        this.platform = pt;
        this.platformClasses = pt;
        var body = document.body;
        var aigens = window['aigens'];
        if (aigens)
            aigens.platform = this.platform;
        for (let p of this.enums) {
            body.classList.remove("plt-" + p);
        }
        body.classList.add("plt-" + this.platform);
        console.log("platform", this.platform);
    }
    checkLimited(platforms) {
        if (platforms.length > 0) {
            let limited = true;
            if (platforms.indexOf('mobile') >= 0 && this.isMobile()) {
                limited = false;
            }
            if (platforms.indexOf('tablet') >= 0 && this.isTablet()) {
                limited = false;
            }
            this.platformLimited = limited;
        }
    }
    isApp() {
        return this.menuChannel === 'app';
    }
    setSupport(support) {
        var aigens = window['aigens'];
        if (aigens) {
            aigens.webp = support;
        }
        this.webp = support;
    }
    checkWebp(feature = 'lossy') {
        const webpSupport = localStorage.getItem('webpSupport');
        if (webpSupport != null) {
            this.setSupport(webpSupport == 'true');
            return;
        }
        var kTestImages = {
            lossy: 'UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA',
            lossless: 'UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==',
            alpha: 'UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==',
            animation: 'UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA'
        };
        var img = new Image();
        img.onload = () => {
            //var result = (img.width > 0) && (img.height > 0);
            //callback(feature, result);
            localStorage.setItem('webpSupport', 'true');
            this.webp = true;
            console.log("webp supported");
            //if (aigens) aigens.webp = true;
            this.setSupport(true);
        };
        img.onerror = () => {
            //callback(feature, false);
            localStorage.setItem('webpSupport', 'false');
            //this.webp = false;
            this.setSupport(false);
            console.log("webp NOT supported");
        };
        img.src = "data:image/webp;base64," + kTestImages[feature];
    }
    openSettingsPage() {
        return Promise.resolve();
    }
    openExternalLink(url) {
        window.open(url, '_blank', 'noopener');
    }
}
PlatformService.ɵfac = function PlatformService_Factory(t) { return new (t || PlatformService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_1__.Injector)); };
PlatformService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineInjectable"]({ token: PlatformService, factory: PlatformService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 28759:
/*!****************************************************************!*\
  !*** ./projects/core/src/app/pure/services/routing.service.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RoutingService": () => (/* binding */ RoutingService)
/* harmony export */ });
/* harmony import */ var _tabbar_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tabbar.service */ 46297);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _platform_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./platform.service */ 45485);
/* harmony import */ var _subscribe_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./subscribe.service */ 47074);
/* harmony import */ var _navigation_menu_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./navigation-menu.service */ 69574);
/* harmony import */ var _capacitor_splash_screen__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @capacitor/splash-screen */ 82239);
/* harmony import */ var _aigens_core_src_app_pure_services_lazy_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/lazy.service */ 60040);
/* harmony import */ var _managers_setting_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../managers/setting-manager */ 74663);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @angular/core */ 3184);











//WARNING: DO NOT MODIFY THIS CLASS
//WARNING: DO NOT ADD DEPENDENCY
class RoutingService {
    constructor(injector) {
        this.dev = false;
        console.log('RoutingService constructor');
        this.dev = window.location.hostname == 'localhost';
        this.router = injector.get(_angular_router__WEBPACK_IMPORTED_MODULE_7__.Router);
        this.context = injector.get(_subscribe_service__WEBPACK_IMPORTED_MODULE_2__.SubscribeService);
        this.location = injector.get(_angular_common__WEBPACK_IMPORTED_MODULE_8__.Location);
        this.platformService = injector.get(_platform_service__WEBPACK_IMPORTED_MODULE_1__.PlatformService);
        this.tabbarService = injector.get(_tabbar_service__WEBPACK_IMPORTED_MODULE_0__.TabbarService);
        this.navigationMenuService = injector.get(_navigation_menu_service__WEBPACK_IMPORTED_MODULE_3__.NavigationMenuService);
        this.lazyService = injector.get(_aigens_core_src_app_pure_services_lazy_service__WEBPACK_IMPORTED_MODULE_5__.LazyService);
        this.rootIndexInHistory = window.history.length;
        this.ijt = injector;
    }
    back() {
        if (this.isAux()) {
            // this.navigateCloseAllModal();
            this.navigateCloseModal();
        }
        else {
            this.location.back();
        }
    }
    exit() {
        console.log("web exit not implemented");
    }
    finish(closedData) {
        console.log("web finish not implemented");
    }
    isMobile() {
        var width = window.innerWidth;
        return width < 600;
    }
    isRoot() {
        var _a, _b;
        if (this.platformService.isApp()) {
            return (_b = (_a = this.navigationMenuService) === null || _a === void 0 ? void 0 : _a.isRoot(this.getPrimaryPath(), this.platformService.getChannel())) !== null && _b !== void 0 ? _b : false;
        }
        return true;
    }
    canBack() {
        const back = (this.getQuery('back') === 'true');
        return back || !this.isRoot();
    }
    getQuery(name) {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        return urlParams.get(name);
    }
    hasMenu() {
        if (!this.isRoot() || !this.platformService.isApp()) {
            return false;
        }
        return true;
    }
    isAux(url = null) {
        if (!url) {
            url = window.location.href;
        }
        if (url.indexOf('(') > 0 && url.indexOf(')') > 0) {
            console.log('is aux', url);
            return true;
        }
        return false;
    }
    getPrimaryPath(url = null) {
        if (!url) {
            url = window.location.pathname;
        }
        return url.replace(/ *\([^)]*\) */g, '');
    }
    //always close modal and go to path
    navigate(path, extras = {}) {
        if (path.startsWith('/')) {
            path = path.substring(1);
        }
        var history = window.history;
        //always merge query params
        if (!extras.queryParamsHandling) {
            extras.queryParamsHandling = 'merge';
        }
        console.log('CUSTOM NAV', path, extras);
        if (this.isAux()) {
            var auxDepth = history.state.auxDepth;
            if (auxDepth > 0) {
                console.log('need to clear histoy of', auxDepth);
                history.go(-auxDepth);
                this.clearCache();
                setTimeout(() => {
                    console.log('GO', path);
                    this.router.navigate([{ outlets: { primary: path, modal: null } }], extras);
                }, 300);
            }
            else {
                this.router.navigate([{ outlets: { primary: path, modal: null } }], extras);
            }
            //this.router.navigate([{ outlets: { modal: null } }], { replaceUrl: true });
        }
        else {
            this.router.navigate([{ outlets: { primary: path, modal: null } }], extras);
        }
    }
    saveAuxProfile(auxId, profile) {
        RoutingService.auxCache[auxId] = profile;
        console.log('aux profiles', RoutingService.auxCache);
    }
    getAuxInput() {
        var profile = this.getAuxProfile();
        return profile.input;
    }
    getAuxProfile() {
        const auxId = history.state.auxId;
        return this.getAuxById(auxId);
    }
    getAuxById(auxId) {
        if (auxId >= 0) {
            var profile = RoutingService.auxCache[auxId];
            if (profile) {
                return profile;
            }
        }
        return {};
    }
    navigateModal(path, input = {}, extras = {}) {
        var auxId = RoutingService.auxCounter++;
        var profile = {
            id: auxId,
            path: path,
            input: input,
            extras: extras
        };
        var isAux = this.isAux();
        if (!isAux) {
            //clear all reuse dialogs
            this.clearCache();
        }
        this.saveAuxProfile(auxId, profile);
        var state = extras.state || {};
        var currentState = window.history.state;
        //get the current aux depth, and keep adding 1
        var auxDepth = currentState.auxDepth || 0;
        //we record the auxDepth, so we can use back to history.go(-auxDepth) to clear the modal history
        state.auxDepth = auxDepth + 1;
        state.auxId = auxId;
        extras.state = state;
        //extras.queryParams = {"ABC": "DEF"};
        extras.queryParamsHandling = 'merge';
        console.log('navigateModal', path, extras);
        this.router.navigate([{ outlets: { modal: path } }], extras);
    }
    navigateBottomPopup(path, input = {}, extras = {}) {
        const auxId = RoutingService.auxCounter++;
        const profile = {
            id: auxId,
            path: path,
            input: input,
            extras: extras,
            type: 'bottom'
        };
        const isAux = this.isAux();
        if (!isAux) {
            //clear all reuse dialogs
            this.clearCache();
        }
        this.saveAuxProfile(auxId, profile);
        const state = extras.state || {};
        const currentState = window.history.state;
        //get the current aux depth, and keep adding 1
        const auxDepth = currentState.auxDepth || 0;
        //we record the auxDepth, so we can use back to history.go(-auxDepth) to clear the modal history
        state.auxDepth = auxDepth + 1;
        state.auxId = auxId;
        extras.state = state;
        //extras.queryParams = {"ABC": "DEF"};
        extras.queryParamsHandling = 'merge';
        console.log('navigateModal', path, extras);
        this.router.navigate([{ outlets: { bottom: path } }], extras);
    }
    navigateSideMenu() {
        this.navigateModal('side/menu');
    }
    isHome(url) {
        if (url.indexOf('home/brand') >= 0 ||
            url.indexOf('home/group') >= 0 ||
            url.indexOf('home/court') >= 0 ||
            url.indexOf('home/store') >= 0) {
            return true;
        }
        else {
            return false;
        }
    }
    navigateByUrl(url, currentUrl = '', params = {}) {
        var _a, _b, _c, _d, _e, _f, _g, _h;
        const isModal = url.startsWith('modal:');
        const isExternal = url.startsWith('http://') || url.startsWith('https://');
        const dynamicLink = url.startsWith('#');
        if (dynamicLink) {
            if (url === '#login') {
                this.goLogin();
            }
            else if (url === '#home') {
                if (!this.isHome(currentUrl)) {
                    console.log('go to home page');
                    this.goHome(currentUrl);
                }
            }
            else if (url === '#crmHome') {
                this.goCrmHome();
            }
            else if (url === '#ordering') {
                const brandMode = !!(this.getNavParams(currentUrl, 'brand') || this.getNavParams(currentUrl, 'brandId'));
                const courtMode = !!(this.getNavParams(currentUrl, 'court') || this.getNavParams(currentUrl, 'courtId'));
                const storeMode = !brandMode && !courtMode || !!(this.getNavParams(currentUrl, 'storeId'));
                ;
                this.orderNowHandle({
                    brandId: this.isHome(currentUrl) ? (_b = (_a = this.getNavParams(currentUrl, 'brand')) !== null && _a !== void 0 ? _a : this.getNavParams(currentUrl, 'brandId')) !== null && _b !== void 0 ? _b : this.context['brandId'] : this.getNavParams(currentUrl, 'brandId'),
                    storeMode,
                    courtMode,
                    storeId: (_c = this.getNavParams(currentUrl, 'store')) !== null && _c !== void 0 ? _c : this.getNavParams(currentUrl, 'storeId'),
                    mode: this.getNavParams(currentUrl, 'mode'),
                    key: this.getNavParams(currentUrl, 'key'),
                    spot: this.getNavParams(currentUrl, 'spot')
                });
            }
            else if (url === '#orderHistory') {
                this.orderHistoryClicked({
                    storeId: (_d = this.getNavParams(currentUrl, 'storeId')) !== null && _d !== void 0 ? _d : this.context['storeId'],
                    brandId: (_e = this.getNavParams(currentUrl, 'brandId')) !== null && _e !== void 0 ? _e : this.context['brandId'],
                    mode: this.getNavParams(currentUrl, 'mode'),
                    key: this.getNavParams(currentUrl, 'key'),
                    spot: this.getNavParams(currentUrl, 'spot'),
                    reorderToggle: (_h = (_g = (_f = this.context) === null || _f === void 0 ? void 0 : _f['brand']) === null || _g === void 0 ? void 0 : _g['reorderToggle']) !== null && _h !== void 0 ? _h : false,
                });
            }
            else if (url === '#hotelRoomCheckout') {
                const path = `directory/hotel-room-checkout`;
                this.navigateModal(path);
            }
            return;
        }
        if (isExternal) {
            this.platformService.openExternalLink(url);
            return;
        }
        const urlparams = this.paramsToObject(url);
        const finalUrl = url.replace(/\?\S+=\S+/g, '');
        const finalParams = Object.assign(Object.assign(Object.assign({}, urlparams), params), { confirmedMode: null, confirmedStore: null });
        const mode = this.getNavParams(currentUrl, 'mode');
        if (mode) {
            finalParams['mode'] = mode;
        }
        if (isModal) {
            this.navigateModal(finalUrl.slice(6), {}, { queryParams: finalParams });
        }
        else {
            this.navigate(finalUrl, { queryParams: finalParams });
        }
    }
    goLogin() {
        var _a;
        let path = '';
        if ((_a = this.context) === null || _a === void 0 ? void 0 : _a.brandId) {
            path = `auth/login/brand/${this.context.brandId}`;
        }
        else {
            path = `auth/login/group/${this.context.groupId}`;
        }
        this.navigateModal(path);
    }
    getCrmHome() {
        if (this.context['brandId']) {
            return `/crm/brand/${this.context.brandId}/home`;
        }
        return `/crm/groupId/${this.context.groupId}/home`;
    }
    goCrmHome() {
        const path = this.getCrmHome();
        this.navigate(path);
    }
    //clear any previous AUX states, this might not be necessary but as a safeguard to keep states cleared
    clearCache() {
        var cache = RoutingService.auxCache;
        for (var member in cache) {
            delete cache[member];
        }
        //var cus = this.customRouteReuseStrategy as any;
        //cus.clear();
    }
    // 清空大于某个路由层级的数据，保留小于等于当前路由层级的数据 (default current route auxId)
    // e.g: unlockCat route-dialog flow: unlockDialog => variationsItemsDialog => comboDilog => modifierDialog
    // if from comboDialog back to unlockDialog , so need clear cache-data about variationsItemsDialog and comboDilog
    clearCacheMoreThanAuxId(auxId = null) {
        auxId = auxId !== null && auxId !== void 0 ? auxId : history.state.auxId;
        var cache = RoutingService.auxCache;
        for (var member in cache) {
            if (member > auxId) {
                delete cache[member];
            }
        }
    }
    navigateBackRootAndForward(path, options) {
        var currentLength = window.history.length;
        this.navigateBackAndForward(currentLength - this.rootIndexInHistory, path, options);
    }
    navigateBackAndForward(backSteps, path, options) {
        console.log("going back", backSteps);
        history.go(-backSteps);
        if (!path)
            return;
        setTimeout(() => {
            this.navigate(path, options);
        }, 300);
    }
    navigateCloseAllModal(options = {}) {
        console.log('navigateCloseAllModal');
        if (this.isAux()) {
            var auxDepth = history.state.auxDepth;
            if (auxDepth > 0) {
                console.log('need to clear histoy of', auxDepth);
                history.go(-auxDepth);
                this.clearCache();
            }
            else {
                console.log('MISSING auxDepth in history state!');
                this.location.back();
            }
            // notice
            this.context.next('routingService.navigateCloseAllModal', { closedAuxUrl: window.location.href });
        }
        else {
            console.log('Not AUX dialog');
        }
        if (options.forwardUrl) {
            this.handleForward(options);
        }
        if (options.actionAfterClosed) {
            setTimeout(() => {
                // debugger;
                options.actionAfterClosed();
            }, 50);
        }
    }
    navigateCloseModal(options = {}) {
        console.log('navigateCloseModal');
        if (this.isAux()) {
            var auxDepth = history.state.auxDepth;
            if (auxDepth > 0) {
                console.log('need to clear histoy of', auxDepth);
                history.go(-1);
                if (auxDepth == 1) {
                    this.clearCache();
                }
            }
            else {
                console.log('MISSING auxDepth in history state!');
                this.location.back();
            }
            //this.router.navigate([{ outlets: { modal: null } }], { replaceUrl: true });
        }
        else {
            console.log('Not AUX dialog');
        }
        if (options.forwardUrl) {
            this.handleForward(options);
        }
    }
    handleForward(options) {
        setTimeout(() => {
            console.log("FORWARD TO", options.forwardUrl, options.extras);
            this.navigate(options.forwardUrl, options.extras || {});
        }, 50);
    }
    /**
     * @description: navigate model to which you want
     * @param {*} auxDepth which model navigate to
     * @return {*}
     */
    navigateCloseModalTo(auxDepth = 1, options = {}) {
        if (this.isAux()) {
            var auxDepthHistroy = history.state.auxDepth;
            if (auxDepthHistroy > 0 && auxDepth > 0 && auxDepthHistroy > auxDepth) {
                const go = auxDepthHistroy - auxDepth;
                history.go(-go);
                if (auxDepth == 1) {
                    this.clearCacheMoreThanAuxId();
                }
            }
            else {
                console.log('MISSING auxDepth in history state!');
                this.location.back();
            }
        }
        else {
            console.log("Not AUX dialog");
        }
        if (options.forwardUrl) {
            this.handleForward(options);
        }
    }
    getCurrentRoute() {
        var _a;
        return (_a = this.router) === null || _a === void 0 ? void 0 : _a.url;
    }
    orderNowHandle(inputObj) {
        var _a, _b, _c, _d, _e, _f, _g, _h;
        let path;
        const singleStore = this.context.singleStore;
        if (this.settingManager == null) {
            this.settingManager = this.ijt.get(_managers_setting_manager__WEBPACK_IMPORTED_MODULE_6__.SettingManager);
        }
        // room dining
        const inRoomDiningNeedAuth = this.settingManager.get('verifiedByPmsForRoomNumber', false) && this.settingManager.get('pos.requireSpot', false);
        console.log(inputObj);
        if (inputObj.storeMode) { // store home: /home/store
            const storeId = inputObj.storeId || this.context.storeId || this.context.defaultStoreId;
            const mode = inputObj.mode; // mode from caller such as from request param
            const authHotelRoom = localStorage.getItem('authHotelRoom');
            const storeModes = this.getValidModeForStore((_a = this.context.store) === null || _a === void 0 ? void 0 : _a.modes);
            if (mode) { // mode is defined, then redirect directly to menu page
                if (inRoomDiningNeedAuth && mode === 'dinein') { // show auth dialog for room dining
                    if (!authHotelRoom) {
                        path = 'directory/hotel-room-dining-auth';
                        this.navigateModal(path, { noReplaceUrl: true }, { queryParams: {}, skipLocationChange: false });
                        return;
                    }
                    else {
                        const authHotelRoomObj = JSON.parse(authHotelRoom);
                        inputObj.spot = authHotelRoomObj === null || authHotelRoomObj === void 0 ? void 0 : authHotelRoomObj.room;
                    }
                }
                path = `order/store/${storeId}/mode/${mode}`;
                this.navigate(path, {
                    queryParams: {
                        key: inputObj.key,
                        spot: inputObj.spot,
                        back: true,
                        mode: null,
                        storeId: null,
                        catId: inputObj.catId,
                        overrideMode: null,
                        // it should pop up the selectTime dialog when popupTimeSelectModalAfterSelectStore true and it is form store Home
                        // so use the existed flag('selectTime') to trigger the selectTime dialog
                        selectTime: ((_b = this.settingManager) === null || _b === void 0 ? void 0 : _b.get('popupTimeSelectModalAfterSelectStore', false)) ? true : null,
                    }
                });
            }
            else if (this.isMenuFirstFlow() && !inputObj.ignoreMenuFirstFlow) {
                // if no mode from caller (ex: no req param defined), then get from default store mode
                let firstFlowMode = mode || this.context.defaultStoreMode;
                // path = `order/store/${storeId}/mode/${firstFlowMode}`;
                // this.router.navigate([path], {queryParams: {key: inputObj.key, spot: inputObj.spot, back: true}});
                const qp = { confirmedMode: false, key: inputObj.key, spot: inputObj.spot, back: true, mode: null, storeId: null, catId: inputObj.catId, overrideMode: null };
                if (storeModes.length == 1) {
                    qp.confirmedMode = null;
                }
                // if the default mode not valid, fallback to the first available mode (for store home)
                if ((storeModes === null || storeModes === void 0 ? void 0 : storeModes.indexOf(firstFlowMode)) < 0) {
                    firstFlowMode = storeModes[0];
                }
                path = `order/store/${storeId}/mode/${firstFlowMode}`;
                this.navigate(path, { queryParams: qp });
            }
            else { // if no mode defined & not menu first flow, then show mode selector popup
                if (storeModes.length == 1) { // if only has 1 valid mode then redirect to menu directly
                    if (inRoomDiningNeedAuth && storeModes[0] === 'dinein') { // show auth dialog for room dining
                        if (!authHotelRoom) {
                            path = 'directory/hotel-room-dining-auth';
                            this.navigateModal(path, { noReplaceUrl: true }, { queryParams: {}, skipLocationChange: false });
                            return;
                        }
                        else {
                            const authHotelRoomObj = JSON.parse(authHotelRoom);
                            inputObj.spot = authHotelRoomObj === null || authHotelRoomObj === void 0 ? void 0 : authHotelRoomObj.room;
                        }
                    }
                    path = `order/store/${storeId}/mode/${storeModes[0]}`;
                    this.navigate(path, {
                        queryParams: {
                            key: inputObj.key,
                            spot: inputObj.spot,
                            back: true,
                            mode: null,
                            storeId: null,
                            catId: inputObj.catId,
                            // it should pop up the selectTime dialog when popupTimeSelectModalAfterSelectStore true and it is form store Home
                            // so use the existed flag('selectTime') to trigger the selectTime dialog
                            selectTime: ((_c = this.settingManager) === null || _c === void 0 ? void 0 : _c.get('popupTimeSelectModalAfterSelectStore', false)) ? true : null,
                        }
                    });
                    return;
                }
                path = `popup/store/${storeId}`;
                this.navigateModal(path, { noReplaceUrl: true }, { queryParams: {}, skipLocationChange: false });
            }
        }
        else if (inputObj.miniapp) {
            if (singleStore || inputObj.storeId || inputObj.isStoreHome) {
                path = `/order/store/${inputObj.storeId}/mode/${inputObj.mode}`;
                const qp = {
                    back: true,
                    // storeId: null,
                };
                this.router.navigate([path], { queryParamsHandling: 'merge', queryParams: qp });
            }
            else if (this.isMenuFirstFlow() && inputObj.storeId) {
                path = `/order/store/${inputObj.storeId}/mode/${inputObj.mode}`;
                const qp = {
                    back: true,
                    storeId: null,
                };
                if (!inputObj.isStoreHome) {
                    qp.brandId = inputObj.brandId;
                    qp.confirmedStore = false;
                }
                this.router.navigate([path], { queryParams: qp });
            }
            else {
                const path = `directory/brand/${inputObj.brandId}`;
                const qp = {
                    back: true,
                    mode: inputObj.mode,
                    storeId: null,
                };
                this.navigateModal(path, { noReplaceUrl: true }, { queryParams: qp, skipLocationChange: false });
            }
        }
        else if (inputObj === null || inputObj === void 0 ? void 0 : inputObj.courtMode) {
            const directoryService = this.lazyService.getService('DirectoryService');
            if ((_d = this.context.court) === null || _d === void 0 ? void 0 : _d.closed) {
                this.navigate(`order/court/${this.context.courtId}/no-service`, { queryParams: { code: 'courtClosed' } });
                return;
            }
            else if (!((_e = directoryService === null || directoryService === void 0 ? void 0 : directoryService.getStoreClass()) === null || _e === void 0 ? void 0 : _e.isOpeningHours(this.context.court, new Date().getTime()))) {
                this.navigate(`order/court/${this.context.courtId}/no-service`, { queryParams: { code: 'courtOpeninghours' } });
                return;
            }
            path = `directory/court/${this.context.courtId}`;
            this.navigateModal(path, { noReplaceUrl: true });
        }
        else { // brand mode: /home/brand
            let currentUrl = window.location.href;
            const storeId = this.getQuery('storeId') || this.context.defaultStoreId;
            const mode = inputObj.mode; // mode from caller such as from request param
            const checkMenuFirst = inputObj.checkMenuFirstEvenConfirmed ? this.isMenuFirstFlow() : true;
            if ((this.isMenuFirstFlow() && storeId && !inputObj.ignoreMenuFirstFlow) || (checkMenuFirst && !inputObj.ignoreMenuFirstFlow && this.getQuery('storeId') && mode)) { // if menu first flow, then redirect to store directly
                // if no mode from caller (ex: no req param defined), then get from default store mode
                const firstFlowMode = mode || this.context.defaultStoreMode;
                // path = `/order/store/${storeId}/mode/${firstFlowMode}`;
                // this.router.navigate([path], {queryParams: {brandId: inputObj.brandId, back: true}, skipLocationChange: false});
                const qp = {
                    confirmedMode: false,
                    confirmedStore: false,
                    brandId: inputObj.brandId,
                    catId: inputObj.catId,
                    storeId: null,
                    mode: null,
                    back: true,
                    overrideMode: null
                };
                const brandModes = this.getValidModeForBrand((_f = this.context.brand) === null || _f === void 0 ? void 0 : _f.modes);
                if (brandModes.length == 1 && brandModes[0] == firstFlowMode) {
                    qp.confirmedMode = null;
                }
                if (mode) {
                    qp.confirmedMode = null;
                }
                if (singleStore) { // store is confirmed if single store
                    qp.confirmedStore = null;
                }
                if (mode == 'view') { // view mode then make all state as confirmed
                    qp.confirmedMode = null;
                    qp.confirmedStore = null;
                }
                if (this.getNavParams(currentUrl, 'storeId')) {
                    qp.confirmedStore = null;
                }
                path = `/order/store/${storeId}/mode/${firstFlowMode}`;
                this.navigate(path, { queryParams: qp, skipLocationChange: false, replaceUrl: (_g = inputObj === null || inputObj === void 0 ? void 0 : inputObj.replaceUrl) !== null && _g !== void 0 ? _g : false });
                //this.router.navigate([path], { queryParams: qp, skipLocationChange: false, replaceUrl: inputObj?.replaceUrl ?? false, });
            }
            else { // show mode & store selector
                path = `directory/brand/${inputObj.brandId}`;
                const params = {
                    brandId: inputObj.brandId,
                    catId: inputObj.catId,
                    mode
                };
                if (inputObj.autoSelectSingleStore) {
                    params['autoSelectSingleStore'] = true;
                }
                this.navigateModal(path, { noReplaceUrl: true }, { queryParams: params, replaceUrl: (_h = inputObj === null || inputObj === void 0 ? void 0 : inputObj.replaceUrl) !== null && _h !== void 0 ? _h : false });
            }
        }
    }
    orderHistoryClicked(inputObj) {
        const page = inputObj.reorderToggle ? 'reorder-page' : 'order-history';
        if (this.context.courtId) {
            // this.router.navigate([`/order/court/${this.context.courtId}/order-history`],
            //  { queryParams: { back: true, mode: inputObj.mode, } });
            this.router.navigate([`/order/court/${this.context.courtId}/${page}`], { queryParams: { back: true, mode: inputObj.mode, } });
        }
        else {
            // const path = `/order/brand/${inputObj.brandId}/order-history`;
            const path = `/order/brand/${inputObj.brandId}/${page}`;
            let params = {};
            params = {
                mode: inputObj.mode,
                spot: inputObj.spot,
                key: inputObj.key,
                back: true
            };
            if (inputObj.storeId) {
                params['storeId'] = inputObj.storeId;
            }
            this.router.navigate([path], { queryParams: params });
        }
    }
    isMenuFirstFlow() {
        // return false;
        // get flag for menu first flow from device
        // if (this.context?.config?.data?.menuBeforeMode == null) {
        //     return true;
        // }
        var _a, _b;
        // return this.context?.config?.data?.menuBeforeMode;
        const orderModeSelection = (_b = (_a = this.context) === null || _a === void 0 ? void 0 : _a.brand) === null || _b === void 0 ? void 0 : _b.orderModeSelection;
        if (!orderModeSelection || orderModeSelection == 'beforeMenu') {
            return false;
        }
        return true;
    }
    getValidModeForBrand(brandModes) {
        return this.filterModes(brandModes, ['takeaway', 'dinein', 'delivery']);
    }
    getValidModeForStore(storeModes) {
        return this.filterModes(storeModes, ['takeaway', 'dinein']);
    }
    filterModes(modes, valids) {
        var result = [];
        if (!modes) {
            return result;
        }
        for (let m of modes) {
            if (valids.indexOf(m) >= 0) {
                result.push(m);
            }
        }
        return result;
    }
    paramsToObject(url = '') {
        var _a;
        try {
            const paramsString = url.match(/\?\S+=\S+/g);
            if (paramsString.length <= 0) {
                return {};
            }
            const entries = new URLSearchParams((_a = paramsString[0]) === null || _a === void 0 ? void 0 : _a.slice(1));
            const result = {};
            for (const [key, value] of entries) { // each 'entry' is a [key, value] tupple
                result[key] = value;
            }
            return result;
        }
        catch (e) {
            return {};
        }
    }
    getNavParams(url = '', key = '') {
        var _a;
        const queryParams = this.paramsToObject(url);
        if (key in queryParams) {
            return queryParams[key];
        }
        const splited = url.replace(/\?\S+=\S+/g, '').replace(/\(modal:/g, '/').split('/');
        const keyIndex = splited.indexOf(key);
        if (keyIndex < 0 || keyIndex >= splited.length) {
            return null;
        }
        return (_a = splited[keyIndex + 1]) !== null && _a !== void 0 ? _a : null;
    }
    getHome(currentUrl = '') {
        var _a, _b, _c, _d, _e, _f;
        const newParams = {};
        let url = this.navigationMenuService.getHomePath(this.platformService.getChannel());
        const mode = this.getNavParams(currentUrl, 'mode');
        if (mode) {
            newParams['mode'] = mode;
        }
        if (url === '#crmHome') {
            const groupId = (_a = this.getNavParams(currentUrl, 'groupId')) !== null && _a !== void 0 ? _a : this.getNavParams(currentUrl, 'group');
            const storeId = (_b = this.getNavParams(currentUrl, 'storeId')) !== null && _b !== void 0 ? _b : this.getNavParams(currentUrl, 'store');
            newParams['storeId'] = storeId !== null && storeId !== void 0 ? storeId : null;
            newParams['groupId'] = groupId !== null && groupId !== void 0 ? groupId : null;
            return [this.getCrmHome(), newParams];
        }
        if (!url || url === '#home') {
            const brandId = (_c = this.getNavParams(currentUrl, 'brandId')) !== null && _c !== void 0 ? _c : this.getNavParams(currentUrl, 'brand');
            const courtId = (_d = this.getNavParams(currentUrl, 'courtId')) !== null && _d !== void 0 ? _d : this.getNavParams(currentUrl, 'court');
            const groupId = (_e = this.getNavParams(currentUrl, 'groupId')) !== null && _e !== void 0 ? _e : this.getNavParams(currentUrl, 'group');
            const storeId = (_f = this.getNavParams(currentUrl, 'storeId')) !== null && _f !== void 0 ? _f : this.getNavParams(currentUrl, 'store');
            if (this.getNavParams(currentUrl, 'brand') && !this.getNavParams(currentUrl, 'brandId') && !this.getNavParams(currentUrl, 'storeId')) {
                url = `home/brand/${brandId}`;
            }
            else if (this.getNavParams(currentUrl, 'brandId')) {
                url = `home/brand/${brandId}`;
                newParams['storeId'] = storeId !== null && storeId !== void 0 ? storeId : this.context.storeId;
                newParams['brandId'] = brandId !== null && brandId !== void 0 ? brandId : this.context.brandId;
            }
            else if (groupId) {
                url = `home/group/${groupId}`;
                newParams['storeId'] = storeId !== null && storeId !== void 0 ? storeId : this.context.storeId;
            }
            else if (courtId) {
                url = `home/court/${courtId}`;
                // newParams['storeId'] = this.context.storeId;
            }
            else {
                url = `home/store/${storeId !== null && storeId !== void 0 ? storeId : this.context.storeId}`;
            }
        }
        const params = this.paramsToObject(url);
        const finalUrl = url.replace(/\?\S+=\S+/g, '');
        const finalParams = Object.assign(Object.assign(Object.assign({}, params), newParams), { back: null, confirmedMode: null, confirmedStore: null });
        return [finalUrl, finalParams];
    }
    goHome(currentUrl = '') {
        // if (!homeUrl) {
        //     homeUrl = this.routeGuardService.getHome();
        // }
        // if (homeUrl) {
        //     //window.location.href = homeUrl;
        //     if (!this.platformService.isAliApp()) {
        //         const params = this.paramsToObject(homeUrl);
        //         this.navigate(homeUrl.replace(/\?\S+=\S+/g, ''), { queryParams: { back: null, ...params } });
        //     } else {
        //         window.location.replace(homeUrl);
        //     }
        // }
        const [finalUrl, finalParams] = this.getHome(currentUrl);
        this.navigate(finalUrl, { queryParams: finalParams });
    }
    dismissPreLoader() {
        var w = window;
        if (w.dismissPreLoader) {
            w.dismissPreLoader();
        }
        // Please keep, when open byod with sdk on capactitor app, have splash and need to dismiss it first.
        try {
            _capacitor_splash_screen__WEBPACK_IMPORTED_MODULE_4__.SplashScreen.hide();
        }
        catch (error) {
        }
    }
    openBrowser(options) {
        var url = options.url;
        if (!url)
            return;
        //this.navigate(url);
        window.open(url, '_blank').focus();
    }
    mark() {
        return history.length;
    }
    backTo(marker) {
        var diff = history.length - marker;
        console.log('history diff', diff);
        if (diff < 0) {
            return;
        }
        history.go(-diff);
    }
}
RoutingService.auxCounter = 1;
RoutingService.auxCache = {};
RoutingService.ɵfac = function RoutingService_Factory(t) { return new (t || RoutingService)(_angular_core__WEBPACK_IMPORTED_MODULE_9__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_9__.Injector)); };
RoutingService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_9__["ɵɵdefineInjectable"]({ token: RoutingService, factory: RoutingService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 38792:
/*!***************************************************************!*\
  !*** ./projects/core/src/app/pure/services/sentry.service.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SentryService": () => (/* binding */ SentryService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class SentryService {
    constructor() {
        this._Sentry = null;
        this.logError = false;
    }
    get Sentry() {
        if (this._Sentry) {
            return this._Sentry;
        }
        this._Sentry = window.Sentry;
        return this._Sentry;
    }
    log(...args) {
        if (this.logError) {
            console.log(...args);
        }
    }
    track(eventName, event) {
        var _a;
        try {
            (_a = this.Sentry) === null || _a === void 0 ? void 0 : _a.addBreadcrumb({
                type: 'user',
                category: 'event',
                message: eventName,
                data: Object.assign({}, event),
                level: "info",
            });
        }
        catch (e) {
            this.log(e);
        }
    }
    captureException(error) {
        try {
            this.Sentry.captureException(error);
        }
        catch (e) {
            this.log(e);
        }
    }
    setTag(key, value) {
        try {
            this.Sentry.setTag(key, value);
        }
        catch (e) {
            this.log(e);
        }
    }
    setMember(member) {
        try {
            const sentryMember = { id: member.id };
            if (member === null || member === void 0 ? void 0 : member.name) {
                sentryMember['username'] = member === null || member === void 0 ? void 0 : member.name;
            }
            if (member === null || member === void 0 ? void 0 : member.email) {
                sentryMember['email'] = member === null || member === void 0 ? void 0 : member.email;
            }
            this.Sentry.setUser(sentryMember);
        }
        catch (e) {
            this.log(e);
        }
    }
    removeMember() {
        try {
            this.Sentry.setUser(null);
        }
        catch (e) {
            this.log(e);
        }
    }
    setContext(key, context) {
        try {
            this.Sentry.setContext(key, context);
        }
        catch (e) {
            this.log(e);
        }
    }
}
SentryService.ɵfac = function SentryService_Factory(t) { return new (t || SentryService)(); };
SentryService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({ token: SentryService, factory: SentryService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 47074:
/*!******************************************************************!*\
  !*** ./projects/core/src/app/pure/services/subscribe.service.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SubscribeService": () => (/* binding */ SubscribeService)
/* harmony export */ });
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ 76317);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs */ 80155);
/* harmony import */ var _common_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./common.service */ 43872);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! lodash-es */ 45269);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _framework_services_storage_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../framework/services/storage.service */ 24430);







class SubscribeService {
    constructor(injector, storageService) {
        this.storageService = storageService;
        this.FIRST_LOAD_EMBEDDED_CONTEXT = 'firstLoadEmbeddedContext';
        this.SDK_MEMBER_CONTEXT = 'sdkMemberContext';
        this.isLoadMemberContext = false;
        this.init();
        this.setTranslation(injector.get(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_2__.TranslateService));
    }
    getQuery(name) {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        return urlParams.get(name);
    }
    init() {
        var _a, _b, _c, _d;
        if (!window['aigens']) {
            window['aigens'] = {};
        }
        var aigens = window['aigens'];
        if (aigens && aigens.context) {
            Object.assign(this, aigens.context);
        }
        let userLang;
        let urlLocale = this.getQuery("locale");
        const languages = (_b = (_a = window['aigens']) === null || _a === void 0 ? void 0 : _a.context) === null || _b === void 0 ? void 0 : _b.languages;
        if (!languages || (languages === null || languages === void 0 ? void 0 : languages.includes(_common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.getLocal('locale')))) {
            userLang = _common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.getLocal('locale');
        }
        var lang = urlLocale || userLang || ((_d = (_c = window['aigens']) === null || _c === void 0 ? void 0 : _c.context) === null || _d === void 0 ? void 0 : _d.language) || 'en';
        this['userLang'] = lang;
        _common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.setLocal('locale', lang); // override locale on local storage
        this.next('language', lang);
        aigens.context = this;
        this.storageService.getStorage(this.getMemberKey())
            .then((value) => {
            const member = value === null || value === void 0 ? void 0 : value.member;
            if (member) {
                this.next('member', member);
                this.next('sessionId', value === null || value === void 0 ? void 0 : value.session);
            }
            this.next('isLoadMemberContext', true); // remark the memberContext loaded
            console.log('=== ', value);
        }).catch((reason) => {
            console.log('ERROR', reason);
        });
        // var member = CommonService.getLocal('member');
        // if (member) {
        //     this.next('member', member);
        // }
    }
    update() {
        var aigens = window['aigens'];
        if (aigens && aigens.context) {
            Object.assign(this, aigens.context);
        }
    }
    getObservable(name, initValue = null) {
        var name2 = name + '$';
        var bs = this[name2];
        if (!bs) {
            bs = new rxjs__WEBPACK_IMPORTED_MODULE_3__.BehaviorSubject(initValue);
            bs.name = name;
            this[name2] = bs;
            //console.log('making bs', name, initValue, bs);
        }
        return bs;
    }
    get(name) {
        return this[name];
    }
    next(name, value) {
        console.log('next', name, value);
        this[name] = value;
        this.getObservable(name).next(value);
    }
    bind(listener, fields) {
        for (let f of fields) {
            var cb = function (value) {
                //console.log("bind callback!", listener, f, value, this);
                listener[f] = value;
            };
            this.getObservable(f).subscribe(cb);
        }
    }
    /**
     * Merge overwrite translation here to get the latest translation update in home page (home module)
     *
     * @param t
     * @private
     */
    setTranslation(t) {
        t.onLangChange.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.first)()).subscribe((res) => {
            this.mergeTranslation(t);
        });
    }
    mergeTranslation(t) {
        var _a, _b;
        const overwrites = (_b = (_a = this['config']) === null || _a === void 0 ? void 0 : _a.data) === null || _b === void 0 ? void 0 : _b.translations;
        if (overwrites) {
            for (const lang of Object.keys(overwrites)) {
                const x = t.translations[lang];
                (0,lodash_es__WEBPACK_IMPORTED_MODULE_5__["default"])(x, overwrites[lang]);
            }
        }
    }
    logout() {
        this.storageService.setStorage(this.getMemberKey(), null);
    }
    getMemberKey() {
        if (!window['aigens']) {
            window['aigens'] = {};
        }
        var aigens = window['aigens'];
        let contextId = 'type=member';
        if (aigens && aigens.context) {
            const context = aigens.context;
            const crm = context.crm;
            if (crm) {
                contextId += '&crm=' + crm.type;
                if (crm.source) {
                    contextId += '&source=' + crm.source;
                }
            }
        }
        return contextId;
    }
}
SubscribeService.ɵfac = function SubscribeService_Factory(t) { return new (t || SubscribeService)(_angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_6__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵinject"](_framework_services_storage_service__WEBPACK_IMPORTED_MODULE_1__.StorageService)); };
SubscribeService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdefineInjectable"]({ token: SubscribeService, factory: SubscribeService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 46297:
/*!***************************************************************!*\
  !*** ./projects/core/src/app/pure/services/tabbar.service.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TabbarService": () => (/* binding */ TabbarService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _aigens_core_src_app_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/subscribe.service */ 47074);



const tabs = {
    home: {
        i18n: "app.tabs.home",
        route: ["/app/home/brand/@brandId", { queryParams: {} }],
        icon: "nav-bar-home-outline",
        matchName: 'home'
    },
    // {
    //     i18n: "tabs.home",
    //     route: ["/app/crm/brand/@brandId/home", { queryParams: {} }],
    //     icon: "home",
    //     iconSrc: "mat",
    //     matchName: 'home'
    // },
    membership: {
        i18n: "app.tabs.membership",
        route: ["/app/membership/brand/@brandId/", { queryParams: {} }],
        icon: "nav-bar-member-outline",
        matchName: 'membership'
    },
    ordering: {
        i18n: "app.tabs.ordering",
        route: ["/app/ordering/brand/@brandId", { queryParams: {} }],
        icon: "nav-bar-ordering-outline",
        matchName: 'ordering'
    },
    rewards: {
        i18n: "app.tabs.reward",
        route: ["/app/rewards/brand/@brandId", { queryParams: {} }],
        icon: "nav-bar-reward-outline",
        matchName: 'rewards'
    },
    stamps: {
        i18n: "app.tabs.stamps",
        route: ["/app/stamps/brand/@brandId/", { queryParams: {} }],
        icon: "side-menu-stamps-outline",
        matchName: 'stamps'
    },
    stores: {
        i18n: "app.tabs.stores",
        route: ["/app/stores/brand/@brandId/", { queryParams: {} }],
        icon: "nav-bar-store-list-outline",
        matchName: 'stores'
    },
    reorder: {
        i18n: "app.tabs.order-history",
        route: ["/app/reorder/brand/@brandId", { queryParams: {} }],
        icon: "nav-bar-order-history-outline",
        matchName: 'reorder'
    },
    inbox: {
        i18n: "app.tabs.inbox",
        route: ["/app/inbox/brand/@brandId", { queryParams: {} }],
        icon: "side-menu-inbox-outline",
        matchName: 'inbox'
    },
    news: {
        i18n: "app.tabs.news",
        route: ["/app/news/brand/@brandId", { queryParams: {} }],
        icon: "side-menu-news-outline",
        matchName: 'news'
    },
    settings: {
        i18n: "app.tabs.settings",
        route: ["/app/settings/brand/@brandId", { queryParams: {} }],
        icon: "side-menu-settings-outline",
        matchName: 'settings'
    },
    customerSurvey: {
        i18n: "app.tabs.customer-survey",
        route: ["@externalLink", { queryParams: {} }],
        external: 'surveyApp',
        icon: "side-menu-customer-survey-outline",
        matchName: 'inbox'
    },
    careers: {
        i18n: "app.tabs.careers",
        route: ["@externalLink", { queryParams: {} }],
        external: 'recruitmentForm',
        icon: "side-menu-careers-outline",
        matchName: 'careers'
    },
    directory: {
        i18n: "app.tabs.stores",
        route: ["/app/directory/brand/@brandId", { queryParams: {} }],
        icon: "nav-bar-store-list-outline",
        matchName: 'directory'
    }
};
class TabbarService {
    constructor(injector, context) {
        this.context = context;
        this.selectedTabs = ['home', 'membership', 'ordering', 'stores', 'reorder'];
        this.selectedMenu = ['home', 'inbox', 'news', 'ordering', 'rewards', 'stamps', 'membership', 'reorder', 'settings'];
    }
    getTabsByArray(tabs) {
        return this.patchTabs(this.selectedTabs.map(tab => tabs[tab]));
    }
    getTabs() {
        return this.patchTabs(this.selectedTabs.map(tab => tabs[tab]));
    }
    getMenus() {
        return this.patchTabs(this.selectedMenu.map(tab => tabs[tab]));
    }
    isRoot(path) {
        return this.selectedTabs.some((tab) => {
            var _a;
            return path.indexOf((_a = tabs[tab]) === null || _a === void 0 ? void 0 : _a.matchName) >= 0;
        });
    }
    patchTabs(tabs) {
        var _a, _b;
        for (let t of tabs) {
            let link = t.route[0];
            if (t.external !== undefined) {
                link = link.replace('@externalLink', (_a = this.context) === null || _a === void 0 ? void 0 : _a['brand']['links'][t.external]['url']);
            }
            link = link.replace('@brandId', '' + ((_b = this.context) === null || _b === void 0 ? void 0 : _b['brandId']));
            t.route[0] = link;
        }
        return tabs;
    }
}
TabbarService.ɵfac = function TabbarService_Factory(t) { return new (t || TabbarService)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_1__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵinject"](_aigens_core_src_app_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_0__.SubscribeService)); };
TabbarService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineInjectable"]({ token: TabbarService, factory: TabbarService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 72570:
/*!*************************************************************!*\
  !*** ./projects/core/src/app/pure/services/time.service.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TimeService": () => (/* binding */ TimeService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class TimeService {
    constructor() {
        this.offset = 0;
    }
    getRawTime() {
        return new Date().getTime();
    }
    getTime() {
        return this.getRawTime() + this.offset;
    }
    getTimeObject() {
        return new Date(this.getTime());
    }
    setServerVerifiedTime(serverTime) {
        const localTime = this.getRawTime();
        const delta = serverTime - localTime;
        // If offset less than 1 minutes, don't set offset
        if (Math.abs(delta) < 60000) {
            this.offset = 0;
            return;
        }
        // Round to 30s
        this.offset = Math.round(delta / 30000) * 30000;
        console.log('Adjust time with offset: ' + this.offset);
        // If time difference are too big, prompt an error
        // if(Math.abs(this.offset) >= 900000) {
        //     throw {name: 'time-difference-too-large', layout: 'toast'}
        // }
    }
}
TimeService.ɵfac = function TimeService_Factory(t) { return new (t || TimeService)(); };
TimeService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({ token: TimeService, factory: TimeService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 56009:
/*!*******************************************************!*\
  !*** ./projects/device/src/app/app-routing.module.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AppRoutingModule": () => (/* binding */ AppRoutingModule)
/* harmony export */ });
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _device_device_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./device/device.module */ 8068);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);




const routes = [
    {
        path: '',
        redirectTo: '/device/setup',
        pathMatch: 'full'
    },
    {
        path: 'device',
        loadChildren: () => _device_device_module__WEBPACK_IMPORTED_MODULE_0__.DeviceModule
    },
    //debuging
    {
        path: 'test',
        loadChildren: () => __webpack_require__.e(/*! import() */ "projects_test_src_app_test_test_module_ts").then(__webpack_require__.bind(__webpack_require__, /*! ../../../test/src/app/test/test.module */ 14210)).then(m => m.TestModule),
    }
];
class AppRoutingModule {
}
AppRoutingModule.ɵfac = function AppRoutingModule_Factory(t) { return new (t || AppRoutingModule)(); };
AppRoutingModule.ɵmod = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineNgModule"]({ type: AppRoutingModule });
AppRoutingModule.ɵinj = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineInjector"]({ imports: [_angular_router__WEBPACK_IMPORTED_MODULE_2__.RouterModule.forRoot(routes), _angular_router__WEBPACK_IMPORTED_MODULE_2__.RouterModule] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵsetNgModuleScope"](AppRoutingModule, { imports: [_angular_router__WEBPACK_IMPORTED_MODULE_2__.RouterModule], exports: [_angular_router__WEBPACK_IMPORTED_MODULE_2__.RouterModule] }); })();


/***/ }),

/***/ 28981:
/*!**************************************************!*\
  !*** ./projects/device/src/app/app.component.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AppComponent": () => (/* binding */ AppComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _core_src_app_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../core/src/app/framework */ 44651);





const fromEntries = __webpack_require__(/*! fromentries */ 93234);
// import { AppTrackingTransparency } from 'capacitor-plugin-app-tracking-transparency';
class AppComponent {
    constructor(injector, t, router, configService) {
        this.injector = injector;
        this.t = t;
        this.router = router;
        this.configService = configService;
        this.init = {
            "profile": {
                "country": "HK",
                "production": false,
                "applePay": "https://us-central1-aigensstoretest.cloudfunctions.net/applePaySession",
                "groupId": 500,
                "api": "https://aigensstoretest.appspot.com",
                "locale": "en"
            },
            "context": {}
        };
        if (!Object['fromEntries']) {
            Object['fromEntries'] = fromEntries;
        }
        window['aigens'] = this.init;
        this.showTrackingPopup();
        this.initTranslation();
    }
    initTranslation() {
        const locale = this.configService.getLocale() || 'en';
        this.t.setDefaultLang(locale);
        this.t.use(locale);
        this.configService.setLocale(locale);
    }
    showTrackingPopup() {
        // if (Capacitor.isNativePlatform() && Capacitor.getPlatform() == 'ios') {
        //     setTimeout(() => {
        //         AppTrackingTransparency.requestPermission().then(r => {
        //         })
        //     }, 500);
        // }
    }
}
AppComponent.ɵfac = function AppComponent_Factory(t) { return new (t || AppComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_1__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_ngx_translate_core__WEBPACK_IMPORTED_MODULE_2__.TranslateService), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_angular_router__WEBPACK_IMPORTED_MODULE_3__.Router), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_core_src_app_framework__WEBPACK_IMPORTED_MODULE_0__.ConfigService)); };
AppComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineComponent"]({ type: AppComponent, selectors: [["app-root"]], decls: 1, vars: 0, template: function AppComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelement"](0, "router-outlet");
    } }, dependencies: [_angular_router__WEBPACK_IMPORTED_MODULE_3__.RouterOutlet], styles: ["[_nghost-%COMP%] {\n  display: block;\n  height: 100%;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGNBQUE7RUFDQSxZQUFBO0FBQ0YiLCJmaWxlIjoiYXBwLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xuICBkaXNwbGF5OiBibG9jaztcbiAgaGVpZ2h0OiAxMDAlO1xufVxuIl19 */"] });


/***/ }),

/***/ 91168:
/*!***********************************************!*\
  !*** ./projects/device/src/app/app.module.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AppModule": () => (/* binding */ AppModule),
/* harmony export */   "HttpLoaderFactory": () => (/* binding */ HttpLoaderFactory)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/platform-browser */ 50318);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var _ngx_translate_http_loader__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ngx-translate/http-loader */ 32202);
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @angular/common/http */ 28784);
/* harmony import */ var _app_routing_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./app-routing.module */ 56009);
/* harmony import */ var _app_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./app.component */ 28981);
/* harmony import */ var _aigens_core_src_app_pure_base_reuse_strategy__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aigens/core/src/app/pure/base/reuse-strategy */ 75585);
/* harmony import */ var _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/platform-browser/animations */ 73598);
/* harmony import */ var angular_material_css_vars__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! angular-material-css-vars */ 33017);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);








//do like this to avoid importing entire framework






// import * as Sentry from "@sentry/angular";
function HttpLoaderFactory(http) {
    return new _ngx_translate_http_loader__WEBPACK_IMPORTED_MODULE_3__.TranslateHttpLoader(http, './assets/i18n/', '.json');
}
class AppModule {
}
AppModule.ɵfac = function AppModule_Factory(t) { return new (t || AppModule)(); };
AppModule.ɵmod = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineNgModule"]({ type: AppModule, bootstrap: [_app_component__WEBPACK_IMPORTED_MODULE_1__.AppComponent] });
AppModule.ɵinj = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineInjector"]({ providers: [
        {
            provide: _angular_common__WEBPACK_IMPORTED_MODULE_5__.APP_BASE_HREF,
            useValue: '/'
        },
        {
            provide: _angular_router__WEBPACK_IMPORTED_MODULE_6__.RouteReuseStrategy,
            useClass: _aigens_core_src_app_pure_base_reuse_strategy__WEBPACK_IMPORTED_MODULE_2__.CustomRouteReuseStrategy,
        },
        // {
        //     provide: ErrorHandler,
        //     useValue: Sentry.createErrorHandler({
        //         showDialog: false,
        //     }),
        // },
        // {
        //     provide: Sentry.TraceService,
        //     deps: [Router],
        // },
        // {
        //     provide: APP_INITIALIZER,
        //     useFactory: () => () => { },
        //     deps: [Sentry.TraceService],
        //     multi: true,
        // },
    ], imports: [_angular_platform_browser__WEBPACK_IMPORTED_MODULE_7__.BrowserModule,
        _app_routing_module__WEBPACK_IMPORTED_MODULE_0__.AppRoutingModule,
        _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_8__.BrowserAnimationsModule,
        _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.HttpClientModule,
        _ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.TranslateModule.forRoot({
            defaultLanguage: 'en',
            loader: {
                provide: _ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.TranslateLoader,
                useFactory: HttpLoaderFactory,
                deps: [_angular_common_http__WEBPACK_IMPORTED_MODULE_9__.HttpClient]
            }
        }),
        angular_material_css_vars__WEBPACK_IMPORTED_MODULE_11__.MaterialCssVarsModule.forRoot({
            // all optional
            isAutoContrast: true,
            darkThemeClass: 'isDarkTheme',
            lightThemeClass: 'isLightTheme',
        })] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵsetNgModuleScope"](AppModule, { declarations: [_app_component__WEBPACK_IMPORTED_MODULE_1__.AppComponent], imports: [_angular_platform_browser__WEBPACK_IMPORTED_MODULE_7__.BrowserModule,
        _app_routing_module__WEBPACK_IMPORTED_MODULE_0__.AppRoutingModule,
        _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_8__.BrowserAnimationsModule,
        _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.HttpClientModule, _ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.TranslateModule, angular_material_css_vars__WEBPACK_IMPORTED_MODULE_11__.MaterialCssVarsModule] }); })();


/***/ }),

/***/ 43632:
/*!****************************************************************************************************************!*\
  !*** ./projects/device/src/app/device/components/ProgressDialogComponent/ProgressDialogComponent.component.ts ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ProgressDialogComponent": () => (/* binding */ ProgressDialogComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_material_progress_spinner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/material/progress-spinner */ 74742);


class ProgressDialogComponent {
    constructor() { }
    ngOnInit() {
    }
}
ProgressDialogComponent.ɵfac = function ProgressDialogComponent_Factory(t) { return new (t || ProgressDialogComponent)(); };
ProgressDialogComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineComponent"]({ type: ProgressDialogComponent, selectors: [["app-ProgressDialogComponent"]], decls: 1, vars: 0, consts: [["diameter", "30"]], template: function ProgressDialogComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelement"](0, "mat-spinner", 0);
    } }, dependencies: [_angular_material_progress_spinner__WEBPACK_IMPORTED_MODULE_1__.MatProgressSpinner], styles: ["\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJQcm9ncmVzc0RpYWxvZ0NvbXBvbmVudC5jb21wb25lbnQuc2NzcyJ9 */"] });


/***/ }),

/***/ 22691:
/*!******************************************************************************************!*\
  !*** ./projects/device/src/app/device/components/alert-dialog/alert-dialog.component.ts ***!
  \******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AlertDialogComponent": () => (/* binding */ AlertDialogComponent)
/* harmony export */ });
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/material/dialog */ 95758);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_material_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/material/button */ 87317);





function AlertDialogComponent_button_6_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](0, "button", 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](1, "Cancel");
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
} }
class AlertDialogComponent {
    constructor(dialogRef, input) {
        this.dialogRef = dialogRef;
        this.input = input;
    }
    ngOnInit() {
        console.log("m", this.input.message, this.input.title);
    }
    onOkClick() {
        this.dialogRef.close();
    }
}
AlertDialogComponent.ɵfac = function AlertDialogComponent_Factory(t) { return new (t || AlertDialogComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogRef), _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MAT_DIALOG_DATA)); };
AlertDialogComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineComponent"]({ type: AlertDialogComponent, selectors: [["app-alert-dialog"]], decls: 9, vars: 3, consts: [["matDialogTitle", "", "data-testid", "alertDialogTitle"], ["data-testid", "alertDialogMessage", 1, "alert-msg"], ["align", "end"], ["mat-button", "", "matDialogClose", "cancel", "color", "primary", "data-testid", "alert-cancel-button", 4, "ngIf"], ["mat-button", "", "matDialogClose", "confirm", "color", "primary", "data-testid", "alert-confirm-button", 1, "confirm"], ["mat-button", "", "matDialogClose", "cancel", "color", "primary", "data-testid", "alert-cancel-button"]], template: function AlertDialogComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](0, "h2", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](2, "mat-dialog-content")(3, "p", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](4);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]()();
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](5, "mat-dialog-actions", 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtemplate"](6, AlertDialogComponent_button_6_Template, 2, 0, "button", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](7, "button", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](8, "OK");
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]()();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](ctx.input.title);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](ctx.input.message);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngIf", ctx.input.showCancel);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_2__.NgIf, _angular_material_button__WEBPACK_IMPORTED_MODULE_3__.MatButton, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogClose, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogTitle, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogContent, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogActions], styles: ["mat-dialog-content[_ngcontent-%COMP%] {\n  min-width: 10rem;\n}\n\n.alert-msg[_ngcontent-%COMP%] {\n  line-height: normal;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsZXJ0LWRpYWxvZy5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGdCQUFBO0FBQ0o7O0FBRUE7RUFDSSxtQkFBQTtBQUNKIiwiZmlsZSI6ImFsZXJ0LWRpYWxvZy5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIm1hdC1kaWFsb2ctY29udGVudCB7XG4gICAgbWluLXdpZHRoOiAxMHJlbTtcbn1cblxuLmFsZXJ0LW1zZ3tcbiAgICBsaW5lLWhlaWdodDogbm9ybWFsO1xufVxuIl19 */"] });


/***/ }),

/***/ 59416:
/*!**********************************************************************************************!*\
  !*** ./projects/device/src/app/device/components/confirm-dialog/confirm-dialog.component.ts ***!
  \**********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConfirmDialogComponent": () => (/* binding */ ConfirmDialogComponent)
/* harmony export */ });
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/material/dialog */ 95758);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_material_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/material/button */ 87317);





const _c0 = function (a0) { return { "cancelButtononRightSide": a0 }; };
class ConfirmDialogComponent {
    constructor(input) {
        this.input = input;
    }
    ngOnInit() {
        var _a;
        this.message = this.input.message || "";
        this.title = this.input.title || "";
        this.cancel = this.input.cancel || "Cancel";
        this.ok = this.input.ok || "Ok";
        this.cancelButtononRightSide = (_a = this.input) === null || _a === void 0 ? void 0 : _a.cancelButtononRightSide;
        console.log("m", this.message, this.title, this.cancel, this.ok);
    }
    cancelClicked() {
        if (this.input.callback) {
            this.input.callback(null);
        }
    }
    okClicked() {
        if (this.input.callback) {
            this.input.callback("OK");
        }
    }
}
ConfirmDialogComponent.ɵfac = function ConfirmDialogComponent_Factory(t) { return new (t || ConfirmDialogComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MAT_DIALOG_DATA)); };
ConfirmDialogComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineComponent"]({ type: ConfirmDialogComponent, selectors: [["app-confirm-dialog"]], decls: 11, vars: 7, consts: [[1, "confirm-dialog"], ["matDialogTitle", ""], ["data-testid", "confirm-dialog-message"], ["align", "end"], ["mat-button", "", "matDialogClose", "cancel", "color", "dark", "data-testid", "confirm-dialog-cancel-button", 1, "cancel-button", 3, "ngClass", "click"], ["mat-button", "", "matDialogClose", "confirm", "color", "primary", "data-testid", "confirm-dialog-confirm-button", 1, "ok-button", 3, "click"]], template: function ConfirmDialogComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](0, "div", 0)(1, "h2", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](3, "mat-dialog-content")(4, "p", 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](5);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]()();
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](6, "mat-dialog-actions", 3)(7, "button", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵlistener"]("click", function ConfirmDialogComponent_Template_button_click_7_listener() { return ctx.cancelClicked(); });
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](8);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](9, "button", 5);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵlistener"]("click", function ConfirmDialogComponent_Template_button_click_9_listener() { return ctx.okClicked(); });
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](10);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]()()();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](ctx.title);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](ctx.message);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵpureFunction1"](5, _c0, ctx.cancelButtononRightSide));
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](ctx.cancel);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](ctx.ok);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_2__.NgClass, _angular_material_button__WEBPACK_IMPORTED_MODULE_3__.MatButton, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogClose, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogTitle, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogContent, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogActions], styles: [".mat-dialog-content[_ngcontent-%COMP%] {\n  overflow-y: auto;\n}\n.mat-dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\n  line-height: normal;\n}\n  .confirm-dialog .mat-dialog-container {\n  width: 80vw;\n  max-width: 325px;\n  min-height: 120px;\n}\n.cancelButtononRightSide[_ngcontent-%COMP%] {\n  order: 2;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZpcm0tZGlhbG9nLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUksZ0JBQUE7QUFBSjtBQUNJO0VBQ0ksbUJBQUE7QUFDUjtBQUdBO0VBQ0ksV0FBQTtFQUNBLGdCQUFBO0VBQ0EsaUJBQUE7QUFBSjtBQUlBO0VBQ0ksUUFBQTtBQURKIiwiZmlsZSI6ImNvbmZpcm0tZGlhbG9nLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLm1hdC1kaWFsb2ctY29udGVudHtcbiAgICAvLyBvdmVyZmxvdzogaGlkZGVuO1xuICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgcHtcbiAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcbiAgICB9XG59XG5cbjo6bmctZGVlcCAuY29uZmlybS1kaWFsb2cgLm1hdC1kaWFsb2ctY29udGFpbmVyIHtcbiAgICB3aWR0aDogODB2dztcbiAgICBtYXgtd2lkdGg6IDMyNXB4O1xuICAgIG1pbi1oZWlnaHQ6IDEyMHB4O1xuICAgIC8vIG1heC1oZWlnaHQ6IDkwdmg7XG59XG5cbi5jYW5jZWxCdXR0b25vblJpZ2h0U2lkZSB7XG4gICAgb3JkZXI6IDI7XG59XG4iXX0= */"] });


/***/ }),

/***/ 8068:
/*!*********************************************************!*\
  !*** ./projects/device/src/app/device/device.module.ts ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DeviceModule": () => (/* binding */ DeviceModule)
/* harmony export */ });
/* harmony import */ var _aigens_core_src_app_pure_base_page_params__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/core/src/app/pure/base/page-params */ 8744);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @angular/forms */ 90587);
/* harmony import */ var _angular_material_button__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @angular/material/button */ 87317);
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! @angular/material/dialog */ 95758);
/* harmony import */ var _angular_material_icon__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! @angular/material/icon */ 65590);
/* harmony import */ var _angular_material_input__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! @angular/material/input */ 43365);
/* harmony import */ var _angular_material_progress_spinner__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! @angular/material/progress-spinner */ 74742);
/* harmony import */ var _angular_material_select__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! @angular/material/select */ 91434);
/* harmony import */ var _angular_material_snack_bar__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @angular/material/snack-bar */ 32528);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var _core_src_app_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../core/src/app/framework */ 44651);
/* harmony import */ var _native_src_app_native_services_native_location_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../native/src/app/native/services/native-location.service */ 85542);
/* harmony import */ var _ui_src_app_ui_ui_module__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../ui/src/app/ui/ui.module */ 39420);
/* harmony import */ var _ux_src_app_ux_ux_module__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../ux/src/app/ux/ux.module */ 79420);
/* harmony import */ var _components_alert_dialog_alert_dialog_component__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./components/alert-dialog/alert-dialog.component */ 22691);
/* harmony import */ var _components_confirm_dialog_confirm_dialog_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./components/confirm-dialog/confirm-dialog.component */ 59416);
/* harmony import */ var _components_ProgressDialogComponent_ProgressDialogComponent_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./components/ProgressDialogComponent/ProgressDialogComponent.component */ 43632);
/* harmony import */ var _pages_setup_page_setup_page_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./pages/setup-page/setup-page.component */ 59294);
/* harmony import */ var _pages_test_page_test_page_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./pages/test-page/test-page.component */ 17251);
/* harmony import */ var _root_root_component__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./root/root.component */ 14525);
/* harmony import */ var ngx_moment__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ngx-moment */ 39692);
/* harmony import */ var _pages_logout_page_logout_page_component__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./pages/logout-page/logout-page.component */ 5450);
/* harmony import */ var _native_src_app_native_services_native_storage_service__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../../native/src/app/native/services/native-storage.service */ 87504);
/* harmony import */ var _core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../../core/src/app/pure/services/platform.service */ 45485);
/* harmony import */ var _native_src_app_native_services_native_platform_service__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../../native/src/app/native/services/native-platform.service */ 83815);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @angular/core */ 3184);





























const routes = [
    {
        path: '',
        component: _root_root_component__WEBPACK_IMPORTED_MODULE_10__.RootComponent,
        children: [
            {
                path: 'setup',
                component: _pages_setup_page_setup_page_component__WEBPACK_IMPORTED_MODULE_8__.SetupPageComponent,
                data: {
                    reuse: false,
                    auth: false,
                    entry: true,
                    checkpoint: true
                }
            },
            {
                path: 'logout',
                component: _pages_logout_page_logout_page_component__WEBPACK_IMPORTED_MODULE_11__.LogoutPageComponent,
                data: {
                    reuse: false,
                    auth: false,
                    entry: true,
                    checkpoint: true
                }
            }
        ]
    },
    {
        path: 'test',
        component: _root_root_component__WEBPACK_IMPORTED_MODULE_10__.RootComponent,
        children: [
            {
                path: '',
                component: _pages_test_page_test_page_component__WEBPACK_IMPORTED_MODULE_9__.TestPageComponent,
                data: {
                    reuse: false,
                    auth: false,
                    entry: true,
                    checkpoint: false
                }
            }
        ]
    }
];
class DeviceModule {
}
DeviceModule.ɵfac = function DeviceModule_Factory(t) { return new (t || DeviceModule)(); };
DeviceModule.ɵmod = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_15__["ɵɵdefineNgModule"]({ type: DeviceModule });
DeviceModule.ɵinj = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_15__["ɵɵdefineInjector"]({ providers: [
        _aigens_core_src_app_pure_base_page_params__WEBPACK_IMPORTED_MODULE_0__.PageParams,
        {
            provide: _core_src_app_framework__WEBPACK_IMPORTED_MODULE_1__.LocationService,
            useFactory: _native_src_app_native_services_native_location_service__WEBPACK_IMPORTED_MODULE_2__.NativeLocationService.locationServiceFactory,
        },
        {
            provide: _core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_13__.PlatformService,
            useClass: _native_src_app_native_services_native_platform_service__WEBPACK_IMPORTED_MODULE_14__.NativePlatformService,
        },
        _native_src_app_native_services_native_storage_service__WEBPACK_IMPORTED_MODULE_12__.NativeStorageService
    ], imports: [_angular_common__WEBPACK_IMPORTED_MODULE_16__.CommonModule,
        _angular_forms__WEBPACK_IMPORTED_MODULE_17__.FormsModule,
        _angular_router__WEBPACK_IMPORTED_MODULE_18__.RouterModule.forChild(routes),
        _ngx_translate_core__WEBPACK_IMPORTED_MODULE_19__.TranslateModule,
        _ui_src_app_ui_ui_module__WEBPACK_IMPORTED_MODULE_3__.UiModule,
        _ux_src_app_ux_ux_module__WEBPACK_IMPORTED_MODULE_4__.UxModule,
        _angular_material_button__WEBPACK_IMPORTED_MODULE_20__.MatButtonModule,
        //MatCheckboxModule,
        //MatToolbarModule,
        //MatChipsModule,
        //MatOptionModule,
        //MatGridListModule,
        //MatProgressBarModule,
        //MatSliderModule,
        //MatSlideToggleModule,
        //MatMenuModule,
        _angular_material_dialog__WEBPACK_IMPORTED_MODULE_21__.MatDialogModule,
        _angular_material_snack_bar__WEBPACK_IMPORTED_MODULE_22__.MatSnackBarModule,
        _angular_material_select__WEBPACK_IMPORTED_MODULE_23__.MatSelectModule,
        //MatExpansionModule,
        _angular_material_input__WEBPACK_IMPORTED_MODULE_24__.MatInputModule,
        //MatSidenavModule,
        //MatCardModule,
        _angular_material_icon__WEBPACK_IMPORTED_MODULE_25__.MatIconModule,
        //MatRadioModule,
        _angular_material_progress_spinner__WEBPACK_IMPORTED_MODULE_26__.MatProgressSpinnerModule,
        ngx_moment__WEBPACK_IMPORTED_MODULE_27__.MomentModule,
        //MatTabsModule,
        //MatListModule,
        //MatButtonToggleModule,
        _core_src_app_framework__WEBPACK_IMPORTED_MODULE_1__.FrameworkModule] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && _angular_core__WEBPACK_IMPORTED_MODULE_15__["ɵɵsetNgModuleScope"](DeviceModule, { declarations: [_root_root_component__WEBPACK_IMPORTED_MODULE_10__.RootComponent,
        _pages_setup_page_setup_page_component__WEBPACK_IMPORTED_MODULE_8__.SetupPageComponent,
        _pages_logout_page_logout_page_component__WEBPACK_IMPORTED_MODULE_11__.LogoutPageComponent,
        _pages_test_page_test_page_component__WEBPACK_IMPORTED_MODULE_9__.TestPageComponent,
        _components_ProgressDialogComponent_ProgressDialogComponent_component__WEBPACK_IMPORTED_MODULE_7__.ProgressDialogComponent,
        _components_alert_dialog_alert_dialog_component__WEBPACK_IMPORTED_MODULE_5__.AlertDialogComponent,
        _components_confirm_dialog_confirm_dialog_component__WEBPACK_IMPORTED_MODULE_6__.ConfirmDialogComponent], imports: [_angular_common__WEBPACK_IMPORTED_MODULE_16__.CommonModule,
        _angular_forms__WEBPACK_IMPORTED_MODULE_17__.FormsModule, _angular_router__WEBPACK_IMPORTED_MODULE_18__.RouterModule, _ngx_translate_core__WEBPACK_IMPORTED_MODULE_19__.TranslateModule,
        _ui_src_app_ui_ui_module__WEBPACK_IMPORTED_MODULE_3__.UiModule,
        _ux_src_app_ux_ux_module__WEBPACK_IMPORTED_MODULE_4__.UxModule,
        _angular_material_button__WEBPACK_IMPORTED_MODULE_20__.MatButtonModule,
        //MatCheckboxModule,
        //MatToolbarModule,
        //MatChipsModule,
        //MatOptionModule,
        //MatGridListModule,
        //MatProgressBarModule,
        //MatSliderModule,
        //MatSlideToggleModule,
        //MatMenuModule,
        _angular_material_dialog__WEBPACK_IMPORTED_MODULE_21__.MatDialogModule,
        _angular_material_snack_bar__WEBPACK_IMPORTED_MODULE_22__.MatSnackBarModule,
        _angular_material_select__WEBPACK_IMPORTED_MODULE_23__.MatSelectModule,
        //MatExpansionModule,
        _angular_material_input__WEBPACK_IMPORTED_MODULE_24__.MatInputModule,
        //MatSidenavModule,
        //MatCardModule,
        _angular_material_icon__WEBPACK_IMPORTED_MODULE_25__.MatIconModule,
        //MatRadioModule,
        _angular_material_progress_spinner__WEBPACK_IMPORTED_MODULE_26__.MatProgressSpinnerModule,
        ngx_moment__WEBPACK_IMPORTED_MODULE_27__.MomentModule,
        //MatTabsModule,
        //MatListModule,
        //MatButtonToggleModule,
        _core_src_app_framework__WEBPACK_IMPORTED_MODULE_1__.FrameworkModule] }); })();


/***/ }),

/***/ 5450:
/*!***********************************************************************************!*\
  !*** ./projects/device/src/app/device/pages/logout-page/logout-page.component.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LogoutPageComponent": () => (/* binding */ LogoutPageComponent)
/* harmony export */ });
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/animations */ 31631);
/* harmony import */ var aigens_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aigens-framework */ 44651);
/* harmony import */ var _native_src_app_native_services_native_storage_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../native/src/app/native/services/native-storage.service */ 87504);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ngx-translate/core */ 33935);









function LogoutPageComponent_button_6_Template(rf, ctx) { if (rf & 1) {
    const _r2 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](0, "button", 8);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵlistener"]("click", function LogoutPageComponent_button_6_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵrestoreView"](_r2); const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵresetView"](ctx_r1.continueClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpipe"](2, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpipeBind1"](2, 1, "logout.continue"));
} }
class LogoutPageComponent extends aigens_framework__WEBPACK_IMPORTED_MODULE_0__.BasePage {
    constructor(injector, storageService, nativeStorageService) {
        super(injector);
        this.injector = injector;
        this.storageService = storageService;
        this.nativeStorageService = nativeStorageService;
        this.showContinue = false;
        this.clearStation();
    }
    ngOnInit() {
        super.ngOnInit();
        setTimeout(() => {
            this.toSetupPage();
        }, 100);
        setTimeout(() => {
            this.showContinue = true;
        }, 600);
    }
    toSetupPage() {
        _native_src_app_native_services_native_storage_service__WEBPACK_IMPORTED_MODULE_1__.NativeStorageService.fromLogout = true;
        this.routingService.navigate("/device/setup", {
            queryParams: {}
        });
    }
    continueClicked() {
        this.clearStation();
        this.toSetupPage();
    }
    clearStation() {
        console.log("clearStation");
        this.storageService.setLocal("lastStation", null);
        this.nativeStorageService.setStorage("lastStation", null);
        this.sentryService.track("Clear Station", {});
    }
}
LogoutPageComponent.ɵfac = function LogoutPageComponent_Factory(t) { return new (t || LogoutPageComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_2__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdirectiveInject"](aigens_framework__WEBPACK_IMPORTED_MODULE_0__.StorageService), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdirectiveInject"](_native_src_app_native_services_native_storage_service__WEBPACK_IMPORTED_MODULE_1__.NativeStorageService)); };
LogoutPageComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineComponent"]({ type: LogoutPageComponent, selectors: [["app-logout-page"]], features: [_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵInheritDefinitionFeature"]], decls: 9, vars: 1, consts: [[1, "main-container"], [1, "bg-top"], ["src", "../../../../assets/images/bg02.svg"], [1, "bg-bottom"], ["src", "../../../../assets/images/bg01.svg"], [1, "logout-content"], ["class", "continue-btn", 3, "click", 4, "ngIf"], ["src", "../../../../assets/images/Aigens logn_3.svg"], [1, "continue-btn", 3, "click"]], template: function LogoutPageComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](0, "div", 0)(1, "div", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelement"](2, "img", 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](3, "div", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelement"](4, "img", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](5, "main", 5);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtemplate"](6, LogoutPageComponent_button_6_Template, 3, 3, "button", 6);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](7, "footer");
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelement"](8, "img", 7);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]()();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](6);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("ngIf", ctx.showContinue);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_3__.NgIf, _ngx_translate_core__WEBPACK_IMPORTED_MODULE_4__.TranslatePipe], styles: ["p[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%] {\n  margin: 0;\n}\n\n[_nghost-%COMP%] {\n  display: block;\n  height: 100%;\n}\n\n.top[_ngcontent-%COMP%] {\n  position: relative;\n  height: 100%;\n}\n\n.logout-content[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.logout-content[_ngcontent-%COMP%]   .continue-btn[_ngcontent-%COMP%] {\n  padding: 1rem;\n  font-size: 1rem;\n}\n\nbutton[_ngcontent-%COMP%] {\n  margin: 10px;\n}\n\n.main-container[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n  height: auto;\n  min-height: 100%;\n  color: #fff;\n  \n  background: rgb(31, 33, 40);   \n  background: linear-gradient(135deg, rgb(31, 33, 40) 30%, rgb(33, 47, 77) 100%); \n  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=\"#1f2128\", endColorstr=\"#212f4d\",GradientType=1 ); \n}\n\nmain[_ngcontent-%COMP%] {\n  width: 100%;\n  max-width: 30rem;\n  flex: 1 1 auto;\n  margin: 0 auto;\n}\n\nmain.scan-page[_ngcontent-%COMP%] {\n  position: relative;\n  padding: 1rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: calc(100% - 2rem);\n}\n\nmain.scan-page[_ngcontent-%COMP%]   .btn-public[_ngcontent-%COMP%] {\n  width: 15rem;\n  position: absolute;\n  bottom: 0;\n  left: 50%;\n  transform: translateX(-50%);\n}\n\nfooter[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  padding: 1.5rem 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\nfooter[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  width: 7rem;\n}\n\n.bg-top[_ngcontent-%COMP%] {\n  z-index: 0;\n  width: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  max-width: 30rem;\n}\n\n.bg-top[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  width: 100%;\n}\n\n.bg-bottom[_ngcontent-%COMP%] {\n  max-width: 30rem;\n  z-index: 0;\n  width: 100%;\n  position: fixed;\n  bottom: 0;\n  right: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n}\n\n.bg-bottom[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  width: 100%;\n}\n\n.header-wrapper[_ngcontent-%COMP%] {\n  display: flex;\n  margin-top: 4rem;\n  margin-bottom: 1.5rem;\n  align-items: flex-start;\n}\n\n.header-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  margin-right: 0.5rem;\n  width: 1.4rem;\n  margin-top: 0.2rem;\n}\n\n.header-inner[_ngcontent-%COMP%] {\n  font-size: 2.6rem;\n  line-height: 1em;\n  text-transform: uppercase;\n  color: #36B4E5;\n  letter-spacing: 0.05rem;\n}\n\n.content-wrapper[_ngcontent-%COMP%] {\n  background: #2B2F37;\n  box-shadow: 0 0.5rem 0.8rem 0 rgba(0, 0, 0, 0.3);\n  border-radius: 0.5rem;\n  margin: 0 1.5rem;\n  padding: 1.5rem 1rem;\n  margin-bottom: 1rem;\n}\n\n.scan-inner[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n}\n\n.scan-inner[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  width: 3rem;\n  flex: 0 0 3rem;\n  margin-right: 0.5rem;\n}\n\n.scan-inner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\n  font-size: 1rem;\n}\n\n.scan-inner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n  color: #36B4E5;\n}\n\n.btn-public[_ngcontent-%COMP%] {\n  background: #36B4E5;\n  margin: 0;\n  margin-top: 1rem;\n  width: 100%;\n  color: #fff;\n}\n\n.btn-public.outline[_ngcontent-%COMP%] {\n  background: transparent;\n  box-shadow: 0 0 0 1px #36B4E5;\n  color: #36B4E5;\n}\n\n.btn-public.margin-reset[_ngcontent-%COMP%] {\n  margin-top: 0;\n}\n\n.input-field[_ngcontent-%COMP%] {\n  width: 100%;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-input-element {\n  color: #fff;\n  font-size: 1.5rem;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-form-field-label {\n  color: #36B4E5;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-form-field-underline {\n  background-color: #36B4E5;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-form-field-ripple {\n  background-color: #36B4E5;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-form-field-required-marker {\n  color: #36B4E5;\n}\n\n.store-info[_ngcontent-%COMP%] {\n  font-size: 1rem;\n  line-height: 1.6em;\n}\n\n.auto-time[_ngcontent-%COMP%]   .btn-public[_ngcontent-%COMP%] {\n  margin-bottom: 1rem;\n  margin-top: 0;\n}\n\n@media not screen and (max-width: 767px) {\n  .scanner-inner[_ngcontent-%COMP%] {\n    width: 30rem;\n    height: 30rem;\n  }\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ291dC1wYWdlLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksU0FBQTtBQUNKOztBQUdBO0VBQ0ksY0FBQTtFQUNBLFlBQUE7QUFBSjs7QUFHQTtFQUNJLGtCQUFBO0VBQ0EsWUFBQTtBQUFKOztBQUdBO0VBQ0ksYUFBQTtFQUNBLHVCQUFBO0VBQ0EsbUJBQUE7QUFBSjs7QUFDSTtFQUNJLGFBQUE7RUFDQSxlQUFBO0FBQ1I7O0FBR0E7RUFDSSxZQUFBO0FBQUo7O0FBR0E7RUFDSSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7RUFDQSxXQUFBO0VBQ0Esa0hBQUE7RUFDQSwyQkFBQSxFQUFBLGlCQUFBLEVBQ0EsYUFBQSxFQUNBLDRCQUFBO0VBQ0EsOEVBQUEsRUFBQSxxREFBQTtFQUNBLG1IQUFBLEVBQUEsMENBQUE7QUFBSjs7QUFLQTtFQUNJLFdBQUE7RUFDQSxnQkFBQTtFQUNBLGNBQUE7RUFDQSxjQUFBO0FBRko7O0FBR0k7RUFDSSxrQkFBQTtFQUNBLGFBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtFQUNBLHdCQUFBO0FBRFI7O0FBRVE7RUFDSSxZQUFBO0VBQ0Esa0JBQUE7RUFDQSxTQUFBO0VBQ0EsU0FBQTtFQUNBLDJCQUFBO0FBQVo7O0FBSUE7RUFDSSxjQUFBO0VBQ0EsaUJBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtBQURKOztBQUVJO0VBQ0ksV0FBQTtBQUFSOztBQUdBO0VBQ0ksVUFBQTtFQUNBLFdBQUE7RUFDQSxlQUFBO0VBQ0EsTUFBQTtFQUNBLE9BQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSwyQkFBQTtFQUNBLGdCQUFBO0FBQUo7O0FBQ0k7RUFDSSxXQUFBO0FBQ1I7O0FBR0E7RUFDSSxnQkFBQTtFQUNBLFVBQUE7RUFDQSxXQUFBO0VBQ0EsZUFBQTtFQUNBLFNBQUE7RUFDQSxRQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0VBQ0EseUJBQUE7QUFBSjs7QUFDSTtFQUNJLFdBQUE7QUFDUjs7QUFFQTtFQUNJLGFBQUE7RUFDQSxnQkFBQTtFQUNBLHFCQUFBO0VBQ0EsdUJBQUE7QUFDSjs7QUFBSTtFQUNJLG9CQUFBO0VBQ0EsYUFBQTtFQUNBLGtCQUFBO0FBRVI7O0FBQ0E7RUFDSSxpQkFBQTtFQUNBLGdCQUFBO0VBQ0EseUJBQUE7RUFDQSxjQUFBO0VBQ0EsdUJBQUE7QUFFSjs7QUFBQTtFQUNJLG1CQUFBO0VBQ0EsZ0RBQUE7RUFDQSxxQkFBQTtFQUNBLGdCQUFBO0VBQ0Esb0JBQUE7RUFDQSxtQkFBQTtBQUdKOztBQURBO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0FBSUo7O0FBSEk7RUFDSSxXQUFBO0VBQ0EsY0FBQTtFQUNBLG9CQUFBO0FBS1I7O0FBSEk7RUFDSSxlQUFBO0FBS1I7O0FBSlE7RUFDSSxjQUFBO0FBTVo7O0FBRkE7RUFDSSxtQkFBQTtFQUNBLFNBQUE7RUFDQSxnQkFBQTtFQUNBLFdBQUE7RUFDQSxXQUFBO0FBS0o7O0FBSkk7RUFDSSx1QkFBQTtFQUNBLDZCQUFBO0VBQ0EsY0FBQTtBQU1SOztBQUpJO0VBQ0ksYUFBQTtBQU1SOztBQUhBO0VBQ0ksV0FBQTtBQU1KOztBQUhRO0VBQ0ksV0FBQTtFQUNBLGlCQUFBO0FBS1o7O0FBSFE7RUFDSSxjQUFBO0FBS1o7O0FBSFE7RUFDSSx5QkFBQTtBQUtaOztBQUhRO0VBQ0kseUJBQUE7QUFLWjs7QUFIUTtFQUNJLGNBQUE7QUFLWjs7QUFFQTtFQUNJLGVBQUE7RUFDQSxrQkFBQTtBQUNKOztBQUVJO0VBQ0ksbUJBQUE7RUFDQSxhQUFBO0FBQ1I7O0FBS0E7RUFDSTtJQUNJLFlBQUE7SUFDQSxhQUFBO0VBRk47QUFDRiIsImZpbGUiOiJsb2dvdXQtcGFnZS5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbInAsIGgxLCBoMiwgaDMsIGg0LCBoNSwgaDZ7XG4gICAgbWFyZ2luOiAwO1xufVxuXG5cbjpob3N0IHtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICBoZWlnaHQ6IDEwMCU7XG59XG5cbi50b3B7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIGhlaWdodDogMTAwJTtcbn1cblxuLmxvZ291dC1jb250ZW50IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgLmNvbnRpbnVlLWJ0biB7XG4gICAgICAgIHBhZGRpbmc6IDFyZW07XG4gICAgICAgIGZvbnQtc2l6ZTogMXJlbTtcbiAgICB9XG59XG5cbmJ1dHRvbntcbiAgICBtYXJnaW46IDEwcHg7XG59XG5cbi5tYWluLWNvbnRhaW5lcntcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgaGVpZ2h0OiBhdXRvO1xuICAgIG1pbi1oZWlnaHQ6IDEwMCU7XG4gICAgY29sb3I6ICNmZmY7XG4gICAgLyogUGVybWFsaW5rIC0gdXNlIHRvIGVkaXQgYW5kIHNoYXJlIHRoaXMgZ3JhZGllbnQ6IGh0dHBzOi8vY29sb3J6aWxsYS5jb20vZ3JhZGllbnQtZWRpdG9yLyMxZjIxMjgrMzAsMjEyZjRkKzEwMCAqL1xuICAgIGJhY2tncm91bmQ6IHJnYigzMSwzMyw0MCk7IC8qIE9sZCBicm93c2VycyAqL1xuICAgIGJhY2tncm91bmQ6IC1tb3otbGluZWFyLWdyYWRpZW50KC00NWRlZywgIHJnYmEoMzEsMzMsNDAsMSkgMzAlLCByZ2JhKDMzLDQ3LDc3LDEpIDEwMCUpOyAvKiBGRjMuNi0xNSAqL1xuICAgIGJhY2tncm91bmQ6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KC00NWRlZywgIHJnYmEoMzEsMzMsNDAsMSkgMzAlLHJnYmEoMzMsNDcsNzcsMSkgMTAwJSk7IC8qIENocm9tZTEwLTI1LFNhZmFyaTUuMS02ICovXG4gICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIHJnYmEoMzEsMzMsNDAsMSkgMzAlLHJnYmEoMzMsNDcsNzcsMSkgMTAwJSk7IC8qIFczQywgSUUxMCssIEZGMTYrLCBDaHJvbWUyNissIE9wZXJhMTIrLCBTYWZhcmk3KyAqL1xuICAgIGZpbHRlcjogcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KCBzdGFydENvbG9yc3RyPScjMWYyMTI4JywgZW5kQ29sb3JzdHI9JyMyMTJmNGQnLEdyYWRpZW50VHlwZT0xICk7IC8qIElFNi05IGZhbGxiYWNrIG9uIGhvcml6b250YWwgZ3JhZGllbnQgKi9cblxuXG5cbn1cbm1haW57XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgbWF4LXdpZHRoOiAzMHJlbTtcbiAgICBmbGV4OiAxIDEgYXV0bztcbiAgICBtYXJnaW46IDAgYXV0bztcbiAgICAmLnNjYW4tcGFnZXtcbiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICBwYWRkaW5nOiAxcmVtO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgd2lkdGg6IGNhbGMoMTAwJSAtIDJyZW0pO1xuICAgICAgICAuYnRuLXB1YmxpY3tcbiAgICAgICAgICAgIHdpZHRoOiAxNXJlbTtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgIGJvdHRvbTogMDtcbiAgICAgICAgICAgIGxlZnQ6IDUwJTtcbiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZvb3RlcntcbiAgICBmbGV4OiAwIDAgYXV0bztcbiAgICBwYWRkaW5nOiAxLjVyZW0gMDtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgaW1ne1xuICAgICAgICB3aWR0aDogN3JlbTtcbiAgICB9XG59XG4uYmctdG9we1xuICAgIHotaW5kZXg6IDA7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgcG9zaXRpb246IGZpeGVkO1xuICAgIHRvcDogMDtcbiAgICBsZWZ0OiAwO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7XG4gICAgbWF4LXdpZHRoOiAzMHJlbTtcbiAgICBpbWd7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgIH1cblxufVxuLmJnLWJvdHRvbXtcbiAgICBtYXgtd2lkdGg6IDMwcmVtO1xuICAgIHotaW5kZXg6IDA7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgcG9zaXRpb246IGZpeGVkO1xuICAgIGJvdHRvbTogMDtcbiAgICByaWdodDogMDtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbiAgICBpbWd7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgIH1cbn1cbi5oZWFkZXItd3JhcHBlcntcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIG1hcmdpbi10b3A6IDRyZW07XG4gICAgbWFyZ2luLWJvdHRvbTogMS41cmVtO1xuICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xuICAgIGltZ3tcbiAgICAgICAgbWFyZ2luLXJpZ2h0OiAwLjVyZW07XG4gICAgICAgIHdpZHRoOiAxLjRyZW07XG4gICAgICAgIG1hcmdpbi10b3A6IDAuMnJlbTtcbiAgICB9XG59XG4uaGVhZGVyLWlubmVye1xuICAgIGZvbnQtc2l6ZTogMi42cmVtO1xuICAgIGxpbmUtaGVpZ2h0OiAxZW07XG4gICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcbiAgICBjb2xvcjogIzM2QjRFNTtcbiAgICBsZXR0ZXItc3BhY2luZzowLjA1cmVtXG59XG4uY29udGVudC13cmFwcGVye1xuICAgIGJhY2tncm91bmQ6ICMyQjJGMzc7XG4gICAgYm94LXNoYWRvdzogMCAwLjVyZW0gMC44cmVtIDAgcmdiYSgwLDAsMCwwLjMpO1xuICAgIGJvcmRlci1yYWRpdXM6IDAuNXJlbTtcbiAgICBtYXJnaW46IDAgMS41cmVtO1xuICAgIHBhZGRpbmc6IDEuNXJlbSAxcmVtO1xuICAgIG1hcmdpbi1ib3R0b206IDFyZW07XG59XG4uc2Nhbi1pbm5lcntcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgaW1ne1xuICAgICAgICB3aWR0aDogM3JlbTtcbiAgICAgICAgZmxleDogMCAwIDNyZW07XG4gICAgICAgIG1hcmdpbi1yaWdodDogMC41cmVtO1xuICAgIH1cbiAgICBwe1xuICAgICAgICBmb250LXNpemU6IDFyZW07XG4gICAgICAgIHNwYW57XG4gICAgICAgICAgICBjb2xvcjogIzM2QjRFNTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi5idG4tcHVibGlje1xuICAgIGJhY2tncm91bmQ6ICMzNkI0RTU7XG4gICAgbWFyZ2luOiAwO1xuICAgIG1hcmdpbi10b3A6IDFyZW07XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgY29sb3I6ICNmZmY7XG4gICAgJi5vdXRsaW5le1xuICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgICAgICAgYm94LXNoYWRvdzogMCAwIDAgMXB4ICMzNkI0RTU7XG4gICAgICAgIGNvbG9yOiAjMzZCNEU1O1xuICAgIH1cbiAgICAmLm1hcmdpbi1yZXNldHtcbiAgICAgICAgbWFyZ2luLXRvcDogMDtcbiAgICB9XG59XG4uaW5wdXQtZmllbGR7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgJjo6bmctZGVlcHtcblxuICAgICAgICAubWF0LWlucHV0LWVsZW1lbnQge1xuICAgICAgICAgICAgY29sb3I6ICNmZmY7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNXJlbTtcbiAgICAgICAgfVxuICAgICAgICAubWF0LWZvcm0tZmllbGQtbGFiZWwge1xuICAgICAgICAgICAgY29sb3I6ICMzNkI0RTU7XG4gICAgICAgIH1cbiAgICAgICAgLm1hdC1mb3JtLWZpZWxkLXVuZGVybGluZSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzZCNEU1O1xuICAgICAgICB9XG4gICAgICAgIC5tYXQtZm9ybS1maWVsZC1yaXBwbGUge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzM2QjRFNTtcbiAgICAgICAgfVxuICAgICAgICAubWF0LWZvcm0tZmllbGQtcmVxdWlyZWQtbWFya2VyIHtcbiAgICAgICAgICAgIGNvbG9yOiAjMzZCNEU1O1xuICAgICAgICB9XG5cblxuXG4gICAgfVxufVxuLnN0b3JlLWluZm97XG4gICAgZm9udC1zaXplOiAxcmVtO1xuICAgIGxpbmUtaGVpZ2h0OiAxLjZlbTtcbn1cbi5hdXRvLXRpbWV7XG4gICAgLmJ0bi1wdWJsaWN7XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07XG4gICAgICAgIG1hcmdpbi10b3A6IDA7XG4gICAgfVxufVxuXG5cblxuQG1lZGlhIG5vdCBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDc2N3B4KXtcbiAgICAuc2Nhbm5lci1pbm5lcntcbiAgICAgICAgd2lkdGg6IDMwcmVtO1xuICAgICAgICBoZWlnaHQ6IDMwcmVtO1xuICAgIH1cblxufVxuIl19 */"], data: { animation: [
            (0,_angular_animations__WEBPACK_IMPORTED_MODULE_5__.trigger)('catInOut', [
                (0,_angular_animations__WEBPACK_IMPORTED_MODULE_5__.transition)(':enter', [
                    (0,_angular_animations__WEBPACK_IMPORTED_MODULE_5__.style)({ opacity: 0, transform: 'translateX(50%)' }),
                    (0,_angular_animations__WEBPACK_IMPORTED_MODULE_5__.animate)('300ms ease-out', (0,_angular_animations__WEBPACK_IMPORTED_MODULE_5__.style)({ opacity: 1, transform: 'translateX(0)' })),
                ]),
                //   transition(':leave', [
                //     animate('300ms ease-in-out', style({ opacity: 0, transform: 'translateX(-50%)' }))
                //   ])
            ]),
        ] } });


/***/ }),

/***/ 59294:
/*!*********************************************************************************!*\
  !*** ./projects/device/src/app/device/pages/setup-page/setup-page.component.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ActivateMode": () => (/* binding */ ActivateMode),
/* harmony export */   "SetupPageComponent": () => (/* binding */ SetupPageComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _angular_animations__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! @angular/animations */ 31631);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _capacitor_toast__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @capacitor/toast */ 75881);
/* harmony import */ var aigens_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aigens-framework */ 44651);
/* harmony import */ var _native_src_app_native_services_native_storage_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../native/src/app/native/services/native-storage.service */ 87504);
/* harmony import */ var _capacitor_device__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @capacitor/device */ 4744);
/* harmony import */ var _capacitor_camera__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @capacitor/camera */ 4241);
/* harmony import */ var _core_src_app_framework_directives_select_by_keyboard__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../../core/src/app/framework/directives/select-by-keyboard */ 44723);
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! lodash-es */ 45269);
/* harmony import */ var _aigens_aigens_sdk_adyen__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @aigens/aigens-sdk-adyen */ 73961);
/* harmony import */ var _aigens_aigens_sdk_sunmi_printer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @aigens/aigens-sdk-sunmi-printer */ 41759);
/* harmony import */ var _aigens_virtual_keyboard__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @aigens/virtual-keyboard */ 6098);
/* harmony import */ var _native_src_app_native_services_native_camera_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../../../native/src/app/native/services/native-camera.service */ 96190);
/* harmony import */ var _merchant_src_app_native_services_native_app_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../../../merchant/src/app/native/services/native.app.service */ 87118);
/* harmony import */ var _native_src_app_native_services_native_notification_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../../../native/src/app/native/services/native-notification.service */ 75125);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @angular/forms */ 90587);
/* harmony import */ var _angular_material_button__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @angular/material/button */ 87317);
/* harmony import */ var _angular_material_form_field__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @angular/material/form-field */ 44770);
/* harmony import */ var _angular_material_input__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @angular/material/input */ 43365);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @ngx-translate/core */ 33935);












// const { VirtualKeyboardJs } = require('@aigens/electron-virtual-keyboard')
// import { VirtualKeyboardJs } from '@aigens/electron-virtual-keyboard';













function SetupPageComponent_div_0_div_16_Template(rf, ctx) { if (rf & 1) {
    const _r8 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "div", 18)(1, "div", 19);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelement"](2, "img", 20);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](3, "p");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](5, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](6, "button", 21);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵlistener"]("click", function SetupPageComponent_div_0_div_16_Template_button_click_6_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵrestoreView"](_r8); const ctx_r7 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](2); return _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵresetView"](ctx_r7.scanClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](7);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](8, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]()();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("@catInOut", undefined);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](5, 3, "setup.scan-text"), " ");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](8, 5, "setup.scan-qr"), " ");
} }
function SetupPageComponent_div_0_div_17_Template(rf, ctx) { if (rf & 1) {
    const _r10 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "div", 18)(1, "mat-form-field", 22)(2, "mat-label");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](4, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](5, "input", 23);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵlistener"]("ngModelChange", function SetupPageComponent_div_0_div_17_Template_input_ngModelChange_5_listener($event) { _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵrestoreView"](_r10); const ctx_r9 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](2); return _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵresetView"](ctx_r9.installCode = $event); });
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelement"](6, "div", 24);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](7, "div")(8, "button", 25);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵlistener"]("click", function SetupPageComponent_div_0_div_17_Template_button_click_8_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵrestoreView"](_r10); const ctx_r11 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](2); return _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵresetView"](ctx_r11.setupClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](9);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](10, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]()()();
} if (rf & 2) {
    const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("@catInOut", undefined);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](4, 4, "setup.installation-code"));
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngModel", ctx_r3.installCode);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](10, 6, "setup.install"), " ");
} }
function SetupPageComponent_div_0_div_18_p_2_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "p");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](2, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r12 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate2"]("", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](2, 2, "setup.store"), ": ", ctx_r12.station == null ? null : ctx_r12.station.store == null ? null : ctx_r12.station.store.name, "");
} }
function SetupPageComponent_div_0_div_18_p_6_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "p");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](2, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r13 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate2"]("", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](2, 2, "setup.number"), ": ", ctx_r13.station == null ? null : ctx_r13.station.number, "");
} }
function SetupPageComponent_div_0_div_18_div_7_Template(rf, ctx) { if (rf & 1) {
    const _r16 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "div", 29)(1, "button", 30);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵlistener"]("click", function SetupPageComponent_div_0_div_18_div_7_Template_button_click_1_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵrestoreView"](_r16); const ctx_r15 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](3); return _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵresetView"](ctx_r15.goClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](3, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](4, "button", 31);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵlistener"]("click", function SetupPageComponent_div_0_div_18_div_7_Template_button_click_4_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵrestoreView"](_r16); const ctx_r17 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](3); return _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵresetView"](ctx_r17.logoutClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](5);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](6, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]()();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("@catInOut", undefined);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](3, 3, "setup.activate-device"), " ");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](6, 5, "setup.remove-device"), " ");
} }
function SetupPageComponent_div_0_div_18_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "div", 18)(1, "div", 26);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](2, SetupPageComponent_div_0_div_18_p_2_Template, 3, 4, "p", 27);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](3, "p");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](5, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](6, SetupPageComponent_div_0_div_18_p_6_Template, 3, 4, "p", 27);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](7, SetupPageComponent_div_0_div_18_div_7_Template, 7, 7, "div", 28);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r4 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("@catInOut", undefined);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", ctx_r4.station.store);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate2"]("", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](5, 6, "setup.type"), ": ", ctx_r4.station == null ? null : ctx_r4.station.type, "");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", ctx_r4.station.number);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", !ctx_r4.autoLoginTime && ctx_r4.station);
} }
function SetupPageComponent_div_0_div_19_div_7_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "div", 34);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](2, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](3, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]()();
} if (rf & 2) {
    const ctx_r18 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("@catInOut", undefined);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](2, 3, "setup.auto-activate"), " ");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"]("", ctx_r18.remainingSeconds, "s");
} }
function SetupPageComponent_div_0_div_19_Template(rf, ctx) { if (rf & 1) {
    const _r20 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "div", 32)(1, "button", 30);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵlistener"]("click", function SetupPageComponent_div_0_div_19_Template_button_click_1_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵrestoreView"](_r20); const ctx_r19 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](2); return _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵresetView"](ctx_r19.goClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](3, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](4, "button", 31);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵlistener"]("click", function SetupPageComponent_div_0_div_19_Template_button_click_4_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵrestoreView"](_r20); const ctx_r21 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](2); return _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵresetView"](ctx_r21.cancelClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](5);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](6, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](7, SetupPageComponent_div_0_div_19_div_7_Template, 5, 5, "div", 33);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r5 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("@catInOut", undefined);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](3, 4, "setup.activate-device"), " ");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](6, 6, "setup.cancel"), " ");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", ctx_r5.remainingSeconds);
} }
function SetupPageComponent_div_0_span_22_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "span", 35);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r6 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"]("V", ctx_r6.appInfo == null ? null : ctx_r6.appInfo.version, "");
} }
const _c0 = function (a0) { return { "scan-page": a0 }; };
function SetupPageComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r23 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "div", 2)(1, "div", 3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelement"](2, "img", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](3, "div", 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelement"](4, "img", 6);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](5, "main", 7)(6, "div", 8)(7, "div", 9)(8, "div", 10);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelement"](9, "img", 11);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](10, "div", 12);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](11, "Universal ");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelement"](12, "br");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](13, " Device ");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](14, "button", 13);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵlistener"]("click", function SetupPageComponent_div_0_Template_button_click_14_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵrestoreView"](_r23); const ctx_r22 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵresetView"](ctx_r22.changeLanguage()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](15);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](16, SetupPageComponent_div_0_div_16_Template, 9, 7, "div", 14);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](17, SetupPageComponent_div_0_div_17_Template, 11, 8, "div", 14);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](18, SetupPageComponent_div_0_div_18_Template, 8, 8, "div", 14);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](19, SetupPageComponent_div_0_div_19_Template, 8, 8, "div", 15);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]()()();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](20, "footer");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelement"](21, "img", 16);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](22, SetupPageComponent_div_0_span_22_Template, 2, 1, "span", 17);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]()();
} if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](5);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpureFunction1"](7, _c0, ctx_r0.scanning));
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](10);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate"](ctx_r0.showLanguage);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", !ctx_r0.station);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", !ctx_r0.station);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", ctx_r0.station);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", ctx_r0.station && ctx_r0.autoLoginTime && ctx_r0.remainingSeconds);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", ctx_r0.appInfo == null ? null : ctx_r0.appInfo.version);
} }
function SetupPageComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r25 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](0, "div", 36);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelement"](1, "div", 37);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementStart"](2, "button", 38);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵlistener"]("click", function SetupPageComponent_div_1_Template_button_click_2_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵrestoreView"](_r25); const ctx_r24 = _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵresetView"](ctx_r24.stopScan()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipe"](4, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵelementEnd"]()();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵpipeBind1"](4, 1, "setup.stop-scan"), " ");
} }
class SetupPageComponent extends aigens_framework__WEBPACK_IMPORTED_MODULE_1__.BasePage {
    constructor(injector, 
    //private storageService: StorageService,
    cameraService, nativeStorageService, nativeAppService, nativeNotificationService) {
        super(injector);
        this.injector = injector;
        this.cameraService = cameraService;
        this.nativeStorageService = nativeStorageService;
        this.nativeAppService = nativeAppService;
        this.nativeNotificationService = nativeNotificationService;
        this.scanning = false;
        this.busy = false;
        this.LAST_STATION_KEY = "lastStation";
        this.activateMode = ActivateMode.manual;
        this.countDown = 3;
        this.fromLogout = false;
        this.timestampToFormattedDate = (timestamp) => {
            const date = new Date(timestamp);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        };
        // this.logoutClicked();
        this.getDeviceId();
        this.virtualKeyboardJs = new _aigens_virtual_keyboard__WEBPACK_IMPORTED_MODULE_8__["default"]();
    }
    getDeviceId() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            if (this.deviceId) {
                return this.deviceId;
            }
            const r = yield _capacitor_device__WEBPACK_IMPORTED_MODULE_3__.Device.getId();
            const d = r;
            this.deviceId = (d === null || d === void 0 ? void 0 : d.identifier) || (d === null || d === void 0 ? void 0 : d.uuid);
            return this.deviceId;
        });
    }
    getUIRefreshInterval() {
        return 1000;
    }
    onRefreshUI() {
        if (this.autoLoginTime) {
            var now = new Date().getTime();
            var diff = this.autoLoginTime - now;
            if (diff < 0) {
                //go login
                setTimeout(() => {
                    this.autoLoginTime = null;
                }, 2000);
                this.remainingSeconds = null;
                this.goClicked();
            }
            else {
                this.remainingSeconds = Math.ceil(diff / 1000);
            }
        }
    }
    setAlert(alert) {
        _core_src_app_framework_directives_select_by_keyboard__WEBPACK_IMPORTED_MODULE_5__.SelectByKeyboardService.setCurrentAlert(alert);
    }
    init() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            /* Peter: commented out, don't use any local storage to test if native storage works
            this.station = this.storageService.getLocal(this.LAST_STATION_KEY);
            if (this.station) {
                this.nativeStorageService.setStorage(this.LAST_STATION_KEY, this.station);
            }else {
                this.station = await this.nativeStorageService.getStorage(this.LAST_STATION_KEY);
            }
            */
            this.getNormalConfig();
            try {
                this.station = yield this.nativeStorageService.getStorage(this.LAST_STATION_KEY);
                this.appInfo = yield this.nativeAppService.getAppInfo();
            }
            catch (error) {
            }
            console.log("station:", this.station);
            if (!this.station) {
                this.getStations();
            }
            else {
                this.getStationById();
                this.setData(this.station);
            }
            this.showLanguage = this.t.currentLang == 'en' ? 'ZH' : 'EN';
            if (this.virtualKeyboardJs.isElectron()) {
                this.virtualKeyboardJs.setInput(".installcode-input", ".installcode-kb-container", (key, input) => {
                    console.log('setInput:', key, input);
                }, {
                    show: false,
                    autoPosition: false
                });
            }
        });
    }
    changeLanguage() {
        const locale = this.t.currentLang == 'en' ? 'zh' : 'en';
        this.showLanguage = locale == 'en' ? 'ZH' : 'EN';
        this.t.setDefaultLang(locale);
        this.t.use(locale);
        this.configService.setLocale(locale);
        this.mergeTranslation();
    }
    setActivateMode(aigensDevice) {
        var _a;
        const isForceActivateMode = (aigensDevice === null || aigensDevice === void 0 ? void 0 : aigensDevice.isForceActivateMode) || false;
        let activateMode = ((_a = this.station) === null || _a === void 0 ? void 0 : _a.activateMode) || (aigensDevice === null || aigensDevice === void 0 ? void 0 : aigensDevice.activateMode) || this.activateMode;
        // test
        // const loginBehavior: any = ActivateMode.CountDownLogin;
        const isfrom = _native_src_app_native_services_native_storage_service__WEBPACK_IMPORTED_MODULE_2__.NativeStorageService.fromLogout;
        if (isfrom && !isForceActivateMode) {
            activateMode = ActivateMode.manual;
        }
        _native_src_app_native_services_native_storage_service__WEBPACK_IMPORTED_MODULE_2__.NativeStorageService.fromLogout = false;
        switch (activateMode) {
            case ActivateMode.auto:
                this.goClicked();
                break;
            case ActivateMode.countdown:
                const autoCountDown = (aigensDevice === null || aigensDevice === void 0 ? void 0 : aigensDevice.autoCountDown) || 3000;
                this.autoLoginTime = new Date().getTime() + autoCountDown;
                break;
            case ActivateMode.manual:
                this.autoLoginTime = null;
                break;
        }
    }
    getStationById() {
        var _a, _b;
        const id = (_a = this.station) === null || _a === void 0 ? void 0 : _a.stationId;
        const apiKey = (_b = this.station) === null || _b === void 0 ? void 0 : _b.apiKey;
        if (!id || !apiKey)
            return;
        const host = (0,_angular_core__WEBPACK_IMPORTED_MODULE_12__.isDevMode)() ? "https://aigensstoretest.appspot.com" : "https://auth2.aigens.com";
        const url = `${host}/api/v1/store/station/${id}.json`;
        const headers = {
            "Authorization": "Bearer " + apiKey
        };
        this.dataService.getRawWithHeaders(url, {}, false, headers).subscribe({
            next: rsp => {
                var _a;
                // console.log("rsp", rsp);
                const activateMode = (_a = rsp === null || rsp === void 0 ? void 0 : rsp.data) === null || _a === void 0 ? void 0 : _a.activateMode;
                if (activateMode) {
                    this.station.activateMode = activateMode;
                    this.nativeStorageService.setStorage(this.LAST_STATION_KEY, this.station);
                }
            },
            error: err => {
                console.log("err", err);
            }
        });
    }
    // for temp
    getNormalConfig() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            const mod = (0,_angular_core__WEBPACK_IMPORTED_MODULE_12__.isDevMode)() ? 'uat' : 'prd';
            const key = `aigens-device-config-${mod}`;
            this.nativeStorageService.getStorage(key).then(rsp => {
                if (rsp)
                    window['aigensDeviceNormal'] = rsp;
                this.insertStyle();
            });
            // hardcode first
            const url = `https://aigensstoretest.aigens.com/api/v1/store/config.json?type=byod&storeId=5704131641606144&t=${new Date().getTime()}`;
            this.dataService.getRaw(url, {}).subscribe(rsp => {
                var _a, _b;
                const aigensDevice = (_b = (_a = rsp === null || rsp === void 0 ? void 0 : rsp.data) === null || _a === void 0 ? void 0 : _a.data) === null || _b === void 0 ? void 0 : _b[mod];
                window['aigensDeviceNormal'] = aigensDevice;
                this.nativeStorageService.setStorage(key, aigensDevice);
                this.insertStyle();
            }, err => {
                console.log("err:", err);
            });
        });
    }
    insertStyle() {
        var _a;
        this.mergeTranslation(window['aigensDeviceNormal']);
        var styleContent = (_a = window['aigensDeviceNormal']) === null || _a === void 0 ? void 0 : _a.cssStyle;
        if (!styleContent)
            return;
        const id = "device-style-id-normal";
        var style = document.getElementById(id);
        if (style) {
            style.innerText = styleContent;
            return;
        }
        style = document.createElement("style");
        style.innerText = styleContent;
        style.setAttribute('id', id);
        document.head.appendChild(style);
    }
    getConfig(storeId) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            if (!storeId)
                return;
            const mod = (0,_angular_core__WEBPACK_IMPORTED_MODULE_12__.isDevMode)() ? 'uat' : 'prd';
            const key = `aigens-device-config-${mod}-${storeId}`;
            let isCalled = false;
            const hasLoading = !(yield this.nativeStorageService.getStorage(key));
            this.nativeStorageService.getStorage(key).then(rsp => {
                if (rsp) {
                    window['aigensDevice'] = rsp;
                    this.applyConfig(rsp);
                    if (!isCalled)
                        this.setActivateMode(rsp);
                    isCalled = true;
                }
            });
            const host = (0,_angular_core__WEBPACK_IMPORTED_MODULE_12__.isDevMode)() ? "https://aigensstoretest.appspot.com" : "https://auth2.aigens.com";
            const url = `${host}/api/v1/store/config.json?type=app&storeId=${storeId}&t=${new Date().getTime()}`;
            if (hasLoading)
                this.dialogService.superloading(true);
            this.dataService.getRaw(url, {}).subscribe(rsp => {
                var _a, _b;
                const aigensDevice = (_b = (_a = rsp === null || rsp === void 0 ? void 0 : rsp.data) === null || _a === void 0 ? void 0 : _a.data) === null || _b === void 0 ? void 0 : _b.device;
                window['aigensDevice'] = aigensDevice;
                this.nativeStorageService.setStorage(key, aigensDevice);
                this.applyConfig(aigensDevice);
                if (!isCalled)
                    this.setActivateMode(aigensDevice);
                isCalled = true;
                if (hasLoading)
                    this.dialogService.superloading(false);
            }, err => {
                console.log("err:", err);
                if (hasLoading)
                    this.dialogService.superloading(false);
            });
        });
    }
    mergeTranslation(aigensDevice) {
        var _a, _b;
        if (!aigensDevice)
            aigensDevice = window['aigensDevice'];
        var lang = this.t.currentLang;
        var currentTrans = (_a = this.t.translations) === null || _a === void 0 ? void 0 : _a[lang];
        var newTrans = (_b = aigensDevice === null || aigensDevice === void 0 ? void 0 : aigensDevice.translations) === null || _b === void 0 ? void 0 : _b[lang];
        if (newTrans) {
            (0,lodash_es__WEBPACK_IMPORTED_MODULE_14__["default"])(currentTrans, newTrans);
        }
    }
    applyConfig(aigensDevice) {
        const styleContent = aigensDevice === null || aigensDevice === void 0 ? void 0 : aigensDevice.cssStyle;
        if (styleContent) {
            const id = "device-style-id-9527";
            var style = document.getElementById(id);
            if (style) {
                style.innerText = styleContent;
            }
            else {
                style = document.createElement("style");
                style.innerText = styleContent;
                style.setAttribute('id', id);
                document.head.appendChild(style);
            }
        }
        this.mergeTranslation(aigensDevice);
    }
    processPermissions() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            const r = yield _capacitor_camera__WEBPACK_IMPORTED_MODULE_4__.Camera.checkPermissions();
            if (r.camera == 'granted')
                return;
            _capacitor_camera__WEBPACK_IMPORTED_MODULE_4__.Camera.requestPermissions({
                permissions: ['camera']
            });
        });
    }
    ngOnInit() {
        super.ngOnInit();
        this.currentUrl = window.location.href;
        this.init();
        this.processPermissions();
    }
    getApiHost(code) {
        var isPrd = true;
        if (code.startsWith("TEST")) {
            isPrd = false;
        }
        var host = "https://auth2.aigens.com";
        if (!isPrd) {
            host = "https://aigensstoretest.appspot.com";
        }
        return host;
    }
    testQR() {
        var qrContent = "https://test.order.place/display/store/500/signage/500/screen/500-0?stationId=818120013&installCode=JBX2GLY";
        this.parseUrl(qrContent);
    }
    doTest() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            console.log("Test Clicked");
            yield _capacitor_toast__WEBPACK_IMPORTED_MODULE_0__.Toast.show({
                text: 'Hello!',
            });
        });
    }
    back() {
        //this.location.back();
    }
    retryToCall() {
        let count = 0;
        this.intervalId = setInterval(() => {
            count += 2;
            if (navigator.onLine) {
                clearInterval(this.intervalId);
                this.openWebUrl();
                return;
            }
            if (count === 20) {
                clearInterval(this.intervalId);
                this.dialogService.superloading(false);
                const alert = this.dialogService.showConfirm("", this.t.instant('global.network-error'), {
                    okText: 'Retry',
                    cancelText: 'Cancel',
                    callback: (res) => {
                        if (res === 'OK') {
                            this.goClicked();
                        }
                    }
                });
                this.setAlert(alert);
            }
        }, 2000);
    }
    goClicked() {
        if (!navigator.onLine) {
            this.dialogService.superloading(true);
            console.log('offline error');
            this.retryToCall();
            return;
        }
        this.openWebUrl();
    }
    openWebUrl() {
        this.dialogService.superloading(false);
        var url = this.station.webUrl;
        var apiKey = this.station.apiKey;
        if (apiKey) {
            var sep = url.indexOf('?') > 0 ? '&' : '?';
            url += sep + 'apiKey=' + apiKey;
        }
        // console.log('URL', url);
        // DEBUG on localhost
        // window.location.href = url.replace(/https:\/\/merchanttest.order.place/gi, 'http://192.168.100.43:4200');
        const deviceLogoutLink = `deviceLogoutLink=${encodeURIComponent(`${window.origin}/device/logout`)}`;
        var sign = url.indexOf('?') > 0 ? '&' : '?';
        url += sign + deviceLogoutLink;
        // url += `&t=${new Date().getTime()}&nocache=true`
        url += `&t=${new Date().getTime()}`;
        console.log("goClicked url:", url);
        window.location.href = url;
        // this.subscribeGlobalTopic();
    }
    testClicked() {
        //this.routingService.navigate("/device/test");
        //var url = "/device/test";
        var url = "/test/app/store/500";
        this.routingService.navigate(url);
    }
    setupClicked() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            console.log("install code", this.installCode);
            if (!this.installCode || this.installCode.length <= 4) {
                const alert = this.dialogService.showAlert("", this.t.instant('setup.check-your-code'));
                this.setAlert(alert);
                return;
            }
            if (this.installCode.indexOf("http") == 0) {
                this.station = {
                    webUrl: this.installCode
                };
                this.goClicked();
                return;
            }
            if (this.busy)
                return;
            var url = this.getApiHost(this.installCode) + "/api/v1/store/station/install.json";
            var deviceId = yield this.getDeviceId();
            var params = {
                code: this.installCode,
                deviceId: deviceId,
                t: new Date().getTime()
            };
            this.dialogService.superloading(true);
            this.busy = true;
            this.dataService.get(url, params).subscribe(install => {
                this.dialogService.superloading(false);
                console.log("install", install);
                this.busy = false;
                this.setData(install);
            }, err => {
                this.busy = false;
                this.dialogService.superloading(false);
                this.dialogService.dismissPreLoader();
                const alert = this.dialogService.showError(err);
                this.setAlert(alert);
            });
        });
    }
    getStations() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            this.dialogService.superloading(true);
            let err;
            try {
                const res = yield this.callInstallStation();
                this.dialogService.superloading(false);
                this.dialogService.dismissPreLoader();
                this.setData(res);
                return;
            }
            catch (error) {
                console.log("prd error:", error);
                err = error;
                // this.dialogService.showError(error);
            }
            this.dialogService.superloading(false);
            this.dialogService.dismissPreLoader();
        });
    }
    callInstallStation() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            const host = (0,_angular_core__WEBPACK_IMPORTED_MODULE_12__.isDevMode)() ? "https://aigensstoretest.appspot.com" : "https://auth2.aigens.com";
            var url = host + "/api/v1/store/station/install.json";
            var deviceId = yield this.getDeviceId();
            var params = {
                deviceId: deviceId,
                t: new Date().getTime()
            };
            return new Promise((resolve, reject) => {
                this.dataService.get(url, params).subscribe(install => {
                    resolve(install);
                }, err => {
                    reject(err);
                });
            });
        });
    }
    scanClicked() {
        if (this.testUrl) {
            this.parseUrl(this.testUrl);
        }
        else {
            this.startScan();
        }
    }
    startScan() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            const r = yield _capacitor_camera__WEBPACK_IMPORTED_MODULE_4__.Camera.checkPermissions();
            if (r.camera !== 'granted') {
                const alert = this.dialogService.showAlert("", this.t.instant('setup.camera-permissions'), rsp => {
                    this.platformService.openSettingsPage();
                });
                this.setAlert(alert);
                return;
            }
            this.scanning = true;
            this.cameraService.startScan((result) => {
                this.stopScan();
                console.log("startScan Result", result);
                this.parseUrl(result.content);
            });
        });
    }
    cancelClicked() {
        this.autoLoginTime = null;
        this.remainingSeconds = null;
    }
    stopScan() {
        this.scanning = false;
        this.cameraService.stopScan();
    }
    parseUrl(testUrl) {
        const queryString = testUrl;
        const urlParams = new URLSearchParams(queryString);
        const installCode = urlParams.get('installCode');
        console.log("installCode", installCode);
        if (installCode && installCode.length > 2) {
            this.installCode = installCode;
        }
        else {
            const alert = this.dialogService.showAlert("", this.t.instant('setup.check-your-qrcode'));
            this.setAlert(alert);
        }
    }
    logoutClicked() {
        this.station = null;
        this.autoLoginTime = null;
        this.remainingSeconds = null;
        //this.storageService.setLocal(this.LAST_STATION_KEY, null);
        this.nativeStorageService.setStorage(this.LAST_STATION_KEY, null);
    }
    setData(install) {
        if (!install)
            return;
        //this.storageService.setLocal(this.LAST_STATION_KEY, install);
        this.nativeStorageService.setStorage(this.LAST_STATION_KEY, install);
        this.station = install;
        this.getConfig(install === null || install === void 0 ? void 0 : install.storeId);
    }
    testToLogout() {
        this.routingService.navigate("/device/logout");
    }
    adyenPay() {
        const url = "https://apitest.aigens.com/api/v2/merchant/terminal/intent.json";
        const sid = "ai:6f831bd8-750c-43cb-a83a-b7db83f95ffe";
        const params = {
            "storeId": 504,
            "stationId": 504,
            "grandTotal": 5.0,
            "id": new Date().getTime() + "fsefs-sfe-fse-fes-fs"
        };
        this.dialogService.superloading(true);
        this.dataService.postWithHeaders(url, params, {}, { sid }).subscribe(rsp => {
            var _a;
            console.log("rsp:", rsp);
            this.dialogService.superloading(false);
            const intent = (_a = rsp === null || rsp === void 0 ? void 0 : rsp.data) === null || _a === void 0 ? void 0 : _a.intent;
            _aigens_aigens_sdk_adyen__WEBPACK_IMPORTED_MODULE_6__.Adyen.startPayment({
                authenticationServiceObject: {
                    url: "https://apitest.aigens.com/api/v2/pay/terminal/connectiontoken.json",
                    sid,
                    stationId: "504"
                },
                paymentObject: {
                    // serviceId: "86da8c8f-4",
                    // saleId: "aigens-sale-id",
                    // transactionID: "transactionID",
                    // currency: "HKD",
                    // requestedAmount: "5",
                    // timeStamp: `${this.timestampToFormattedDate(new Date().getTime())}T07:29:03.384Z`,
                    nexoRequest: intent
                }
            }).then(rsp => {
                this.msg = JSON.stringify(rsp);
            }).catch(err => {
                this.msg = (err === null || err === void 0 ? void 0 : err.message) || err;
            });
        }, err => {
            this.dialogService.superloading(false);
            this.dialogService.showError(err);
        });
    }
    testprint() {
        _aigens_aigens_sdk_sunmi_printer__WEBPACK_IMPORTED_MODULE_7__.SunmiPrinter.EscAndApiPrint({
            contents: [
                {
                    type: "printBitmap",
                    bitmapUrl: {
                        url: 'https://www.baidu.com/img/flexible/logo/pc/result.png',
                    },
                    bitmapStyle: {
                        // algorithm?: 'DITHERING', 'BINARIZATION'
                        // value?: number;
                        // align?: "DEFAULT" | "LEFT" | "CENTER" | "RIGHT";
                        align: "CENTER",
                        width: 300,
                        height: 300,
                    },
                }, {
                    type: 'printEsc',
                    text: 'fseffse',
                }
            ],
            autoCut: true
        });
    }
    getinstallationId() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_13__.__awaiter)(this, void 0, void 0, function* () {
            const rsp = yield _aigens_aigens_sdk_adyen__WEBPACK_IMPORTED_MODULE_6__.Adyen.getInstallationId();
            this.msg = `getInstallationId: ${rsp.installationId}`;
        });
    }
}
SetupPageComponent.ɵfac = function SetupPageComponent_Factory(t) { return new (t || SetupPageComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_12__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵdirectiveInject"](_native_src_app_native_services_native_camera_service__WEBPACK_IMPORTED_MODULE_9__.NativeCameraService), _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵdirectiveInject"](_native_src_app_native_services_native_storage_service__WEBPACK_IMPORTED_MODULE_2__.NativeStorageService), _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵdirectiveInject"](_merchant_src_app_native_services_native_app_service__WEBPACK_IMPORTED_MODULE_10__.NativeAppService), _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵdirectiveInject"](_native_src_app_native_services_native_notification_service__WEBPACK_IMPORTED_MODULE_11__.NativeNotificationService)); };
SetupPageComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵdefineComponent"]({ type: SetupPageComponent, selectors: [["app-setup-page"]], features: [_angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵInheritDefinitionFeature"]], decls: 2, vars: 2, consts: [["class", "main-container", 4, "ngIf"], ["class", "scanner-wrapper", 4, "ngIf"], [1, "main-container"], [1, "bg-top"], ["src", "../../../../assets/images/bg02.svg"], [1, "bg-bottom"], ["src", "../../../../assets/images/bg01.svg"], [3, "ngClass"], [1, "top"], [1, "main"], [1, "header-wrapper"], ["src", "../../../../assets/images/icon_start.svg"], [1, "header-inner"], ["mat-flat-button", "", "appSelectByKeyboard", "", 1, "language-ele", 3, "click"], ["class", "content-wrapper", 4, "ngIf"], ["class", "content-wrapper auto-time count-down-wrapper", 4, "ngIf"], ["src", "../../../../assets/images/Aigens logn_3.svg"], ["class", "version", 4, "ngIf"], [1, "content-wrapper"], [1, "scan-inner"], ["src", "../../../../assets/images/icon_scan.svg"], ["mat-flat-button", "", "appSelectByKeyboard", "", 1, "btn-public", 3, "click"], ["floatLabel", "always", 1, "input-field", "keyboard-form-field"], ["matInput", "", "appSelectByKeyboard", "", 1, "installcode-input", 3, "ngModel", "ngModelChange"], [1, "installcode-kb-container"], ["mat-flat-button", "", "color", "primary", "appSelectByKeyboard", "", 1, "btn-public", "outline", 3, "click"], [1, "store-info"], [4, "ngIf"], ["class", "device-warpper", 4, "ngIf"], [1, "device-warpper"], ["mat-raised-button", "", "appSelectByKeyboard", "", 1, "btn-public", 3, "click"], ["mat-stroked-button", "", "appSelectByKeyboard", "", 1, "btn-public", "outline", 3, "click"], [1, "content-wrapper", "auto-time", "count-down-wrapper"], ["class", "countdown", 4, "ngIf"], [1, "countdown"], [1, "version"], [1, "scanner-wrapper"], [1, "scanner-inner"], ["mat-raised-button", "", "color", "primary", "appSelectByKeyboard", "", 1, "btn-public", "stop-btn", 3, "click"]], template: function SetupPageComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](0, SetupPageComponent_div_0_Template, 23, 9, "div", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵtemplate"](1, SetupPageComponent_div_1_Template, 5, 3, "div", 1);
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", !ctx.scanning);
        _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_12__["ɵɵproperty"]("ngIf", ctx.scanning);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_15__.NgClass, _angular_common__WEBPACK_IMPORTED_MODULE_15__.NgIf, _angular_forms__WEBPACK_IMPORTED_MODULE_16__.DefaultValueAccessor, _angular_forms__WEBPACK_IMPORTED_MODULE_16__.NgControlStatus, _angular_forms__WEBPACK_IMPORTED_MODULE_16__.NgModel, _angular_material_button__WEBPACK_IMPORTED_MODULE_17__.MatButton, _angular_material_form_field__WEBPACK_IMPORTED_MODULE_18__.MatFormField, _angular_material_form_field__WEBPACK_IMPORTED_MODULE_18__.MatLabel, _angular_material_input__WEBPACK_IMPORTED_MODULE_19__.MatInput, _core_src_app_framework_directives_select_by_keyboard__WEBPACK_IMPORTED_MODULE_5__.SelectByKeyboardDirective, _ngx_translate_core__WEBPACK_IMPORTED_MODULE_20__.TranslatePipe], styles: ["p[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%] {\n  margin: 0;\n}\n\n[_nghost-%COMP%] {\n  display: block;\n  height: 100%;\n}\n\n.top[_ngcontent-%COMP%] {\n  position: relative;\n  height: 100%;\n}\n\nbutton[_ngcontent-%COMP%] {\n  margin: 10px;\n}\n\n.countdown[_ngcontent-%COMP%] {\n  font-size: 1rem;\n  text-align: center;\n  line-height: 1.5em;\n}\n\n.countdown[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n  display: block;\n  font-size: 2rem;\n  color: #36B4E5;\n  font-weight: bold;\n  margin: 0.5rem;\n}\n\n.main-container[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n  height: auto;\n  min-height: 100%;\n  color: #fff;\n  \n  background: rgb(31, 33, 40);   \n  background: linear-gradient(135deg, rgb(31, 33, 40) 30%, rgb(33, 47, 77) 100%); \n  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=\"#1f2128\", endColorstr=\"#212f4d\",GradientType=1 ); \n}\n\nmain[_ngcontent-%COMP%] {\n  width: 100%;\n  max-width: 30rem;\n  flex: 1 1 auto;\n  margin: 0 auto;\n}\n\nmain.scan-page[_ngcontent-%COMP%] {\n  position: relative;\n  padding: 1rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: calc(100% - 2rem);\n}\n\nmain.scan-page[_ngcontent-%COMP%]   .btn-public[_ngcontent-%COMP%] {\n  width: 15rem;\n  position: absolute;\n  bottom: 0;\n  left: 50%;\n  transform: translateX(-50%);\n}\n\nfooter[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  padding: 1.5rem 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\nfooter[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  width: 7rem;\n}\n\n.bg-top[_ngcontent-%COMP%] {\n  z-index: 0;\n  width: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  max-width: 30rem;\n}\n\n.bg-top[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  width: 100%;\n}\n\n.bg-bottom[_ngcontent-%COMP%] {\n  max-width: 30rem;\n  z-index: 0;\n  width: 100%;\n  position: fixed;\n  bottom: 0;\n  right: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n}\n\n.bg-bottom[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  width: 100%;\n}\n\n.header-wrapper[_ngcontent-%COMP%] {\n  display: flex;\n  margin-top: 4rem;\n  margin-bottom: 1.5rem;\n  align-items: flex-start;\n}\n\n.header-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  margin-right: 0.5rem;\n  width: 1.4rem;\n  margin-top: 0.2rem;\n}\n\n.header-wrapper[_ngcontent-%COMP%]   .language-ele[_ngcontent-%COMP%] {\n  align-self: flex-end;\n  background: #056084;\n  color: white;\n  width: 2.2rem;\n  height: 2.2rem;\n  padding: 0;\n  text-align: center;\n  line-height: 2.2rem;\n  min-width: auto;\n}\n\n.header-inner[_ngcontent-%COMP%] {\n  font-size: 2.6rem;\n  line-height: 1em;\n  text-transform: uppercase;\n  color: #36B4E5;\n  letter-spacing: 0.05rem;\n  width: 65%;\n}\n\n.content-wrapper[_ngcontent-%COMP%] {\n  background: #2B2F37;\n  box-shadow: 0 0.5rem 0.8rem 0 rgba(0, 0, 0, 0.3);\n  border-radius: 0.5rem;\n  margin: 0 1.5rem;\n  padding: 1.5rem 1rem;\n  margin-bottom: 1rem;\n}\n\n.scan-inner[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n}\n\n.scan-inner[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  width: 3rem;\n  flex: 0 0 3rem;\n  margin-right: 0.5rem;\n}\n\n.scan-inner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\n  font-size: 1rem;\n}\n\n.scan-inner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n  color: #36B4E5;\n}\n\n.btn-public[_ngcontent-%COMP%] {\n  background: #36B4E5;\n  margin: 0;\n  margin-top: 1rem;\n  width: 100%;\n  color: #fff;\n}\n\n.btn-public.outline[_ngcontent-%COMP%] {\n  background: transparent;\n  box-shadow: 0 0 0 1px #36B4E5;\n  color: #36B4E5;\n}\n\n.btn-public.margin-reset[_ngcontent-%COMP%] {\n  margin-top: 0;\n}\n\n.stop-btn[_ngcontent-%COMP%] {\n  margin-top: 4rem;\n  width: 15rem;\n}\n\n.input-field[_ngcontent-%COMP%] {\n  width: 100%;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-input-element {\n  color: #fff;\n  font-size: 1.5rem;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-form-field-label {\n  color: #36B4E5;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-form-field-underline {\n  background-color: #36B4E5;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-form-field-ripple {\n  background-color: #36B4E5;\n}\n\n.input-field[_ngcontent-%COMP%]  .mat-form-field-required-marker {\n  color: #36B4E5;\n}\n\n.store-info[_ngcontent-%COMP%] {\n  font-size: 1rem;\n  line-height: 1.6em;\n}\n\n.auto-time[_ngcontent-%COMP%]   .btn-public[_ngcontent-%COMP%] {\n  margin-bottom: 1rem;\n  margin-top: 0;\n}\n\n.scanner-wrapper[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n}\n\n.scanner-inner[_ngcontent-%COMP%] {\n  width: 15rem;\n  height: 15rem;\n  border: red solid 1px;\n  top: 50%;\n}\n\n@media not screen and (max-width: 767px) {\n  .scanner-inner[_ngcontent-%COMP%] {\n    width: 30rem;\n    height: 30rem;\n  }\n  .stop-btn[_ngcontent-%COMP%] {\n    width: 30rem;\n  }\n}\n\n.version[_ngcontent-%COMP%] {\n  position: absolute;\n  right: 0;\n  margin-right: 1rem;\n}\n\n.test[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\n  height: 44px;\n  width: 100%;\n}\n\n.test[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%] {\n  width: 100%;\n  height: 200px;\n}\n\n.keyboard-form-field[_ngcontent-%COMP%] {\n  position: relative;\n}\n\n.keyboard-form-field[_ngcontent-%COMP%]   .installcode-kb-container[_ngcontent-%COMP%] {\n  position: absolute;\n  z-index: 99;\n  top: 3rem;\n  left: 0px;\n  display: none;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNldHVwLXBhZ2UuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxTQUFBO0FBQ0o7O0FBR0E7RUFDSSxjQUFBO0VBQ0EsWUFBQTtBQUFKOztBQUdBO0VBQ0ksa0JBQUE7RUFDQSxZQUFBO0FBQUo7O0FBY0E7RUFDSSxZQUFBO0FBWEo7O0FBY0E7RUFDSSxlQUFBO0VBQ0Esa0JBQUE7RUFDQSxrQkFBQTtBQVhKOztBQVlJO0VBQ0ksY0FBQTtFQUNBLGVBQUE7RUFDQSxjQUFBO0VBQ0EsaUJBQUE7RUFDQSxjQUFBO0FBVlI7O0FBYUE7RUFDSSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7RUFDQSxXQUFBO0VBQ0Esa0hBQUE7RUFDQSwyQkFBQSxFQUFBLGlCQUFBLEVBQ0EsYUFBQSxFQUNBLDRCQUFBO0VBQ0EsOEVBQUEsRUFBQSxxREFBQTtFQUNBLG1IQUFBLEVBQUEsMENBQUE7QUFWSjs7QUFlQTtFQUNJLFdBQUE7RUFDQSxnQkFBQTtFQUNBLGNBQUE7RUFDQSxjQUFBO0FBWko7O0FBYUk7RUFDSSxrQkFBQTtFQUNBLGFBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtFQUNBLHdCQUFBO0FBWFI7O0FBWVE7RUFDSSxZQUFBO0VBQ0Esa0JBQUE7RUFDQSxTQUFBO0VBQ0EsU0FBQTtFQUNBLDJCQUFBO0FBVlo7O0FBY0E7RUFDSSxjQUFBO0VBQ0EsaUJBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtBQVhKOztBQVlJO0VBQ0ksV0FBQTtBQVZSOztBQWFBO0VBQ0ksVUFBQTtFQUNBLFdBQUE7RUFDQSxlQUFBO0VBQ0EsTUFBQTtFQUNBLE9BQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSwyQkFBQTtFQUNBLGdCQUFBO0FBVko7O0FBV0k7RUFDSSxXQUFBO0FBVFI7O0FBYUE7RUFDSSxnQkFBQTtFQUNBLFVBQUE7RUFDQSxXQUFBO0VBQ0EsZUFBQTtFQUNBLFNBQUE7RUFDQSxRQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0VBQ0EseUJBQUE7QUFWSjs7QUFXSTtFQUNJLFdBQUE7QUFUUjs7QUFZQTtFQUNJLGFBQUE7RUFDQSxnQkFBQTtFQUNBLHFCQUFBO0VBQ0EsdUJBQUE7QUFUSjs7QUFVSTtFQUNJLG9CQUFBO0VBQ0EsYUFBQTtFQUNBLGtCQUFBO0FBUlI7O0FBVUk7RUFDSSxvQkFBQTtFQUVBLG1CQUFBO0VBQ0EsWUFBQTtFQUNBLGFBQUE7RUFDQSxjQUFBO0VBQ0EsVUFBQTtFQUNBLGtCQUFBO0VBQ0EsbUJBQUE7RUFDQSxlQUFBO0FBUlI7O0FBV0E7RUFDSSxpQkFBQTtFQUNBLGdCQUFBO0VBQ0EseUJBQUE7RUFDQSxjQUFBO0VBQ0EsdUJBQUE7RUFDQSxVQUFBO0FBUko7O0FBVUE7RUFDSSxtQkFBQTtFQUNBLGdEQUFBO0VBQ0EscUJBQUE7RUFDQSxnQkFBQTtFQUNBLG9CQUFBO0VBQ0EsbUJBQUE7QUFQSjs7QUFTQTtFQUNJLGFBQUE7RUFDQSxtQkFBQTtBQU5KOztBQU9JO0VBQ0ksV0FBQTtFQUNBLGNBQUE7RUFDQSxvQkFBQTtBQUxSOztBQU9JO0VBQ0ksZUFBQTtBQUxSOztBQU1RO0VBQ0ksY0FBQTtBQUpaOztBQVFBO0VBQ0ksbUJBQUE7RUFDQSxTQUFBO0VBQ0EsZ0JBQUE7RUFDQSxXQUFBO0VBQ0EsV0FBQTtBQUxKOztBQU1JO0VBQ0ksdUJBQUE7RUFDQSw2QkFBQTtFQUNBLGNBQUE7QUFKUjs7QUFNSTtFQUNJLGFBQUE7QUFKUjs7QUFRQTtFQUNJLGdCQUFBO0VBQ0EsWUFBQTtBQUxKOztBQU9BO0VBQ0ksV0FBQTtBQUpKOztBQU9RO0VBQ0ksV0FBQTtFQUNBLGlCQUFBO0FBTFo7O0FBT1E7RUFDSSxjQUFBO0FBTFo7O0FBT1E7RUFDSSx5QkFBQTtBQUxaOztBQU9RO0VBQ0kseUJBQUE7QUFMWjs7QUFPUTtFQUNJLGNBQUE7QUFMWjs7QUFZQTtFQUNJLGVBQUE7RUFDQSxrQkFBQTtBQVRKOztBQVlJO0VBQ0ksbUJBQUE7RUFDQSxhQUFBO0FBVFI7O0FBZUE7RUFFSSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7QUFiSjs7QUFnQkE7RUFDSSxZQUFBO0VBQ0EsYUFBQTtFQUNBLHFCQUFBO0VBQ0EsUUFBQTtBQWJKOztBQWdCQTtFQUNJO0lBQ0ksWUFBQTtJQUNBLGFBQUE7RUFiTjtFQWdCRTtJQUNJLFlBQUE7RUFkTjtBQUNGOztBQWtCQTtFQUNJLGtCQUFBO0VBQ0EsUUFBQTtFQUNBLGtCQUFBO0FBaEJKOztBQW9CSTtFQUNJLFlBQUE7RUFDQSxXQUFBO0FBakJSOztBQW1CSTtFQUNJLFdBQUE7RUFDQSxhQUFBO0FBakJSOztBQXFCQTtFQUNJLGtCQUFBO0FBbEJKOztBQW1CSTtFQUNJLGtCQUFBO0VBQ0EsV0FBQTtFQUNBLFNBQUE7RUFDQSxTQUFBO0VBQ0EsYUFBQTtBQWpCUiIsImZpbGUiOiJzZXR1cC1wYWdlLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsicCwgaDEsIGgyLCBoMywgaDQsIGg1LCBoNntcbiAgICBtYXJnaW46IDA7XG59XG5cblxuOmhvc3Qge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIGhlaWdodDogMTAwJTtcbn1cblxuLnRvcHtcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgaGVpZ2h0OiAxMDAlO1xufVxuXG4ubWFpbntcbiAgICAvLyB3aWR0aDogNTAwcHg7XG4gICAgLy8gaGVpZ2h0OiAzMDBweDtcbiAgICAvLyBiYWNrZ3JvdW5kLWNvbG9yOiBwaW5rO1xuICAgIC8vIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAvLyB0b3A6IDUwJTtcbiAgICAvLyBsZWZ0OiA1MCU7XG4gICAgLy8gdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgNTAlKTtcbiAgICAvLyB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5cbmJ1dHRvbntcbiAgICBtYXJnaW46IDEwcHg7XG59XG5cbi5jb3VudGRvd257XG4gICAgZm9udC1zaXplOiAxcmVtO1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICBsaW5lLWhlaWdodDogMS41ZW07XG4gICAgc3BhbntcbiAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgIGZvbnQtc2l6ZTogMnJlbTtcbiAgICAgICAgY29sb3I6ICMzNkI0RTU7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgICAgICBtYXJnaW46IDAuNXJlbTtcbiAgICB9XG59XG4ubWFpbi1jb250YWluZXJ7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIGhlaWdodDogYXV0bztcbiAgICBtaW4taGVpZ2h0OiAxMDAlO1xuICAgIGNvbG9yOiAjZmZmO1xuICAgIC8qIFBlcm1hbGluayAtIHVzZSB0byBlZGl0IGFuZCBzaGFyZSB0aGlzIGdyYWRpZW50OiBodHRwczovL2NvbG9yemlsbGEuY29tL2dyYWRpZW50LWVkaXRvci8jMWYyMTI4KzMwLDIxMmY0ZCsxMDAgKi9cbiAgICBiYWNrZ3JvdW5kOiByZ2IoMzEsMzMsNDApOyAvKiBPbGQgYnJvd3NlcnMgKi9cbiAgICBiYWNrZ3JvdW5kOiAtbW96LWxpbmVhci1ncmFkaWVudCgtNDVkZWcsICByZ2JhKDMxLDMzLDQwLDEpIDMwJSwgcmdiYSgzMyw0Nyw3NywxKSAxMDAlKTsgLyogRkYzLjYtMTUgKi9cbiAgICBiYWNrZ3JvdW5kOiAtd2Via2l0LWxpbmVhci1ncmFkaWVudCgtNDVkZWcsICByZ2JhKDMxLDMzLDQwLDEpIDMwJSxyZ2JhKDMzLDQ3LDc3LDEpIDEwMCUpOyAvKiBDaHJvbWUxMC0yNSxTYWZhcmk1LjEtNiAqL1xuICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICByZ2JhKDMxLDMzLDQwLDEpIDMwJSxyZ2JhKDMzLDQ3LDc3LDEpIDEwMCUpOyAvKiBXM0MsIElFMTArLCBGRjE2KywgQ2hyb21lMjYrLCBPcGVyYTEyKywgU2FmYXJpNysgKi9cbiAgICBmaWx0ZXI6IHByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudCggc3RhcnRDb2xvcnN0cj0nIzFmMjEyOCcsIGVuZENvbG9yc3RyPScjMjEyZjRkJyxHcmFkaWVudFR5cGU9MSApOyAvKiBJRTYtOSBmYWxsYmFjayBvbiBob3Jpem9udGFsIGdyYWRpZW50ICovXG5cblxuXG59XG5tYWlue1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIG1heC13aWR0aDogMzByZW07XG4gICAgZmxleDogMSAxIGF1dG87XG4gICAgbWFyZ2luOiAwIGF1dG87XG4gICAgJi5zY2FuLXBhZ2V7XG4gICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgcGFkZGluZzogMXJlbTtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIHdpZHRoOiBjYWxjKDEwMCUgLSAycmVtKTtcbiAgICAgICAgLmJ0bi1wdWJsaWN7XG4gICAgICAgICAgICB3aWR0aDogMTVyZW07XG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBib3R0b206IDA7XG4gICAgICAgICAgICBsZWZ0OiA1MCU7XG4gICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mb290ZXJ7XG4gICAgZmxleDogMCAwIGF1dG87XG4gICAgcGFkZGluZzogMS41cmVtIDA7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIGltZ3tcbiAgICAgICAgd2lkdGg6IDdyZW07XG4gICAgfVxufVxuLmJnLXRvcHtcbiAgICB6LWluZGV4OiAwO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6IDA7XG4gICAgbGVmdDogMDtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0O1xuICAgIG1heC13aWR0aDogMzByZW07XG4gICAgaW1ne1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICB9XG5cbn1cbi5iZy1ib3R0b217XG4gICAgbWF4LXdpZHRoOiAzMHJlbTtcbiAgICB6LWluZGV4OiAwO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICBib3R0b206IDA7XG4gICAgcmlnaHQ6IDA7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG4gICAgaW1ne1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICB9XG59XG4uaGVhZGVyLXdyYXBwZXJ7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBtYXJnaW4tdG9wOiA0cmVtO1xuICAgIG1hcmdpbi1ib3R0b206IDEuNXJlbTtcbiAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDtcbiAgICBpbWd7XG4gICAgICAgIG1hcmdpbi1yaWdodDogMC41cmVtO1xuICAgICAgICB3aWR0aDogMS40cmVtO1xuICAgICAgICBtYXJnaW4tdG9wOiAwLjJyZW07XG4gICAgfVxuICAgIC5sYW5ndWFnZS1lbGUge1xuICAgICAgICBhbGlnbi1zZWxmOiBmbGV4LWVuZDtcbiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICBiYWNrZ3JvdW5kOiAjMDU2MDg0O1xuICAgICAgICBjb2xvcjogd2hpdGU7XG4gICAgICAgIHdpZHRoOiAyLjJyZW07XG4gICAgICAgIGhlaWdodDogMi4ycmVtO1xuICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiAyLjJyZW07XG4gICAgICAgIG1pbi13aWR0aDogYXV0bztcbiAgICB9XG59XG4uaGVhZGVyLWlubmVye1xuICAgIGZvbnQtc2l6ZTogMi42cmVtO1xuICAgIGxpbmUtaGVpZ2h0OiAxZW07XG4gICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcbiAgICBjb2xvcjogIzM2QjRFNTtcbiAgICBsZXR0ZXItc3BhY2luZzowLjA1cmVtO1xuICAgIHdpZHRoOiA2NSU7XG59XG4uY29udGVudC13cmFwcGVye1xuICAgIGJhY2tncm91bmQ6ICMyQjJGMzc7XG4gICAgYm94LXNoYWRvdzogMCAwLjVyZW0gMC44cmVtIDAgcmdiYSgwLDAsMCwwLjMpO1xuICAgIGJvcmRlci1yYWRpdXM6IDAuNXJlbTtcbiAgICBtYXJnaW46IDAgMS41cmVtO1xuICAgIHBhZGRpbmc6IDEuNXJlbSAxcmVtO1xuICAgIG1hcmdpbi1ib3R0b206IDFyZW07XG59XG4uc2Nhbi1pbm5lcntcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgaW1ne1xuICAgICAgICB3aWR0aDogM3JlbTtcbiAgICAgICAgZmxleDogMCAwIDNyZW07XG4gICAgICAgIG1hcmdpbi1yaWdodDogMC41cmVtO1xuICAgIH1cbiAgICBwe1xuICAgICAgICBmb250LXNpemU6IDFyZW07XG4gICAgICAgIHNwYW57XG4gICAgICAgICAgICBjb2xvcjogIzM2QjRFNTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi5idG4tcHVibGlje1xuICAgIGJhY2tncm91bmQ6ICMzNkI0RTU7XG4gICAgbWFyZ2luOiAwO1xuICAgIG1hcmdpbi10b3A6IDFyZW07XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgY29sb3I6ICNmZmY7XG4gICAgJi5vdXRsaW5le1xuICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgICAgICAgYm94LXNoYWRvdzogMCAwIDAgMXB4ICMzNkI0RTU7XG4gICAgICAgIGNvbG9yOiAjMzZCNEU1O1xuICAgIH1cbiAgICAmLm1hcmdpbi1yZXNldHtcbiAgICAgICAgbWFyZ2luLXRvcDogMDtcbiAgICB9XG59XG5cbi5zdG9wLWJ0biB7XG4gICAgbWFyZ2luLXRvcDogNHJlbTtcbiAgICB3aWR0aDogMTVyZW07XG59XG4uaW5wdXQtZmllbGR7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgJjo6bmctZGVlcHtcblxuICAgICAgICAubWF0LWlucHV0LWVsZW1lbnQge1xuICAgICAgICAgICAgY29sb3I6ICNmZmY7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNXJlbTtcbiAgICAgICAgfVxuICAgICAgICAubWF0LWZvcm0tZmllbGQtbGFiZWwge1xuICAgICAgICAgICAgY29sb3I6ICMzNkI0RTU7XG4gICAgICAgIH1cbiAgICAgICAgLm1hdC1mb3JtLWZpZWxkLXVuZGVybGluZSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzZCNEU1O1xuICAgICAgICB9XG4gICAgICAgIC5tYXQtZm9ybS1maWVsZC1yaXBwbGUge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzM2QjRFNTtcbiAgICAgICAgfVxuICAgICAgICAubWF0LWZvcm0tZmllbGQtcmVxdWlyZWQtbWFya2VyIHtcbiAgICAgICAgICAgIGNvbG9yOiAjMzZCNEU1O1xuICAgICAgICB9XG5cblxuXG4gICAgfVxufVxuLnN0b3JlLWluZm97XG4gICAgZm9udC1zaXplOiAxcmVtO1xuICAgIGxpbmUtaGVpZ2h0OiAxLjZlbTtcbn1cbi5hdXRvLXRpbWV7XG4gICAgLmJ0bi1wdWJsaWN7XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07XG4gICAgICAgIG1hcmdpbi10b3A6IDA7XG4gICAgfVxufVxuXG5cblxuLnNjYW5uZXItd3JhcHBlcntcblxuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbn1cblxuLnNjYW5uZXItaW5uZXIge1xuICAgIHdpZHRoOiAxNXJlbTtcbiAgICBoZWlnaHQ6IDE1cmVtO1xuICAgIGJvcmRlcjogcmVkIHNvbGlkIDFweDtcbiAgICB0b3A6IDUwJTtcbn1cblxuQG1lZGlhIG5vdCBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDc2N3B4KXtcbiAgICAuc2Nhbm5lci1pbm5lcntcbiAgICAgICAgd2lkdGg6IDMwcmVtO1xuICAgICAgICBoZWlnaHQ6IDMwcmVtO1xuICAgIH1cblxuICAgIC5zdG9wLWJ0biB7XG4gICAgICAgIHdpZHRoOiAzMHJlbTtcbiAgICB9XG5cbn1cblxuLnZlcnNpb24ge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICByaWdodDogMDtcbiAgICBtYXJnaW4tcmlnaHQ6IDFyZW07XG59XG5cbi50ZXN0IHtcbiAgICBidXR0b24ge1xuICAgICAgICBoZWlnaHQ6IDQ0cHg7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgIH1cbiAgICB0ZXh0YXJlYSB7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICBoZWlnaHQ6IDIwMHB4O1xuICAgIH1cbn1cblxuLmtleWJvYXJkLWZvcm0tZmllbGQge1xuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAuaW5zdGFsbGNvZGUta2ItY29udGFpbmVyIHtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICB6LWluZGV4OiA5OTtcbiAgICAgICAgdG9wOiAzcmVtO1xuICAgICAgICBsZWZ0OiAwcHg7XG4gICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgfVxufVxuIl19 */"], data: { animation: [
            (0,_angular_animations__WEBPACK_IMPORTED_MODULE_21__.trigger)('catInOut', [
                (0,_angular_animations__WEBPACK_IMPORTED_MODULE_21__.transition)(':enter', [
                    (0,_angular_animations__WEBPACK_IMPORTED_MODULE_21__.style)({ opacity: 0, transform: 'translateX(50%)' }),
                    (0,_angular_animations__WEBPACK_IMPORTED_MODULE_21__.animate)('300ms ease-out', (0,_angular_animations__WEBPACK_IMPORTED_MODULE_21__.style)({ opacity: 1, transform: 'translateX(0)' })),
                ]),
                //   transition(':leave', [
                //     animate('300ms ease-in-out', style({ opacity: 0, transform: 'translateX(-50%)' }))
                //   ])
            ]),
        ] } });
var ActivateMode;
(function (ActivateMode) {
    ActivateMode["auto"] = "auto";
    ActivateMode["countdown"] = "countdown";
    ActivateMode["manual"] = "manual";
})(ActivateMode || (ActivateMode = {}));


/***/ }),

/***/ 17251:
/*!*******************************************************************************!*\
  !*** ./projects/device/src/app/device/pages/test-page/test-page.component.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TestPageComponent": () => (/* binding */ TestPageComponent)
/* harmony export */ });
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @capacitor/core */ 26549);
/* harmony import */ var aigens_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../core/src/app/framework */ 44651);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _native_src_app_native_services_native_location_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../native/src/app/native/services/native-location.service */ 85542);
/* harmony import */ var _native_src_app_native_services_native_camera_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../../native/src/app/native/services/native-camera.service */ 96190);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_material_button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/material/button */ 87317);









function TestPageComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementStart"](0, "div")(1, "div");
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementStart"](3, "button", 1);
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵlistener"]("click", function TestPageComponent_div_0_Template_button_click_3_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵrestoreView"](_r3); const ctx_r2 = _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵresetView"](ctx_r2.getLocation()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵtext"](4, "Get Location");
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementStart"](5, "button", 1);
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵlistener"]("click", function TestPageComponent_div_0_Template_button_click_5_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵrestoreView"](_r3); const ctx_r4 = _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵresetView"](ctx_r4.scanQR()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵtext"](6, "Scan QR");
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementStart"](7, "button", 1);
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵlistener"]("click", function TestPageComponent_div_0_Template_button_click_7_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵrestoreView"](_r3); const ctx_r5 = _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵresetView"](ctx_r5.checkPermission()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵtext"](8, "Check Permission");
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementEnd"]()();
} if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵtextInterpolate2"](" NATIVE TEST platform: ", ctx_r0.platform, " native: ", ctx_r0.native, " ");
} }
function TestPageComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r7 = _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementStart"](0, "div")(1, "button", 1);
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵlistener"]("click", function TestPageComponent_div_1_Template_button_click_1_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵrestoreView"](_r7); const ctx_r6 = _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵresetView"](ctx_r6.stopScan()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵtext"](2, "Stop Scan");
    _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelementEnd"]()();
} }
class TestPageComponent extends aigens_framework__WEBPACK_IMPORTED_MODULE_1__.BasePage {
    constructor(injector, locationService, nativeLocationService, cameraService) {
        super(injector);
        this.injector = injector;
        this.locationService = locationService;
        this.nativeLocationService = nativeLocationService;
        this.cameraService = cameraService;
        this.scanning = false;
    }
    ngOnInit() {
        this.platform = _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.Capacitor.getPlatform();
        this.native = _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.Capacitor.isNativePlatform();
    }
    getLocation() {
        this.locationService.getGps((result) => {
            var msg = JSON.stringify(result);
            this.dialogService.showAlert("Result", msg);
        });
    }
    scanQR() {
        this.scanning = true;
        this.cameraService.startScan((result) => {
            var msg = JSON.stringify(result);
            this.stopScan();
            this.dialogService.showAlert("Result", msg);
        });
    }
    stopScan() {
        this.scanning = false;
        this.cameraService.stopScan();
    }
    checkPermission() {
        this.cameraService.checkPermission((result) => {
            var msg = JSON.stringify(result);
            this.dialogService.showAlert("Result", msg);
        });
    }
    getNativeLocation() {
        this.nativeLocationService.getGps((result) => {
            var msg = JSON.stringify(result);
            this.dialogService.showAlert("Result", msg);
        });
    }
}
TestPageComponent.ɵfac = function TestPageComponent_Factory(t) { return new (t || TestPageComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_4__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdirectiveInject"](aigens_framework__WEBPACK_IMPORTED_MODULE_1__.LocationService), _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdirectiveInject"](_native_src_app_native_services_native_location_service__WEBPACK_IMPORTED_MODULE_2__.NativeLocationService), _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdirectiveInject"](_native_src_app_native_services_native_camera_service__WEBPACK_IMPORTED_MODULE_3__.NativeCameraService)); };
TestPageComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineComponent"]({ type: TestPageComponent, selectors: [["app-test-page"]], features: [_angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵInheritDefinitionFeature"]], decls: 2, vars: 2, consts: [[4, "ngIf"], ["mat-raised-button", "", "color", "primary", 3, "click"]], template: function TestPageComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵtemplate"](0, TestPageComponent_div_0_Template, 9, 2, "div", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵtemplate"](1, TestPageComponent_div_1_Template, 3, 0, "div", 0);
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵproperty"]("ngIf", !ctx.scanning);
        _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵproperty"]("ngIf", ctx.scanning);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_5__.NgIf, _angular_material_button__WEBPACK_IMPORTED_MODULE_6__.MatButton], styles: ["[_nghost-%COMP%] {\n  display: block;\n  margin: 10px;\n}\n\nbutton[_ngcontent-%COMP%] {\n  margin: 10px;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QtcGFnZS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGNBQUE7RUFDQSxZQUFBO0FBQ0o7O0FBRUE7RUFDSSxZQUFBO0FBQ0oiLCJmaWxlIjoidGVzdC1wYWdlLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIG1hcmdpbjogMTBweDtcbn1cblxuYnV0dG9uIHtcbiAgICBtYXJnaW46IDEwcHg7XG59XG4iXX0= */"] });


/***/ }),

/***/ 14525:
/*!***************************************************************!*\
  !*** ./projects/device/src/app/device/root/root.component.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RootComponent": () => (/* binding */ RootComponent)
/* harmony export */ });
/* harmony import */ var _components_ProgressDialogComponent_ProgressDialogComponent_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/ProgressDialogComponent/ProgressDialogComponent.component */ 43632);
/* harmony import */ var _components_alert_dialog_alert_dialog_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/alert-dialog/alert-dialog.component */ 22691);
/* harmony import */ var _components_confirm_dialog_confirm_dialog_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/confirm-dialog/confirm-dialog.component */ 59416);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _aigens_core_src_app_framework__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @aigens/core/src/app/framework */ 44651);
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/material/dialog */ 95758);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/router */ 52816);







class RootComponent {
    constructor(dialogService, matDialog) {
        this.dialogService = dialogService;
        this.dialogService.dismissPreLoader();
        this.dialogService.setDialogController(matDialog);
        this.dialogService.setSuperLoaderComponent(_components_ProgressDialogComponent_ProgressDialogComponent_component__WEBPACK_IMPORTED_MODULE_0__.ProgressDialogComponent);
        this.dialogService.setAlertComponent(_components_alert_dialog_alert_dialog_component__WEBPACK_IMPORTED_MODULE_1__.AlertDialogComponent);
        this.dialogService.setConfirmComponent(_components_confirm_dialog_confirm_dialog_component__WEBPACK_IMPORTED_MODULE_2__.ConfirmDialogComponent);
    }
    ngOnInit() {
    }
}
RootComponent.ɵfac = function RootComponent_Factory(t) { return new (t || RootComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdirectiveInject"](_aigens_core_src_app_framework__WEBPACK_IMPORTED_MODULE_3__.DialogService), _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_5__.MatDialog)); };
RootComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineComponent"]({ type: RootComponent, selectors: [["app-root"]], decls: 1, vars: 0, template: function RootComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵelement"](0, "router-outlet");
    } }, dependencies: [_angular_router__WEBPACK_IMPORTED_MODULE_6__.RouterOutlet], styles: ["[_nghost-%COMP%] {\n  display: block;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvb3QuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxjQUFBO0FBQ0YiLCJmaWxlIjoicm9vdC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcbiAgZGlzcGxheTogYmxvY2s7XG59XG4iXX0= */"] });


/***/ }),

/***/ 2880:
/*!*********************************************************!*\
  !*** ./projects/device/src/environments/environment.ts ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "environment": () => (/* binding */ environment)
/* harmony export */ });
// This file can be replaced during build by using the `fileReplacements` array.
// `ng build` replaces `environment.ts` with `environment.prod.ts`.
// The list of file replacements can be found in `angular.json`.
const environment = {
    production: false
};
/*
 * For easier debugging in development mode, you can import the following file
 * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.
 *
 * This import should be commented out in production mode because it will have a negative impact
 * on performance if an error is thrown.
 */
// import 'zone.js/plugins/zone-error';  // Included with Angular CLI.


/***/ }),

/***/ 33318:
/*!*************************************!*\
  !*** ./projects/device/src/main.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/platform-browser */ 50318);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _app_app_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./app/app.module */ 91168);
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./environments/environment */ 2880);




// import * as Sentry from "@sentry/angular";
// import { BrowserTracing } from "@sentry/tracing";
if (_environments_environment__WEBPACK_IMPORTED_MODULE_1__.environment.production) {
    (0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.enableProdMode)();
}
// Sentry.init({
//     dsn: "https://41e7316ba4e14f6dad692039314b134d@o1308624.ingest.sentry.io/6554369",
//     integrations: [
//         new BrowserTracing({
//             tracingOrigins: ["localhost", "https:\/\/\w*\.order\.place"],
//             routingInstrumentation: Sentry.routingInstrumentation,
//         }),
//     ],
//     // Set tracesSampleRate to 1.0 to capture 100%
//     // of transactions for performance monitoring.
//     // We recommend adjusting this value in production
//     tracesSampleRate: 1.0,
// });
_angular_platform_browser__WEBPACK_IMPORTED_MODULE_3__.platformBrowser().bootstrapModule(_app_app_module__WEBPACK_IMPORTED_MODULE_0__.AppModule)
    .catch(err => console.error(err));


/***/ }),

/***/ 87118:
/*!*************************************************************************!*\
  !*** ./projects/merchant/src/app/native/services/native.app.service.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NativeAppService": () => (/* binding */ NativeAppService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _capacitor_app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @capacitor/app */ 93253);
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @capacitor/core */ 26549);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ 3184);





class NativeAppService {
    constructor(ngZone) {
        this.ngZone = ngZone;
        this.appLinkListeners = [];
        this.listenerIds = [];
        console.log("AppService interface service");
        _capacitor_app__WEBPACK_IMPORTED_MODULE_0__.App.addListener('appUrlOpen', (data) => {
            this.ngZone.run(() => {
                // data: {"iosSourceApplication":"","iosOpenInPlace":"","url":"capacitor://localhost/brand/5163349922807808/payment/status/success?redirect=true"}
                console.log('App opened with URL: ', data, data.url);
                if (!_capacitor_core__WEBPACK_IMPORTED_MODULE_1__.Capacitor.isNativePlatform())
                    return;
                let url = data && data.url || "";
                if (this.appLinkListeners.length > 0) {
                    this.appLinkListeners.forEach(listener => {
                        listener.onAppLinkChanged(url);
                    });
                }
            });
        });
    }
    getAppInfo() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_2__.__awaiter)(this, void 0, void 0, function* () {
            try {
                return yield _capacitor_app__WEBPACK_IMPORTED_MODULE_0__.App.getInfo();
            }
            catch (error) {
                return null;
            }
        });
    }
    genListenerId() {
        let id = 1;
        if (this.listenerIds.length > 0) {
            id = this.listenerIds[this.listenerIds.length - 1] + 1;
        }
        this.listenerIds.push(id);
        return id;
    }
    freedListener(listeners, listenerID) {
        listeners.forEach((listener, index) => {
            if (listener && listener.appListenerId == listenerID) {
                listeners.splice(index, 1);
            }
        });
    }
    setAppLinkListener(listener) {
        let listenerId_ = this.genListenerId();
        listener.appListenerId = listenerId_;
        this.appLinkListeners.push(listener);
        return listenerId_;
    }
    unsubscribe(listenerId) {
        if (!listenerId)
            return;
        if (this.listenerIds.indexOf(listenerId) < 0) {
            console.warn("not include listenerId");
            return;
        }
        let i = this.listenerIds.indexOf(listenerId);
        this.listenerIds.splice(i, 1);
        this.freedListener(this.appLinkListeners, listenerId);
    }
}
NativeAppService.isFromLogoutPage = false;
NativeAppService.ɵfac = function NativeAppService_Factory(t) { return new (t || NativeAppService)(_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_3__.NgZone)); };
NativeAppService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdefineInjectable"]({ token: NativeAppService, factory: NativeAppService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 96190:
/*!**************************************************************************!*\
  !*** ./projects/native/src/app/native/services/native-camera.service.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NativeCameraService": () => (/* binding */ NativeCameraService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _aigens_aigens_sdk_scan__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/aigens-sdk-scan */ 96422);
/* harmony import */ var _capacitor_community_barcode_scanner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @capacitor-community/barcode-scanner */ 48353);
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @capacitor/core */ 26549);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);





class NativeCameraService {
    constructor() {
        this.havePermission = false;
    }
    static cameraServiceFactory() {
        var native = _capacitor_core__WEBPACK_IMPORTED_MODULE_2__.Capacitor.isNativePlatform();
        if (native) {
            return new NativeCameraService();
        }
        return new NativeCameraService();
    }
    isAvailable() {
        return true;
    }
    checkPermission(callback) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__awaiter)(this, void 0, void 0, function* () {
            // check or request permission
            yield _capacitor_community_barcode_scanner__WEBPACK_IMPORTED_MODULE_1__.BarcodeScanner.checkPermission({ force: true }).then((result) => {
                console.log("checkPermission Result", result);
                if (result.granted) {
                    console.log("GRANTED");
                    this.havePermission = true;
                }
                callback(result);
            });
        });
    }
    scan(callback, options = {}) {
        _aigens_aigens_sdk_scan__WEBPACK_IMPORTED_MODULE_0__.Scan.scan(options).then((res) => {
            callback(res);
        });
    }
    startScan(callback, rejectPermissionCallback) {
        if (this.havePermission) {
            this.scanRaw(callback);
        }
        else {
            this.checkPermission((permissionResult) => {
                console.log(permissionResult);
                if (this.havePermission) {
                    this.scanRaw(callback);
                }
                else {
                    rejectPermissionCallback && rejectPermissionCallback();
                }
            });
        }
    }
    stopScan() {
        _capacitor_community_barcode_scanner__WEBPACK_IMPORTED_MODULE_1__.BarcodeScanner.showBackground();
        _capacitor_community_barcode_scanner__WEBPACK_IMPORTED_MODULE_1__.BarcodeScanner.stopScan();
    }
    scanRaw(callback) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__awaiter)(this, void 0, void 0, function* () {
            console.log("Scanning");
            _capacitor_community_barcode_scanner__WEBPACK_IMPORTED_MODULE_1__.BarcodeScanner.hideBackground(); // make background of WebView transparent
            yield _capacitor_community_barcode_scanner__WEBPACK_IMPORTED_MODULE_1__.BarcodeScanner.startScan({ targetedFormats: [_capacitor_community_barcode_scanner__WEBPACK_IMPORTED_MODULE_1__.SupportedFormat.QR_CODE] }).then((result) => {
                console.log("Result", result);
                // if the result has content
                if (result.hasContent) {
                    console.log(result.content); // log the raw scanned content
                    _capacitor_community_barcode_scanner__WEBPACK_IMPORTED_MODULE_1__.BarcodeScanner.stopScan();
                    callback(result);
                }
            });
        });
    }
}
NativeCameraService.ɵfac = function NativeCameraService_Factory(t) { return new (t || NativeCameraService)(); };
NativeCameraService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineInjectable"]({ token: NativeCameraService, factory: NativeCameraService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 85542:
/*!****************************************************************************!*\
  !*** ./projects/native/src/app/native/services/native-location.service.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NativeLocationService": () => (/* binding */ NativeLocationService)
/* harmony export */ });
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @capacitor/core */ 26549);
/* harmony import */ var _capacitor_geolocation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @capacitor/geolocation */ 7621);
/* harmony import */ var _core_src_app_framework__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/src/app/framework */ 44651);
/* harmony import */ var _core_src_app_pure_services_common_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/src/app/pure/services/common.service */ 43872);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/core */ 3184);





class NativeLocationService extends _core_src_app_framework__WEBPACK_IMPORTED_MODULE_2__.LocationService {
    constructor() {
        super();
    }
    static locationServiceFactory() {
        var native = _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.Capacitor.isNativePlatform();
        if (native) {
            return new NativeLocationService();
        }
        return new _core_src_app_framework__WEBPACK_IMPORTED_MODULE_2__.LocationService();
    }
    getGps(callback) {
        _capacitor_geolocation__WEBPACK_IMPORTED_MODULE_1__.Geolocation.getCurrentPosition().then((result) => {
            if (!result) {
                callback(null);
                return;
            }
            var coords = result.coords;
            if (coords.latitude) {
                var gps = {
                    latitude: this.round(coords.latitude, 4),
                    longitude: this.round(coords.longitude, 4)
                };
                _core_src_app_pure_services_common_service__WEBPACK_IMPORTED_MODULE_3__.CommonService.setLocal("lastGps", gps);
                callback(gps);
            }
            else {
                callback(null);
            }
        }).catch(() => {
            callback(null);
        });
    }
    requestPermissions() {
        _capacitor_geolocation__WEBPACK_IMPORTED_MODULE_1__.Geolocation.requestPermissions().then(rsp => {
            console.log("requestPermissions rsp :", rsp);
        }, err => {
            console.log("requestPermissions error :", err);
        });
    }
}
NativeLocationService.ɵfac = function NativeLocationService_Factory(t) { return new (t || NativeLocationService)(); };
NativeLocationService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_4__["ɵɵdefineInjectable"]({ token: NativeLocationService, factory: NativeLocationService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 75125:
/*!********************************************************************************!*\
  !*** ./projects/native/src/app/native/services/native-notification.service.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NativeNotificationService": () => (/* binding */ NativeNotificationService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @capacitor/core */ 26549);
/* harmony import */ var _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @capacitor/push-notifications */ 71704);
/* harmony import */ var _capacitor_community_fcm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @capacitor-community/fcm */ 68116);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _core_src_app_framework__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/src/app/framework */ 44651);
/* harmony import */ var _core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../core/src/app/pure/services/platform.service */ 45485);








// const { PushNotifications, AigensSdk } = Plugins;
class NativeNotificationService {
    constructor(ngZone, context, dataService, configService, platformService) {
        this.ngZone = ngZone;
        this.context = context;
        this.dataService = dataService;
        this.configService = configService;
        this.platformService = platformService;
        this.doneSetup = false;
        console.log("NativeNotificationService constructor");
        this.getAppInfo();
    }
    getAppInfo() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_5__.__awaiter)(this, void 0, void 0, function* () {
            const info = yield this.platformService.getAppInfo();
            console.log("getAppInfo:", info);
            this.appInfo = info;
        });
    }
    openNotification(openNotificationCb, openActionCb) {
        this.openNotification = openNotificationCb;
        this.openActionCb = openActionCb;
    }
    register(tokenCb, notificationCb, actionCb) {
        this.tokenCb = tokenCb;
        this.notificationCb = notificationCb;
        this.actionCb = actionCb;
        if (!this.doneSetup) {
            this.setup();
        }
        else {
            _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__.PushNotifications.register();
        }
    }
    subscribeTopic(topic) {
        if (!topic)
            return;
        _capacitor_community_fcm__WEBPACK_IMPORTED_MODULE_2__.FCM.subscribeTo({ topic: topic })
            .then((r) => {
            console.log(`subscribed to topic ` + topic);
        })
            .catch((err) => console.log(err));
    }
    subscribeGlobalTopic(brandId) {
        if (!brandId)
            return;
        var topic = "B" + brandId;
        if (!this.configService.isPrd()) {
            topic = topic + "-test";
        }
        console.log("try subscribe topic", topic);
        this.subscribeTopic(topic);
    }
    hasPermission(callback) {
        if (!_capacitor_core__WEBPACK_IMPORTED_MODULE_0__.Capacitor.isNativePlatform()) {
            callback && callback(false);
            return;
        }
        // if (Capacitor.getPlatform() == 'android') {
        //     var message = {
        //         method: "checkNotificationPermissions",
        //         service: "TempService",
        //         params: {
        //         }
        //     }
        //     AigensSdk.invoke(message).then((result) => {
        //         console.log("SDK Result", result);
        //         let granted = result && result.granted || false;
        //         callback && callback(granted);
        //     });
        //     return;
        // }
        _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__.PushNotifications.requestPermissions().then((result) => {
            callback && callback((result === null || result === void 0 ? void 0 : result.receive) == "granted");
        });
    }
    setup() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_5__.__awaiter)(this, void 0, void 0, function* () {
            console.log("notification setup called");
            // Request permission to use push notifications
            // iOS will prompt user and return if they granted permission or not
            // Android will just grant without prompting
            let permStatus = yield _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__.PushNotifications.checkPermissions();
            if (permStatus.receive === 'prompt') {
                permStatus = yield _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__.PushNotifications.requestPermissions();
            }
            if (permStatus.receive !== 'granted') {
                console.warn('User denied permissions!');
                return;
            }
            this.doneSetup = true;
            yield _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__.PushNotifications.register();
            // PushNotifications.requestPermissions().then((result: PermissionStatus) => {
            //     if (result?.receive == "granted") {
            //         // Register with Apple / Google to receive push via APNS/FCM
            //         this.doneSetup = true;
            //         PushNotifications.register();
            //     } else {
            //         // Show some error
            //     }
            // });
            // Get FCM token instead the APN one returned by Capacitor
            /**
            * Get fcm token to eventually use from a serve
            *
            * Recommended to use this instead of
            * @usage
            * ```typescript
            * PushNotifications.addListener("registration", (token) => {
            *   console.log(token.data);
            * });
            * ```
            * because the native capacitor method, for apple, returns the APN's token
            */
            if (_capacitor_core__WEBPACK_IMPORTED_MODULE_0__.Capacitor.getPlatform() === 'ios') {
                _capacitor_community_fcm__WEBPACK_IMPORTED_MODULE_2__.FCM.getToken()
                    .then((r) => {
                    if (this.tokenCb) {
                        this.ngZone.run(() => {
                            this.tokenCb(r.token);
                        });
                    }
                })
                    .catch((err) => console.log(err));
            }
            else if (_capacitor_core__WEBPACK_IMPORTED_MODULE_0__.Capacitor.getPlatform() === 'android') {
                // On success, we should be able to receive notifications
                _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__.PushNotifications.addListener('registration', (token) => {
                    console.log('Push registration success, token: ' + token.value);
                    if (this.tokenCb) {
                        this.ngZone.run(() => {
                            this.tokenCb(token.value);
                        });
                    }
                });
            }
            // Some issue with our setup and push will not work
            _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__.PushNotifications.addListener('registrationError', (error) => {
                console.log('Error on registration: ' + JSON.stringify(error));
                //alert('Error on registration: ' + JSON.stringify(error));
            });
            // Show us the notification payload if the app is open on our device
            _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__.PushNotifications.addListener('pushNotificationReceived', (notification) => {
                console.log('Push received: ' + JSON.stringify(notification));
                //alert('Push received: ' + JSON.stringify(notification));
                // if (this.lastMessageId === notification.id) {
                //     return;
                // }
                // this.lastMessageId = notification.id ;
                if (this.notificationCb) {
                    this.ngZone.run(() => {
                        var _a;
                        this.notificationCb(notification);
                        (_a = this.openNotificationCb) === null || _a === void 0 ? void 0 : _a.call(this, notification);
                    });
                }
            });
            // Method called when tapping on a notification
            _capacitor_push_notifications__WEBPACK_IMPORTED_MODULE_1__.PushNotifications.addListener('pushNotificationActionPerformed', (notificationAction) => {
                console.log('Push action performed: ' + JSON.stringify(notificationAction));
                //alert('Push action performed: ' + JSON.stringify(notification));
                if (this.actionCb) {
                    this.ngZone.run(() => {
                        var _a;
                        this.actionCb(notificationAction.notification);
                        (_a = this.openActionCb) === null || _a === void 0 ? void 0 : _a.call(this, notificationAction.notification);
                    });
                }
            });
        });
    }
    registerPushToken(token) {
        var _a, _b, _c;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_5__.__awaiter)(this, void 0, void 0, function* () {
            if (!_capacitor_core__WEBPACK_IMPORTED_MODULE_0__.Capacitor.isNativePlatform())
                return;
            if (!this.appInfo) {
                const info = yield this.platformService.getAppInfo();
                this.appInfo = info;
            }
            const appId = (_a = this.appInfo) === null || _a === void 0 ? void 0 : _a.id;
            if (!((_b = this.context) === null || _b === void 0 ? void 0 : _b.brandId) || !((_c = this.context) === null || _c === void 0 ? void 0 : _c.member) || !appId) {
                console.log("missing something");
                return;
            }
            const url = '/api/v1/crm/pushregister.json';
            const params = {
                brandId: this.context.brandId,
                token: token,
                app: appId
            };
            this.dataService.postWithParams(url, params).subscribe(data => {
                console.log("Reged push to server", data);
                if (data) {
                    this.configService.setLocal("lastRegToken", token);
                }
            }, err => {
                console.log("registerPushToken err:", err);
            });
        });
    }
}
NativeNotificationService.ɵfac = function NativeNotificationService_Factory(t) { return new (t || NativeNotificationService)(_angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_6__.NgZone), _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵinject"](_core_src_app_framework__WEBPACK_IMPORTED_MODULE_3__.Context), _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵinject"](_core_src_app_framework__WEBPACK_IMPORTED_MODULE_3__.DataService), _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵinject"](_core_src_app_framework__WEBPACK_IMPORTED_MODULE_3__.ConfigService), _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵinject"](_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_4__.PlatformService)); };
NativeNotificationService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdefineInjectable"]({ token: NativeNotificationService, factory: NativeNotificationService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 83815:
/*!****************************************************************************!*\
  !*** ./projects/native/src/app/native/services/native-platform.service.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NativePlatformService": () => (/* binding */ NativePlatformService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _capacitor_app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @capacitor/app */ 93253);
/* harmony import */ var _capacitor_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @capacitor/browser */ 18313);
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @capacitor/core */ 26549);
/* harmony import */ var _capacitor_device__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @capacitor/device */ 4744);
/* harmony import */ var capacitor_native_settings__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! capacitor-native-settings */ 82599);
/* harmony import */ var _core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../core/src/app/pure/services/platform.service */ 45485);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/core */ 3184);









class NativePlatformService extends _core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_5__.PlatformService {
    constructor(injector) {
        super(injector);
        console.log("NativePlatformService constructor2");
        this.init();
        /*
        App.addListener('appStateChange', ({ isActive }) => {
            console.log('App state changed. Is active?', isActive);
        });

        App.addListener('appUrlOpen', data => {
            console.log('App opened with URL:', data);
        });

        App.addListener('appRestoredResult', data => {
            console.log('Restored state:', data);
        });
        */
    }
    init() {
        if (this.isNative()) {
            console.log("getting native app info!");
            _capacitor_app__WEBPACK_IMPORTED_MODULE_0__.App.getInfo().then(appInfo => {
                this.appInfo = appInfo;
                console.log("info", appInfo);
            });
        }
    }
    isNative() {
        var native = _capacitor_core__WEBPACK_IMPORTED_MODULE_2__.Capacitor.isNativePlatform();
        return native;
    }
    getVersion() {
        var _a, _b;
        return (_b = (_a = this.appInfo) === null || _a === void 0 ? void 0 : _a.version) !== null && _b !== void 0 ? _b : '';
    }
    getAppInfo() {
        if (this.appInfo) {
            return Promise.resolve(this.appInfo);
        }
        else if (!this.isNative()) {
            return Promise.resolve({});
        }
        else {
            return _capacitor_app__WEBPACK_IMPORTED_MODULE_0__.App.getInfo();
        }
    }
    getAppInfoInstant() {
        return this.appInfo;
    }
    getNativePlatform() {
        var platform = _capacitor_core__WEBPACK_IMPORTED_MODULE_2__.Capacitor.getPlatform();
        return platform;
    }
    getNativeAppId() {
        var _a;
        return (_a = this.appInfo) === null || _a === void 0 ? void 0 : _a.id;
    }
    /**
     * open phone's setting page
     * @returns
     */
    openSettingsPage() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_6__.__awaiter)(this, void 0, void 0, function* () {
            const platform = (yield _capacitor_device__WEBPACK_IMPORTED_MODULE_3__.Device.getInfo()).platform;
            if (platform === 'ios') {
                return capacitor_native_settings__WEBPACK_IMPORTED_MODULE_4__.NativeSettings.openIOS({
                    option: capacitor_native_settings__WEBPACK_IMPORTED_MODULE_4__.IOSSettings.App,
                });
            }
            else if (platform === 'android') {
                return capacitor_native_settings__WEBPACK_IMPORTED_MODULE_4__.NativeSettings.openAndroid({
                    option: capacitor_native_settings__WEBPACK_IMPORTED_MODULE_4__.AndroidSettings.ApplicationDetails,
                });
            }
        });
    }
    openExternalLink(url) {
        _capacitor_browser__WEBPACK_IMPORTED_MODULE_1__.Browser.open({ url });
    }
}
NativePlatformService.ɵfac = function NativePlatformService_Factory(t) { return new (t || NativePlatformService)(_angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_7__.Injector)); };
NativePlatformService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdefineInjectable"]({ token: NativePlatformService, factory: NativePlatformService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 87504:
/*!***************************************************************************!*\
  !*** ./projects/native/src/app/native/services/native-storage.service.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NativeStorageService": () => (/* binding */ NativeStorageService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _capacitor_preferences__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @capacitor/preferences */ 85191);
/* harmony import */ var lzutf8__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lzutf8 */ 51457);
/* harmony import */ var lzutf8__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lzutf8__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _core_src_app_framework_services_storage_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/src/app/framework/services/storage.service */ 24430);
/* harmony import */ var _core_src_app_pure_services_common_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/src/app/pure/services/common.service */ 43872);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/core */ 3184);


// import { Storage } from '@capacitor/storage';





class NativeStorageService extends _core_src_app_framework_services_storage_service__WEBPACK_IMPORTED_MODULE_2__.StorageService {
    constructor(injector) {
        console.log("NativeStorageService constructor");
        super(injector);
    }
    setStorage(key, object, compress = false) {
        /**
         * Sometimes we need to prohibit writing to storage
         * * If get storage takes 3 seconds, get to order and then write into storage.
         * * It takes 1 second to remove order, and there will be a problem. The order is deleted, but it still exists in storage, so we need to write an attribute to prohibit writing to storage.
         * ** 假如get storage 需要 3秒, get 到 order 再写入 storage
         * ** remove order 需要1秒, 就会出现一个问题. 订单被删除了, storage 中仍存在, 所以需要写一个属性去禁止写入 storage.
         */
        if (NativeStorageService.prohibitWritingToStorage) {
            return Promise.resolve(null);
        }
        if (object == null) {
            return _capacitor_preferences__WEBPACK_IMPORTED_MODULE_0__.Preferences.remove({ key: key });
        }
        if (compress) {
            return this.setStorageCompress(key, object);
        }
        else {
            return _capacitor_preferences__WEBPACK_IMPORTED_MODULE_0__.Preferences.set({ key: key, value: _core_src_app_pure_services_common_service__WEBPACK_IMPORTED_MODULE_3__.CommonService.serialize(object) });
        }
    }
    getStorageCompress(key) {
        return this.getStorage(key, true);
    }
    setStorageCompress(key, object) {
        var promise = new Promise((resolve, reject) => {
            var str = JSON.stringify(object);
            console.log("before compress", str.length);
            lzutf8__WEBPACK_IMPORTED_MODULE_1__.compressAsync(str, { outputEncoding: "StorageBinaryString" }, function (result, error) {
                if (error === undefined) {
                    console.log("after compress", result.length);
                    //localForage.setItem(key, result);
                    _capacitor_preferences__WEBPACK_IMPORTED_MODULE_0__.Preferences.set({ key: key, value: result });
                    resolve(result);
                }
                else {
                    console.log("Compression error", error);
                    reject(error.message);
                }
            });
        });
        return promise;
    }
    removeItem(key) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__awaiter)(this, void 0, void 0, function* () {
            if (!key)
                return;
            yield _capacitor_preferences__WEBPACK_IMPORTED_MODULE_0__.Preferences.remove({ key: key });
        });
    }
    getStorageKeys() {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__awaiter)(this, void 0, void 0, function* () {
            const r = yield _capacitor_preferences__WEBPACK_IMPORTED_MODULE_0__.Preferences.keys();
            return r.keys || [];
        });
    }
    getStorage(key, compress = false) {
        var promise = new Promise((resolve, reject) => {
            _capacitor_preferences__WEBPACK_IMPORTED_MODULE_0__.Preferences.get({ key: key }).then(result => {
                var value = result.value;
                if (value == null || value == 'undefined') {
                    resolve(null);
                }
                else if (!compress) {
                    resolve(_core_src_app_pure_services_common_service__WEBPACK_IMPORTED_MODULE_3__.CommonService.deserialize(value));
                }
                else {
                    console.log("compressed length", value['length']);
                    lzutf8__WEBPACK_IMPORTED_MODULE_1__.decompressAsync(value, { inputEncoding: "StorageBinaryString" }, function (result, error) {
                        if (error === undefined) {
                            console.log("decompressed length", result.length);
                            //var obj = JSON.parse(result);
                            var obj = _core_src_app_pure_services_common_service__WEBPACK_IMPORTED_MODULE_3__.CommonService.deserialize(result);
                            resolve(obj);
                        }
                        else {
                            console.log("Decompression error", error);
                            resolve(null);
                        }
                    });
                }
            });
        });
        return promise;
    }
}
NativeStorageService.prohibitWritingToStorage = false;
NativeStorageService.fromLogout = false;
NativeStorageService.ɵfac = function NativeStorageService_Factory(t) { return new (t || NativeStorageService)(_angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_5__.Injector)); };
NativeStorageService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵdefineInjectable"]({ token: NativeStorageService, factory: NativeStorageService.ɵfac, providedIn: 'root' });


/***/ }),

/***/ 55215:
/*!********************************************************************!*\
  !*** ./projects/ui/src/app/ui/components/empty/empty.component.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EmptyComponent": () => (/* binding */ EmptyComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);

class EmptyComponent {
    constructor() { }
    ngOnInit() {
    }
}
EmptyComponent.ɵfac = function EmptyComponent_Factory(t) { return new (t || EmptyComponent)(); };
EmptyComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineComponent"]({ type: EmptyComponent, selectors: [["app-empty"]], decls: 0, vars: 0, template: function EmptyComponent_Template(rf, ctx) { }, styles: ["[_nghost-%COMP%] {\n  display: block;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVtcHR5LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBQTtBQUNGIiwiZmlsZSI6ImVtcHR5LmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xuICBkaXNwbGF5OiBibG9jaztcbn1cbiJdfQ== */"] });


/***/ }),

/***/ 79298:
/*!****************************************************************************!*\
  !*** ./projects/ui/src/app/ui/components/grid-list/grid-list.component.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "GridListComponent": () => (/* binding */ GridListComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _icon_icon_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../icon/icon.component */ 28492);




function GridListComponent_ng_container_1_div_1_ng_template_1_Template(rf, ctx) { }
const _c0 = function (a0) { return { content: a0 }; };
function GridListComponent_ng_container_1_div_1_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 6);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](1, GridListComponent_ng_container_1_div_1_ng_template_1_Template, 0, 0, "ng-template", 7);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} if (rf & 2) {
    const content_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]().$implicit;
    const ctx_r5 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngTemplateOutlet", ctx_r5.templateVariable)("ngTemplateOutletContext", _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpureFunction1"](2, _c0, content_r3));
} }
function GridListComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementContainerStart"](0);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](1, GridListComponent_ng_container_1_div_1_Template, 2, 4, "div", 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementContainerEnd"]();
} if (rf & 2) {
    const i_r4 = ctx.index;
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", ctx_r0.showAll || i_r4 < ctx_r0.hideAfter);
} }
function GridListComponent_app_icon_3_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelement"](0, "app-icon", 8);
} }
function GridListComponent_app_icon_4_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelement"](0, "app-icon", 9);
} }
const _c1 = function (a0) { return { "flex-direction": a0 }; };
class GridListComponent {
    constructor() {
        this.contents = [];
        this.hideAfter = 1;
        this.flexDirection = "row";
        this.showAll = false;
    }
    ngOnInit() {
    }
    toggle() {
        this.showAll = !this.showAll;
    }
}
GridListComponent.ɵfac = function GridListComponent_Factory(t) { return new (t || GridListComponent)(); };
GridListComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineComponent"]({ type: GridListComponent, selectors: [["app-grid-list"]], contentQueries: function GridListComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵcontentQuery"](dirIndex, _angular_core__WEBPACK_IMPORTED_MODULE_1__.TemplateRef, 5);
    } if (rf & 2) {
        let _t;
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵqueryRefresh"](_t = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵloadQuery"]()) && (ctx.templateVariable = _t.first);
    } }, inputs: { contents: "contents", hideAfter: "hideAfter", flexDirection: "flexDirection" }, decls: 5, vars: 6, consts: [[1, "list", "w-full", "justify-center", "p-5", 3, "ngStyle"], [4, "ngFor", "ngForOf"], [1, "btn", 3, "click"], ["name", "more_horiz", "source", "mat", 4, "ngIf"], ["name", "expand_less", "source", "mat", 4, "ngIf"], ["class", "item", 4, "ngIf"], [1, "item"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], ["name", "more_horiz", "source", "mat"], ["name", "expand_less", "source", "mat"]], template: function GridListComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](1, GridListComponent_ng_container_1_Template, 2, 1, "ng-container", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](2, "button", 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵlistener"]("click", function GridListComponent_Template_button_click_2_listener() { return ctx.toggle(); });
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](3, GridListComponent_app_icon_3_Template, 1, 0, "app-icon", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](4, GridListComponent_app_icon_4_Template, 1, 0, "app-icon", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpureFunction1"](4, _c1, ctx.flexDirection));
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngForOf", ctx.contents);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx.showAll && ctx.hideAfter < (ctx.contents == null ? null : ctx.contents.length));
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", ctx.showAll);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_2__.NgForOf, _angular_common__WEBPACK_IMPORTED_MODULE_2__.NgIf, _angular_common__WEBPACK_IMPORTED_MODULE_2__.NgTemplateOutlet, _angular_common__WEBPACK_IMPORTED_MODULE_2__.NgStyle, _icon_icon_component__WEBPACK_IMPORTED_MODULE_0__.IconComponent], styles: ["[_nghost-%COMP%] {\n  display: block;\n}\n\n.list[_ngcontent-%COMP%] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(8rem, 8rem));\n  gap: 0.8rem;\n  row-gap: 1.25rem;\n}\n\n.action[_ngcontent-%COMP%] {\n  display: flex;\n}\n\n.spacer[_ngcontent-%COMP%] {\n  flex-grow: 1;\n}\n\n.item[_ngcontent-%COMP%] {\n  cursor: pointer;\n}\n\n.btn[_ngcontent-%COMP%] {\n  outline: none;\n}\n\n@media not screen and (min-width: 600px) {\n  .list[_ngcontent-%COMP%] {\n    grid-template-columns: repeat(auto-fit, minmax(8rem, 1fr));\n  }\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdyaWQtbGlzdC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGNBQUE7QUFDSjs7QUFFQTtFQUNJLGFBQUE7RUFDQSwyREFBQTtFQUNBLFdBQUE7RUFDQSxnQkFBQTtBQUNKOztBQUVBO0VBQ0ksYUFBQTtBQUNKOztBQUVBO0VBQ0ksWUFBQTtBQUNKOztBQUVBO0VBQ0ksZUFBQTtBQUNKOztBQUVBO0VBQ0ksYUFBQTtBQUNKOztBQUVBO0VBQ0k7SUFHSSwwREFBQTtFQUROO0FBQ0YiLCJmaWxlIjoiZ3JpZC1saXN0LmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xufVxuXG4ubGlzdCB7XG4gICAgZGlzcGxheTogZ3JpZDtcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdChhdXRvLWZpdCwgbWlubWF4KDhyZW0sIDhyZW0pKTtcbiAgICBnYXA6IDAuOHJlbTtcbiAgICByb3ctZ2FwOiAxLjI1cmVtO1xufVxuXG4uYWN0aW9uIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xufVxuXG4uc3BhY2VyIHtcbiAgICBmbGV4LWdyb3c6IDE7XG59XG5cbi5pdGVtIHtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbi5idG4ge1xuICAgIG91dGxpbmU6IG5vbmU7XG59XG5cbkBtZWRpYSBub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA2MDBweCkge1xuICAgIC5saXN0IHtcbiAgICAgICAgLy8gZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiBhdXRvIGF1dG87XG4gICAgICAgIC8vIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoOHJlbSwgOHJlbSkpO1xuICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdChhdXRvLWZpdCwgbWlubWF4KDhyZW0sIDFmcikpO1xuICAgIH1cbn1cbiJdfQ== */"] });


/***/ }),

/***/ 28492:
/*!******************************************************************!*\
  !*** ./projects/ui/src/app/ui/components/icon/icon.component.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IconComponent": () => (/* binding */ IconComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/common */ 36362);


const _c0 = function (a0) { return { "font-size": a0, "line-height": "1em", "width": "1em", "height": "1em" }; };
function IconComponent_ng_container_0_span_1_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](0, "span", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵclassMap"](ctx_r1.matClass);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵpureFunction1"](5, _c0, ctx_r1.fontsize));
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](ctx_r1.name);
} }
const _c1 = function (a0) { return { "font-size": a0, height: "1em", width: "1em", fill: "currentColor", display: "inline-block" }; };
function IconComponent_ng_container_0__svg_svg_2_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵnamespaceSVG"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](0, "svg", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelement"](1, "use");
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r2 = _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵpureFunction1"](2, _c1, ctx_r2.fontsize));
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵattribute"]("href", "assets/icons/sprites.svg#" + ctx_r2.name);
} }
function IconComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementContainerStart"](0, 1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtemplate"](1, IconComponent_ng_container_0_span_1_Template, 2, 7, "span", 2);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtemplate"](2, IconComponent_ng_container_0__svg_svg_2_Template, 2, 4, "svg", 3);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementContainerEnd"]();
} if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngSwitch", ctx_r0.source);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngSwitchCase", "mat");
} }
class IconComponent {
    constructor() {
        this.source = 'custom'; // can be custom or mat
        this.height = '24px';
    }
    ngOnInit() {
        if (this.size) {
            this.fontsize = this.size + "px";
        }
        else {
            this.fontsize = "inherit";
        }
        this.height = this.fontsize;
        if (this.source == 'mat') {
            this.matClass = "material-icons";
            if (this.var) {
                this.matClass += "-" + this.var;
            }
        }
    }
}
IconComponent.ɵfac = function IconComponent_Factory(t) { return new (t || IconComponent)(); };
IconComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineComponent"]({ type: IconComponent, selectors: [["app-icon"]], hostVars: 2, hostBindings: function IconComponent_HostBindings(rf, ctx) { if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵstyleProp"]("height", ctx.height);
    } }, inputs: { size: "size", name: "name", var: "var", source: "source" }, decls: 1, vars: 1, consts: [[3, "ngSwitch", 4, "ngIf"], [3, "ngSwitch"], [3, "class", "ngStyle", 4, "ngSwitchCase"], [3, "ngStyle", 4, "ngSwitchDefault"], [3, "ngStyle"]], template: function IconComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtemplate"](0, IconComponent_ng_container_0_Template, 3, 2, "ng-container", 0);
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngIf", ctx.name);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_1__.NgIf, _angular_common__WEBPACK_IMPORTED_MODULE_1__.NgStyle, _angular_common__WEBPACK_IMPORTED_MODULE_1__.NgSwitch, _angular_common__WEBPACK_IMPORTED_MODULE_1__.NgSwitchCase, _angular_common__WEBPACK_IMPORTED_MODULE_1__.NgSwitchDefault], styles: ["[_nghost-%COMP%] {\n  display: inline-block;\n  vertical-align: middle;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImljb24uY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxxQkFBQTtFQUNBLHNCQUFBO0FBQ0oiLCJmaWxlIjoiaWNvbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0e1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xufSJdfQ== */"] });


/***/ }),

/***/ 29025:
/*!****************************************************************!*\
  !*** ./projects/ui/src/app/ui/components/img/img.component.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ImgComponent": () => (/* binding */ ImgComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _icon_icon_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../icon/icon.component */ 28492);



function ImgComponent_div_0_app_icon_1_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelement"](0, "app-icon", 6);
} if (rf & 2) {
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("name", ctx_r1.icon);
} }
function ImgComponent_div_0_div_2_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 7);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r2 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](ctx_r2.content.name);
} }
function ImgComponent_div_0_div_3_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 8);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](ctx_r3.content.name[0]);
} }
const _c0 = function (a0, a1) { return { "fadeIn": a0, "loading": a1 }; };
const _c1 = function (a0) { return { "object-fit": a0 }; };
function ImgComponent_div_0_img_4_Template(rf, ctx) { if (rf & 1) {
    const _r6 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "img", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵlistener"]("load", function ImgComponent_div_0_img_4_Template_img_load_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrestoreView"](_r6); const ctx_r5 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"](2); return _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵresetView"](ctx_r5.onload()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r4 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵclassMap"](ctx_r4.class);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpropertyInterpolate"]("src", ctx_r4.src, _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵsanitizeUrl"]);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpureFunction2"](6, _c0, ctx_r4.useAnimate && ctx_r4.loaded, ctx_r4.useAnimate && !ctx_r4.loaded))("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpureFunction1"](9, _c1, ctx_r4.constrain));
} }
const _c2 = function (a0, a1, a2) { return { "padding-top": a0, "background": a1, "height": a2 }; };
function ImgComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](1, ImgComponent_div_0_app_icon_1_Template, 1, 1, "app-icon", 2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](2, ImgComponent_div_0_div_2_Template, 2, 1, "div", 3);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](3, ImgComponent_div_0_div_3_Template, 2, 1, "div", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](4, ImgComponent_div_0_img_4_Template, 1, 11, "img", 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpureFunction3"](5, _c2, ctx_r0.paddingTop, ctx_r0.background, ctx_r0.height));
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx_r0.src && ctx_r0.fallback == "" && ctx_r0.icon);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx_r0.src && ctx_r0.fallback == "name" && ctx_r0.content);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx_r0.src && ctx_r0.fallback == "prefix" && (ctx_r0.content == null ? null : ctx_r0.content.name));
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", ctx_r0.src && ctx_r0.type != "background");
} }
class ImgComponent {
    constructor() {
        this.imgName = 'default';
        this.ratio = 1;
        this.icon = "";
        this.animate = false;
        this.pw = 500;
        this.class = "";
        this.fallback = "";
        this.background = "transparent";
        this.type = "";
        this.constrain = 'cover';
        this.hideEmpty = false;
        this.loaded = false;
        this.useAnimate = false;
        //this control the ratio
        this.paddingTop = "100%";
        this.height = "";
        this._locale = null;
        this.startTime = new Date().getTime();
    }
    set locale(_locale) {
        if (_locale !== this.locale) {
            this._locale = _locale;
            this.initData();
        }
    }
    get locale() {
        return this._locale;
    }
    ngOnInit() {
        this.useAnimate = this.animate;
        var ratio = (1 / this.ratio) * 100;
        this.paddingTop = ratio + "%";
        this.initData();
    }
    ngDoCheck() {
        if (this.oldContent !== this.content) {
            this.initData();
            this.oldContent = this.content;
        }
    }
    initData() {
        var _a;
        if (this.content) {
            //console.log("IMG CONTENT", this.content);
            var imgs = this.content.images || ((_a = this.content[0]) === null || _a === void 0 ? void 0 : _a.images);
            if (imgs) {
                var img = imgs[this.imgName] || imgs['logo'];
                if (img) {
                    this.src = this.getImgLocaleUrl(img);
                }
            }
        }
        if (this.src) {
            this.src = ImgComponent.patchUrl(this.src, this.pw);
        }
        if (this.src && this.type == 'background') {
            this.background = 'no-repeat center url(' + this.src + ') ';
            this.paddingTop = "0px";
            this.height = "100%";
        }
    }
    //https://lh3.googleusercontent.com/4U4a6TeGMNnCUk4hWhSMR90lPT7GZNkBLk-YmD2QRC-nRnRZGdug5vv8hwrF7ClO0wjTW4zDQo7jeTcyScLx3pmxaUsP
    static patchUrl(url, width) {
        var aigens = window['aigens'];
        if (url) {
            var isGoogle = url.indexOf("googleusercontent.com") != -1 || url.indexOf("image.order.place") != -1 || url.indexOf("image.aigens.com") != -1 || url.indexOf("imagetest.aigens.com") != -1;
            //if url is google and not already enchanced
            if (isGoogle) {
                var eqIndex = url.lastIndexOf("=");
                if (eqIndex != -1) {
                    var x = url.substring(0, eqIndex);
                    url = x;
                }
                var segs = [];
                if (width > 0 && url.indexOf('=w') == -1) {
                    segs.push('w' + width);
                }
                if (width == 0 && url.indexOf('=s') == -1) { // use original size if width is 0
                    segs.push('s0');
                }
                var webp = aigens === null || aigens === void 0 ? void 0 : aigens.webp;
                if (webp) {
                    segs.push("rw");
                }
                if (segs.length > 0) {
                    url += "=" + segs.join("-");
                }
            }
            if (isGoogle && (aigens === null || aigens === void 0 ? void 0 : aigens.network) == 'cn') {
                var imgHost = aigens.profile.imgHost2;
                if (imgHost) {
                    var path = url.substring(url.lastIndexOf('/'));
                    url = imgHost + path;
                }
            }
        }
        return url;
    }
    getImgLocaleUrl(img) {
        if (!this.locale) {
            return img.url;
        }
        const urlName = 'url_' + this.locale;
        if (urlName in img) {
            return img[urlName];
        }
        return img.url;
    }
    onload() {
        this.loadedTime = new Date().getTime();
        var diff = this.loadedTime - this.startTime;
        if (diff < 500) {
            this.useAnimate = false;
        }
        this.loaded = true;
    }
}
ImgComponent.ɵfac = function ImgComponent_Factory(t) { return new (t || ImgComponent)(); };
ImgComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineComponent"]({ type: ImgComponent, selectors: [["app-img"]], inputs: { src: "src", content: "content", imgName: "imgName", ratio: "ratio", icon: "icon", animate: "animate", pw: "pw", class: "class", fallback: "fallback", background: "background", type: "type", constrain: "constrain", hideEmpty: "hideEmpty", locale: "locale" }, decls: 1, vars: 1, consts: [["class", "wrapper", 3, "ngStyle", 4, "ngIf"], [1, "wrapper", 3, "ngStyle"], ["class", "center", "source", "mat", 3, "name", 4, "ngIf"], ["class", "center w-full p-3 noimg-cat-name", 4, "ngIf"], ["class", "center", 4, "ngIf"], [3, "src", "class", "ngClass", "ngStyle", "load", 4, "ngIf"], ["source", "mat", 1, "center", 3, "name"], [1, "center", "w-full", "p-3", "noimg-cat-name"], [1, "center"], [3, "src", "ngClass", "ngStyle", "load"]], template: function ImgComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](0, ImgComponent_div_0_Template, 5, 9, "div", 0);
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", ctx.src || !ctx.hideEmpty);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_2__.NgClass, _angular_common__WEBPACK_IMPORTED_MODULE_2__.NgIf, _angular_common__WEBPACK_IMPORTED_MODULE_2__.NgStyle, _icon_icon_component__WEBPACK_IMPORTED_MODULE_0__.IconComponent], styles: ["[_nghost-%COMP%] {\n  display: block;\n}\n\n.wrapper[_ngcontent-%COMP%] {\n  position: relative;\n  background-color: transparent;\n  text-align: center;\n  background-size: cover !important;\n}\n\nimg[_ngcontent-%COMP%] {\n  max-width: 100%;\n  max-height: 100%;\n  width: 100%;\n  height: 100%;\n  display: block;\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0 !important;\n  right: 0;\n}\n\n.loading[_ngcontent-%COMP%] {\n  display: none;\n}\n\n.fadeIn[_ngcontent-%COMP%] {\n  display: block;\n  animation: fadeIn 0.5s;\n  -webkit-animation: fadeIn 0.5s;\n  -moz-animation: fadeIn 0.5s;\n  -o-animation: fadeIn 0.5s;\n  -ms-animation: fadeIn 0.5s;\n}\n\n@keyframes fadeIn {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n.center[_ngcontent-%COMP%] {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n\n.noimg-cat-name[_ngcontent-%COMP%] {\n  line-height: normal;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImltZy5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGNBQUE7QUFDSjs7QUFHQTtFQUNJLGtCQUFBO0VBQ0EsNkJBQUE7RUFDQSxrQkFBQTtFQUNBLGlDQUFBO0FBQUo7O0FBR0E7RUFDSSxlQUFBO0VBQ0EsZ0JBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtFQUVBLGNBQUE7RUFDQSxrQkFBQTtFQUNBLE1BQUE7RUFDQSxPQUFBO0VBQ0Esb0JBQUE7RUFDQSxRQUFBO0FBREo7O0FBSUE7RUFDSSxhQUFBO0FBREo7O0FBS0E7RUFDSSxjQUFBO0VBQ0Esc0JBQUE7RUFDQSw4QkFBQTtFQUNBLDJCQUFBO0VBQ0EseUJBQUE7RUFDQSwwQkFBQTtBQUZKOztBQUtBO0VBQ0k7SUFDSSxVQUFBO0VBRk47RUFJRTtJQUNJLFVBQUE7RUFGTjtBQUNGOztBQU9BO0VBQ0ksa0JBQUE7RUFDQSxRQUFBO0VBQ0EsU0FBQTtFQUNBLGdDQUFBO0FBTEo7O0FBUUE7RUFDSSxtQkFBQTtBQUxKIiwiZmlsZSI6ImltZy5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICAvL2JhY2tncm91bmQtY29sb3I6ICNlNGU0ZTQ7XG59XG5cbi53cmFwcGVyIHtcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIGJhY2tncm91bmQtc2l6ZTogY292ZXIgIWltcG9ydGFudDtcbn1cblxuaW1nIHtcbiAgICBtYXgtd2lkdGg6IDEwMCU7XG4gICAgbWF4LWhlaWdodDogMTAwJTtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgLy8gb2JqZWN0LWZpdDogY292ZXI7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHRvcDogMDtcbiAgICBsZWZ0OiAwO1xuICAgIGJvdHRvbTogMCAhaW1wb3J0YW50O1xuICAgIHJpZ2h0OiAwO1xufVxuXG4ubG9hZGluZ3tcbiAgICBkaXNwbGF5OiBub25lO1xufVxuXG5cbi5mYWRlSW4ge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIGFuaW1hdGlvbjogZmFkZUluIDAuNXM7XG4gICAgLXdlYmtpdC1hbmltYXRpb246IGZhZGVJbiAwLjVzO1xuICAgIC1tb3otYW5pbWF0aW9uOiBmYWRlSW4gMC41cztcbiAgICAtby1hbmltYXRpb246IGZhZGVJbiAwLjVzO1xuICAgIC1tcy1hbmltYXRpb246IGZhZGVJbiAwLjVzO1xufVxuXG5Aa2V5ZnJhbWVzIGZhZGVJbiB7XG4gICAgMCUge1xuICAgICAgICBvcGFjaXR5OiAwO1xuICAgIH1cbiAgICAxMDAlIHtcbiAgICAgICAgb3BhY2l0eTogMTtcbiAgICB9XG59XG5cblxuXG4uY2VudGVye1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB0b3A6IDUwJTtcbiAgICBsZWZ0OiA1MCU7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG59XG5cbi5ub2ltZy1jYXQtbmFtZXtcbiAgICBsaW5lLWhlaWdodDogbm9ybWFsO1xufVxuIl19 */"] });


/***/ }),

/***/ 26910:
/*!**************************************************************************!*\
  !*** ./projects/ui/src/app/ui/components/row-list/row-list.component.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RowListComponent": () => (/* binding */ RowListComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _icon_icon_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../icon/icon.component */ 28492);




function RowListComponent_ng_container_1_div_1_ng_template_1_Template(rf, ctx) { }
const _c0 = function (a0) { return { content: a0 }; };
function RowListComponent_ng_container_1_div_1_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 6);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](1, RowListComponent_ng_container_1_div_1_ng_template_1_Template, 0, 0, "ng-template", 7);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} if (rf & 2) {
    const content_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]().$implicit;
    const ctx_r5 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngTemplateOutlet", ctx_r5.templateVariable)("ngTemplateOutletContext", _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpureFunction1"](2, _c0, content_r3));
} }
function RowListComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementContainerStart"](0);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](1, RowListComponent_ng_container_1_div_1_Template, 2, 4, "div", 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementContainerEnd"]();
} if (rf & 2) {
    const i_r4 = ctx.index;
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", ctx_r0.showAll || i_r4 < ctx_r0.hideAfter);
} }
function RowListComponent_app_icon_3_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelement"](0, "app-icon", 8);
} }
function RowListComponent_app_icon_4_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelement"](0, "app-icon", 9);
} }
const _c1 = function (a0) { return { "flex-direction": a0 }; };
class RowListComponent {
    constructor() {
        this.contents = [];
        this.hideAfter = 1;
        this.flexDirection = "column";
        this.showAll = false;
    }
    ngOnInit() {
    }
    toggle() {
        this.showAll = !this.showAll;
    }
}
RowListComponent.ɵfac = function RowListComponent_Factory(t) { return new (t || RowListComponent)(); };
RowListComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineComponent"]({ type: RowListComponent, selectors: [["app-row-list"]], contentQueries: function RowListComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵcontentQuery"](dirIndex, _angular_core__WEBPACK_IMPORTED_MODULE_1__.TemplateRef, 5);
    } if (rf & 2) {
        let _t;
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵqueryRefresh"](_t = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵloadQuery"]()) && (ctx.templateVariable = _t.first);
    } }, inputs: { contents: "contents", hideAfter: "hideAfter", flexDirection: "flexDirection" }, decls: 5, vars: 6, consts: [[1, "list", "w-full", 3, "ngStyle"], [4, "ngFor", "ngForOf"], [1, "btn", 3, "click"], ["name", "more_horiz", "source", "mat", 4, "ngIf"], ["name", "expand_less", "source", "mat", 4, "ngIf"], ["class", "item", 4, "ngIf"], [1, "item"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], ["name", "more_horiz", "source", "mat"], ["name", "expand_less", "source", "mat"]], template: function RowListComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](1, RowListComponent_ng_container_1_Template, 2, 1, "ng-container", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](2, "button", 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵlistener"]("click", function RowListComponent_Template_button_click_2_listener() { return ctx.toggle(); });
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](3, RowListComponent_app_icon_3_Template, 1, 0, "app-icon", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](4, RowListComponent_app_icon_4_Template, 1, 0, "app-icon", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpureFunction1"](4, _c1, ctx.flexDirection));
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngForOf", ctx.contents);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx.showAll && ctx.hideAfter < (ctx.contents == null ? null : ctx.contents.length));
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", ctx.showAll);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_2__.NgForOf, _angular_common__WEBPACK_IMPORTED_MODULE_2__.NgIf, _angular_common__WEBPACK_IMPORTED_MODULE_2__.NgTemplateOutlet, _angular_common__WEBPACK_IMPORTED_MODULE_2__.NgStyle, _icon_icon_component__WEBPACK_IMPORTED_MODULE_0__.IconComponent], styles: ["[_nghost-%COMP%] {\n  display: block;\n}\n\n.list[_ngcontent-%COMP%] {\n  display: flex;\n  flex-wrap: wrap;\n  align-content: center;\n}\n\n.action[_ngcontent-%COMP%] {\n  display: flex;\n}\n\n.spacer[_ngcontent-%COMP%] {\n  flex-grow: 1;\n}\n\n.item[_ngcontent-%COMP%] {\n  width: 170px;\n  margin-bottom: 1rem;\n}\n\n.btn[_ngcontent-%COMP%] {\n  outline: none;\n}\n\n@media not screen and (min-width: 600px) {\n  .item[_ngcontent-%COMP%] {\n    width: 100%;\n  }\n  .item[_ngcontent-%COMP%]:nth-child(3n+0) {\n    margin-right: 0;\n  }\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdy1saXN0LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksY0FBQTtBQUNKOztBQUVBO0VBQ0ksYUFBQTtFQUNBLGVBQUE7RUFDQSxxQkFBQTtBQUNKOztBQUVBO0VBQ0ksYUFBQTtBQUNKOztBQUVBO0VBQ0ksWUFBQTtBQUNKOztBQUVBO0VBRUksWUFBQTtFQUNBLG1CQUFBO0FBQUo7O0FBR0E7RUFDSSxhQUFBO0FBQUo7O0FBR0E7RUFDSTtJQUVJLFdBQUE7RUFETjtFQUdNO0lBQ0ksZUFBQTtFQURWO0FBQ0YiLCJmaWxlIjoicm93LWxpc3QuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XG4gICAgZGlzcGxheTogYmxvY2s7XG59XG5cbi5saXN0IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtd3JhcDogd3JhcDtcbiAgICBhbGlnbi1jb250ZW50OiBjZW50ZXI7XG59XG5cbi5hY3Rpb24ge1xuICAgIGRpc3BsYXk6IGZsZXg7XG59XG5cbi5zcGFjZXIge1xuICAgIGZsZXgtZ3JvdzogMTtcbn1cblxuLml0ZW0ge1xuICAgIC8vZmxleC1ncm93OiAxO1xuICAgIHdpZHRoOiAxNzBweDtcbiAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xufVxuXG4uYnRuIHtcbiAgICBvdXRsaW5lOiBub25lO1xufVxuXG5AbWVkaWEgbm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNjAwcHgpIHtcbiAgICAuaXRlbSB7XG4gICAgICAgIC8vIHdpZHRoOiBjYWxjKDMzLjMzJSAtIDExcHgpO1xuICAgICAgICB3aWR0aDogMTAwJTtcblxuICAgICAgICAmOm50aC1jaGlsZCgzbiArIDApIHtcbiAgICAgICAgICAgIG1hcmdpbi1yaWdodDogMDtcbiAgICAgICAgfVxuICAgICAgICAvLyBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgIC8vIG92ZXJmbG93OiBoaWRkZW47XG4gICAgfVxufVxuIl19 */"] });


/***/ }),

/***/ 4172:
/*!************************************************************************!*\
  !*** ./projects/ui/src/app/ui/components/tab-bar/tab-bar.component.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TabBarComponent": () => (/* binding */ TabBarComponent)
/* harmony export */ });
/* harmony import */ var _aigens_core_src_app_pure_services_navigation_menu_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/navigation-menu.service */ 69574);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _icon_icon_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../icon/icon.component */ 28492);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @ngx-translate/core */ 33935);







const _c0 = function (a0, a1, a2) { return { "animated": a0, "active": a1, "bigBtn": a2 }; };
const _c1 = function (a0) { return { color: a0 }; };
function TabBarComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r3 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](0, "div", 3);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵlistener"]("click", function TabBarComponent_div_1_Template_div_click_0_listener() { const restoredCtx = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵrestoreView"](_r3); const tab_r1 = restoredCtx.$implicit; const ctx_r2 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵresetView"](ctx_r2.tabClicked(tab_r1)); });
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](1, "div", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelement"](2, "app-icon", 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](3, "h3", 6);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpipe"](5, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]()()();
} if (rf & 2) {
    const tab_r1 = ctx.$implicit;
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵnextContext"]();
    let tmp_4_0;
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpureFunction3"](9, _c0, ctx_r0.enableClickAnimation, ctx_r0.isTabActive(tab_r1), (tab_r1 == null ? null : tab_r1.displayType) === "bigBtn"))("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpureFunction1"](13, _c1, ctx_r0.isTabActive(tab_r1) ? ctx_r0.activeColor : ctx_r0.defaultColor));
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpureFunction1"](15, _c1, ctx_r0.isTabActive(tab_r1) ? ctx_r0.activeColor : ctx_r0.defaultColor))("name", ctx_r0.getIconName(tab_r1))("source", (tmp_4_0 = tab_r1 == null ? null : tab_r1.icon == null ? null : tab_r1.icon.src) !== null && tmp_4_0 !== undefined ? tmp_4_0 : "custom");
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpureFunction1"](17, _c1, ctx_r0.isTabActive(tab_r1) ? ctx_r0.activeColor : ctx_r0.defaultColor));
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpipeBind1"](5, 7, tab_r1.title), " ");
} }
class TabBarComponent {
    constructor(injector) {
        this.injector = injector;
        this.tabs = []; // tab contents
        this.activeColor = 'var(--P)'; // the color of tab when active
        this.defaultColor = '#c4c4c4';
        this.backgroundColor = '#FFFFFF';
        this.enableClickAnimation = false;
        this.tabSelected = new _angular_core__WEBPACK_IMPORTED_MODULE_2__.EventEmitter();
        this.router = injector.get(_angular_router__WEBPACK_IMPORTED_MODULE_3__.Router);
        this.navigationMenuService = injector.get(_aigens_core_src_app_pure_services_navigation_menu_service__WEBPACK_IMPORTED_MODULE_0__.NavigationMenuService);
    }
    ngOnInit() {
    }
    isTabActive(tab) {
        const url = this.router.url;
        return this.navigationMenuService.hasRouteMatch(tab, url);
    }
    tabClicked(tab) {
        this.tabSelected.emit(tab);
    }
    getIconName(tab) {
        var _a, _b, _c, _d;
        if (!this.isTabActive(tab)) {
            return (_a = tab.icon) === null || _a === void 0 ? void 0 : _a.name;
        }
        if ((_b = tab.activeIcon) === null || _b === void 0 ? void 0 : _b.name) {
            return (_c = tab.activeIcon) === null || _c === void 0 ? void 0 : _c.name;
        }
        return (_d = tab.icon) === null || _d === void 0 ? void 0 : _d.name;
    }
}
TabBarComponent.ɵfac = function TabBarComponent_Factory(t) { return new (t || TabBarComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_2__.Injector)); };
TabBarComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineComponent"]({ type: TabBarComponent, selectors: [["app-tab-bar"]], inputs: { tabs: "tabs", activeColor: "activeColor", defaultColor: "defaultColor", backgroundColor: "backgroundColor", enableClickAnimation: "enableClickAnimation" }, outputs: { tabSelected: "tabSelected" }, decls: 3, vars: 3, consts: [[1, "tabbar"], ["matRipple", "", "class", "tab", 3, "ngClass", "ngStyle", "click", 4, "ngFor", "ngForOf"], [1, "tabbar-bottom"], ["matRipple", "", 1, "tab", 3, "ngClass", "ngStyle", "click"], [1, "wrapper-tabbar-content"], ["size", "22", 1, "icon-tab", 3, "ngStyle", "name", "source"], [1, "justify-center", "align-middle", 3, "ngStyle"]], template: function TabBarComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](0, "div", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtemplate"](1, TabBarComponent_div_1_Template, 6, 19, "div", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelement"](2, "div", 2);
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵstyleProp"]("background", ctx.backgroundColor);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("ngForOf", ctx.tabs);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_4__.NgClass, _angular_common__WEBPACK_IMPORTED_MODULE_4__.NgForOf, _angular_common__WEBPACK_IMPORTED_MODULE_4__.NgStyle, _icon_icon_component__WEBPACK_IMPORTED_MODULE_1__.IconComponent, _ngx_translate_core__WEBPACK_IMPORTED_MODULE_5__.TranslatePipe], styles: ["[_nghost-%COMP%] {\n  display: block;\n  z-index: 998;\n}\n\n.tabbar[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex: auto;\n  height: 4rem;\n  border-top: 1px solid #eee;\n}\n\n.tab[_ngcontent-%COMP%] {\n  padding: 0.5rem 0px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex: 1 0;\n  flex-direction: column;\n  height: 100%;\n}\n\n.tab.animated[_ngcontent-%COMP%] {\n  transition: background-color 500ms ease-out;\n}\n\n.tab.animated[_ngcontent-%COMP%]:active {\n  background-color: #EEEEEE;\n}\n\n.tab[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\n  text-transform: uppercase;\n  letter-spacing: 0.2px;\n  font-size: 0.7rem;\n  margin-top: 3px;\n  text-align: center;\n}\n\n.icon-tab[_ngcontent-%COMP%] {\n  margin-bottom: 0.3rem;\n  transition: 300ms all ease;\n}\n\nh3[_ngcontent-%COMP%] {\n  font-size: 0.75rem;\n  font-weight: 400;\n  transition: 300ms all ease;\n}\n\n.wrapper-tabbar-content[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n}\n\n.bigBtn[_ngcontent-%COMP%] {\n  position: relative;\n}\n\n.bigBtn[_ngcontent-%COMP%]   .wrapper-tabbar-content[_ngcontent-%COMP%] {\n  position: absolute;\n  width: 4.8rem;\n  height: 4.8rem;\n  top: -2.4rem;\n  right: 50%;\n  left: 50%;\n  transform: translate(-50%, 0);\n  background: var(--P);\n  border: 3px solid #fff;\n  border-radius: 50rem;\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);\n}\n\n.bigBtn[_ngcontent-%COMP%]   .wrapper-tabbar-content[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n  color: var(--PC) !important;\n}\n\n.bigBtn[_ngcontent-%COMP%]   .wrapper-tabbar-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\n  color: var(--PC) !important;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhYi1iYXIuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxjQUFBO0VBQ0EsWUFBQTtBQUNKOztBQU9BO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0VBQ0EsdUJBQUE7RUFDQSxVQUFBO0VBQ0EsWUFBQTtFQUNBLDBCQUFBO0FBSko7O0FBT0E7RUFDSSxtQkFBQTtFQUNBLGFBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0VBQ0EsU0FBQTtFQUNBLHNCQUFBO0VBQ0EsWUFBQTtBQUpKOztBQU1JO0VBQ0ksMkNBQUE7QUFKUjs7QUFLUTtFQUNJLHlCQUFBO0FBSFo7O0FBTUk7RUFDSSx5QkFBQTtFQUNBLHFCQUFBO0VBQ0EsaUJBQUE7RUFDQSxlQUFBO0VBQ0Esa0JBQUE7QUFKUjs7QUFRQTtFQUVJLHFCQUFBO0VBQ0EsMEJBQUE7QUFOSjs7QUFTQTtFQUNJLGtCQUFBO0VBQ0EsZ0JBQUE7RUFDQSwwQkFBQTtBQU5KOztBQVlBO0VBQ0ksYUFBQTtFQUNBLHNCQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0FBVEo7O0FBWUE7RUFDSSxrQkFBQTtBQVRKOztBQVVJO0VBQ0ksa0JBQUE7RUFDQSxhQUFBO0VBQ0EsY0FBQTtFQUNBLFlBQUE7RUFDQSxVQUFBO0VBQ0EsU0FBQTtFQUNBLDZCQUFBO0VBQ0Esb0JBQUE7RUFDQSxzQkFBQTtFQUNBLG9CQUFBO0VBQ0EsMkNBQUE7QUFSUjs7QUFTUTtFQUNJLDJCQUFBO0FBUFo7O0FBU1E7RUFDSSwyQkFBQTtBQVBaIiwiZmlsZSI6InRhYi1iYXIuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgei1pbmRleDogOTk4O1xuICAgIC8vIGZvbnQtd2VpZ2h0OiBub3JtYWw7XG4gICAgLy8gYmFja2dyb3VuZDogIzQ5MUQxODtcbiAgICAvLyBiYWNrZ3JvdW5kOiAjRjJFOEQ4O1xuICAgIC8vIGJvcmRlci10b3A6IDFweCBzb2xpZCAjRjdGMkVDO1xuICAgIC8vIGJveC1zaGFkb3c6ICAwIDFweCA1cHggIzAwMDAwMDM2O1xufVxuXG4udGFiYmFye1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICBmbGV4OiBhdXRvO1xuICAgIGhlaWdodDogNHJlbTtcbiAgICBib3JkZXItdG9wOiAxcHggc29saWQgI2VlZTtcbn1cblxuLnRhYiB7XG4gICAgcGFkZGluZzogMC41cmVtIDBweDtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgZmxleDogMSAwO1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgaGVpZ2h0OiAxMDAlO1xuXG4gICAgJi5hbmltYXRlZHtcbiAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciA1MDBtcyBlYXNlLW91dDtcbiAgICAgICAgJjphY3RpdmV7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRUVFRUVFO1xuICAgICAgICB9XG4gICAgfVxuICAgIGgze1xuICAgICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xuICAgICAgICBsZXR0ZXItc3BhY2luZzogMC4ycHg7XG4gICAgICAgIGZvbnQtc2l6ZTogMC43cmVtO1xuICAgICAgICBtYXJnaW4tdG9wOiAzcHg7XG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICB9XG59XG5cbi5pY29uLXRhYntcbiAgICAvLyBjb2xvcjogIzQ5MUQxODtcbiAgICBtYXJnaW4tYm90dG9tOiAwLjNyZW07XG4gICAgdHJhbnNpdGlvbjogMzAwbXMgYWxsIGVhc2U7XG59XG5cbmgze1xuICAgIGZvbnQtc2l6ZTogMC43NXJlbTtcbiAgICBmb250LXdlaWdodDogNDAwO1xuICAgIHRyYW5zaXRpb246IDMwMG1zIGFsbCBlYXNlO1xuICAgIC8vIGNvbG9yOiM0OTFEMTg7XG5cblxufVxuXG4ud3JhcHBlci10YWJiYXItY29udGVudHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBoZWlnaHQ6IDEwMCU7XG59XG5cbi5iaWdCdG57XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIC53cmFwcGVyLXRhYmJhci1jb250ZW50e1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIHdpZHRoOiA0LjhyZW07XG4gICAgICAgIGhlaWdodDogNC44cmVtO1xuICAgICAgICB0b3A6IC0yLjRyZW07XG4gICAgICAgIHJpZ2h0OiA1MCU7XG4gICAgICAgIGxlZnQ6IDUwJTtcbiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgMCk7XG4gICAgICAgIGJhY2tncm91bmQ6IHZhcigtLVApO1xuICAgICAgICBib3JkZXI6IDNweCBzb2xpZCAjZmZmO1xuICAgICAgICBib3JkZXItcmFkaXVzOiA1MHJlbTtcbiAgICAgICAgYm94LXNoYWRvdzogMHB4IDBweCAxMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgICAgICAgYXBwLWljb257XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tUEMpICFpbXBvcnRhbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaDN7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tUEMpICFpbXBvcnRhbnQ7XG4gICAgICAgIH1cbiAgICB9XG5cbn1cblxuIl19 */"] });


/***/ }),

/***/ 50019:
/*!*******************************************************!*\
  !*** ./projects/ui/src/app/ui/pipes/locale-string.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LocaleStringPipe": () => (/* binding */ LocaleStringPipe)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ngx-translate/core */ 33935);


class LocaleStringPipe {
    constructor(translateService) {
        this.translateService = translateService;
    }
    transform(content, lang = null, field = "name") {
        if (!content)
            return "";
        if (typeof content == 'string') {
            return this.translateService.instant(content);
        }
        //return value.name;
        return this.lookup(content, lang, field);
    }
    lookup(content, lang, field) {
        var result = null;
        //var lang = window['aigens']?.context?.userLang;
        //console.log("i18n pipe", content, field,  lang);
        if (lang) {
            result = content[field + "_" + lang];
        }
        if (!result) {
            result = content[field];
        }
        return result;
    }
}
LocaleStringPipe.ɵfac = function LocaleStringPipe_Factory(t) { return new (t || LocaleStringPipe)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.TranslateService, 16)); };
LocaleStringPipe.ɵpipe = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({ name: "i18n", type: LocaleStringPipe, pure: true });


/***/ }),

/***/ 39420:
/*!*********************************************!*\
  !*** ./projects/ui/src/app/ui/ui.module.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UiModule": () => (/* binding */ UiModule)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var _components_grid_list_grid_list_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./components/grid-list/grid-list.component */ 79298);
/* harmony import */ var _components_icon_icon_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./components/icon/icon.component */ 28492);
/* harmony import */ var _components_img_img_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./components/img/img.component */ 29025);
/* harmony import */ var _components_row_list_row_list_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./components/row-list/row-list.component */ 26910);
/* harmony import */ var _components_tab_bar_tab_bar_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./components/tab-bar/tab-bar.component */ 4172);
/* harmony import */ var _pipes_locale_string__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./pipes/locale-string */ 50019);
/* harmony import */ var _components_empty_empty_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./components/empty/empty.component */ 55215);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/core */ 3184);











const MY_COMPONENTS = [
    _components_img_img_component__WEBPACK_IMPORTED_MODULE_2__.ImgComponent, _components_icon_icon_component__WEBPACK_IMPORTED_MODULE_1__.IconComponent, _components_grid_list_grid_list_component__WEBPACK_IMPORTED_MODULE_0__.GridListComponent, _components_tab_bar_tab_bar_component__WEBPACK_IMPORTED_MODULE_4__.TabBarComponent, _components_row_list_row_list_component__WEBPACK_IMPORTED_MODULE_3__.RowListComponent
];
const MY_PIPES = [
    _pipes_locale_string__WEBPACK_IMPORTED_MODULE_5__.LocaleStringPipe
];
class UiModule {
}
UiModule.ɵfac = function UiModule_Factory(t) { return new (t || UiModule)(); };
UiModule.ɵmod = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdefineNgModule"]({ type: UiModule });
UiModule.ɵinj = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdefineInjector"]({ imports: [_angular_common__WEBPACK_IMPORTED_MODULE_8__.CommonModule,
        _ngx_translate_core__WEBPACK_IMPORTED_MODULE_9__.TranslateModule,
        _angular_router__WEBPACK_IMPORTED_MODULE_10__.RouterModule] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵsetNgModuleScope"](UiModule, { declarations: [_components_img_img_component__WEBPACK_IMPORTED_MODULE_2__.ImgComponent, _components_icon_icon_component__WEBPACK_IMPORTED_MODULE_1__.IconComponent, _components_grid_list_grid_list_component__WEBPACK_IMPORTED_MODULE_0__.GridListComponent, _components_tab_bar_tab_bar_component__WEBPACK_IMPORTED_MODULE_4__.TabBarComponent, _components_row_list_row_list_component__WEBPACK_IMPORTED_MODULE_3__.RowListComponent, _pipes_locale_string__WEBPACK_IMPORTED_MODULE_5__.LocaleStringPipe, _components_empty_empty_component__WEBPACK_IMPORTED_MODULE_6__.EmptyComponent], imports: [_angular_common__WEBPACK_IMPORTED_MODULE_8__.CommonModule,
        _ngx_translate_core__WEBPACK_IMPORTED_MODULE_9__.TranslateModule,
        _angular_router__WEBPACK_IMPORTED_MODULE_10__.RouterModule], exports: [_components_img_img_component__WEBPACK_IMPORTED_MODULE_2__.ImgComponent, _components_icon_icon_component__WEBPACK_IMPORTED_MODULE_1__.IconComponent, _components_grid_list_grid_list_component__WEBPACK_IMPORTED_MODULE_0__.GridListComponent, _components_tab_bar_tab_bar_component__WEBPACK_IMPORTED_MODULE_4__.TabBarComponent, _components_row_list_row_list_component__WEBPACK_IMPORTED_MODULE_3__.RowListComponent, _pipes_locale_string__WEBPACK_IMPORTED_MODULE_5__.LocaleStringPipe] }); })();


/***/ }),

/***/ 18906:
/*!****************************************************************************************************!*\
  !*** ./projects/ux/src/app/ux/components/favorite-items-button/favorite-items-button.component.ts ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FavoriteItemsButtonComponent": () => (/* binding */ FavoriteItemsButtonComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/src/app/pure/services/routing.service */ 28759);
/* harmony import */ var _core_src_app_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../core/src/app/pure/services/subscribe.service */ 47074);
/* harmony import */ var _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/components/icon/icon.component */ 28492);




class FavoriteItemsButtonComponent {
    constructor(routingService, ss) {
        this.routingService = routingService;
        this.ss = ss;
        this.context = ss;
    }
    ngOnInit() {
    }
    favoriteClicked() {
        this.routingService.navigate(`/order/store/${this.context.storeId}/favorite-item`, {});
    }
}
FavoriteItemsButtonComponent.ɵfac = function FavoriteItemsButtonComponent_Factory(t) { return new (t || FavoriteItemsButtonComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdirectiveInject"](_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__.RoutingService), _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdirectiveInject"](_core_src_app_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_1__.SubscribeService)); };
FavoriteItemsButtonComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdefineComponent"]({ type: FavoriteItemsButtonComponent, selectors: [["app-favorite-items-button"]], decls: 2, vars: 1, consts: [[1, "favorite-items-btn", "mat-focus-indicator", "mat-button", "mat-button-base", 3, "click"], ["name", "favorite_border", "source", "mat", 3, "size"]], template: function FavoriteItemsButtonComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementStart"](0, "button", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵlistener"]("click", function FavoriteItemsButtonComponent_Template_button_click_0_listener() { return ctx.favoriteClicked(); });
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelement"](1, "app-icon", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementEnd"]();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵproperty"]("size", 20);
    } }, dependencies: [_ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_2__.IconComponent], styles: ["[_nghost-%COMP%] {\n  position: relative;\n}\n\n.favorite-items-btn[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  color: white;\n}\n\n.favorite-items-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n  margin-left: 4px;\n  margin-right: 4px;\n  display: flex;\n  align-items: center;\n}\n\n.favorite-items-btn[_ngcontent-%COMP%]:hover {\n  filter: brightness(0.9);\n}\n\n@media not screen and (min-width: 840px) {\n  [_nghost-%COMP%] {\n    position: unset;\n  }\n  .favorite-items-btn[_ngcontent-%COMP%] {\n    padding: 0;\n    min-width: auto;\n    display: flex;\n    align-items: center;\n  }\n  .favorite-items-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n    width: 20px;\n    height: 20px !important;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  .favorite-items-btn[_ngcontent-%COMP%]  span.material-icons {\n    font-size: 20px !important;\n  }\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZhdm9yaXRlLWl0ZW1zLWJ1dHRvbi5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGtCQUFBO0FBQ0o7O0FBRUU7RUFDSSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxZQUFBO0FBQ047O0FBQU07RUFDSSxnQkFBQTtFQUNBLGlCQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0FBRVY7O0FBQU07RUFDRSx1QkFBQTtBQUVSOztBQUtFO0VBRUU7SUFDRSxlQUFBO0VBSEo7RUFNSTtJQUNJLFVBQUE7SUFDQSxlQUFBO0lBQ0EsYUFBQTtJQUNBLG1CQUFBO0VBSlI7RUFLUTtJQUNFLFdBQUE7SUFDQSx1QkFBQTtJQUNBLGFBQUE7SUFDQSxtQkFBQTtJQUNBLHVCQUFBO0VBSFY7RUFNVTtJQUNFLDBCQUFBO0VBSlo7QUFDRiIsImZpbGUiOiJmYXZvcml0ZS1pdGVtcy1idXR0b24uY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdHtcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIH1cblxuICAuZmF2b3JpdGUtaXRlbXMtYnRue1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICBjb2xvcjogd2hpdGU7XG4gICAgICBhcHAtaWNvbntcbiAgICAgICAgICBtYXJnaW4tbGVmdDogNHB4O1xuICAgICAgICAgIG1hcmdpbi1yaWdodDogNHB4O1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgIH1cbiAgICAgICY6aG92ZXIge1xuICAgICAgICBmaWx0ZXI6IGJyaWdodG5lc3MoMC45KTtcbiAgICB9XG4gIH1cblxuICBAbWVkaWEgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA4NDBweCkge1xuICB9XG5cbiAgQG1lZGlhIG5vdCBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDg0MHB4KSB7XG5cbiAgICA6aG9zdHtcbiAgICAgIHBvc2l0aW9uOiB1bnNldDtcbiAgICB9XG5cbiAgICAgIC5mYXZvcml0ZS1pdGVtcy1idG57XG4gICAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgICBtaW4td2lkdGg6IGF1dG87XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgIGFwcC1pY29ue1xuICAgICAgICAgICAgd2lkdGg6IDIwcHg7XG4gICAgICAgICAgICBoZWlnaHQ6IDIwcHggIWltcG9ydGFudDtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgfVxuICAgICAgICAgICY6Om5nLWRlZXB7XG4gICAgICAgICAgICBzcGFuLm1hdGVyaWFsLWljb25ze1xuICAgICAgICAgICAgICBmb250LXNpemU6IDIwcHggIWltcG9ydGFudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG5cblxuICB9XG4iXX0= */"] });


/***/ }),

/***/ 47119:
/*!**********************************************************************!*\
  !*** ./projects/ux/src/app/ux/components/footer/footer.component.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FooterComponent": () => (/* binding */ FooterComponent)
/* harmony export */ });
/* harmony import */ var _aigens_core_src_app_pure_base_page_params__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/core/src/app/pure/base/page-params */ 8744);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/routing.service */ 28759);
/* harmony import */ var _core_src_app_pure_services_lazy_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../core/src/app/pure/services/lazy.service */ 60040);
/* harmony import */ var _aigens_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/platform.service */ 45485);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _ui_src_app_ui_components_img_img_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/components/img/img.component */ 29025);
/* harmony import */ var _ui_src_app_ui_pipes_locale_string__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/pipes/locale-string */ 50019);









function FooterComponent_div_1_div_2_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](0, "div");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelement"](1, "app-img", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]();
} if (rf & 2) {
    const icons_r4 = ctx.$implicit;
    const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵproperty"]("src", ctx_r3.getPaymentIconWithPath(icons_r4));
} }
function FooterComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](0, "div", 2)(1, "div", 8);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtemplate"](2, FooterComponent_div_1_div_2_Template, 2, 1, "div", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]()();
} if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵproperty"]("ngForOf", ctx_r0.payments);
} }
function FooterComponent_ng_container_4_div_5_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](0, "div", 12);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtext"](1, " |");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]();
} }
function FooterComponent_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    const _r9 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementContainerStart"](0);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](1, "div", 10);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵlistener"]("click", function FooterComponent_ng_container_4_Template_div_click_1_listener() { const restoredCtx = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵrestoreView"](_r9); const agreement_r5 = restoredCtx.$implicit; const ctx_r8 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵresetView"](ctx_r8.agreementClicked([agreement_r5])); });
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](2, "h3");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵpipe"](4, "i18n");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtemplate"](5, FooterComponent_ng_container_4_div_5_Template, 2, 0, "div", 11);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementContainerEnd"]();
} if (rf & 2) {
    const agreement_r5 = ctx.$implicit;
    const i_r6 = ctx.index;
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵpipeBind3"](4, 2, agreement_r5, ctx_r1.context.userLang, "title"));
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵproperty"]("ngIf", i_r6 < ctx_r1.agreements.length - 1);
} }
function FooterComponent_ng_container_9_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementContainerStart"](0);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelement"](1, "img", 13);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementContainerEnd"]();
} }
class FooterComponent {
    constructor(routingService, lazyService, platformService, route) {
        this.routingService = routingService;
        this.lazyService = lazyService;
        this.platformService = platformService;
        this.route = route;
        this.showPaymentIcons = false;
        this.payments = [];
        this.context = window['aigens'].context;
        console.log('FooterComponent construct');
    }
    ngOnInit() {
        var _a, _b, _c, _d;
        this.navParams = new _aigens_core_src_app_pure_base_page_params__WEBPACK_IMPORTED_MODULE_0__.PageParams();
        this.navParams.route = this.route;
        if (this.context.agreements) {
            this.agreements = this.agreementSorting('home', null, (_a = this.navParams.get('mode')) !== null && _a !== void 0 ? _a : null);
        }
        const paymentIcons = (_d = (_c = (_b = this.context) === null || _b === void 0 ? void 0 : _b.config) === null || _c === void 0 ? void 0 : _c.data) === null || _d === void 0 ? void 0 : _d.paymentIcons;
        if (typeof paymentIcons === 'object') {
            Object.keys(paymentIcons).forEach((x) => {
                if (paymentIcons[x] === true && this.getPaymentIcon(x) !== '') {
                    this.payments.push(x);
                }
            });
        }
        if (Array.isArray(paymentIcons)) {
            paymentIcons === null || paymentIcons === void 0 ? void 0 : paymentIcons.forEach((x) => {
                if (this.getPaymentIcon(x) !== '') {
                    this.payments.push(x);
                }
            });
        }
    }
    getPaymentIconWithPath(paymentMethod) {
        const paymentIcon = this.getPaymentIcon(paymentMethod);
        if (paymentIcon === '') {
            return '';
        }
        return `assets/icons/svg/${paymentIcon}.svg`;
    }
    getPaymentIcon(paymentMethod) {
        switch (paymentMethod) {
            case 'creditcard':
                return 'ios-payment-ccard';
            case 'googlepay':
            case 'google':
                return 'ios-payment-gpay';
            case 'applepay':
                return 'ios-payment-apple';
            case 'gopay':
                return 'ios-payment-gopay';
            case 'ewallet':
                return 'ios-payment-ewallet';
            case 'qris':
                return 'ios-payment-qris';
            case 'virtualaccount':
                return 'ios-payment-virtualaccount';
            case 'alipay':
                return 'ios-payment-alipay';
            case 'alipayHK':
                return 'ios-payment-alipay-hk';
            case 'alipayCN':
                return 'ios-payment-alipay-cn';
            case 'cash':
                return 'ios-payment-cashpay';
            case 'gcash':
                return 'ios-payment-gcash-new';
            case 'paymaya':
                return 'ios-payment-paymaya';
            case 'master':
                return 'ios-payment-mastercard';
            case 'visa':
                return 'ios-payment-visa';
            case 'JCB':
                return 'ios-payment-JCB';
            case 'chargetoroom':
                return 'ios-payment-chargetoroom';
            case 'payme':
                return 'ios-payment-payme';
            case 'wechat':
                return 'ios-payment-wechat';
            case 'octopus':
                return 'ios-payment-octopus';
            case 'unionpay':
                return 'ios-payment-unionpay';
            default:
                return '';
        }
    }
    agreementSorting(trigger, feature, mode = '') {
        var _a, _b, _c, _d, _e, _f;
        if (feature == 'active') {
            return (_b = (_a = this.context) === null || _a === void 0 ? void 0 : _a.agreements) === null || _b === void 0 ? void 0 : _b.filter((item) => this.isAgreementValid(item, trigger, mode) && !item.passive);
        }
        if (feature == 'passive') {
            return (_d = (_c = this.context) === null || _c === void 0 ? void 0 : _c.agreements) === null || _d === void 0 ? void 0 : _d.filter((item) => this.isAgreementValid(item, trigger, mode) && item.passive);
        }
        return (_f = (_e = this.context) === null || _e === void 0 ? void 0 : _e.agreements) === null || _f === void 0 ? void 0 : _f.filter((item) => this.isAgreementValid(item, trigger, mode));
    }
    isAgreementValid(agreementItem, trigger, mode = '') {
        var _a, _b, _c, _d, _e;
        if (!agreementItem.enabled) {
            return false;
        }
        if (((_a = agreementItem === null || agreementItem === void 0 ? void 0 : agreementItem.trigger) === null || _a === void 0 ? void 0 : _a.indexOf(trigger)) < 0) {
            return false;
        }
        const channel = this.platformService.getMenuChannel();
        if (((_b = agreementItem.channels) === null || _b === void 0 ? void 0 : _b.length) > 0 && ((_c = agreementItem.channels) === null || _c === void 0 ? void 0 : _c.indexOf(channel)) < 0) {
            return false;
        }
        if (mode && ((_d = agreementItem.modes) === null || _d === void 0 ? void 0 : _d.length) > 0 && ((_e = agreementItem.modes) === null || _e === void 0 ? void 0 : _e.indexOf(mode)) < 0) {
            return false;
        }
        const storeId = this.routingService.getQuery('storeId') || this.context.storeId;
        if (agreementItem.storeIds && storeId && agreementItem.storeIds.indexOf(storeId) < 0) {
            return false;
        }
        return true;
    }
    // (click) = "agreementClicked([agreement])"
    agreementClicked(agreement) {
        // Peter: Pass in a event emitter or find other way to do it for now
        // this.agreementService.showAgreement(agreement, "home")
        const agreementService = this.lazyService.getService('AgreementService');
        if (!agreementService)
            return;
        console.log('agg clicked', agreement);
        agreementService.showAgreement(agreement, 'home');
    }
    getDeviceConfig(key) {
        var _a, _b, _c, _d;
        return (_d = (_c = (_b = (_a = this.context) === null || _a === void 0 ? void 0 : _a.config) === null || _b === void 0 ? void 0 : _b.data) === null || _c === void 0 ? void 0 : _c[key]) !== null && _d !== void 0 ? _d : null;
    }
}
FooterComponent.ɵfac = function FooterComponent_Factory(t) { return new (t || FooterComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_1__.RoutingService), _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdirectiveInject"](_core_src_app_pure_services_lazy_service__WEBPACK_IMPORTED_MODULE_2__.LazyService), _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_3__.PlatformService), _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdirectiveInject"](_angular_router__WEBPACK_IMPORTED_MODULE_7__.ActivatedRoute)); };
FooterComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdefineComponent"]({ type: FooterComponent, selectors: [["app-footer"]], inputs: { showPaymentIcons: "showPaymentIcons" }, decls: 10, vars: 3, consts: [[1, "block", "w-full"], ["class", "footer-width", 4, "ngIf"], [1, "footer-width"], [1, "justify-start", "flex"], [4, "ngFor", "ngForOf"], [1, "flex", "items-center"], ["src", "assets/images/aigens_logo.svg", 1, "img-aigens"], [4, "ngIf"], [1, "flex", "justify-around", "w-full"], ["constrain", "contain", 3, "src"], [1, "footer-shortcuts", 3, "click"], ["class", "mx-2 -mt-0.5", 4, "ngIf"], [1, "mx-2", "-mt-0.5"], ["src", "assets/images/pos/epoint-footer.svg", 1, "img-aigens", "ml-2", "py-0.5"]], template: function FooterComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](0, "div", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtemplate"](1, FooterComponent_div_1_Template, 3, 1, "div", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](2, "div", 2)(3, "div", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtemplate"](4, FooterComponent_ng_container_4_Template, 6, 6, "ng-container", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](5, "div", 5)(6, "h4");
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtext"](7, "Powered by");
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelement"](8, "img", 6);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtemplate"](9, FooterComponent_ng_container_9_Template, 2, 0, "ng-container", 7);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]()()();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵproperty"]("ngIf", ctx.payments && ctx.payments.length > 0 && ctx.showPaymentIcons);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵproperty"]("ngForOf", ctx.agreements);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](5);
        _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵproperty"]("ngIf", ctx.getDeviceConfig("displayEpointLogo"));
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_8__.NgForOf, _angular_common__WEBPACK_IMPORTED_MODULE_8__.NgIf, _ui_src_app_ui_components_img_img_component__WEBPACK_IMPORTED_MODULE_4__.ImgComponent, _ui_src_app_ui_pipes_locale_string__WEBPACK_IMPORTED_MODULE_5__.LocaleStringPipe], styles: ["[_nghost-%COMP%] {\n  display: block;\n  background: #fff;\n  display: flex;\n  justify-content: center;\n  border-top: 1px solid #ececec;\n}\n\n.footer-width[_ngcontent-%COMP%] {\n  padding: 1.25rem 2rem;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.accor-footer-width[_ngcontent-%COMP%] {\n  max-width: 1440px;\n  width: 100%;\n  background-color: black;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n  bottom: 0;\n  z-index: 1;\n  height: 4rem;\n}\n\napp-img[_ngcontent-%COMP%] {\n  width: 2rem;\n}\n\n.trade-mark[_ngcontent-%COMP%] {\n  margin-left: 30px;\n  font-size: 16px;\n  text-align: left;\n  display: grid;\n  gap: 5px;\n}\n\n.copy-right[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n  color: #fff;\n  font-size: 0.6rem;\n  opacity: 0.5;\n}\n\nh3[_ngcontent-%COMP%] {\n  color: #8a8a8a;\n  font-size: 12px;\n  text-decoration: underline;\n}\n\nh4[_ngcontent-%COMP%] {\n  color: #8a8a8a;\n  font-size: 12px;\n  margin-right: 0.3rem;\n}\n\n.img-aigens[_ngcontent-%COMP%] {\n  height: 1rem;\n}\n\n.footer-shortcuts[_ngcontent-%COMP%] {\n  cursor: pointer;\n}\n\n@media not screen and (min-width: 600px) {\n  [_nghost-%COMP%] {\n    padding: 0.75rem 2rem;\n  }\n  .footer-width[_ngcontent-%COMP%] {\n    justify-content: center !important;\n  }\n  .footer-shortcuts[_ngcontent-%COMP%] {\n    display: none;\n  }\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvb3Rlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGNBQUE7RUFDQSxnQkFBQTtFQUNBLGFBQUE7RUFDQSx1QkFBQTtFQUNBLDZCQUFBO0FBQ0o7O0FBRUE7RUFFSSxxQkFBQTtFQUNBLFdBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSw4QkFBQTtBQUFKOztBQUdBO0VBRUksaUJBQUE7RUFDQSxXQUFBO0VBQ0EsdUJBQUE7RUFDQSxZQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0VBQ0EsNkJBQUE7RUFFQSxTQUFBO0VBQ0EsVUFBQTtFQUNBLFlBQUE7QUFGSjs7QUFLQTtFQUNJLFdBQUE7QUFGSjs7QUFLQTtFQUNJLGlCQUFBO0VBQ0EsZUFBQTtFQUNBLGdCQUFBO0VBQ0EsYUFBQTtFQUNBLFFBQUE7QUFGSjs7QUFNSTtFQUNJLFdBQUE7RUFDQSxpQkFBQTtFQUNBLFlBQUE7QUFIUjs7QUFPQTtFQUNJLGNBQUE7RUFDQSxlQUFBO0VBQ0EsMEJBQUE7QUFKSjs7QUFNQTtFQUNJLGNBQUE7RUFDQSxlQUFBO0VBQ0Esb0JBQUE7QUFISjs7QUFLQTtFQUNJLFlBQUE7QUFGSjs7QUFLQTtFQUNJLGVBQUE7QUFGSjs7QUFJQTtFQUNJO0lBQ0kscUJBQUE7RUFETjtFQUdFO0lBQ0ksa0NBQUE7RUFETjtFQUdFO0lBQ0ksYUFBQTtFQUROO0FBQ0YiLCJmaWxlIjoiZm9vdGVyLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIGJhY2tncm91bmQ6ICNmZmY7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICBib3JkZXItdG9wOiAxcHggc29saWQgI2VjZWNlYztcbn1cblxuLmZvb3Rlci13aWR0aCB7XG4gICAgLy8gbWF4LXdpZHRoOiAxMTIwcHg7XG4gICAgcGFkZGluZzogMS4yNXJlbSAycmVtO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG59XG5cbi5hY2Nvci1mb290ZXItd2lkdGgge1xuICAgIC8vIHBhZGRpbmc6IDE1cHg7XG4gICAgbWF4LXdpZHRoOiAxNDQwcHg7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7XG4gICAgY29sb3I6IHdoaXRlO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDtcbiAgICAvLyBwb3NpdGlvbjogZml4ZWQ7XG4gICAgYm90dG9tOiAwO1xuICAgIHotaW5kZXg6IDE7XG4gICAgaGVpZ2h0OiA0cmVtO1xufVxuXG5hcHAtaW1ne1xuICAgIHdpZHRoOiAycmVtO1xufVxuXG4udHJhZGUtbWFyayB7XG4gICAgbWFyZ2luLWxlZnQ6IDMwcHg7XG4gICAgZm9udC1zaXplOiAxNnB4O1xuICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gICAgZGlzcGxheTogZ3JpZDtcbiAgICBnYXA6IDVweDtcbn1cblxuLmNvcHktcmlnaHQge1xuICAgIHNwYW4ge1xuICAgICAgICBjb2xvcjogI2ZmZjtcbiAgICAgICAgZm9udC1zaXplOiAwLjZyZW07XG4gICAgICAgIG9wYWNpdHk6IDAuNTtcbiAgICB9XG59XG5cbmgzIHtcbiAgICBjb2xvcjogIzhhOGE4YTtcbiAgICBmb250LXNpemU6IDEycHg7XG4gICAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmU7XG59XG5oNCB7XG4gICAgY29sb3I6ICM4YThhOGE7XG4gICAgZm9udC1zaXplOiAxMnB4O1xuICAgIG1hcmdpbi1yaWdodDogMC4zcmVtO1xufVxuLmltZy1haWdlbnMge1xuICAgIGhlaWdodDogMXJlbTtcbn1cblxuLmZvb3Rlci1zaG9ydGN1dHMge1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbn1cbkBtZWRpYSBub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA2MDBweCkge1xuICAgIDpob3N0IHtcbiAgICAgICAgcGFkZGluZzogMC43NXJlbSAycmVtO1xuICAgIH1cbiAgICAuZm9vdGVyLXdpZHRoIHtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDtcbiAgICB9XG4gICAgLmZvb3Rlci1zaG9ydGN1dHMge1xuICAgICAgICBkaXNwbGF5OiBub25lO1xuICAgIH1cbn1cbiJdfQ== */"] });


/***/ }),

/***/ 51093:
/*!****************************************************************************************!*\
  !*** ./projects/ux/src/app/ux/components/language-select/language-select.component.ts ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LanguageSelectComponent": () => (/* binding */ LanguageSelectComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _core_src_app_pure_services_common_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/src/app/pure/services/common.service */ 43872);
/* harmony import */ var _aigens_core_src_app_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/subscribe.service */ 47074);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/components/icon/icon.component */ 28492);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @ngx-translate/core */ 33935);







function LanguageSelectComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementStart"](0, "div", 6);
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵlistener"]("click", function LanguageSelectComponent_div_0_Template_div_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵrestoreView"](_r3); const ctx_r2 = _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵresetView"](ctx_r2.dismissClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementEnd"]();
} }
function LanguageSelectComponent_div_7_a_2_Template(rf, ctx) { if (rf & 1) {
    const _r7 = _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementStart"](0, "a", 10);
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵlistener"]("click", function LanguageSelectComponent_div_7_a_2_Template_a_click_0_listener() { const restoredCtx = _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵrestoreView"](_r7); const lang_r5 = restoredCtx.$implicit; const ctx_r6 = _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵnextContext"](2); return _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵresetView"](ctx_r6.languageClicked(lang_r5)); });
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵpipe"](2, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementEnd"]();
} if (rf & 2) {
    const lang_r5 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵpipeBind1"](2, 1, "lang." + lang_r5));
} }
function LanguageSelectComponent_div_7_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementStart"](0, "div", 7)(1, "div", 8);
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵtemplate"](2, LanguageSelectComponent_div_7_a_2_Template, 3, 3, "a", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementEnd"]()();
} if (rf & 2) {
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵproperty"]("ngForOf", ctx_r1.languages);
} }
class LanguageSelectComponent {
    constructor(injector, subscribeService) {
        this.injector = injector;
        this.subscribeService = subscribeService;
        this.showDropdown = false;
        this.changed = new _angular_core__WEBPACK_IMPORTED_MODULE_3__.EventEmitter();
        this.context = window['aigens'].context;
        if (!this.context.userLang) {
            this.languageClicked(this.context.language);
        }
    }
    get languages() {
        var _a, _b, _c;
        // sometimes languages in brand lever is different from store level
        return ((_a = this.context) === null || _a === void 0 ? void 0 : _a.languages) || ((_c = (_b = this.context) === null || _b === void 0 ? void 0 : _b.store) === null || _c === void 0 ? void 0 : _c.languages) || [];
    }
    ngOnInit() {
        setTimeout(() => {
            this.context.userLang = this.getLocale();
        }, 500);
    }
    selectClicked() {
        this.showDropdown = !this.showDropdown;
    }
    dismissClicked() {
        this.showDropdown = false;
    }
    languageClicked(lang) {
        this.showDropdown = false;
        /*
        var oldLang = this.t.currentLang;
        if(oldLang == lang){
            console.log("same lang");
            return;
        }
        */
        this.context.userLang = lang;
        this.subscribeService.next("language", lang);
        this.subscribeService.next("userLang", lang);
        if (this.changed) {
            this.changed.emit(lang);
        }
    }
    getLocale() {
        return _core_src_app_pure_services_common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.getLocal("locale");
    }
    setLocale(lang) {
        return _core_src_app_pure_services_common_service__WEBPACK_IMPORTED_MODULE_0__.CommonService.setLocal("locale", lang);
    }
}
LanguageSelectComponent.ɵfac = function LanguageSelectComponent_Factory(t) { return new (t || LanguageSelectComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_3__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_1__.SubscribeService)); };
LanguageSelectComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵdefineComponent"]({ type: LanguageSelectComponent, selectors: [["app-language-select"]], outputs: { changed: "changed" }, decls: 8, vars: 7, consts: [["class", "overlay z-40", 3, "click", 4, "ngIf"], [1, "lang-btn", "mat-focus-indicator", "mat-button", "mat-button-base", "p-0", 3, "click"], ["name", "language", "source", "mat", 3, "size"], [1, "mobile:hidden", "current-lang"], ["name", "expand_more", "source", "mat", 1, "mobile:hidden", "lang-arrow", 3, "size"], ["class", "desfj380df absolute right-0 top-7 z-50 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none", "role", "menu", "aria-orientation", "vertical", "aria-labelledby", "menu-button", "tabindex", "-1", 4, "ngIf"], [1, "overlay", "z-40", 3, "click"], ["role", "menu", "aria-orientation", "vertical", "aria-labelledby", "menu-button", "tabindex", "-1", 1, "desfj380df", "absolute", "right-0", "top-7", "z-50", "mt-2", "w-56", "rounded-md", "shadow-lg", "bg-white", "ring-1", "ring-black", "ring-opacity-5", "focus:outline-none"], ["role", "none", 1, "py-1"], ["class", "text-gray-700 block px-4 py-2 text-sm cursor-pointer", "role", "menuitem", "tabindex", "-1", "id", "menu-item-0", 3, "click", 4, "ngFor", "ngForOf"], ["role", "menuitem", "tabindex", "-1", "id", "menu-item-0", 1, "text-gray-700", "block", "px-4", "py-2", "text-sm", "cursor-pointer", 3, "click"]], template: function LanguageSelectComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵtemplate"](0, LanguageSelectComponent_div_0_Template, 1, 0, "div", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementStart"](1, "button", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵlistener"]("click", function LanguageSelectComponent_Template_button_click_1_listener() { return ctx.selectClicked(); });
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelement"](2, "app-icon", 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementStart"](3, "span", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵtext"](4);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵpipe"](5, "translate");
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelement"](6, "app-icon", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵtemplate"](7, LanguageSelectComponent_div_7_Template, 3, 1, "div", 5);
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵproperty"]("ngIf", ctx.showDropdown);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵproperty"]("size", 20);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵpipeBind1"](5, 5, "lang." + ctx.context.userLang));
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵproperty"]("size", 15);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_3__["ɵɵproperty"]("ngIf", ctx.showDropdown);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_4__.NgForOf, _angular_common__WEBPACK_IMPORTED_MODULE_4__.NgIf, _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_2__.IconComponent, _ngx_translate_core__WEBPACK_IMPORTED_MODULE_5__.TranslatePipe], styles: ["[_nghost-%COMP%] {\n  position: relative;\n}\n\n.lang-btn[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n}\n\n.lang-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n  margin-left: 4px;\n  margin-right: 4px;\n  display: flex;\n  align-items: center;\n}\n\n.lang-btn[_ngcontent-%COMP%]:hover {\n  filter: brightness(0.9);\n}\n\n.overlay[_ngcontent-%COMP%] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0 !important;\n  z-index: 100;\n}\n\n.current-lang[_ngcontent-%COMP%] {\n  font-size: 0.8rem;\n  font-weight: lighter;\n}\n\n@media not screen and (min-width: 840px) {\n  [_nghost-%COMP%] {\n    position: unset;\n  }\n  .current-lang[_ngcontent-%COMP%], .lang-arrow[_ngcontent-%COMP%] {\n    display: none !important;\n  }\n  .lang-btn[_ngcontent-%COMP%] {\n    padding: 0;\n    min-width: auto;\n    display: flex;\n    align-items: center;\n  }\n  .lang-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n    width: 20px;\n    height: 20px !important;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  .lang-btn[_ngcontent-%COMP%]  span.material-icons {\n    font-size: 20px !important;\n  }\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxhbmd1YWdlLXNlbGVjdC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGtCQUFBO0FBQ0Y7O0FBRUE7RUFDSSxhQUFBO0VBQ0EsbUJBQUE7QUFDSjs7QUFBSTtFQUNJLGdCQUFBO0VBQ0EsaUJBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7QUFFUjs7QUFBSTtFQUNFLHVCQUFBO0FBRU47O0FBRUE7RUFDSSxlQUFBO0VBQ0EsTUFBQTtFQUNBLE9BQUE7RUFDQSxRQUFBO0VBQ0Esb0JBQUE7RUFDQSxZQUFBO0FBQ0o7O0FBRUE7RUFDRSxpQkFBQTtFQUNBLG9CQUFBO0FBQ0Y7O0FBUUE7RUFFRTtJQUNFLGVBQUE7RUFORjtFQVNFO0lBQ0ksd0JBQUE7RUFQTjtFQVNFO0lBQ0ksVUFBQTtJQUNBLGVBQUE7SUFDQSxhQUFBO0lBQ0EsbUJBQUE7RUFQTjtFQVFNO0lBQ0UsV0FBQTtJQUNBLHVCQUFBO0lBQ0EsYUFBQTtJQUNBLG1CQUFBO0lBQ0EsdUJBQUE7RUFOUjtFQVNRO0lBQ0UsMEJBQUE7RUFQVjtBQUNGIiwiZmlsZSI6Imxhbmd1YWdlLXNlbGVjdC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0e1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG59XG5cbi5sYW5nLWJ0bntcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgYXBwLWljb257XG4gICAgICAgIG1hcmdpbi1sZWZ0OiA0cHg7XG4gICAgICAgIG1hcmdpbi1yaWdodDogNHB4O1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIH1cbiAgICAmOmhvdmVyIHtcbiAgICAgIGZpbHRlcjogYnJpZ2h0bmVzcygwLjkpO1xuICB9XG59XG5cbi5vdmVybGF5e1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6IDA7XG4gICAgbGVmdDogMDtcbiAgICByaWdodDogMDtcbiAgICBib3R0b206IDAgIWltcG9ydGFudDtcbiAgICB6LWluZGV4OiAxMDA7XG59XG5cbi5jdXJyZW50LWxhbmd7XG4gIGZvbnQtc2l6ZTogMC44cmVtO1xuICBmb250LXdlaWdodDogbGlnaHRlcjtcbn1cblxuXG5cblxuQG1lZGlhIHNjcmVlbiBhbmQgKG1pbi13aWR0aDogODQwcHgpIHtcbn1cblxuQG1lZGlhIG5vdCBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDg0MHB4KSB7XG5cbiAgOmhvc3R7XG4gICAgcG9zaXRpb246IHVuc2V0O1xuICB9XG5cbiAgICAuY3VycmVudC1sYW5nLCAubGFuZy1hcnJvd3tcbiAgICAgICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O1xuICAgIH1cbiAgICAubGFuZy1idG57XG4gICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgIG1pbi13aWR0aDogYXV0bztcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgYXBwLWljb257XG4gICAgICAgICAgd2lkdGg6IDIwcHg7XG4gICAgICAgICAgaGVpZ2h0OiAyMHB4ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICB9XG4gICAgICAgICY6Om5nLWRlZXB7XG4gICAgICAgICAgc3Bhbi5tYXRlcmlhbC1pY29uc3tcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjBweCAhaW1wb3J0YW50O1xuICAgICAgICAgIH0gIFxuICAgICAgICB9XG4gICAgfVxuXG4gIFxufVxuIl19 */"] });


/***/ }),

/***/ 84904:
/*!************************************************************************!*\
  !*** ./projects/ux/src/app/ux/components/nav-bar/nav-bar.component.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NavBarComponent": () => (/* binding */ NavBarComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! tslib */ 34929);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! rxjs */ 54363);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _aigens_core_src_app_pure_services_lazy_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/lazy.service */ 60040);
/* harmony import */ var _aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/routing.service */ 28759);
/* harmony import */ var _aigens_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/platform.service */ 45485);
/* harmony import */ var _aigens_core_src_app_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @aigens/core/src/app/pure/managers/setting-manager */ 74663);
/* harmony import */ var _ui_src_app_ui_components_img_img_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/components/img/img.component */ 29025);
/* harmony import */ var _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/components/icon/icon.component */ 28492);
/* harmony import */ var _language_select_language_select_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../language-select/language-select.component */ 51093);
/* harmony import */ var _user_button_user_button_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../user-button/user-button.component */ 39746);
/* harmony import */ var _favorite_items_button_favorite_items_button_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../favorite-items-button/favorite-items-button.component */ 18906);
/* harmony import */ var _search_button_search_button_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../search-button/search-button.component */ 5907);
/* harmony import */ var _refresh_button_refresh_button_component__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../refresh-button/refresh-button.component */ 6719);

















function NavBarComponent_button_3_Template(rf, ctx) { if (rf & 1) {
    const _r12 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementStart"](0, "button", 14);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵlistener"]("click", function NavBarComponent_button_3_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵrestoreView"](_r12); const ctx_r11 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵresetView"](ctx_r11.menuClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](1, "app-icon", 15);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementEnd"]();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("size", 24);
} }
function NavBarComponent_button_4_Template(rf, ctx) { if (rf & 1) {
    const _r14 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementStart"](0, "button", 16);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵlistener"]("click", function NavBarComponent_button_4_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵrestoreView"](_r14); const ctx_r13 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵresetView"](ctx_r13.backClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](1, "app-icon", 17);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementEnd"]();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("size", 24);
} }
function NavBarComponent_button_5_Template(rf, ctx) { if (rf & 1) {
    const _r16 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementStart"](0, "button", 18);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵlistener"]("click", function NavBarComponent_button_5_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵrestoreView"](_r16); const ctx_r15 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵresetView"](ctx_r15.closeClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](1, "app-icon", 19);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementEnd"]();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("size", 24);
} }
function NavBarComponent_button_6_Template(rf, ctx) { if (rf & 1) {
    const _r18 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementStart"](0, "button", 16);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵlistener"]("click", function NavBarComponent_button_6_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵrestoreView"](_r18); const ctx_r17 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵresetView"](ctx_r17.homeClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](1, "app-icon", 20);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementEnd"]();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("size", 24);
} }
function NavBarComponent_app_img_7_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](0, "app-img", 21);
} if (rf & 2) {
    const ctx_r4 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("content", (ctx_r4.context == null ? null : ctx_r4.context.brand) || (ctx_r4.context == null ? null : ctx_r4.context.court))("hideEmpty", true);
} }
function NavBarComponent_span_8_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementStart"](0, "span", 22);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r5 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtextInterpolate"](ctx_r5.title);
} }
function NavBarComponent_app_search_button_14_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](0, "app-search-button", 23);
} }
function NavBarComponent_app_favorite_items_button_15_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](0, "app-favorite-items-button", 23);
} }
function NavBarComponent_app_language_select_16_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](0, "app-language-select", 23);
} }
function NavBarComponent_app_user_button_17_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](0, "app-user-button", 23);
} }
function NavBarComponent_app_refresh_button_18_Template(rf, ctx) { if (rf & 1) {
    const _r20 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementStart"](0, "app-refresh-button", 24);
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵlistener"]("click", function NavBarComponent_app_refresh_button_18_Template_app_refresh_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵrestoreView"](_r20); const ctx_r19 = _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵresetView"](ctx_r19.refreshClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementEnd"]();
} }
const _c0 = [[["", "left", ""]], [["", "right", ""]]];
const _c1 = function (a0, a1) { return { "full-width": a0, "embedded": a1 }; };
const _c2 = ["[left]", "[right]"];
class NavBarComponent {
    constructor(injector, router, location, lazyService, routingService, route, platformService, settingManager) {
        this.injector = injector;
        this.router = router;
        this.location = location;
        this.lazyService = lazyService;
        this.routingService = routingService;
        this.route = route;
        this.platformService = platformService;
        this.settingManager = settingManager;
        this.title = '';
        this.menu = false;
        this.home = false;
        this.back = false;
        this.language = false;
        this.user = false;
        this.fullWidth = false;
        this.fullBackgroundWidth = false;
        this.hasSignedIn = false;
        this.menuPath = 'side/menu';
        this.refresh = false;
        this.logo = true;
        this.favorite = false;
        // for sdk: after paied to orderDetailPage
        this.forceShowExit = false;
        this.embedded = false;
        this.homePage = false; // flag to state this navbar is used in home page or not
        this.search = false;
        this.refreshClick = new _angular_core__WEBPACK_IMPORTED_MODULE_11__.EventEmitter();
        this.login = true;
        this.sdk = true;
        this.showExit = false;
        this.oldMemberId = null;
        this.oldMemberGuest = null;
        this.context = window['aigens'].context;
        this.embedded = this.platformService.isEmbedded();
        this.sdk = this.platformService.isSDK();
    }
    ngOnInit() {
        this.injectRouteData();
    }
    ngDoCheck() {
        var _a, _b, _c, _d;
        if (((_a = this.context.member) === null || _a === void 0 ? void 0 : _a.id) !== this.oldMemberId && ((_b = this.context.member) === null || _b === void 0 ? void 0 : _b.guest) !== this.oldMemberGuest) {
            this.oldMemberGuest = (_c = this.context.member) === null || _c === void 0 ? void 0 : _c.guest;
            this.oldMemberId = (_d = this.context.member) === null || _d === void 0 ? void 0 : _d.id;
        }
        var canBack = this.routingService.canBack();
        // console.log("canBack", canBack);
        // console.log('forceShowExit', this.forceShowExit);
        // is sdk or pass forceShowExit = true & missing the backicon
        this.showExit = (this.sdk && !canBack) || (this.forceShowExit && !this.back);
        // console.log('forceShowExit', this.forceShowExit);
    }
    ngOnChanges(changes) {
        this.injectRouteData();
    }
    get languages() {
        var _a, _b, _c, _d, _e;
        return (_e = (_b = (_a = this.context) === null || _a === void 0 ? void 0 : _a.languages) !== null && _b !== void 0 ? _b : (_d = (_c = this.context) === null || _c === void 0 ? void 0 : _c.store) === null || _d === void 0 ? void 0 : _d.languages) !== null && _e !== void 0 ? _e : [];
    }
    injectRouteData() {
        var _a, _b;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_12__.__awaiter)(this, void 0, void 0, function* () {
            const routeData = (_b = (_a = (yield (0,rxjs__WEBPACK_IMPORTED_MODULE_13__.firstValueFrom)(this.route.data))) === null || _a === void 0 ? void 0 : _a.navbarConfig) !== null && _b !== void 0 ? _b : {};
            const injectableFields = ['menu', 'home', 'back', 'language', 'user', 'menuPath'];
            for (let index in injectableFields) {
                const field = injectableFields[index];
                if (field in routeData) {
                    this[field] = routeData[field];
                }
            }
        });
    }
    canLogin() {
        var _a, _b, _c, _d, _e, _f;
        if (!this.user)
            return false;
        if (this.courtHasFeature('login')) {
            return true;
        }
        if (((_c = (_b = (_a = this.context) === null || _a === void 0 ? void 0 : _a.brand) === null || _b === void 0 ? void 0 : _b.features) === null || _c === void 0 ? void 0 : _c.indexOf('login')) < 0) {
            return false;
        }
        if (!((_d = this === null || this === void 0 ? void 0 : this.context) === null || _d === void 0 ? void 0 : _d.crm)) {
            return false;
        }
        if ((_f = (_e = this.context) === null || _e === void 0 ? void 0 : _e.crm) === null || _f === void 0 ? void 0 : _f['disabled']) {
            return false;
        }
        return true;
    }
    courtHasFeature(feature) {
        var _a, _b, _c, _d;
        if (!((_a = this.context) === null || _a === void 0 ? void 0 : _a.court)) {
            return false;
        }
        return ((_d = (_c = (_b = this.context) === null || _b === void 0 ? void 0 : _b.court) === null || _c === void 0 ? void 0 : _c.features) === null || _d === void 0 ? void 0 : _d.indexOf(feature)) >= 0;
    }
    menuClicked() {
        var extras = {
        //    skipLocationChange: true
        };
        const auxInput = {};
        if (this.homePage) {
            auxInput.homePage = true;
        }
        const params = Object.assign(Object.assign({}, this.route.snapshot.queryParams), this.route.snapshot.params);
        this.routingService.navigateModal(this.menuPath, auxInput, { queryParams: params });
        // this.router.navigate([{outlets: {modal: 'side/menu'}}], {queryParams: this.route.snapshot.queryParams});
    }
    backClicked() {
        this.location.back();
    }
    homeClicked() {
        console.log("going home natively", this.homeUrl);
        if (this.homeUrl) {
            if (this.settingManager.get('keepModeWhenRedirectToHome', false) && this.homeUrl.includes(`mode`)) {
                this.routingService.navigateByUrl(this.homeUrl, window.location.href, { back: null, clearOrder: null });
            }
            else {
                let mode = null;
                let canKeepModes = ['web', 'catering', 'byod'];
                canKeepModes.forEach((m) => {
                    if (this.homeUrl.includes(`mode=${m}`)) {
                        mode = m;
                    }
                });
                this.routingService.navigateByUrl(this.homeUrl, window.location.href, { back: null, clearOrder: null, mode });
            }
        }
        else {
            this.routingService.goHome(window.location.href);
        }
    }
    refreshClicked() {
        this.refreshClick.emit(true);
    }
    closeClicked() {
        console.log("closing");
        var service = this.lazyService.getService("RoutingService");
        service === null || service === void 0 ? void 0 : service.finish();
    }
    checkFavorite() {
        return this.favorite && this.settingManager.get('menu.showFav', false) && this.oldMemberGuest === false;
    }
}
NavBarComponent.ɵfac = function NavBarComponent_Factory(t) { return new (t || NavBarComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_11__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdirectiveInject"](_angular_router__WEBPACK_IMPORTED_MODULE_14__.Router), _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdirectiveInject"](_angular_common__WEBPACK_IMPORTED_MODULE_15__.Location), _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_lazy_service__WEBPACK_IMPORTED_MODULE_0__.LazyService), _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_1__.RoutingService), _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdirectiveInject"](_angular_router__WEBPACK_IMPORTED_MODULE_14__.ActivatedRoute), _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_2__.PlatformService), _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_3__.SettingManager)); };
NavBarComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdefineComponent"]({ type: NavBarComponent, selectors: [["app-nav-bar"]], inputs: { title: "title", menu: "menu", home: "home", homeUrl: "homeUrl", back: "back", language: "language", user: "user", fullWidth: "fullWidth", fullBackgroundWidth: "fullBackgroundWidth", hasSignedIn: "hasSignedIn", menuPath: "menuPath", refresh: "refresh", logo: "logo", favorite: "favorite", forceShowExit: "forceShowExit", embedded: "embedded", homePage: "homePage", search: "search", login: "login" }, outputs: { refreshClick: "refreshClick" }, features: [_angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵNgOnChangesFeature"]], ngContentSelectors: _c2, decls: 19, vars: 15, consts: [[1, "mat-toolbar", "header", "mat-toolbar-single-row", "justify-center", 3, "ngClass"], [1, "flex", "items-center", "justify-between", "w-full"], ["left", "", 1, "flex", "items-center", "left-box"], ["class", "menu-btn mat-focus-indicator mat-icon-button mat-button-base", "data-testid", "hamburger-menu-button", 3, "click", 4, "ngIf"], ["class", "menu-btn mat-focus-indicator mat-icon-button mat-button-base", 3, "click", 4, "ngIf"], ["class", "menu-btn mat-focus-indicator mat-icon-button mat-button-base sdk-back", 3, "click", 4, "ngIf"], ["class", "brand-logo-desktop", "constrain", "contain", 3, "content", "hideEmpty", 4, "ngIf"], ["class", "title-brand", 4, "ngIf"], ["center", ""], [1, "spacer"], ["right", "", 1, "flex", "items-center", "right-box"], ["class", "ml-4 mobile:ml-2", 4, "ngIf"], ["class", "flex", "class", "ml-4 mobile:ml-2", 4, "ngIf"], ["class", "ml-4 mobile:ml-2", 3, "click", 4, "ngIf"], ["data-testid", "hamburger-menu-button", 1, "menu-btn", "mat-focus-indicator", "mat-icon-button", "mat-button-base", 3, "click"], ["name", "menu", "source", "mat", 3, "size"], [1, "menu-btn", "mat-focus-indicator", "mat-icon-button", "mat-button-base", 3, "click"], ["name", "arrow_back_ios", "source", "mat", 3, "size"], [1, "menu-btn", "mat-focus-indicator", "mat-icon-button", "mat-button-base", "sdk-back", 3, "click"], ["name", "arrow_back", "source", "mat", 3, "size"], ["name", "home", "source", "mat", 3, "size"], ["constrain", "contain", 1, "brand-logo-desktop", 3, "content", "hideEmpty"], [1, "title-brand"], [1, "ml-4", "mobile:ml-2"], [1, "ml-4", "mobile:ml-2", 3, "click"]], template: function NavBarComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵprojectionDef"](_c0);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementStart"](0, "div", 0)(1, "div", 1)(2, "div", 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](3, NavBarComponent_button_3_Template, 2, 1, "button", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](4, NavBarComponent_button_4_Template, 2, 1, "button", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](5, NavBarComponent_button_5_Template, 2, 1, "button", 5);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](6, NavBarComponent_button_6_Template, 2, 1, "button", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](7, NavBarComponent_app_img_7_Template, 1, 2, "app-img", 6);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](8, NavBarComponent_span_8_Template, 2, 1, "span", 7);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵprojection"](9);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementStart"](10, "div", 8);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelement"](11, "span", 9);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementStart"](12, "div", 10);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵprojection"](13, 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](14, NavBarComponent_app_search_button_14_Template, 1, 0, "app-search-button", 11);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](15, NavBarComponent_app_favorite_items_button_15_Template, 1, 0, "app-favorite-items-button", 11);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](16, NavBarComponent_app_language_select_16_Template, 1, 0, "app-language-select", 11);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](17, NavBarComponent_app_user_button_17_Template, 1, 0, "app-user-button", 12);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵtemplate"](18, NavBarComponent_app_refresh_button_18_Template, 1, 0, "app-refresh-button", 13);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵelementEnd"]()()();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵpureFunction2"](12, _c1, ctx.fullWidth, ctx.embedded));
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", !ctx.back && ctx.menu && !ctx.sdk);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.back);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.sdk && !ctx.back);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.home && ctx.homeUrl && !ctx.sdk);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.logo && ((ctx.context == null ? null : ctx.context.brand) || (ctx.context == null ? null : ctx.context.court)));
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.title);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](6);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.search && !ctx.embedded);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.checkFavorite());
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.language && ctx.languages.length > 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.canLogin() && !ctx.embedded && !ctx.sdk && ctx.login);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵproperty"]("ngIf", ctx.refresh);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_15__.NgClass, _angular_common__WEBPACK_IMPORTED_MODULE_15__.NgIf, _ui_src_app_ui_components_img_img_component__WEBPACK_IMPORTED_MODULE_4__.ImgComponent, _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_5__.IconComponent, _language_select_language_select_component__WEBPACK_IMPORTED_MODULE_6__.LanguageSelectComponent, _user_button_user_button_component__WEBPACK_IMPORTED_MODULE_7__.UserButtonComponent, _favorite_items_button_favorite_items_button_component__WEBPACK_IMPORTED_MODULE_8__.FavoriteItemsButtonComponent, _search_button_search_button_component__WEBPACK_IMPORTED_MODULE_9__.SearchButtonComponent, _refresh_button_refresh_button_component__WEBPACK_IMPORTED_MODULE_10__.RefreshButtonComponent], styles: ["[_nghost-%COMP%] {\n  width: 100%;\n  display: block;\n  z-index: 1000;\n}\n\n.full-width[_ngcontent-%COMP%] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n}\n\n.mat-toolbar-single-row[_ngcontent-%COMP%] {\n  display: flex;\n  box-sizing: border-box;\n  padding: 0 16px;\n  width: 100%;\n  flex-direction: row;\n  align-items: center;\n  white-space: nowrap;\n  box-shadow: inset 0 -1px var(--P300);\n}\n\n.embedded[_ngcontent-%COMP%] {\n  height: 40px;\n}\n\n.mat-icon-button[_ngcontent-%COMP%] {\n  padding: 0;\n  min-width: 0;\n  width: 40px;\n  height: 40px;\n  flex-shrink: 0;\n  line-height: 40px;\n  border-radius: 50%;\n}\n\n.spacer[_ngcontent-%COMP%] {\n  flex: 1 1 auto;\n}\n\n.header[_ngcontent-%COMP%] {\n  background: var(--P);\n  color: var(--PC);\n}\n\n.left-box[_ngcontent-%COMP%] {\n  flex: 1 1 auto;\n  overflow: hidden;\n}\n\n.brand-logo-desktop[_ngcontent-%COMP%] {\n  margin-left: 1.5rem;\n  height: 50px;\n  width: 50px;\n  flex-shrink: 0;\n}\n\n.title-brand[_ngcontent-%COMP%] {\n  font-size: 1.2rem;\n  line-height: normal;\n  margin-left: 1rem;\n}\n\n.menu-btn[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  width: 20px;\n  height: 20px;\n}\n\n.menu-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.menu-btn[_ngcontent-%COMP%]:hover {\n  filter: brightness(0.9);\n}\n\n.right-box[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n}\n\n@media not screen and (min-width: 600px) {\n  .brand-logo-desktop[_ngcontent-%COMP%] {\n    display: none;\n  }\n  .left-box[_ngcontent-%COMP%]   .title-brand[_ngcontent-%COMP%] {\n    margin-left: 0.5rem;\n    font-size: 1.1rem;\n  }\n  .menu-btn[_ngcontent-%COMP%]  span.material-icons {\n    font-size: 20px !important;\n  }\n  .icon-profile[_ngcontent-%COMP%] {\n    display: block !important;\n  }\n  .btn-login-register[_ngcontent-%COMP%] {\n    display: none !important;\n  }\n  .right-box[_ngcontent-%COMP%] {\n    position: relative;\n  }\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5hdi1iYXIuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFSSxXQUFBO0VBQ0EsY0FBQTtFQUNBLGFBQUE7QUFBSjs7QUFHQTtFQUNJLGVBQUE7RUFDQSxNQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7QUFBSjs7QUFHQTtFQUNJLGFBQUE7RUFDQSxzQkFBQTtFQUNBLGVBQUE7RUFDQSxXQUFBO0VBQ0EsbUJBQUE7RUFDQSxtQkFBQTtFQUNBLG1CQUFBO0VBQ0Esb0NBQUE7QUFBSjs7QUFHQTtFQUNJLFlBQUE7QUFBSjs7QUFHQTtFQUNJLFVBQUE7RUFDQSxZQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSxjQUFBO0VBQ0EsaUJBQUE7RUFDQSxrQkFBQTtBQUFKOztBQUdBO0VBQ0ksY0FBQTtBQUFKOztBQUdBO0VBQ0ksb0JBQUE7RUFDQSxnQkFBQTtBQUFKOztBQUdBO0VBQ0ksY0FBQTtFQUNBLGdCQUFBO0FBQUo7O0FBR0E7RUFDSSxtQkFBQTtFQUNBLFlBQUE7RUFDQSxXQUFBO0VBQ0EsY0FBQTtBQUFKOztBQUdBO0VBQ0ksaUJBQUE7RUFDQSxtQkFBQTtFQUNBLGlCQUFBO0FBQUo7O0FBSUE7RUFDSSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtBQURKOztBQUdJO0VBR0ksYUFBQTtFQUNBLG1CQUFBO0VBQ0EsdUJBQUE7QUFIUjs7QUFVSTtFQUNJLHVCQUFBO0FBUlI7O0FBWUE7RUFDSSxjQUFBO0FBVEo7O0FBWUE7RUFFSTtJQUNJLGFBQUE7RUFWTjtFQWFFO0lBQ0ksbUJBQUE7SUFDQSxpQkFBQTtFQVhOO0VBZ0JVO0lBQ0ksMEJBQUE7RUFkZDtFQW1CRTtJQUNJLHlCQUFBO0VBakJOO0VBb0JFO0lBQ0ksd0JBQUE7RUFsQk47RUFxQkU7SUFDSSxrQkFBQTtFQW5CTjtBQUNGIiwiZmlsZSI6Im5hdi1iYXIuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XG4gICAgLy9oZWlnaHQ6IDY0cHg7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgei1pbmRleDogMTAwMDtcbn1cblxuLmZ1bGwtd2lkdGgge1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6IDA7XG4gICAgbGVmdDogMDtcbiAgICByaWdodDogMDtcbn1cblxuLm1hdC10b29sYmFyLXNpbmdsZS1yb3cge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICBwYWRkaW5nOiAwIDE2cHg7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gICAgYm94LXNoYWRvdzogaW5zZXQgMCAtMXB4IHZhcigtLVAzMDApO1xufVxuXG4uZW1iZWRkZWQge1xuICAgIGhlaWdodDogNDBweDtcbn1cblxuLm1hdC1pY29uLWJ1dHRvbiB7XG4gICAgcGFkZGluZzogMDtcbiAgICBtaW4td2lkdGg6IDA7XG4gICAgd2lkdGg6IDQwcHg7XG4gICAgaGVpZ2h0OiA0MHB4O1xuICAgIGZsZXgtc2hyaW5rOiAwO1xuICAgIGxpbmUtaGVpZ2h0OiA0MHB4O1xuICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbn1cblxuLnNwYWNlciB7XG4gICAgZmxleDogMSAxIGF1dG87XG59XG5cbi5oZWFkZXIge1xuICAgIGJhY2tncm91bmQ6IHZhcigtLVApO1xuICAgIGNvbG9yOiB2YXIoLS1QQyk7XG59XG5cbi5sZWZ0LWJveCB7XG4gICAgZmxleDogMSAxIGF1dG87XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcbn1cblxuLmJyYW5kLWxvZ28tZGVza3RvcCB7XG4gICAgbWFyZ2luLWxlZnQ6IDEuNXJlbTtcbiAgICBoZWlnaHQ6IDUwcHg7XG4gICAgd2lkdGg6IDUwcHg7XG4gICAgZmxleC1zaHJpbms6IDA7XG59XG5cbi50aXRsZS1icmFuZCB7XG4gICAgZm9udC1zaXplOiAxLjJyZW07XG4gICAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcbiAgICBtYXJnaW4tbGVmdDogMXJlbTtcbn1cblxuXG4ubWVudS1idG4ge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB3aWR0aDogMjBweDtcbiAgICBoZWlnaHQ6IDIwcHg7XG4gICAgLy8gbWFyZ2luLXJpZ2h0OiAwLjVyZW07XG4gICAgYXBwLWljb24ge1xuICAgICAgICAvLyB3aWR0aDogMjBweDtcbiAgICAgICAgLy8gaGVpZ2h0OiAyMHB4ICFpbXBvcnRhbnQ7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIH1cbiAgICAmOjpuZy1kZWVwIHtcbiAgICAgICAgc3Bhbi5tYXRlcmlhbC1pY29ucyB7XG4gICAgICAgICAgICAvLyBmb250LXNpemU6IDI0cHggIWltcG9ydGFudDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAmOmhvdmVyIHtcbiAgICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDAuOSk7XG4gICAgfVxufVxuXG4ucmlnaHQtYm94IHtcbiAgICBmbGV4OiAwIDAgYXV0bztcbn1cblxuQG1lZGlhIG5vdCBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDYwMHB4KSB7XG5cbiAgICAuYnJhbmQtbG9nby1kZXNrdG9wIHtcbiAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICB9XG5cbiAgICAubGVmdC1ib3ggLnRpdGxlLWJyYW5kIHtcbiAgICAgICAgbWFyZ2luLWxlZnQ6IDAuNXJlbTtcbiAgICAgICAgZm9udC1zaXplOiAxLjFyZW07XG4gICAgfVxuXG4gICAgLm1lbnUtYnRuIHtcbiAgICAgICAgJjo6bmctZGVlcCB7XG4gICAgICAgICAgICBzcGFuLm1hdGVyaWFsLWljb25zIHtcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IDIwcHggIWltcG9ydGFudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC5pY29uLXByb2ZpbGUge1xuICAgICAgICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50O1xuICAgIH1cblxuICAgIC5idG4tbG9naW4tcmVnaXN0ZXIge1xuICAgICAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7XG4gICAgfVxuXG4gICAgLnJpZ2h0LWJveCB7XG4gICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICB9XG59XG5cbkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogODQwcHgpIHtcbiAgICAvLyAuaGVhZGVye1xuICAgIC8vICAgICBtYXJnaW4tYm90dG9tOiAycmVtO1xuICAgIC8vIH1cbn1cbiJdfQ== */"] });


/***/ }),

/***/ 6719:
/*!**************************************************************************************!*\
  !*** ./projects/ux/src/app/ux/components/refresh-button/refresh-button.component.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RefreshButtonComponent": () => (/* binding */ RefreshButtonComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/components/icon/icon.component */ 28492);


class RefreshButtonComponent {
    constructor() { }
    ngOnInit() { }
}
RefreshButtonComponent.ɵfac = function RefreshButtonComponent_Factory(t) { return new (t || RefreshButtonComponent)(); };
RefreshButtonComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineComponent"]({ type: RefreshButtonComponent, selectors: [["app-refresh-button"]], decls: 2, vars: 1, consts: [[1, "refresh-btn"], ["name", "refresh", "source", "mat", 3, "size"]], template: function RefreshButtonComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "button", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelement"](1, "app-icon", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("size", 22);
    } }, dependencies: [_ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_0__.IconComponent], styles: ["[_nghost-%COMP%] {\n  display: block;\n}\n\n.refresh-btn[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.refresh-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n  display: flex;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZnJlc2gtYnV0dG9uLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBQTtBQUNGOztBQUVBO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0VBQ0EsdUJBQUE7QUFDSjs7QUFBSTtFQUNJLGFBQUE7QUFFUiIsImZpbGUiOiJyZWZyZXNoLWJ1dHRvbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcbiAgZGlzcGxheTogYmxvY2s7XG59XG5cbi5yZWZyZXNoLWJ0bntcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgYXBwLWljb257XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgfVxufVxuIl19 */"] });


/***/ }),

/***/ 5907:
/*!************************************************************************************!*\
  !*** ./projects/ux/src/app/ux/components/search-button/search-button.component.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SearchButtonComponent": () => (/* binding */ SearchButtonComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/routing.service */ 28759);
/* harmony import */ var _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/components/icon/icon.component */ 28492);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ngx-translate/core */ 33935);




class SearchButtonComponent {
    constructor(routingService) {
        this.routingService = routingService;
    }
    ngOnInit() {
    }
    searchClicked() {
        this.routingService.navigateModal('order/dialog/search-item', {}, {});
    }
}
SearchButtonComponent.ɵfac = function SearchButtonComponent_Factory(t) { return new (t || SearchButtonComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__.RoutingService)); };
SearchButtonComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineComponent"]({ type: SearchButtonComponent, selectors: [["app-search-button"]], decls: 5, vars: 4, consts: [[1, "search-btn", "mat-focus-indicator", "mat-button", "mat-button-base", 3, "click"], ["name", "search", "source", "mat", 3, "size"], [1, "mobile:hidden", "text-search"]], template: function SearchButtonComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](0, "button", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵlistener"]("click", function SearchButtonComponent_Template_button_click_0_listener() { return ctx.searchClicked(); });
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelement"](1, "app-icon", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](2, "span", 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtext"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpipe"](4, "translate");
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]()();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("size", 20);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵpipeBind1"](4, 2, "buttons.search"));
    } }, dependencies: [_ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_1__.IconComponent, _ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__.TranslatePipe], styles: ["@media not screen and (min-width: 840px) {\n  [_nghost-%COMP%] {\n    position: unset;\n  }\n  .text-search[_ngcontent-%COMP%] {\n    display: none !important;\n  }\n}\n.search-btn[_ngcontent-%COMP%] {\n  min-width: 0;\n  padding: 0 0;\n  display: flex;\n  align-items: center;\n}\n.search-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n  margin-left: 4px;\n  margin-right: 4px;\n  display: flex;\n  align-items: center;\n}\n.search-btn[_ngcontent-%COMP%]:hover {\n  filter: brightness(0.9);\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlYXJjaC1idXR0b24uY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFSTtJQUNJLGVBQUE7RUFBTjtFQUdFO0lBQ0ksd0JBQUE7RUFETjtBQUNGO0FBSUE7RUFDSSxZQUFBO0VBQ0EsWUFBQTtFQUNBLGFBQUE7RUFDQSxtQkFBQTtBQUZKO0FBSUk7RUFDSSxnQkFBQTtFQUNBLGlCQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0FBRlI7QUFLSTtFQUNJLHVCQUFBO0FBSFIiLCJmaWxlIjoic2VhcmNoLWJ1dHRvbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIkBtZWRpYSBub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA4NDBweCkge1xuXG4gICAgOmhvc3Qge1xuICAgICAgICBwb3NpdGlvbjogdW5zZXQ7XG4gICAgfVxuXG4gICAgLnRleHQtc2VhcmNoIHtcbiAgICAgICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O1xuICAgIH1cbn1cblxuLnNlYXJjaC1idG4ge1xuICAgIG1pbi13aWR0aDogMDtcbiAgICBwYWRkaW5nOiAwIDA7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuXG4gICAgYXBwLWljb24ge1xuICAgICAgICBtYXJnaW4tbGVmdDogNHB4O1xuICAgICAgICBtYXJnaW4tcmlnaHQ6IDRweDtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB9XG5cbiAgICAmOmhvdmVyIHtcbiAgICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDAuOSk7XG4gICAgfVxufVxuIl19 */"] });


/***/ }),

/***/ 61204:
/*!************************************************************************!*\
  !*** ./projects/ux/src/app/ux/components/sub-bar/sub-bar.component.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SubBarComponent": () => (/* binding */ SubBarComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/routing.service */ 28759);
/* harmony import */ var _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/components/icon/icon.component */ 28492);





function SubBarComponent_button_3_Template(rf, ctx) { if (rf & 1) {
    const _r4 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](0, "button", 8);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵlistener"]("click", function SubBarComponent_button_3_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵrestoreView"](_r4); const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵresetView"](ctx_r3.backClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelement"](1, "app-icon", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("size", 18);
} }
function SubBarComponent_span_6_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](0, "span", 10);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtextInterpolate"](ctx_r1.title);
} }
function SubBarComponent_button_9_Template(rf, ctx) { if (rf & 1) {
    const _r6 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](0, "button", 11);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵlistener"]("click", function SubBarComponent_button_9_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵrestoreView"](_r6); const ctx_r5 = _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵresetView"](ctx_r5.closeBackBehaviour ? ctx_r5.backClicked() : ctx_r5.closeClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelement"](1, "app-icon", 12);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("size", 24);
} }
const _c0 = [[["", "left", ""]], [["", "right", ""]]];
const _c1 = ["[left]", "[right]"];
class SubBarComponent {
    constructor(location, routingService) {
        this.location = location;
        this.routingService = routingService;
        this.title = '';
        this.dialog = true;
        this.back = true;
        this.close = true;
        this.closeBackBehaviour = false;
        this.backed = new _angular_core__WEBPACK_IMPORTED_MODULE_2__.EventEmitter();
        this.closed = new _angular_core__WEBPACK_IMPORTED_MODULE_2__.EventEmitter();
        this.customCloseLogic = false;
    }
    ngOnInit() {
    }
    backClicked() {
        if (this.backed.observers.length > 0) {
            this.backed.emit({});
        }
        else {
            this.routingService.navigateCloseModal();
        }
    }
    closeClicked() {
        if (!this.customCloseLogic) {
            this.routingService.navigateCloseAllModal();
        }
        this.closed.emit();
    }
}
SubBarComponent.ɵfac = function SubBarComponent_Factory(t) { return new (t || SubBarComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdirectiveInject"](_angular_common__WEBPACK_IMPORTED_MODULE_3__.Location), _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_0__.RoutingService)); };
SubBarComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵdefineComponent"]({ type: SubBarComponent, selectors: [["app-sub-bar"]], inputs: { title: "title", dialog: "dialog", back: "back", close: "close", closeBackBehaviour: "closeBackBehaviour", customCloseLogic: "customCloseLogic" }, outputs: { backed: "backed", closed: "closed" }, ngContentSelectors: _c1, decls: 10, vars: 3, consts: [[1, "mat-toolbar", "header", "mat-toolbar-single-row", "justify-center"], [1, "flex", "items-center", "justify-between", "w-full"], ["left", "", 1, "div-button", "flex", "items-center"], ["class", "back-btn mat-focus-indicator mat-icon-button mat-button-base", "data-testid", "item-detail-back-button", 3, "click", 4, "ngIf"], ["center", ""], ["class", "sb-title font-bold", 4, "ngIf"], ["right", "", 1, "div-button", "flex", "items-center"], ["class", "close-btn mat-focus-indicator mat-icon-button mat-button-base", 3, "click", 4, "ngIf"], ["data-testid", "item-detail-back-button", 1, "back-btn", "mat-focus-indicator", "mat-icon-button", "mat-button-base", 3, "click"], ["name", "arrow_back_ios", "source", "mat", 3, "size"], [1, "sb-title", "font-bold"], [1, "close-btn", "mat-focus-indicator", "mat-icon-button", "mat-button-base", 3, "click"], ["name", "close", "source", "mat", 3, "size"]], template: function SubBarComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵprojectionDef"](_c0);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](0, "div", 0)(1, "div", 1)(2, "div", 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtemplate"](3, SubBarComponent_button_3_Template, 2, 1, "button", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵprojection"](4);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](5, "div", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtemplate"](6, SubBarComponent_span_6_Template, 2, 1, "span", 5);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementStart"](7, "div", 6);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵprojection"](8, 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵtemplate"](9, SubBarComponent_button_9_Template, 2, 1, "button", 7);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵelementEnd"]()()();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("ngIf", ctx.back);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("ngIf", ctx.title);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵadvance"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_2__["ɵɵproperty"]("ngIf", ctx.close);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_3__.NgIf, _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_1__.IconComponent], styles: ["[_nghost-%COMP%] {\n  width: 100%;\n  display: block;\n}\n\n.mat-toolbar-single-row[_ngcontent-%COMP%] {\n  display: flex;\n  box-sizing: border-box;\n  padding: 0 16px;\n  width: 100%;\n  flex-direction: row;\n  align-items: center;\n  white-space: nowrap;\n}\n\ndiv.div-button[_ngcontent-%COMP%] {\n  width: 40px;\n  height: 40px;\n  justify-content: center;\n}\n\ndiv.div-button[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%] {\n  padding: 0;\n  min-width: 0;\n  flex-shrink: 0;\n  line-height: 40px;\n  border-radius: 50%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\ndiv.div-button[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n  display: flex;\n}\n\n.spacer[_ngcontent-%COMP%] {\n  flex: 1 1 auto;\n}\n\n.header[_ngcontent-%COMP%] {\n  color: var(--P);\n  background: #fff;\n}\n\n.back-btn[_ngcontent-%COMP%] {\n  color: var(--P800);\n}\n\n.sb-title[_ngcontent-%COMP%] {\n  font-size: 1.1rem;\n  font-weight: lighter;\n  color: var(--P800);\n  white-space: pre-line;\n  line-height: 1em;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n\n.close-btn[_ngcontent-%COMP%] {\n  color: var(--P800);\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN1Yi1iYXIuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFSSxXQUFBO0VBQ0EsY0FBQTtBQUFKOztBQUdBO0VBQ0ksYUFBQTtFQUNBLHNCQUFBO0VBQ0EsZUFBQTtFQUNBLFdBQUE7RUFDQSxtQkFBQTtFQUNBLG1CQUFBO0VBQ0EsbUJBQUE7QUFBSjs7QUFTQTtFQUNJLFdBQUE7RUFDQSxZQUFBO0VBQ0EsdUJBQUE7QUFOSjs7QUFRSTtFQUNJLFVBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUNBLGlCQUFBO0VBQ0Esa0JBQUE7RUFDQSxhQUFBO0VBQ0EsdUJBQUE7RUFDQSxtQkFBQTtBQU5SOztBQVNJO0VBQ0ksYUFBQTtBQVBSOztBQVlBO0VBQ0ksY0FBQTtBQVRKOztBQVlBO0VBR0ksZUFBQTtFQUNBLGdCQUFBO0FBWEo7O0FBY0E7RUFRSSxrQkFBQTtBQWxCSjs7QUFxQkE7RUFDSSxpQkFBQTtFQUNBLG9CQUFBO0VBQ0Esa0JBQUE7RUFDQSxxQkFBQTtFQUNBLGdCQUFBO0VBQ0EsYUFBQTtFQUNBLHNCQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtBQWxCSjs7QUFzQkE7RUFDSSxrQkFBQTtBQW5CSiIsImZpbGUiOiJzdWItYmFyLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xuICAgIC8vaGVpZ2h0OiA2NHB4O1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGRpc3BsYXk6IGJsb2NrO1xufVxuXG4ubWF0LXRvb2xiYXItc2luZ2xlLXJvdyB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgIHBhZGRpbmc6IDAgMTZweDtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICAvL2JveC1zaGFkb3c6IGluc2V0IDAgLTFweCB2YXIoLS1QMzAwKTtcbn1cblxuXG5cblxuLy9iYWNrIGJ1dHRvbiAmIGNsb3NlIGJ1dHRvbiBhbGlnbm1lbnRcblxuZGl2LmRpdi1idXR0b24ge1xuICAgIHdpZHRoOiA0MHB4O1xuICAgIGhlaWdodDogNDBweDtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblxuICAgIC5tYXQtaWNvbi1idXR0b24ge1xuICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICBtaW4td2lkdGg6IDA7XG4gICAgICAgIGZsZXgtc2hyaW5rOiAwO1xuICAgICAgICBsaW5lLWhlaWdodDogNDBweDtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB9XG5cbiAgICBhcHAtaWNvbiB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgfVxufVxuXG5cbi5zcGFjZXIge1xuICAgIGZsZXg6IDEgMSBhdXRvO1xufVxuXG4uaGVhZGVyIHtcbiAgICAvL2JhY2tncm91bmQ6IHZhcigtLVApO1xuICAgIC8vY29sb3I6IHZhcigtLVBDKTtcbiAgICBjb2xvcjogdmFyKC0tUCk7XG4gICAgYmFja2dyb3VuZDogI2ZmZjtcbn1cblxuLmJhY2stYnRuIHtcbiAgICAvLyB3aWR0aDogYXV0bztcbiAgICAvLyBoZWlnaHQ6IGF1dG87XG4gICAgLy8gZGlzcGxheTogZmxleDtcbiAgICAvLyBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIC8vIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIC8vIGxpbmUtaGVpZ2h0OiBub3JtYWw7XG4gICAgLy8gbWFyZ2luLWxlZnQ6IDAuNXJlbTtcbiAgICBjb2xvcjogdmFyKC0tUDgwMCk7XG59XG5cbi5zYi10aXRsZSB7XG4gICAgZm9udC1zaXplOiAxLjFyZW07XG4gICAgZm9udC13ZWlnaHQ6IGxpZ2h0ZXI7XG4gICAgY29sb3I6IHZhcigtLVA4MDApO1xuICAgIHdoaXRlLXNwYWNlOiBwcmUtbGluZTtcbiAgICBsaW5lLWhlaWdodDogMWVtO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXG59XG5cbi5jbG9zZS1idG4ge1xuICAgIGNvbG9yOiB2YXIoLS1QODAwKTtcbn1cblxuQG1lZGlhIG5vdCBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDc2OHB4KSB7XG59XG4iXX0= */"] });


/***/ }),

/***/ 68163:
/*!**********************************************************************!*\
  !*** ./projects/ux/src/app/ux/components/swiper/swiper.component.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SwiperComponent": () => (/* binding */ SwiperComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/common */ 36362);



function SwiperComponent_ng_container_1_ng_template_2_Template(rf, ctx) { }
const _c0 = function (a0) { return { "margin-right": a0 }; };
const _c1 = function (a0) { return { content: a0 }; };
function SwiperComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementContainerStart"](0);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](1, "div", 2);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtemplate"](2, SwiperComponent_ng_container_1_ng_template_2_Template, 0, 0, "ng-template", 3);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementContainerEnd"]();
} if (rf & 2) {
    const content_r1 = ctx.$implicit;
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵpureFunction1"](3, _c0, ctx_r0.gap + "px"));
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngTemplateOutlet", ctx_r0.templateVariable)("ngTemplateOutletContext", _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵpureFunction1"](5, _c1, content_r1));
} }
// import Swiper core and required modules
/*
import SwiperCore, {
    Autoplay, Navigation,
    Pagination
} from 'swiper/core';
*/
// install Swiper modules
//SwiperCore.use([Navigation, Pagination, Autoplay]);
class SwiperComponent {
    constructor(ref) {
        this.ref = ref;
        //@Input('gap') gap: any = 10;
        this.contents = [];
        this.config = {};
        this.autoplay = false;
        this.loop = true;
        this.gap = 10;
        /*
        config: any = {
            slidesPerView: 'auto',
            spaceBetween: 20,
            breakpoints: {
                // when window width is >= 320px
                320: {
                    slidesPerView: 2.5,
                    spaceBetween: 10
                },
                640: {
                    slidesPerView: 3,
                    spaceBetween: 20
                },
                960: {
                    slidesPerView: 3.5,
                    spaceBetween: 20
                },
                1440: {
                    slidesPerView: 4,
                    spaceBetween: 20
                }
            }
        };
        */
        //@ViewChild('leftNav', {read: ElementRef, static:false}) leftNav: ElementRef;
        //@ViewChild('rightNav', {read: ElementRef, static:false}) rightNav: ElementRef;
        this.showLeft = false;
        this.showRight = true;
    }
    ngOnInit() {
        var _a;
        console.log("config", this.config);
        this.gap = ((_a = this.config) === null || _a === void 0 ? void 0 : _a.spaceBetween) || 10;
    }
    onSlideChange(event) {
        this.showLeft = !event.isBeginning;
        this.showRight = !event.isEnd;
        //console.log("EVENT", event);
        this.ref.detectChanges();
    }
}
SwiperComponent.ɵfac = function SwiperComponent_Factory(t) { return new (t || SwiperComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef)); };
SwiperComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineComponent"]({ type: SwiperComponent, selectors: [["app-swiper"]], contentQueries: function SwiperComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵcontentQuery"](dirIndex, _angular_core__WEBPACK_IMPORTED_MODULE_0__.TemplateRef, 5);
    } if (rf & 2) {
        let _t;
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵqueryRefresh"](_t = _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵloadQuery"]()) && (ctx.templateVariable = _t.first);
    } }, inputs: { contents: "contents", config: "config", autoplay: "autoplay", loop: "loop" }, decls: 2, vars: 1, consts: [[1, "list"], [4, "ngFor", "ngForOf"], [1, "item", 3, "ngStyle"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function SwiperComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](0, "div", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtemplate"](1, SwiperComponent_ng_container_1_Template, 3, 7, "ng-container", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngForOf", ctx.contents);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_1__.NgForOf, _angular_common__WEBPACK_IMPORTED_MODULE_1__.NgTemplateOutlet, _angular_common__WEBPACK_IMPORTED_MODULE_1__.NgStyle], styles: ["[_nghost-%COMP%] {\n  display: block;\n}\n\n.list[_ngcontent-%COMP%] {\n  display: flex;\n  align-content: center;\n  overflow-y: auto;\n}\n\n\n\n.action[_ngcontent-%COMP%] {\n  display: flex;\n}\n\n.spacer[_ngcontent-%COMP%] {\n  flex-grow: 1;\n}\n\n.btn[_ngcontent-%COMP%] {\n  outline: none;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN3aXBlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVJLGNBQUE7QUFBSjs7QUFHQTtFQUVJLGFBQUE7RUFDQSxxQkFBQTtFQUNBLGdCQUFBO0FBREo7O0FBS0E7Ozs7Q0FBQTs7QUFNQTtFQUNJLGFBQUE7QUFISjs7QUFNQTtFQUNJLFlBQUE7QUFISjs7QUFXQTtFQUNJLGFBQUE7QUFSSjs7QUFVQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztDQUFBIiwiZmlsZSI6InN3aXBlci5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcblxuICAgIGRpc3BsYXk6IGJsb2NrO1xufVxuXG4ubGlzdHtcblxuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24tY29udGVudDogY2VudGVyO1xuICAgIG92ZXJmbG93LXk6IGF1dG87XG5cbn1cblxuLypcbi5saXN0Ojotd2Via2l0LXNjcm9sbGJhciB7XG4gICAgZGlzcGxheTogbm9uZTtcbn1cbiovXG5cbi5hY3Rpb257XG4gICAgZGlzcGxheTogZmxleDtcbn1cblxuLnNwYWNlcntcbiAgICBmbGV4LWdyb3c6IDE7XG59XG5cbi5pdGVte1xuXG4gICAgLy9mbGV4LWdyb3c6IDE7XG59XG5cbi5idG57XG4gICAgb3V0bGluZTogbm9uZTtcbn1cbi8qXG46aG9zdCB7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xufVxuXG4udGVzdCB7XG4gICAgY29sb3I6IHJlZDtcbn1cblxuLnN3aXBlci1sZWZ0LFxuLnN3aXBlci1yaWdodCB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHRvcDogNTAlO1xuICAgIC8vYmFja2dyb3VuZDogdmFyKC0tUEMpO1xuICAgIGNvbG9yOiB2YXIoLS1QKTtcbiAgICB6LWluZGV4OiAxMDtcbiAgICBib3JkZXItcmFkaXVzOiAwLjJyZW07XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIGhlaWdodDogMnJlbSAhaW1wb3J0YW50O1xuICAgIHdpZHRoOiAycmVtO1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDBweCwgLTUwJSk7XG4gICAgLy9ib3gtc2hhZG93OiAwIDAgNXB4IDBweCAjMDAwMDAwMWE7XG59XG5cbi5zd2lwZXItbGVmdCB7XG4gICAgbGVmdDogLTQlO1xufVxuXG4uc3dpcGVyLXJpZ2h0IHtcbiAgICByaWdodDogLTQlICFpbXBvcnRhbnQ7XG59XG4qL1xuIl19 */"] });


/***/ }),

/***/ 39746:
/*!********************************************************************************!*\
  !*** ./projects/ux/src/app/ux/components/user-button/user-button.component.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UserButtonComponent": () => (/* binding */ UserButtonComponent)
/* harmony export */ });
/* harmony import */ var _aigens_core_src_app_pure_base_page_params__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aigens/core/src/app/pure/base/page-params */ 8744);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/routing.service */ 28759);
/* harmony import */ var _aigens_core_src_app_pure_services_lazy_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/lazy.service */ 60040);
/* harmony import */ var _aigens_core_src_app_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @aigens/core/src/app/pure/managers/setting-manager */ 74663);
/* harmony import */ var _aigens_core_src_app_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/subscribe.service */ 47074);
/* harmony import */ var _aigens_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/platform.service */ 45485);
/* harmony import */ var _aigens_core_src_app_pure_services_navigation_menu_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @aigens/core/src/app/pure/services/navigation-menu.service */ 69574);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../../../ui/src/app/ui/components/icon/icon.component */ 28492);













function UserButtonComponent_button_0_Template(rf, ctx) { if (rf & 1) {
    const _r4 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](0, "button", 3);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵlistener"]("click", function UserButtonComponent_button_0_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵrestoreView"](_r4); const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵresetView"](ctx_r3.loginClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](1, "h4");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipe"](3, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]()();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipeBind1"](3, 1, "ux.nav-bar.login-register"));
} }
function UserButtonComponent_button_1_Template(rf, ctx) { if (rf & 1) {
    const _r6 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](0, "button", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵlistener"]("click", function UserButtonComponent_button_1_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵrestoreView"](_r6); const ctx_r5 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵresetView"](ctx_r5.loginClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelement"](1, "app-icon", 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("size", 20);
} }
function UserButtonComponent_ng_container_2_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r11 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](0, "div", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵlistener"]("click", function UserButtonComponent_ng_container_2_div_1_Template_div_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵrestoreView"](_r11); const ctx_r10 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](2); return _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵresetView"](ctx_r10.dismissClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]();
} }
function UserButtonComponent_ng_container_2_button_2_Template(rf, ctx) { if (rf & 1) {
    const _r13 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](0, "button", 10);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵlistener"]("click", function UserButtonComponent_ng_container_2_button_2_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵrestoreView"](_r13); const ctx_r12 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](2); return _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵresetView"](ctx_r12.selectClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](1, "h4");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]()();
} if (rf & 2) {
    const ctx_r8 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtextInterpolate"](ctx_r8.getFristString(ctx_r8.context.member == null ? null : ctx_r8.context.member.name));
} }
function UserButtonComponent_ng_container_2_div_3_div_8_button_1_Template(rf, ctx) { if (rf & 1) {
    const _r18 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](0, "button", 17);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵlistener"]("click", function UserButtonComponent_ng_container_2_div_3_div_8_button_1_Template_button_click_0_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵrestoreView"](_r18); const ctx_r17 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](4); return _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵresetView"](ctx_r17.accountClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipe"](2, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipeBind1"](2, 1, "ux.nav-bar.home"), " ");
} }
function UserButtonComponent_ng_container_2_div_3_div_8_Template(rf, ctx) { if (rf & 1) {
    const _r20 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](0, "div");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtemplate"](1, UserButtonComponent_ng_container_2_div_3_div_8_button_1_Template, 3, 3, "button", 15);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](2, "button", 16);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵlistener"]("click", function UserButtonComponent_ng_container_2_div_3_div_8_Template_button_click_2_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵrestoreView"](_r20); const ctx_r19 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](3); return _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵresetView"](ctx_r19.logoutClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipe"](4, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]()();
} if (rf & 2) {
    const ctx_r14 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("ngIf", ctx_r14.showCrmHome);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipeBind1"](4, 2, "ux.nav-bar.logout"), " ");
} }
function UserButtonComponent_ng_container_2_div_3_div_9_Template(rf, ctx) { if (rf & 1) {
    const _r22 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](0, "div")(1, "button", 17);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵlistener"]("click", function UserButtonComponent_ng_container_2_div_3_div_9_Template_button_click_1_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵrestoreView"](_r22); const ctx_r21 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](3); return _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵresetView"](ctx_r21.goProfile()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipe"](3, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](4, "button", 16);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵlistener"]("click", function UserButtonComponent_ng_container_2_div_3_div_9_Template_button_click_4_listener() { _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵrestoreView"](_r22); const ctx_r23 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](3); return _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵresetView"](ctx_r23.logoutClicked()); });
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtext"](5);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipe"](6, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]()();
} if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipeBind1"](3, 2, "miniapp.component.welcome-info.login-dropdown"), " ");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtextInterpolate1"](" ", _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipeBind1"](6, 4, "miniapp.component.welcome-info.logout"), " ");
} }
function UserButtonComponent_ng_container_2_div_3_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](0, "div", 11)(1, "div", 12)(2, "div", 13)(3, "h4");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipe"](5, "translate");
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementStart"](6, "h2", 14);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtext"](7);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtemplate"](8, UserButtonComponent_ng_container_2_div_3_div_8_Template, 5, 4, "div", 2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtemplate"](9, UserButtonComponent_ng_container_2_div_3_div_9_Template, 7, 6, "div", 2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementEnd"]()();
} if (rf & 2) {
    const ctx_r9 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵpipeBind1"](5, 4, "ux.nav-bar.member-name"));
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtextInterpolate"](ctx_r9.context.member == null ? null : ctx_r9.context.member.name);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("ngIf", !ctx_r9.isBKH5);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("ngIf", ctx_r9.isBKH5);
} }
function UserButtonComponent_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementContainerStart"](0);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtemplate"](1, UserButtonComponent_ng_container_2_div_1_Template, 1, 0, "div", 6);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtemplate"](2, UserButtonComponent_ng_container_2_button_2_Template, 3, 1, "button", 7);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtemplate"](3, UserButtonComponent_ng_container_2_div_3_Template, 10, 6, "div", 8);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵelementContainerEnd"]();
} if (rf & 2) {
    const ctx_r2 = _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("ngIf", ctx_r2.showDropdown);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("ngIf", ctx_r2.isLoggedIn());
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("ngIf", ctx_r2.showDropdown && ctx_r2.isLoggedIn());
} }
//import { CartService } from '@aigens/byod/src/app/byod/services/cart.service';
class UserButtonComponent {
    constructor(injector, t, router, routingService, lazyService, settingManager, ss, route, 
    //private cartService: CartService
    platformService, navigationMenuService) {
        this.injector = injector;
        this.t = t;
        this.router = router;
        this.routingService = routingService;
        this.lazyService = lazyService;
        this.settingManager = settingManager;
        this.ss = ss;
        this.route = route;
        this.platformService = platformService;
        this.navigationMenuService = navigationMenuService;
        this.showDropdown = false;
        this.isBKH5 = false;
        this.showCrmHome = true;
        this.context = ss;
        this.navParams = new _aigens_core_src_app_pure_base_page_params__WEBPACK_IMPORTED_MODULE_0__.PageParams();
        this.navParams.route = this.route;
        this.navParams.querys = this.route.snapshot.queryParams;
        this.navParams.params = this.route.snapshot.params;
        this.navParams.input = this.routingService.getAuxInput();
        /*
        if(!this.context.member){
            this.context.member = this.getLocal("member");
        }
        */
    }
    ngOnInit() {
        //bksg h5 flow need to judge;
        if (!this.platformService.isAliApp() && this.context.brandId == 800001) {
            this.isBKH5 = true;
        }
        this.showCrmHome = !this.settingManager.get('hideNavCrmHome', false);
    }
    isLoggedIn() {
        var member = this.context.member;
        if (member && !member.guest) {
            return true;
        }
        return false;
    }
    loginClicked() {
        this.goLogin();
    }
    logoutClicked() {
        if ((this.settingManager.get('mandatoryLogin', false) === true) && window.location.href.includes("/order/")) {
            let title = this.t.instant('ux.nav-bar.logout');
            let message = this.t.instant('ux.nav-bar.logout-message');
            var dialogService = this.lazyService.getService("DialogService");
            dialogService.showConfirm(title, message).subscribe((data) => {
                if ("confirm" == data) {
                    this.processLogout();
                }
                else {
                    return;
                }
            });
        }
        else {
            this.processLogout();
        }
    }
    processLogout() {
        this.ss.next('member', null);
        this.ss.next('membership', null);
        this.ss.next('sessionId', null);
        this.ss.logout();
        localStorage.setItem('member', null);
        localStorage.setItem('session', null);
        this.routingService.goHome(window.location.href);
    }
    goLogin() {
        var _a;
        console.log('go login', this);
        let path = '';
        if ((_a = this.context) === null || _a === void 0 ? void 0 : _a.group) {
            path = `auth/login/group/${this.context.groupId}`;
        }
        else {
            path = `auth/login/brand/${this.context.brandId}`;
        }
        this.routingService.navigateModal(path);
    }
    accountClicked() {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s;
        //handle the redirect of member profile button
        var module = "standard";
        var miniConfig = (_a = window['aigens']) === null || _a === void 0 ? void 0 : _a.miniapp;
        if ((miniConfig === null || miniConfig === void 0 ? void 0 : miniConfig.module) === "miniapp") {
            module = miniConfig.module;
            if (this.context.groupId && this.context.brandId) {
                var path = `miniapp/crm/brand/${this.context.brandId}/membership`;
                this.router.navigate([path], { queryParamsHandling: 'merge' });
            }
        }
        else {
            const params = {};
            const routeStoreId = (_d = (_c = (_b = this.route) === null || _b === void 0 ? void 0 : _b.snapshot) === null || _c === void 0 ? void 0 : _c.paramMap) === null || _d === void 0 ? void 0 : _d.get('storeId');
            const tempConfirmedStore = this.navParams.get('confirmedStore') == null || this.navParams.get('confirmedStore') === 'true';
            const tempConfirmedMode = this.navParams.get('confirmedMode') == null || this.navParams.get('confirmedMode') === 'true';
            //Peter: commented out this due to deps violation
            /*
            if ((this.context?.storeId || routeStoreId) && this.orderContext.confirmedStore) {
                params['storeId'] = routeStoreId ?? this.context?.storeId;
            }
            const mode = this.route?.snapshot?.paramMap?.get('mode') ?? null;
            if (mode && this.orderContext.confirmedMode) {
                params['mode'] = mode;
            }*/
            //Peter: changed to this, might not work.
            if ((((_e = this.context) === null || _e === void 0 ? void 0 : _e.storeId) || routeStoreId) && tempConfirmedStore) {
                params['storeId'] = routeStoreId !== null && routeStoreId !== void 0 ? routeStoreId : (_f = this.context) === null || _f === void 0 ? void 0 : _f.storeId;
            }
            const mode = (_k = (_j = (_h = (_g = this.route) === null || _g === void 0 ? void 0 : _g.snapshot) === null || _h === void 0 ? void 0 : _h.paramMap) === null || _j === void 0 ? void 0 : _j.get('mode')) !== null && _k !== void 0 ? _k : null;
            if (mode && tempConfirmedMode) {
                params['mode'] = mode;
            }
            params['back'] = null;
            const brandId = (_l = this.context.brandId) !== null && _l !== void 0 ? _l : (_o = (_m = this.context) === null || _m === void 0 ? void 0 : _m.crm) === null || _o === void 0 ? void 0 : _o.brandId;
            if (this.navigationMenuService.getNavParams(window.location.href, 'brand')) { // check if the user go into the crm from brand home
                const path = `/crm/brand/${this.context.brandId}/home`;
                params['brandId'] = this.navigationMenuService.getNavParams(window.location.href, 'brand');
                this.router.navigate([path], { queryParams: params, queryParamsHandling: 'merge' });
            }
            else if (this.context.groupId && !brandId) {
                const path = `/crm/group/${this.context.groupId}/home`;
                this.router.navigate([path], { queryParams: params, queryParamsHandling: 'merge' });
            }
            else if (this.context.groupId && brandId && !((_p = this.context) === null || _p === void 0 ? void 0 : _p.storeId)) {
                const path = `/crm/brand/${brandId}/home`;
                params['brandId'] = brandId;
                if (this.context.courtId) {
                    params['courtId'] = (_q = this.context) === null || _q === void 0 ? void 0 : _q.courtId;
                }
                this.router.navigate([path], { queryParams: params, queryParamsHandling: 'merge' });
            }
            else if (this.context.groupId && brandId && ((_r = this.context) === null || _r === void 0 ? void 0 : _r.storeId)) {
                const path = `/crm/brand/${brandId}/home`;
                if (this.context.courtId) {
                    params['courtId'] = (_s = this.context) === null || _s === void 0 ? void 0 : _s.courtId;
                }
                this.router.navigate([path], { queryParams: params, queryParamsHandling: 'merge' });
            }
        }
        this.dismissClicked();
    }
    selectClicked() {
        this.showDropdown = !this.showDropdown;
    }
    dismissClicked() {
        this.showDropdown = false;
    }
    getFristString(str) {
        return str === null || str === void 0 ? void 0 : str.slice(0, 1);
    }
    goProfile() {
        this.showDropdown = false;
        let brandId = this.context.brandId;
        let path = `/miniapp/account-info/brand/${brandId}`;
        this.routingService.navigate(path, { queryParams: {} });
    }
}
UserButtonComponent.ɵfac = function UserButtonComponent_Factory(t) { return new (t || UserButtonComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_8__.Injector), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_ngx_translate_core__WEBPACK_IMPORTED_MODULE_9__.TranslateService), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_angular_router__WEBPACK_IMPORTED_MODULE_10__.Router), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_routing_service__WEBPACK_IMPORTED_MODULE_1__.RoutingService), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_lazy_service__WEBPACK_IMPORTED_MODULE_2__.LazyService), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_managers_setting_manager__WEBPACK_IMPORTED_MODULE_3__.SettingManager), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_subscribe_service__WEBPACK_IMPORTED_MODULE_4__.SubscribeService), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_angular_router__WEBPACK_IMPORTED_MODULE_10__.ActivatedRoute), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_5__.PlatformService), _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdirectiveInject"](_aigens_core_src_app_pure_services_navigation_menu_service__WEBPACK_IMPORTED_MODULE_6__.NavigationMenuService)); };
UserButtonComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵdefineComponent"]({ type: UserButtonComponent, selectors: [["app-user-button"]], decls: 3, vars: 3, consts: [["class", "btn-login-register mobile:hidden tablet:hidden", "data-testid", "login-or-signUp-button", 3, "click", 4, "ngIf"], ["class", "btn-login-register desktop:hidden", "data-testid", "login-or-signUp-button", 3, "click", 4, "ngIf"], [4, "ngIf"], ["data-testid", "login-or-signUp-button", 1, "btn-login-register", "mobile:hidden", "tablet:hidden", 3, "click"], ["data-testid", "login-or-signUp-button", 1, "btn-login-register", "desktop:hidden", 3, "click"], ["name", "login", 1, "flex", "items-center", 3, "size"], ["class", "overlay z-40", 3, "click", 4, "ngIf"], ["class", "btn-after-login mat-focus-indicatior mat-button mat-button-base desktop:ml-0", "data-testid", "memberBtn", 3, "click", 4, "ngIf"], ["class", "234dsfds user-button desfj380df absolute right-0 top-7 z-50 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none ", "role", "menu", "aria-orientation", "vertical", "aria-labelledby", "menu-button", "tabindex", "-1", 4, "ngIf"], [1, "overlay", "z-40", 3, "click"], ["data-testid", "memberBtn", 1, "btn-after-login", "mat-focus-indicatior", "mat-button", "mat-button-base", "desktop:ml-0", 3, "click"], ["role", "menu", "aria-orientation", "vertical", "aria-labelledby", "menu-button", "tabindex", "-1", 1, "234dsfds", "user-button", "desfj380df", "absolute", "right-0", "top-7", "z-50", "mt-2", "w-56", "rounded-md", "shadow-lg", "bg-white", "ring-1", "ring-black", "ring-opacity-5", "focus:outline-none"], ["role", "none"], ["role", "menuitem", "tabindex", "-1", 1, "info-box"], [1, ""], ["class", "mp-btn block cursor-pointer", "role", "menuitem", "tabindex", "-1", 3, "click", 4, "ngIf"], ["role", "menuitem", "tabindex", "-1", 1, "logout-btn", "block", "cursor-pointer", 3, "click"], ["role", "menuitem", "tabindex", "-1", 1, "mp-btn", "block", "cursor-pointer", 3, "click"]], template: function UserButtonComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtemplate"](0, UserButtonComponent_button_0_Template, 4, 3, "button", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtemplate"](1, UserButtonComponent_button_1_Template, 2, 1, "button", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵtemplate"](2, UserButtonComponent_ng_container_2_Template, 4, 3, "ng-container", 2);
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("ngIf", !ctx.isLoggedIn());
        _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("ngIf", !ctx.isLoggedIn());
        _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_8__["ɵɵproperty"]("ngIf", ctx.context.member);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_11__.NgIf, _ui_src_app_ui_components_icon_icon_component__WEBPACK_IMPORTED_MODULE_7__.IconComponent, _ngx_translate_core__WEBPACK_IMPORTED_MODULE_9__.TranslatePipe], styles: ["[_nghost-%COMP%] {\n  display: flex;\n  align-items: center;\n  position: relative;\n}\n\n.overlay[_ngcontent-%COMP%] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0 !important;\n  z-index: 100;\n}\n\n.btn-login-register[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%] {\n  font-size: 0.8rem;\n  font-weight: lighter;\n  line-height: normal;\n  border: 1px solid var(--P200);\n  border-radius: 0.2rem;\n  padding: 0.4rem 0.6rem;\n}\n\n.btn-after-login[_ngcontent-%COMP%] {\n  min-width: unset;\n  padding-left: 0 !important;\n}\n\n.btn-after-login[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%] {\n  font-size: 0.8rem;\n  font-weight: bold;\n  line-height: normal;\n  background: white;\n  color: var(--P);\n  border-radius: 100rem;\n  width: 1.75rem;\n  height: 1.75rem;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.btn-after-login[_ngcontent-%COMP%]:hover {\n  filter: brightness(0.9);\n}\n\n.user-button[_ngcontent-%COMP%] {\n  padding: 1rem 1rem;\n}\n\n.user-button[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%] {\n  font-size: 0.8rem;\n  border-bottom: 1px solid #ececec;\n  color: #989898;\n}\n\n.user-button[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%] {\n  color: var(--P);\n  font-size: 0.8rem;\n  line-height: 1.1em;\n}\n\n.user-button[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\n  font-size: 1.2rem;\n  line-height: 1.1em;\n  color: #333;\n  font-weight: lighter;\n}\n\n.info-box[_ngcontent-%COMP%] {\n  text-align: left;\n}\n\n.info-box[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%] {\n  font-size: 0.7rem;\n}\n\n.info-box[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\n  font-size: 1rem;\n  margin-top: 0.2rem;\n  font-weight: bold;\n  white-space: pre-line;\n  word-break: break-word;\n}\n\n.mp-btn[_ngcontent-%COMP%] {\n  width: 100%;\n  background: var(--P);\n  margin-top: 1rem;\n  padding: 0.6rem;\n  font-size: 0.85rem;\n  border-radius: 3px;\n  line-height: 1.1em;\n  color: white;\n}\n\n.logout-btn[_ngcontent-%COMP%] {\n  width: 100%;\n  color: #b9b9b9;\n  text-decoration: underline;\n  font-size: 0.75rem;\n  line-height: 1em;\n  padding: 0.5rem 0.4rem 0rem 0.4rem;\n}\n\n@media not screen and (min-width: 768px) {\n  .btn-login-register[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%] {\n    padding: 5px 8px;\n    font-size: 0.8rem;\n    font-weight: normal;\n  }\n  .btn-after-login[_ngcontent-%COMP%] {\n    padding: 0;\n    justify-content: flex-end;\n    display: flex !important;\n  }\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXItYnV0dG9uLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0VBQ0Esa0JBQUE7QUFDSjs7QUFFQTtFQUNJLGVBQUE7RUFDQSxNQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxvQkFBQTtFQUNBLFlBQUE7QUFDSjs7QUFHSTtFQUNJLGlCQUFBO0VBQ0Esb0JBQUE7RUFDQSxtQkFBQTtFQUNBLDZCQUFBO0VBQ0EscUJBQUE7RUFDQSxzQkFBQTtBQUFSOztBQUlBO0VBQ0ksZ0JBQUE7RUFDQSwwQkFBQTtBQURKOztBQUVJO0VBQ0ksaUJBQUE7RUFDQSxpQkFBQTtFQUNBLG1CQUFBO0VBQ0EsaUJBQUE7RUFDQSxlQUFBO0VBQ0EscUJBQUE7RUFDQSxjQUFBO0VBQ0EsZUFBQTtFQUNBLGFBQUE7RUFDQSx1QkFBQTtFQUNBLG1CQUFBO0FBQVI7O0FBRUk7RUFDSSx1QkFBQTtBQUFSOztBQUlBO0VBQ0ksa0JBQUE7QUFESjs7QUFFSTtFQUNJLGlCQUFBO0VBQ0EsZ0NBQUE7RUFDQSxjQUFBO0FBQVI7O0FBRUk7RUFDSSxlQUFBO0VBQ0EsaUJBQUE7RUFDQSxrQkFBQTtBQUFSOztBQUVJO0VBQ0ksaUJBQUE7RUFDQSxrQkFBQTtFQUNBLFdBQUE7RUFDQSxvQkFBQTtBQUFSOztBQUlBO0VBQ0ksZ0JBQUE7QUFESjs7QUFFSTtFQUNJLGlCQUFBO0FBQVI7O0FBRUk7RUFDSSxlQUFBO0VBQ0Esa0JBQUE7RUFDQSxpQkFBQTtFQUNBLHFCQUFBO0VBQ0Esc0JBQUE7QUFBUjs7QUFJQTtFQUNJLFdBQUE7RUFDQSxvQkFBQTtFQUNBLGdCQUFBO0VBQ0EsZUFBQTtFQUNBLGtCQUFBO0VBQ0Esa0JBQUE7RUFDQSxrQkFBQTtFQUNBLFlBQUE7QUFESjs7QUFLQTtFQUNJLFdBQUE7RUFDQSxjQUFBO0VBQ0EsMEJBQUE7RUFDQSxrQkFBQTtFQUNBLGdCQUFBO0VBQ0Esa0NBQUE7QUFGSjs7QUFXQTtFQUtRO0lBQ0ksZ0JBQUE7SUFDQSxpQkFBQTtJQUNBLG1CQUFBO0VBWlY7RUFlRTtJQUNJLFVBQUE7SUFDQSx5QkFBQTtJQUNBLHdCQUFBO0VBYk47QUFDRiIsImZpbGUiOiJ1c2VyLWJ1dHRvbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xufVxuXG4ub3ZlcmxheXtcbiAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgdG9wOiAwO1xuICAgIGxlZnQ6IDA7XG4gICAgcmlnaHQ6IDA7XG4gICAgYm90dG9tOiAwICFpbXBvcnRhbnQ7XG4gICAgei1pbmRleDogMTAwO1xufVxuXG4uYnRuLWxvZ2luLXJlZ2lzdGVyIHtcbiAgICBoNCB7XG4gICAgICAgIGZvbnQtc2l6ZTogMC44cmVtO1xuICAgICAgICBmb250LXdlaWdodDogbGlnaHRlcjtcbiAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tUDIwMCk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDAuMnJlbTtcbiAgICAgICAgcGFkZGluZzogMC40cmVtIDAuNnJlbTtcbiAgICB9XG59XG5cbi5idG4tYWZ0ZXItbG9naW57XG4gICAgbWluLXdpZHRoOiB1bnNldDtcbiAgICBwYWRkaW5nLWxlZnQ6IDAgIWltcG9ydGFudDtcbiAgICBoNHtcbiAgICAgICAgZm9udC1zaXplOiAwLjhyZW07XG4gICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgICAgICBsaW5lLWhlaWdodDogbm9ybWFsO1xuICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTtcbiAgICAgICAgY29sb3I6IHZhcigtLVApO1xuICAgICAgICBib3JkZXItcmFkaXVzOiAxMDByZW07XG4gICAgICAgIHdpZHRoOiAxLjc1cmVtO1xuICAgICAgICBoZWlnaHQ6IDEuNzVyZW07XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIH1cbiAgICAmOmhvdmVyIHtcbiAgICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDAuOSk7XG4gICAgfVxufVxuXG4udXNlci1idXR0b257XG4gICAgcGFkZGluZzogMXJlbSAxcmVtO1xuICAgIGg1e1xuICAgICAgICBmb250LXNpemU6IDAuOHJlbTtcbiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlY2VjZWM7XG4gICAgICAgIGNvbG9yOiAjOTg5ODk4O1xuICAgIH1cbiAgICBoNHtcbiAgICAgICAgY29sb3I6IHZhcigtLVApO1xuICAgICAgICBmb250LXNpemU6IDAuOHJlbTtcbiAgICAgICAgbGluZS1oZWlnaHQ6IDEuMWVtO1xuICAgIH1cbiAgICBoMntcbiAgICAgICAgZm9udC1zaXplOiAxLjJyZW07XG4gICAgICAgIGxpbmUtaGVpZ2h0OiAxLjFlbTtcbiAgICAgICAgY29sb3I6ICMzMzM7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiBsaWdodGVyO1xuICAgIH1cbn1cblxuLmluZm8tYm94e1xuICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gICAgaDR7XG4gICAgICAgIGZvbnQtc2l6ZTogMC43cmVtO1xuICAgIH1cbiAgICBoMntcbiAgICAgICAgZm9udC1zaXplOiAxcmVtO1xuICAgICAgICBtYXJnaW4tdG9wOiAwLjJyZW07XG4gICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgICAgICB3aGl0ZS1zcGFjZTogcHJlLWxpbmU7XG4gICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7XG4gICAgfVxufVxuXG4ubXAtYnRue1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGJhY2tncm91bmQ6IHZhcigtLVApO1xuICAgIG1hcmdpbi10b3A6IDFyZW07XG4gICAgcGFkZGluZzogMC42cmVtO1xuICAgIGZvbnQtc2l6ZTogMC44NXJlbTtcbiAgICBib3JkZXItcmFkaXVzOiAzcHg7XG4gICAgbGluZS1oZWlnaHQ6IDEuMWVtO1xuICAgIGNvbG9yOiB3aGl0ZTtcblxufVxuXG4ubG9nb3V0LWJ0bntcbiAgICB3aWR0aDogMTAwJTtcbiAgICBjb2xvcjogI2I5YjliOTtcbiAgICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTtcbiAgICBmb250LXNpemU6IDAuNzVyZW07XG4gICAgbGluZS1oZWlnaHQ6IDFlbTtcbiAgICBwYWRkaW5nOiAwLjVyZW0gMC40cmVtIDByZW0gMC40cmVtO1xufVxuXG5AbWVkaWEgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA3NjhweCkge1xuICAgIC8vIDpob3N0IHtcbiAgICAvLyAgICAgbWFyZ2luLWxlZnQ6IDAgIWltcG9ydGFudDtcbiAgICAvLyB9XG59XG5cbkBtZWRpYSBub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA3NjhweCkge1xuICAgIC8vIDpob3N0IHtcbiAgICAvLyAgICAgbWFyZ2luLWxlZnQ6IDAuNXJlbSAhaW1wb3J0YW50O1xuICAgIC8vIH1cbiAgICAuYnRuLWxvZ2luLXJlZ2lzdGVye1xuICAgICAgICBoNHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDVweCA4cHg7XG4gICAgICAgICAgICBmb250LXNpemU6IDAuOHJlbTtcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLmJ0bi1hZnRlci1sb2dpbntcbiAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbiAgICAgICAgZGlzcGxheTogZmxleCAhaW1wb3J0YW50O1xuICAgIH1cbn1cbiJdfQ== */"] });


/***/ }),

/***/ 37073:
/*!***************************************************************************************!*\
  !*** ./projects/ux/src/app/ux/layouts/container-layout/container-layout.component.ts ***!
  \***************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ContainerLayoutComponent": () => (/* binding */ ContainerLayoutComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 3184);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/router */ 52816);
/* harmony import */ var _core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/src/app/pure/services/platform.service */ 45485);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/common */ 36362);





const _c0 = ["navContainer"];
const _c1 = ["colContainer"];
const _c2 = ["headerContainer"];
function ContainerLayoutComponent_ng_content_3_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](0, 1, ["*ngIf", "showNav"]);
} }
function ContainerLayoutComponent_ng_content_4_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](0, 2, ["*ngIf", "!loading && !empty"]);
} }
function ContainerLayoutComponent_ng_content_6_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](0, 3, ["*ngIf", "!loading && !empty && !over"]);
} }
function ContainerLayoutComponent_div_7_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 12);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](1, 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} }
function ContainerLayoutComponent_div_8_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 13);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](1, 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} }
function ContainerLayoutComponent_div_9_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 14, 15);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](2, 6);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} }
function ContainerLayoutComponent_div_10_div_9_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 23);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](1, 10);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} }
const _c3 = function (a0) { return { "top.px": a0 }; };
function ContainerLayoutComponent_div_10_Template(rf, ctx) { if (rf & 1) {
    const _r14 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 16, 17)(2, "div", 18);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](3, 7);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](4, "div", 19)(5, "div", 20);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵlistener"]("scroll", function ContainerLayoutComponent_div_10_Template_div_scroll_5_listener($event) { _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrestoreView"](_r14); const ctx_r13 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"](); return _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵresetView"](ctx_r13.onScroll($event)); });
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](6, 8);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](7, "div", 21);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](8, 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](9, ContainerLayoutComponent_div_10_div_9_Template, 2, 0, "div", 22);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r7 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpureFunction1"](3, _c3, ctx_r7.stickyTop || ctx_r7.navHeight));
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](5);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpureFunction1"](5, _c3, ctx_r7.stickyTop || ctx_r7.navHeight));
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx_r7.loading && !ctx_r7.empty && ctx_r7.over);
} }
function ContainerLayoutComponent_div_13_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 24);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](1, 11);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} }
function ContainerLayoutComponent_div_14_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 25);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](1, 12);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
} }
const _c4 = [[["", "action", ""]], [["", "nav", ""]], [["", "notice", ""]], [["", "nav2", ""]], [["", "empty", ""]], [["", "loading", ""]], [["", "header", ""]], [["", "left", ""]], [["", "center", ""]], [["", "right", ""]], [["", "over", ""]], [["", "footer", ""]], [["", "status", ""]]];
const _c5 = ["[action]", "[nav]", "[notice]", "[nav2]", "[empty]", "[loading]", "[header]", "[left]", "[center]", "[right]", "[over]", "[footer]", "[status]"];
class ContainerLayoutComponent {
    // DO NOT CHANGE THIS CLASS: DISCUSS WITH PETER
    // DO NOT CHANGE THIS CLASS: DISCUSS WITH PETER
    constructor(route, platformService) {
        this.route = route;
        this.platformService = platformService;
        this.loading = false;
        this.empty = false;
        this.over = false;
        this.showNav = true;
        this.layout = "default";
        this.subLayout = "default";
        this.navHeight = 64;
        this.headerHeight = 0;
        this.scrollOnCenter = new _angular_core__WEBPACK_IMPORTED_MODULE_1__.EventEmitter();
        this.count = 0;
        this.checkConfig();
    }
    //this set the parent tag with class=layout-default
    get layoutClass() {
        return "ml-" + this.layout + " sl-" + this.subLayout;
    }
    ngOnInit() {
    }
    ngAfterViewInit() {
        /*
        setTimeout(()=>{
            this.calNavHeight();
        }, 1000);
        */
        this.timer = setInterval(() => {
            this.calNavHeight();
        }, 1000);
    }
    getOffset(container, field) {
        if (!container)
            return null;
        var el = container.nativeElement;
        if (el) {
            var offsets = el.getBoundingClientRect();
            var height = offsets[field];
            return height;
        }
        return null;
    }
    calNavHeight() {
        if (this.count >= 10) {
            if (this.timer)
                clearInterval(this.timer);
            return;
        }
        var navHeight = this.getOffset(this.navContainer, "height");
        if (navHeight > 10 && this.navHeight != navHeight) {
            this.navHeight = navHeight;
            console.log("auto navHeight", this.navHeight);
        }
        var headerHeight = this.getOffset(this.headerContainer, "height");
        if (headerHeight > 10 && this.headerHeight != headerHeight) {
            this.headerHeight = headerHeight;
            console.log("auto headerHeight", this.headerHeight);
        }
        /*
        var el = this.navContainer.nativeElement;

        if(el){
            var offsets = el.getBoundingClientRect();
            // these are relative to the viewport, i.e. the window
            //var top = offsets.top;
            //var left = offsets.left;
            var height = offsets.height;

            if(height > 10 && this.navHeight != height){
                this.navHeight = height;
                console.log("auto navHeight", this.navHeight);
            }
        }



        var el2 = this.colContainer.nativeElement;

        if(el2){
            var offsets2 = el2.getBoundingClientRect();
            // these are relative to the viewport, i.e. the window
            //var top = offsets.top;
            //var left = offsets.left;
            //console.log("offsets2", offsets2);

            var top2 = offsets2.top;
            if(top2 > 10 && this.colTop != top2){
                this.colTop = top2;
                console.log("auto colTop", this.colTop);
            }
        }
        */
        this.count++;
        //console.log("calNav", this.count);
        //console.log("nav bar offsets", offsets);
    }
    onScroll($event) {
        this.scrollOnCenter.emit($event);
    }
    checkConfig() {
        var data = this.route.snapshot.data;
        if (data.navbar === false) {
            console.log("route config hide nav", this.route.snapshot.data);
            this.showNav = false;
        }
    }
}
ContainerLayoutComponent.ɵfac = function ContainerLayoutComponent_Factory(t) { return new (t || ContainerLayoutComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_angular_router__WEBPACK_IMPORTED_MODULE_2__.ActivatedRoute), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_core_src_app_pure_services_platform_service__WEBPACK_IMPORTED_MODULE_0__.PlatformService)); };
ContainerLayoutComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineComponent"]({ type: ContainerLayoutComponent, selectors: [["app-container-layout"]], viewQuery: function ContainerLayoutComponent_Query(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵviewQuery"](_c0, 5);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵviewQuery"](_c1, 5);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵviewQuery"](_c2, 5);
    } if (rf & 2) {
        let _t;
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵqueryRefresh"](_t = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵloadQuery"]()) && (ctx.navContainer = _t.first);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵqueryRefresh"](_t = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵloadQuery"]()) && (ctx.colContainer = _t.first);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵqueryRefresh"](_t = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵloadQuery"]()) && (ctx.headerContainer = _t.first);
    } }, hostVars: 2, hostBindings: function ContainerLayoutComponent_HostBindings(rf, ctx) { if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵclassMap"](ctx.layoutClass);
    } }, inputs: { loading: "loading", empty: "empty", over: "over", showNav: "showNav", layout: "layout", subLayout: "subLayout", stickyTop: "stickyTop" }, outputs: { scrollOnCenter: "scrollOnCenter" }, ngContentSelectors: _c5, decls: 15, vars: 10, consts: [[1, "cont", 3, "ngClass"], [1, "nav"], ["navContainer", ""], [4, "ngIf"], [1, "nav2"], ["class", "empty", 4, "ngIf"], ["class", "loading", 4, "ngIf"], ["class", "header", 4, "ngIf"], ["class", "columns", 4, "ngIf"], [1, "action", "desktop:hidden"], ["class", "footer hidden desktop:block", 4, "ngIf"], ["class", "status hidden mobile:block", 4, "ngIf"], [1, "empty"], [1, "loading"], [1, "header"], ["headerContainer", ""], [1, "columns"], ["colContainer", ""], [1, "left", 3, "ngStyle"], [1, "middle"], [1, "center", 3, "scroll"], [1, "right", 3, "ngStyle"], ["class", "over", 4, "ngIf"], [1, "over"], [1, "footer", "hidden", "desktop:block"], [1, "status", "hidden", "mobile:block"]], template: function ContainerLayoutComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojectionDef"](_c4);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 0)(1, "div", 1, 2);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](3, ContainerLayoutComponent_ng_content_3_Template, 1, 0, "ng-content", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](4, ContainerLayoutComponent_ng_content_4_Template, 1, 0, "ng-content", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](5, "div", 4);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](6, ContainerLayoutComponent_ng_content_6_Template, 1, 0, "ng-content", 3);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](7, ContainerLayoutComponent_div_7_Template, 2, 0, "div", 5);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](8, ContainerLayoutComponent_div_8_Template, 2, 0, "div", 6);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](9, ContainerLayoutComponent_div_9_Template, 3, 0, "div", 7);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](10, ContainerLayoutComponent_div_10_Template, 10, 7, "div", 8);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](11, "div", 9);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵprojection"](12);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](13, ContainerLayoutComponent_div_13_Template, 2, 0, "div", 10);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](14, ContainerLayoutComponent_div_14_Template, 2, 0, "div", 11);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngClass", ctx.platformService.platformClasses);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", ctx.showNav);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx.loading && !ctx.empty);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx.loading && !ctx.empty && !ctx.over);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", ctx.empty);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", ctx.loading);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx.loading && !ctx.empty && !ctx.over);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx.loading && !ctx.empty);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx.loading && !ctx.empty);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵproperty"]("ngIf", !ctx.loading && !ctx.empty);
    } }, dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_3__.NgClass, _angular_common__WEBPACK_IMPORTED_MODULE_3__.NgIf, _angular_common__WEBPACK_IMPORTED_MODULE_3__.NgStyle], styles: [".ml-default[_nghost-%COMP%]   .cont[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n  max-height: 100%;\n  flex-wrap: nowrap;\n  margin-left: auto;\n  margin-right: auto;\n}\n.ml-default[_nghost-%COMP%]   .nav[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  z-index: 11;\n}\n.ml-default[_nghost-%COMP%]   .header[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  z-index: 1;\n}\n.ml-default[_nghost-%COMP%]   .nav2[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n}\n.ml-default[_nghost-%COMP%]   .over[_ngcontent-%COMP%] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 10;\n  background-color: white;\n}\n.ml-default[_nghost-%COMP%]   .columns[_ngcontent-%COMP%] {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: row;\n  position: relative;\n  overflow: auto;\n  overflow-y: unset;\n}\n.ml-default[_nghost-%COMP%]   .left[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 0;\n}\n.ml-default[_nghost-%COMP%]   .middle[_ngcontent-%COMP%] {\n  flex: 1 1 0;\n  display: flex;\n  flex-direction: column;\n  max-width: 100%;\n  overflow-x: hidden;\n}\n.ml-default[_nghost-%COMP%]   .center[_ngcontent-%COMP%] {\n  height: 100%;\n  flex: 1 1 auto;\n  overflow-y: auto;\n  overflow-x: hidden;\n  -webkit-flex: 1 1 auto;\n}\n.ml-default[_nghost-%COMP%]   .action[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  z-index: 1;\n}\n.ml-default[_nghost-%COMP%]   .right[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n.ml-default[_nghost-%COMP%]   .footer[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n}\n.ml-default[_nghost-%COMP%]   .status[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n}\n.ml-default[_nghost-%COMP%]   .loading[_ngcontent-%COMP%] {\n  display: flex;\n  height: 100%;\n  align-items: center;\n  justify-content: center;\n}\n.ml-sticky[_nghost-%COMP%]   .nav[_ngcontent-%COMP%] {\n  top: 0px;\n  z-index: 10;\n  position: -moz-sticky;\n  position: -o-sticky;\n  position: -ms-sticky;\n  position: sticky;\n}\n.ml-sticky[_nghost-%COMP%]   .columns[_ngcontent-%COMP%] {\n  display: flex;\n}\n.ml-sticky[_nghost-%COMP%]   .top[_ngcontent-%COMP%] {\n  display: none;\n}\n.ml-sticky[_nghost-%COMP%]   .left[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  position: sticky;\n  top: 64px;\n  height: 100%;\n  max-height: calc(100vh - 64px);\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.ml-sticky[_nghost-%COMP%]   .middle[_ngcontent-%COMP%] {\n  flex: 1 1 0;\n  display: flex;\n  flex-direction: column;\n  max-width: 100%;\n  overflow-x: hidden;\n  overflow-y: hidden;\n}\n.ml-sticky[_nghost-%COMP%]   .right[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  position: sticky;\n  top: 64px;\n  height: 100%;\n  max-height: 100vh;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.ml-sticky[_nghost-%COMP%]   .action[_ngcontent-%COMP%] {\n  flex: 0 0 auto;\n  z-index: 1;\n  position: -moz-sticky;\n  position: -o-sticky;\n  position: -ms-sticky;\n  position: sticky;\n  bottom: 0;\n}\n.ml-sticky[_nghost-%COMP%]   .loading[_ngcontent-%COMP%] {\n  display: flex;\n  height: 80vh;\n  align-items: center;\n  justify-content: center;\n}\n.sl-order-default[_nghost-%COMP%]   .left[_ngcontent-%COMP%], .sl-order-default[_nghost-%COMP%]   .right[_ngcontent-%COMP%] {\n  display: none;\n}\n.sl-order-default[_nghost-%COMP%]   .desktop[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%], .sl-order-default[_nghost-%COMP%]   .desktop[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%] {\n  display: block;\n}\n.sl-order-sidecat[_nghost-%COMP%]   .right[_ngcontent-%COMP%], .sl-order-sidecat[_nghost-%COMP%]   .nav2[_ngcontent-%COMP%] {\n  display: none;\n}\n.sl-order-sidecat[_nghost-%COMP%]   .desktop[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%] {\n  display: block;\n}\n.sl-order-kiosk[_nghost-%COMP%]   .action[_ngcontent-%COMP%] {\n  display: block !important;\n}\n.sl-order-kiosk[_nghost-%COMP%]   .footer[_ngcontent-%COMP%] {\n  display: block !important;\n}\n.sl-order-kiosk[_nghost-%COMP%]   .status[_ngcontent-%COMP%] {\n  display: block !important;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxheW91dC9kZWZhdWx0LnNjc3MiLCJjb250YWluZXItbGF5b3V0LmNvbXBvbmVudC5zY3NzIiwibGF5b3V0L3N0aWNreS5zY3NzIiwic3ViL29yZGVyLWRlZmF1bHQuc2NzcyIsInN1Yi9vcmRlci1zaWRlY2F0LnNjc3MiLCJzdWIvb3JkZXIta2lvc2suc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQTtFQUNJLGFBQUE7RUFDQSxzQkFBQTtFQUNBLFlBQUE7RUFDQSxXQUFBO0VBQ0EsZ0JBQUE7RUFDQSxpQkFBQTtFQUNBLGlCQUFBO0VBQ0Esa0JBQUE7QUNGSjtBRE9BO0VBRUksY0FBQTtFQUVBLFdBQUE7QUNQSjtBRFVBO0VBQ0ksY0FBQTtFQUNBLFVBQUE7QUNSSjtBRFdBO0VBQ0ksY0FBQTtBQ1RKO0FEWUE7RUFDSSxrQkFBQTtFQUNBLE1BQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxXQUFBO0VBQ0EsdUJBQUE7QUNWSjtBRGNBO0VBQ0ksY0FBQTtFQUNBLGFBQUE7RUFDQSxtQkFBQTtFQUNBLGtCQUFBO0VBQ0EsY0FBQTtFQUNBLGlCQUFBO0FDWko7QURlQTtFQUVJLGNBQUE7RUFDQSxnQkFBQTtFQUNBLGtCQUFBO0VBQ0EsVUFBQTtBQ2RKO0FEaUJBO0VBRUksV0FBQTtFQUNBLGFBQUE7RUFDQSxzQkFBQTtFQUNBLGVBQUE7RUFDQSxrQkFBQTtBQ2hCSjtBRG1CQTtFQUVJLFlBQUE7RUFFQSxjQUFBO0VBQ0EsZ0JBQUE7RUFDQSxrQkFBQTtFQUNBLHNCQUFBO0FDbkJKO0FEdUJBO0VBQ0ksY0FBQTtFQUNBLFVBQUE7QUNyQko7QUR3QkE7RUFFSSxjQUFBO0VBQ0EsZ0JBQUE7RUFDQSxrQkFBQTtBQ3ZCSjtBRDBCQTtFQUNJLGNBQUE7QUN4Qko7QUQyQkE7RUFDSSxjQUFBO0FDekJKO0FENEJBO0VBQ0ksYUFBQTtFQUNBLFlBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0FDMUJKO0FDdkVBO0VBQ0ksUUFBQTtFQUNBLFdBQUE7RUFFQSxxQkFBQTtFQUNBLG1CQUFBO0VBQ0Esb0JBQUE7RUFDQSxnQkFBQTtBRDBFSjtBQ3ZFQTtFQUNJLGFBQUE7QUR5RUo7QUN0RUE7RUFDSSxhQUFBO0FEd0VKO0FDcEVBO0VBQ0ksY0FBQTtFQUNBLGdCQUFBO0VBQ0EsU0FBQTtFQUdBLFlBQUE7RUFHQSw4QkFBQTtFQUNBLGtCQUFBO0VBQ0EsZ0JBQUE7QURrRUo7QUMvREE7RUFDSSxXQUFBO0VBQ0EsYUFBQTtFQUNBLHNCQUFBO0VBQ0EsZUFBQTtFQUNBLGtCQUFBO0VBQ0Esa0JBQUE7QURpRUo7QUM5REE7RUFDSSxjQUFBO0VBQ0EsZ0JBQUE7RUFDQSxTQUFBO0VBR0EsWUFBQTtFQUdBLGlCQUFBO0VBQ0Esa0JBQUE7RUFDQSxnQkFBQTtBRDRESjtBQ3ZEQTtFQUNJLGNBQUE7RUFDQSxVQUFBO0VBRUEscUJBQUE7RUFDQSxtQkFBQTtFQUNBLG9CQUFBO0VBQ0EsZ0JBQUE7RUFDQSxTQUFBO0FEeURKO0FDdERBO0VBQ0ksYUFBQTtFQUNBLFlBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0FEd0RKO0FFcElBO0VBQ0ksYUFBQTtBRnVJSjtBRWxJSTtFQUNJLGNBQUE7QUZvSVI7QUc1SUE7RUFDSSxhQUFBO0FIK0lKO0FHeklJO0VBQ0ksY0FBQTtBSDJJUjtBSTdJQTtFQUNJLHlCQUFBO0FKZ0pKO0FJN0lBO0VBQ0kseUJBQUE7QUorSUo7QUk1SUE7RUFDSSx5QkFBQTtBSjhJSiIsImZpbGUiOiJjb250YWluZXItbGF5b3V0LmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gRE8gTk9UIENIQU5HRSBUSElTOiBESVNDVVNTIFdJVEggUEVURVJcbi8vIERPIE5PVCBDSEFOR0UgVEhJUzogRElTQ1VTUyBXSVRIIFBFVEVSXG5cbi5jb250IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgaGVpZ2h0OiAxMDAlO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIG1heC1oZWlnaHQ6IDEwMCU7XG4gICAgZmxleC13cmFwOiBub3dyYXA7XG4gICAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gICAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xufVxuXG5cblxuLm5hdiB7XG5cbiAgICBmbGV4OiAwIDAgYXV0bztcbiAgICAvLyBvdmVyZmxvdzogaGlkZGVuO1xuICAgIHotaW5kZXg6IDExO1xufVxuXG4uaGVhZGVyIHtcbiAgICBmbGV4OiAwIDAgYXV0bztcbiAgICB6LWluZGV4OiAxO1xufVxuXG4ubmF2MiB7XG4gICAgZmxleDogMCAwIGF1dG87XG59XG5cbi5vdmVye1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB0b3A6MDtcbiAgICBsZWZ0OjA7XG4gICAgcmlnaHQ6MDtcbiAgICBib3R0b206MDtcbiAgICB6LWluZGV4OiAxMDtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcblxufVxuXG4uY29sdW1ucyB7XG4gICAgZmxleDogMSAxIGF1dG87XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICBvdmVyZmxvdzogYXV0bztcbiAgICBvdmVyZmxvdy15OiB1bnNldDtcbn1cblxuLmxlZnQge1xuICAgIC8vaGVpZ2h0OiAxMDAlO1xuICAgIGZsZXg6IDAgMCBhdXRvO1xuICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgb3ZlcmZsb3cteDogaGlkZGVuO1xuICAgIHBhZGRpbmc6IDA7XG59XG5cbi5taWRkbGUge1xuICAgIC8vaGVpZ2h0OiAxMDAlO1xuICAgIGZsZXg6IDEgMSAwO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBtYXgtd2lkdGg6IDEwMCU7XG4gICAgb3ZlcmZsb3cteDogaGlkZGVuO1xufVxuXG4uY2VudGVyIHtcbiAgICAvL05FRUQgdGhpcyBsaW5lIG9yIHNhZmFyaSBtaWdodCBoYXZlIDAgaGVpZ2h0XG4gICAgaGVpZ2h0OiAxMDAlO1xuXG4gICAgZmxleDogMSAxIGF1dG87XG4gICAgb3ZlcmZsb3cteTogYXV0bztcbiAgICBvdmVyZmxvdy14OiBoaWRkZW47XG4gICAgLXdlYmtpdC1mbGV4OiAxIDEgYXV0bztcblxufVxuXG4uYWN0aW9uIHtcbiAgICBmbGV4OiAwIDAgYXV0bztcbiAgICB6LWluZGV4OiAxO1xufVxuXG4ucmlnaHQge1xuICAgIC8vaGVpZ2h0OiAxMDAlO1xuICAgIGZsZXg6IDAgMCBhdXRvO1xuICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgb3ZlcmZsb3cteDogaGlkZGVuO1xufVxuXG4uZm9vdGVyIHtcbiAgICBmbGV4OiAwIDAgYXV0bztcbn1cblxuLnN0YXR1cyB7XG4gICAgZmxleDogMCAwIGF1dG87XG59XG5cbi5sb2FkaW5ne1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgaGVpZ2h0OiAxMDAlO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cbn1cblxuIiwiOmhvc3QubWwtZGVmYXVsdCAuY29udCB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIGhlaWdodDogMTAwJTtcbiAgd2lkdGg6IDEwMCU7XG4gIG1heC1oZWlnaHQ6IDEwMCU7XG4gIGZsZXgtd3JhcDogbm93cmFwO1xuICBtYXJnaW4tbGVmdDogYXV0bztcbiAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xufVxuOmhvc3QubWwtZGVmYXVsdCAubmF2IHtcbiAgZmxleDogMCAwIGF1dG87XG4gIHotaW5kZXg6IDExO1xufVxuOmhvc3QubWwtZGVmYXVsdCAuaGVhZGVyIHtcbiAgZmxleDogMCAwIGF1dG87XG4gIHotaW5kZXg6IDE7XG59XG46aG9zdC5tbC1kZWZhdWx0IC5uYXYyIHtcbiAgZmxleDogMCAwIGF1dG87XG59XG46aG9zdC5tbC1kZWZhdWx0IC5vdmVyIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG4gIHotaW5kZXg6IDEwO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbn1cbjpob3N0Lm1sLWRlZmF1bHQgLmNvbHVtbnMge1xuICBmbGV4OiAxIDEgYXV0bztcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBvdmVyZmxvdzogYXV0bztcbiAgb3ZlcmZsb3cteTogdW5zZXQ7XG59XG46aG9zdC5tbC1kZWZhdWx0IC5sZWZ0IHtcbiAgZmxleDogMCAwIGF1dG87XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIG92ZXJmbG93LXg6IGhpZGRlbjtcbiAgcGFkZGluZzogMDtcbn1cbjpob3N0Lm1sLWRlZmF1bHQgLm1pZGRsZSB7XG4gIGZsZXg6IDEgMSAwO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICBtYXgtd2lkdGg6IDEwMCU7XG4gIG92ZXJmbG93LXg6IGhpZGRlbjtcbn1cbjpob3N0Lm1sLWRlZmF1bHQgLmNlbnRlciB7XG4gIGhlaWdodDogMTAwJTtcbiAgZmxleDogMSAxIGF1dG87XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIG92ZXJmbG93LXg6IGhpZGRlbjtcbiAgLXdlYmtpdC1mbGV4OiAxIDEgYXV0bztcbn1cbjpob3N0Lm1sLWRlZmF1bHQgLmFjdGlvbiB7XG4gIGZsZXg6IDAgMCBhdXRvO1xuICB6LWluZGV4OiAxO1xufVxuOmhvc3QubWwtZGVmYXVsdCAucmlnaHQge1xuICBmbGV4OiAwIDAgYXV0bztcbiAgb3ZlcmZsb3cteTogYXV0bztcbiAgb3ZlcmZsb3cteDogaGlkZGVuO1xufVxuOmhvc3QubWwtZGVmYXVsdCAuZm9vdGVyIHtcbiAgZmxleDogMCAwIGF1dG87XG59XG46aG9zdC5tbC1kZWZhdWx0IC5zdGF0dXMge1xuICBmbGV4OiAwIDAgYXV0bztcbn1cbjpob3N0Lm1sLWRlZmF1bHQgLmxvYWRpbmcge1xuICBkaXNwbGF5OiBmbGV4O1xuICBoZWlnaHQ6IDEwMCU7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xufVxuXG46aG9zdC5tbC1zdGlja3kgLm5hdiB7XG4gIHRvcDogMHB4O1xuICB6LWluZGV4OiAxMDtcbiAgcG9zaXRpb246IC13ZWJraXQtc3RpY2t5O1xuICBwb3NpdGlvbjogLW1vei1zdGlja3k7XG4gIHBvc2l0aW9uOiAtby1zdGlja3k7XG4gIHBvc2l0aW9uOiAtbXMtc3RpY2t5O1xuICBwb3NpdGlvbjogc3RpY2t5O1xufVxuOmhvc3QubWwtc3RpY2t5IC5jb2x1bW5zIHtcbiAgZGlzcGxheTogZmxleDtcbn1cbjpob3N0Lm1sLXN0aWNreSAudG9wIHtcbiAgZGlzcGxheTogbm9uZTtcbn1cbjpob3N0Lm1sLXN0aWNreSAubGVmdCB7XG4gIGZsZXg6IDAgMCBhdXRvO1xuICBwb3NpdGlvbjogc3RpY2t5O1xuICB0b3A6IDY0cHg7XG4gIGhlaWdodDogMTAwJTtcbiAgbWF4LWhlaWdodDogY2FsYygxMDB2aCAtIDY0cHgpO1xuICBvdmVyZmxvdy14OiBoaWRkZW47XG4gIG92ZXJmbG93LXk6IGF1dG87XG59XG46aG9zdC5tbC1zdGlja3kgLm1pZGRsZSB7XG4gIGZsZXg6IDEgMSAwO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICBtYXgtd2lkdGg6IDEwMCU7XG4gIG92ZXJmbG93LXg6IGhpZGRlbjtcbiAgb3ZlcmZsb3cteTogaGlkZGVuO1xufVxuOmhvc3QubWwtc3RpY2t5IC5yaWdodCB7XG4gIGZsZXg6IDAgMCBhdXRvO1xuICBwb3NpdGlvbjogc3RpY2t5O1xuICB0b3A6IDY0cHg7XG4gIGhlaWdodDogMTAwJTtcbiAgbWF4LWhlaWdodDogMTAwdmg7XG4gIG92ZXJmbG93LXg6IGhpZGRlbjtcbiAgb3ZlcmZsb3cteTogYXV0bztcbn1cbjpob3N0Lm1sLXN0aWNreSAuYWN0aW9uIHtcbiAgZmxleDogMCAwIGF1dG87XG4gIHotaW5kZXg6IDE7XG4gIHBvc2l0aW9uOiAtd2Via2l0LXN0aWNreTtcbiAgcG9zaXRpb246IC1tb3otc3RpY2t5O1xuICBwb3NpdGlvbjogLW8tc3RpY2t5O1xuICBwb3NpdGlvbjogLW1zLXN0aWNreTtcbiAgcG9zaXRpb246IHN0aWNreTtcbiAgYm90dG9tOiAwO1xufVxuOmhvc3QubWwtc3RpY2t5IC5sb2FkaW5nIHtcbiAgZGlzcGxheTogZmxleDtcbiAgaGVpZ2h0OiA4MHZoO1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbn1cblxuOmhvc3Quc2wtb3JkZXItZGVmYXVsdCAubGVmdCwgOmhvc3Quc2wtb3JkZXItZGVmYXVsdCAucmlnaHQge1xuICBkaXNwbGF5OiBub25lO1xufVxuOmhvc3Quc2wtb3JkZXItZGVmYXVsdCAuZGVza3RvcCAubGVmdCwgOmhvc3Quc2wtb3JkZXItZGVmYXVsdCAuZGVza3RvcCAucmlnaHQge1xuICBkaXNwbGF5OiBibG9jaztcbn1cblxuOmhvc3Quc2wtb3JkZXItc2lkZWNhdCAucmlnaHQsIDpob3N0LnNsLW9yZGVyLXNpZGVjYXQgLm5hdjIge1xuICBkaXNwbGF5OiBub25lO1xufVxuOmhvc3Quc2wtb3JkZXItc2lkZWNhdCAuZGVza3RvcCAucmlnaHQge1xuICBkaXNwbGF5OiBibG9jaztcbn1cblxuOmhvc3Quc2wtb3JkZXIta2lvc2sgLmFjdGlvbiB7XG4gIGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7XG59XG46aG9zdC5zbC1vcmRlci1raW9zayAuZm9vdGVyIHtcbiAgZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDtcbn1cbjpob3N0LnNsLW9yZGVyLWtpb3NrIC5zdGF0dXMge1xuICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50O1xufSIsIi8vIERPIE5PVCBDSEFOR0UgVEhJUzogRElTQ1VTUyBXSVRIIFBFVEVSXG4vLyBETyBOT1QgQ0hBTkdFIFRISVM6IERJU0NVU1MgV0lUSCBQRVRFUlxuXG4uY29udCB7XG5cbn1cblxuLm5hdiB7XG4gICAgdG9wOjBweDtcbiAgICB6LWluZGV4OiAxMDtcbiAgICBwb3NpdGlvbjogLXdlYmtpdC1zdGlja3k7XG4gICAgcG9zaXRpb246IC1tb3otc3RpY2t5O1xuICAgIHBvc2l0aW9uOiAtby1zdGlja3k7XG4gICAgcG9zaXRpb246IC1tcy1zdGlja3k7XG4gICAgcG9zaXRpb246IHN0aWNreTtcbn1cblxuLmNvbHVtbnMge1xuICAgIGRpc3BsYXk6IGZsZXg7XG59XG5cbi50b3B7XG4gICAgZGlzcGxheTogbm9uZTtcbn1cblxuXG4ubGVmdCB7XG4gICAgZmxleDogMCAwIGF1dG87XG4gICAgcG9zaXRpb246IHN0aWNreTtcbiAgICB0b3A6IDY0cHg7XG5cbiAgICAvL1RISVMgTElORSBJUyBDUklUSUNBTCwgRE8gTk9UIFJFTU9WRVxuICAgIGhlaWdodDogMTAwJTtcblxuICAgIC8vbWF4LWhlaWdodDogODB2aDtcbiAgICBtYXgtaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNjRweCk7XG4gICAgb3ZlcmZsb3cteDogaGlkZGVuO1xuICAgIG92ZXJmbG93LXk6IGF1dG87XG59XG5cbi5taWRkbGUge1xuICAgIGZsZXg6IDEgMSAwO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBtYXgtd2lkdGg6IDEwMCU7XG4gICAgb3ZlcmZsb3cteDogaGlkZGVuO1xuICAgIG92ZXJmbG93LXk6IGhpZGRlbjtcbn1cblxuLnJpZ2h0IHtcbiAgICBmbGV4OiAwIDAgYXV0bztcbiAgICBwb3NpdGlvbjogc3RpY2t5O1xuICAgIHRvcDogNjRweDtcblxuICAgIC8vVEhJUyBMSU5FIElTIENSSVRJQ0FMLCBETyBOT1QgUkVNT1ZFXG4gICAgaGVpZ2h0OiAxMDAlO1xuXG4gICAgLy9tYXgtaGVpZ2h0OiA4MHZoO1xuICAgIG1heC1oZWlnaHQ6IDEwMHZoO1xuICAgIG92ZXJmbG93LXg6IGhpZGRlbjtcbiAgICBvdmVyZmxvdy15OiBhdXRvO1xufVxuXG5cblxuLmFjdGlvbiB7XG4gICAgZmxleDogMCAwIGF1dG87XG4gICAgei1pbmRleDogMTtcbiAgICBwb3NpdGlvbjogLXdlYmtpdC1zdGlja3k7XG4gICAgcG9zaXRpb246IC1tb3otc3RpY2t5O1xuICAgIHBvc2l0aW9uOiAtby1zdGlja3k7XG4gICAgcG9zaXRpb246IC1tcy1zdGlja3k7XG4gICAgcG9zaXRpb246IHN0aWNreTtcbiAgICBib3R0b206IDA7XG59XG5cbi5sb2FkaW5ne1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgaGVpZ2h0OiA4MHZoO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59XG4iLCIvLyBETyBOT1QgQ0hBTkdFIFRISVM6IERJU0NVU1MgV0lUSCBQRVRFUlxuLy8gRE8gTk9UIENIQU5HRSBUSElTOiBESVNDVVNTIFdJVEggUEVURVJcblxuXG4ubGVmdCwgLnJpZ2h0e1xuICAgIGRpc3BsYXk6IG5vbmU7XG59XG5cbi5kZXNrdG9we1xuXG4gICAgLmxlZnQsIC5yaWdodHtcbiAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgfVxufVxuIiwiLy8gRE8gTk9UIENIQU5HRSBUSElTOiBESVNDVVNTIFdJVEggUEVURVJcbi8vIERPIE5PVCBDSEFOR0UgVEhJUzogRElTQ1VTUyBXSVRIIFBFVEVSXG5cbi5yaWdodCwgLm5hdjJ7XG4gICAgZGlzcGxheTogbm9uZTtcbn1cblxuXG4uZGVza3RvcHtcblxuICAgIC5yaWdodHtcbiAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgfVxufVxuXG4iLCIvLyBETyBOT1QgQ0hBTkdFIFRISVM6IERJU0NVU1MgV0lUSCBQRVRFUlxuLy8gRE8gTk9UIENIQU5HRSBUSElTOiBESVNDVVNTIFdJVEggUEVURVJcblxuXG4ubGVmdHtcblxufVxuXG5cbi5hY3Rpb257XG4gICAgZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDtcbn1cblxuLmZvb3RlcntcbiAgICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50O1xufVxuXG4uc3RhdHVze1xuICAgIGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7XG59XG4iXX0= */"] });


/***/ }),

/***/ 79420:
/*!*********************************************!*\
  !*** ./projects/ux/src/app/ux/ux.module.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UxModule": () => (/* binding */ UxModule)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @angular/common */ 36362);
/* harmony import */ var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @ngx-translate/core */ 33935);
/* harmony import */ var _ui_src_app_ui_ui_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../ui/src/app/ui/ui.module */ 39420);
/* harmony import */ var _components_footer_footer_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./components/footer/footer.component */ 47119);
/* harmony import */ var _components_language_select_language_select_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./components/language-select/language-select.component */ 51093);
/* harmony import */ var _components_nav_bar_nav_bar_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./components/nav-bar/nav-bar.component */ 84904);
/* harmony import */ var _components_sub_bar_sub_bar_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./components/sub-bar/sub-bar.component */ 61204);
/* harmony import */ var _components_swiper_swiper_component__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./components/swiper/swiper.component */ 68163);
/* harmony import */ var _components_user_button_user_button_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./components/user-button/user-button.component */ 39746);
/* harmony import */ var _layouts_container_layout_container_layout_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./layouts/container-layout/container-layout.component */ 37073);
/* harmony import */ var _components_search_button_search_button_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./components/search-button/search-button.component */ 5907);
/* harmony import */ var _components_favorite_items_button_favorite_items_button_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./components/favorite-items-button/favorite-items-button.component */ 18906);
/* harmony import */ var _components_refresh_button_refresh_button_component__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./components/refresh-button/refresh-button.component */ 6719);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @angular/core */ 3184);







//import { SwiperModule } from 'swiper/angular';







const MY_COMPONENTS = [
    _components_nav_bar_nav_bar_component__WEBPACK_IMPORTED_MODULE_3__.NavBarComponent, _components_language_select_language_select_component__WEBPACK_IMPORTED_MODULE_2__.LanguageSelectComponent, _layouts_container_layout_container_layout_component__WEBPACK_IMPORTED_MODULE_7__.ContainerLayoutComponent, _components_swiper_swiper_component__WEBPACK_IMPORTED_MODULE_5__.SwiperComponent, _components_user_button_user_button_component__WEBPACK_IMPORTED_MODULE_6__.UserButtonComponent, _components_sub_bar_sub_bar_component__WEBPACK_IMPORTED_MODULE_4__.SubBarComponent, _components_footer_footer_component__WEBPACK_IMPORTED_MODULE_1__.FooterComponent, _components_favorite_items_button_favorite_items_button_component__WEBPACK_IMPORTED_MODULE_9__.FavoriteItemsButtonComponent
];
const MY_PIPES = [];
//PLEASE DO NOT INCLUDE MATERIAL DEPENDENCY
class UxModule {
}
UxModule.ɵfac = function UxModule_Factory(t) { return new (t || UxModule)(); };
UxModule.ɵmod = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdefineNgModule"]({ type: UxModule });
UxModule.ɵinj = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵdefineInjector"]({ imports: [_angular_common__WEBPACK_IMPORTED_MODULE_12__.CommonModule,
        _ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__.TranslateModule,
        _ui_src_app_ui_ui_module__WEBPACK_IMPORTED_MODULE_0__.UiModule] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && _angular_core__WEBPACK_IMPORTED_MODULE_11__["ɵɵsetNgModuleScope"](UxModule, { declarations: [_components_nav_bar_nav_bar_component__WEBPACK_IMPORTED_MODULE_3__.NavBarComponent, _components_language_select_language_select_component__WEBPACK_IMPORTED_MODULE_2__.LanguageSelectComponent, _layouts_container_layout_container_layout_component__WEBPACK_IMPORTED_MODULE_7__.ContainerLayoutComponent, _components_swiper_swiper_component__WEBPACK_IMPORTED_MODULE_5__.SwiperComponent, _components_user_button_user_button_component__WEBPACK_IMPORTED_MODULE_6__.UserButtonComponent, _components_sub_bar_sub_bar_component__WEBPACK_IMPORTED_MODULE_4__.SubBarComponent, _components_footer_footer_component__WEBPACK_IMPORTED_MODULE_1__.FooterComponent, _components_favorite_items_button_favorite_items_button_component__WEBPACK_IMPORTED_MODULE_9__.FavoriteItemsButtonComponent, _components_search_button_search_button_component__WEBPACK_IMPORTED_MODULE_8__.SearchButtonComponent,
        _components_refresh_button_refresh_button_component__WEBPACK_IMPORTED_MODULE_10__.RefreshButtonComponent], imports: [_angular_common__WEBPACK_IMPORTED_MODULE_12__.CommonModule,
        _ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__.TranslateModule,
        _ui_src_app_ui_ui_module__WEBPACK_IMPORTED_MODULE_0__.UiModule], exports: [_components_nav_bar_nav_bar_component__WEBPACK_IMPORTED_MODULE_3__.NavBarComponent, _components_language_select_language_select_component__WEBPACK_IMPORTED_MODULE_2__.LanguageSelectComponent, _layouts_container_layout_container_layout_component__WEBPACK_IMPORTED_MODULE_7__.ContainerLayoutComponent, _components_swiper_swiper_component__WEBPACK_IMPORTED_MODULE_5__.SwiperComponent, _components_user_button_user_button_component__WEBPACK_IMPORTED_MODULE_6__.UserButtonComponent, _components_sub_bar_sub_bar_component__WEBPACK_IMPORTED_MODULE_4__.SubBarComponent, _components_footer_footer_component__WEBPACK_IMPORTED_MODULE_1__.FooterComponent, _components_favorite_items_button_favorite_items_button_component__WEBPACK_IMPORTED_MODULE_9__.FavoriteItemsButtonComponent] }); })();


/***/ }),

/***/ 11748:
/*!********************************************************!*\
  !*** ./node_modules/moment-mini/locale/ sync ^\.\/.*$ ***!
  \********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var map = {
	"./locale": 86333,
	"./locale.js": 86333
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = 11748;

/***/ }),

/***/ 58415:
/*!**********************!*\
  !*** util (ignored) ***!
  \**********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ 74545:
/*!**********************!*\
  !*** util (ignored) ***!
  \**********************/
/***/ (() => {

/* (ignored) */

/***/ })

},
/******/ __webpack_require__ => { // webpackRuntimeModules
/******/ var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
/******/ __webpack_require__.O(0, ["vendor"], () => (__webpack_exec__(33318)));
/******/ var __webpack_exports__ = __webpack_require__.O();
/******/ }
]);
//# sourceMappingURL=main.js.map